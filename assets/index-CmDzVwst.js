import{j as e,r as s,a as Pa,R as ja,b as Rt}from"./react-vendor-Hgd2odX0.js";import{e as ba,A as Wa}from"./vendor-CH2QN212.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))o(c);new MutationObserver(c=>{for(const k of c)if(k.type==="childList")for(const f of k.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function t(c){const k={};return c.integrity&&(k.integrity=c.integrity),c.referrerPolicy&&(k.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?k.credentials="include":c.crossOrigin==="anonymous"?k.credentials="omit":k.credentials="same-origin",k}function o(c){if(c.ep)return;c.ep=!0;const k=t(c);fetch(c.href,k)}})();const Oe=({className:a="w-10 h-10",src:r})=>e.jsx("img",{src:r||"https://imgur.com/5wRslAz.png",alt:"Logo Miftahul Huda",className:`object-contain ${a}`,onError:t=>{t.currentTarget.src="https://imgur.com/5wRslAz.png"}}),wt=s.createContext(void 0),Wt=({children:a})=>{const[r,t]=s.useState({}),o=s.useRef({});s.useEffect(()=>{o.current=r},[r]);const c=s.useCallback((D,B)=>{t(p=>({...p,[D]:B}))},[]),k=s.useCallback(async(D,B,p,m=!1,u=!0)=>{if(o.current[D]&&!m)return console.log(`${p} : Load Data Local Cache`),o.current[D];try{const i=await B(),g=i._meta,K=(g==null?void 0:g.isFallback)||!1,h=(g==null?void 0:g.path)||"",M=u&&Array.isArray(i)?i[0]:i;if(t(w=>({...w,[D]:M})),K){const w=h.startsWith("/")?h.substring(1):h;console.log(`${p} : public/${w}`)}else console.log(`${p} : Load Data From KV publik/${String(D)}`);return M}catch(i){throw console.error(`Gagal mengambil data ${String(D)}`,i),i}},[]),f=()=>t({});return e.jsx(wt.Provider,{value:{cache:r,fetchData:k,updateCache:c,clearCache:f},children:a})},ge=()=>{const a=s.useContext(wt);if(a===void 0)throw new Error("useData must be used within a DataProvider");return a},Et="https://website.server-miftahulhuda.workers.dev/api",aa={"/content/publik/beranda":"/admin/publik/beranda.json","/content/publik/profil":"/admin/publik/profil.json","/content/publik/akademik":"/admin/publik/akademik.json","/content/publik/galeri":"/admin/publik/galeri.json","/content/publik/berita":"/admin/publik/berita.json","/content/publik/pendaftaran":"/admin/publik/pendaftaran.json","/content/donasi/rencana":"/admin/publik/donasi.json","/content/keuangan/rekening":"/admin/keuangan/rekening.json","/content/donasi/transaksi":"/admin/publik/donasi_transaksi.json","/content/donasi/donatur":"/admin/publik/donasi_donatur.json","/content/database/santri":"/database/santri.json","/content/database/kepegawaian":"/database/kepegawaian.json","/content/database/akun":"/database/akun.json","/content/database/akses":"/database/akses.json","/content/database/token":"/database/token.json","/content/database/dewankiyai":"/database/dewankiyai.json","/content/publik/dasar":"/admin/publik/dasar.json","/content/koperasi/produk":"/admin/keuangan/koperasi/produk.json","/content/koperasi/transaksi":"/admin/keuangan/koperasi/transaksi.json","/content/koperasi/tambahan":"/admin/keuangan/koperasi/tambahan.json","/content/keuangan/transaksi":"/admin/keuangan/umum/transaksi.json","/content/keuangan/biaya":"/admin/keuangan/umum/biaya.json","/content/admin/agenda":"/admin/agenda.json","/content/admin/persuratan":"/admin/persuratan.json","/content/admin/berita":"/admin/publik/berita.json","/content/realtime/notifikasi":"/realtime/notifikasi.json"};async function ce(a,r="GET",t){const o={method:r,headers:{"Content-Type":"application/json"}};t&&(o.body=JSON.stringify(t));try{const c=await fetch(`${Et}${a}`,o);if(!c.ok){if(r==="GET"&&aa[a]){console.warn(`[API FAIL] ${a} -> Try Local: ${aa[a]}`);try{const f=await fetch(aa[a]);if(f.ok)return await f.json()}catch(f){console.error("Local fallback failed:",f)}}const k=await c.text();throw new Error(`API Error ${c.status}: ${k}`)}return c.json()}catch(c){if(r==="GET"&&aa[a]){console.warn(`[NET FAIL] ${a} -> Try Local: ${aa[a]}`);const k=await fetch(aa[a]);if(k.ok)return k.json()}throw c}}async function Ht(){try{const[a,r]=await Promise.all([ce("/content/database/akun","GET"),ce("/content/database/akses","GET")]),t=(Array.isArray(a)?a:[]).map(c=>{const k=Array.isArray(r)?r.find(f=>f.id_akun===c.verifikasi_akun.id_akun):null;return{...c,data_akun:{...c.data_akun,akses:k?k.akses:[],filter_santri:k?k.filter_santri:""}}});return[...(Array.isArray(r)?r:[]).filter(c=>c.peran).map(c=>({verifikasi_akun:{id_akun:c.id_akun,id_santri:"-"},data_akun:{peran:c.peran,nama:c.nama,jabatan:c.jabatan||"Staff",email:c.email,telepon:"-",hash_kata_sandi:c.password,dibuat:new Date().toISOString(),akses:c.akses||[],filter_santri:c.filter_santri||""}})),...t]}catch(a){return console.error("Gagal merge roles",a),[]}}const G={login:a=>{const r={username:a.username,password:a.password||a.hash_kata_sandi};return ce("/auth/login","POST",r)},getRoles:()=>Ht(),updateRoles:a=>ce("/content/database/akun","PUT",a),getBeranda:()=>ce("/content/publik/beranda"),getProfil:()=>ce("/content/publik/profil"),getAkademik:()=>ce("/content/publik/akademik"),getGaleri:()=>ce("/content/publik/galeri"),getBerita:()=>ce("/content/publik/berita"),getDonasiRencana:()=>ce("/content/donasi/rencana"),updateDonasiRencana:a=>ce("/content/donasi/rencana","PUT",a),getRekening:()=>ce("/content/keuangan/rekening"),updateRekening:a=>ce("/content/keuangan/rekening","PUT",a),getDonasiTransaksi:()=>ce("/content/donasi/transaksi"),getDonasiDonatur:()=>ce("/content/donasi/donatur"),updateDonasiDonatur:a=>ce("/content/donasi/donatur","PUT",a),getPendaftaranPage:()=>ce("/content/publik/pendaftaran"),updatePublicContent:(a,r)=>ce(`/content/publik/${a}`,"PUT",r),getWaliAkademik:()=>ce("/content/wali/akademik"),getWaliKeuangan:()=>ce("/content/wali/keuangan"),getWaliNotifikasi:()=>ce("/content/realtime/notifikasi"),getWaliTagihan:()=>ce("/content/realtime/tagihan"),getWaliTransaksi:()=>ce("/content/realtime/transaksi"),getDatabaseSantri:()=>ce("/content/database/santri"),getKepegawaian:()=>ce("/content/database/kepegawaian"),updateKepegawaian:a=>ce("/content/database/kepegawaian","PUT",a),getDewanKiyai:()=>ce("/content/database/dewankiyai"),updateDewanKiyai:a=>ce("/content/database/dewankiyai","PUT",a),getDatabaseAkun:()=>ce("/content/database/akun"),getAiTokens:()=>ce("/content/database/token"),updateAiTokens:a=>ce("/content/database/token","PUT",a),getDasar:()=>ce("/content/publik/dasar"),getPendaftar:()=>ce("/content/database/santri"),submitPendaftaran:a=>ce("/content/database/santri","POST",a),updatePendaftarList:a=>ce("/content/database/santri","PUT",a),getAdminBeranda:()=>ce("/content/admin/beranda"),getKoperasiProduk:()=>ce("/content/koperasi/produk"),getKoperasiTambahan:()=>ce("/content/koperasi/tambahan"),updateKoperasiTambahan:a=>ce("/content/koperasi/tambahan","PUT",a),updateKoperasiProduk:a=>ce("/content/koperasi/produk","PUT",a),getKoperasiTransaksi:()=>ce("/content/koperasi/transaksi"),updateKoperasiTransaksi:a=>ce("/content/koperasi/transaksi","PUT",a),getPersuratan:()=>ce("/content/admin/persuratan"),getAdminBerita:()=>ce("/content/admin/publikasi"),getAgenda:()=>ce("/content/admin/agenda"),getKeuanganTransaksi:()=>ce("/content/keuangan/transaksi"),updateKeuanganTransaksi:a=>ce("/content/keuangan/transaksi","PUT",a),getKeuanganBiaya:()=>ce("/content/keuangan/biaya"),updateKeuanganBiaya:a=>ce("/content/keuangan/biaya","PUT",a),submitDonation:async(a,r)=>{try{const t=await ce("/content/keuangan/transaksi","GET"),o=Array.isArray(t)?t:[];await ce("/content/keuangan/transaksi","PUT",[a,...o])}catch(t){console.error("Failed to save transaction",t)}try{const t=await ce("/content/donasi/donatur","GET"),o=Array.isArray(t)?t:[],c=o.findIndex(k=>k.id_donatur===r.id_donatur);if(c>=0){const k=o[c];o[c]={...k,jumlah_donasi:(k.jumlah_donasi||0)+r.jumlah_donasi}}else o.push(r);await ce("/content/donasi/donatur","PUT",o)}catch(t){console.error("Failed to save donor data",t)}return!0},updateTransactionList:a=>ce("/content/realtime/transaksi","PUT",a),updateTagihanList:a=>ce("/content/realtime/tagihan","PUT",a),getSettings:()=>ce("/settings"),syncDatabase:async a=>{let r=0,t=0;for(const[o,c]of Object.entries(aa))try{a&&a(`Mengupload ${c}...`);const k=await fetch(c);if(!k.ok)throw new Error(`Gagal baca lokal ${c}`);const f=await k.json();await ce(o,"PUT",f),r++}catch(k){console.error(`Gagal sync ${o}:`,k),t++}return{success:r,failed:t}}},Ot=({activePage:a,onNavigate:r,onLogin:t,selectedNews:o,onBackNews:c,isMobileMenuOpen:k,setIsMobileMenuOpen:f})=>{const{fetchData:D,cache:B}=ge(),[p,m]=s.useState(!1),[u,i]=s.useState(null),g={nama:"Miftahul Huda",sub_nama:"Al-Burhani",logo:"https://imgur.com/5wRslAz.png"};s.useEffect(()=>{(async()=>{if(B.dasar)i(Array.isArray(B.dasar)?B.dasar[0]:B.dasar);else try{const N=await D("dasar",G.getDasar,"Navbar",!1,!1);i(Array.isArray(N)?N[0]:N)}catch{}})()},[D,B.dasar]);const K=u||g;s.useEffect(()=>{const j=()=>{window.scrollY>20?m(!0):m(!1)};return window.addEventListener("scroll",j),()=>window.removeEventListener("scroll",j)},[]),s.useEffect(()=>(k?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[k]);const h=[{label:"Beranda",value:"HOME",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 01 1v4a1 1 0 001 1m-6 0h6"})})},{label:"Profil",value:"PROFIL",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h-5 10v-5a1 1 0 011-1h2a1 1 0 01 1v5m-4 0h4"})})},{label:"Akademik",value:"AKADEMIK",icon:e.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 14l9-5-9-5-9 5 9 5z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"})]})},{label:"Fasilitas",value:"FASILITAS",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 01 1v4a1 1 0 001 1m-6 0h6"})})},{label:"Koperasi",value:"KOPERASI",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})},{label:"Galeri",value:"GALERI",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})},{label:"Berita",value:"BERITA",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"})})},{label:"Pendaftaran",value:"PENDAFTARAN",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}],M=[{type:"link",...h[0]},{type:"link",...h[1]},{type:"link",...h[2]},{type:"group",label:"Publikasi",value:"PUBLIKASI",children:[h[3],h[5],h[6]]},{type:"link",...h[4]},{type:"link",...h[7]}],w=p||o!==null||a==="AI_CHAT"||a==="PENDAFTARAN",d=w?"bg-white/95 backdrop-blur-xl border-slate-200/50 shadow-sm":"bg-transparent border-transparent",C=w?"text-slate-600":"text-white/90",L=w?"hover:text-emerald-700":"hover:text-white",P=w?"text-emerald-950":"text-white",y=w?"text-emerald-600":"text-yellow-400",z=j=>j?w?"text-emerald-700 font-bold":"text-white font-bold drop-shadow-md":`font-medium ${C} ${L}`;return e.jsxs(e.Fragment,{children:[e.jsx("nav",{className:`fixed top-0 left-0 right-0 z-[60] transition-all duration-500 ease-in-out border-b ${d} h-20`,children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-full",children:e.jsxs("div",{className:"flex justify-between items-center h-full",children:[e.jsxs("div",{className:"flex items-center space-x-3 cursor-pointer group",onClick:()=>{o?(c(),r("BERITA")):r("HOME")},children:[e.jsx("div",{className:`
                    relative w-10 h-10 md:w-11 md:h-11 flex items-center justify-center rounded-xl transition-all duration-500
                    ${w?"bg-emerald-50":"bg-white/10 backdrop-blur-md ring-1 ring-white/20"}
                    group-hover:scale-105
                `,children:e.jsx(Oe,{src:K.logo,className:"w-7 h-7 md:w-8 md:h-8 object-contain"})}),e.jsxs("div",{className:"flex flex-col justify-center",children:[e.jsx("span",{className:`font-serif font-bold text-lg md:text-xl leading-none tracking-tight transition-colors duration-500 ${P}`,children:K.nama}),e.jsx("span",{className:`text-[9px] md:text-[10px] uppercase tracking-[0.2em] font-bold transition-colors duration-500 font-sans mt-1 ${y}`,children:K.sub_nama})]})]}),e.jsx("div",{className:"hidden lg:flex items-center gap-2 h-full",children:M.map((j,N)=>{var A,S;if(j.type==="link"){const b=a===j.value;return e.jsx("button",{onClick:()=>r(j.value),className:`
                                    relative px-4 h-full flex items-center justify-center text-sm transition-all duration-300
                                    ${z(b)}
                                    group
                                `,children:e.jsxs("div",{className:"relative py-1",children:[j.label,e.jsx("span",{className:`absolute -bottom-1 left-0 w-full h-[2px] rounded-full transition-transform duration-300 ${b?"scale-x-100":"scale-x-0 group-hover:scale-x-50"} ${w?"bg-emerald-600":"bg-yellow-400"}`})]})},N)}else if(j.type==="group"){const b=(A=j.children)==null?void 0:A.some(T=>T.value===a);return e.jsxs("div",{className:"relative h-full flex items-center group px-2",children:[e.jsx("button",{className:`
                                        flex items-center gap-1.5 px-3 h-full text-sm transition-all duration-300
                                        ${z(b||!1)}
                                    `,children:e.jsxs("div",{className:"relative py-1 flex items-center gap-1",children:[j.label,e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 transition-transform duration-300 group-hover:rotate-180 ${b?w?"text-emerald-600":"text-yellow-400":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),e.jsx("span",{className:`absolute -bottom-1 left-0 w-full h-[2px] rounded-full transition-transform duration-300 ${b?"scale-x-100":"scale-x-0 group-hover:scale-x-50"} ${w?"bg-emerald-600":"bg-yellow-400"}`})]})}),e.jsx("div",{className:"absolute top-[80%] left-0 pt-4 w-56 invisible group-hover:visible opacity-0 group-hover:opacity-100 transition-all duration-300 ease-in-out z-[100]",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-xl border border-slate-100 overflow-hidden p-2 transform translate-y-2 group-hover:translate-y-0 transition-transform",children:(S=j.children)==null?void 0:S.map((T,$)=>e.jsxs("button",{onClick:()=>r(T.value),className:`
                                                    w-full text-left px-4 py-3 rounded-xl text-sm font-bold transition-colors flex items-center gap-3
                                                    ${a===T.value?"bg-emerald-50 text-emerald-700":"text-slate-600 hover:bg-slate-50 hover:text-emerald-600"}
                                                `,children:[e.jsx("span",{className:`${a===T.value?"text-emerald-600":"text-slate-400"}`,children:T.icon}),T.label]},$))})})]},N)}return null})}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>r("DONASI"),className:`
                          hidden md:flex items-center gap-2 px-5 py-2.5 rounded-full text-sm font-bold shadow-lg transition-all transform hover:-translate-y-0.5 active:scale-95
                          bg-gradient-to-r from-yellow-400 to-amber-500 text-white hover:shadow-amber-500/30
                      `,children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),"Donasi"]}),e.jsx("button",{onClick:t,className:`
                          hidden md:flex items-center gap-2 px-6 py-2.5 rounded-full text-sm font-bold transition-all border
                          ${w?"bg-slate-900 text-white border-slate-900 hover:bg-slate-800":"bg-white/10 text-white border-white/20 backdrop-blur-md hover:bg-white/20"}
                      `,children:"Masuk"}),e.jsx("button",{onClick:()=>f(!k),className:`
                          lg:hidden p-2.5 rounded-xl transition-all
                          ${w?"text-slate-800 hover:bg-slate-100":"text-white hover:bg-white/10"}
                      `,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:k?"M6 18L18 6M6 6l12 12":"M4 6h16M4 12h16m-7 6h7"})})})]})]})})}),e.jsxs("div",{className:`fixed inset-0 z-[60] lg:hidden transition-all duration-300 ${k?"visible":"invisible delay-300"}`,children:[e.jsx("div",{className:`absolute inset-0 bg-slate-900/60 backdrop-blur-sm transition-opacity duration-300 ${k?"opacity-100":"opacity-0"}`,onClick:()=>f(!1)}),e.jsxs("div",{className:`absolute top-0 right-0 h-full w-[85%] max-w-[320px] bg-white shadow-2xl flex flex-col transform transition-transform duration-300 ease-out ${k?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 flex items-center justify-between bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Oe,{className:"w-8 h-8",src:K.logo}),e.jsx("div",{className:"flex flex-col",children:e.jsx("span",{className:"font-serif font-bold text-lg text-slate-900 leading-none",children:K.nama})})]}),e.jsx("button",{onClick:()=>f(!1),className:"p-2 rounded-full bg-slate-50 text-slate-400 hover:bg-rose-50 hover:text-rose-500 transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:[e.jsx("p",{className:"px-2 text-[10px] font-black text-slate-400 uppercase tracking-widest mb-3 mt-2",children:"Menu Utama"}),e.jsx("div",{className:"space-y-1",children:h.map(j=>e.jsxs("button",{onClick:()=>{r(j.value),f(!1)},className:`w-full text-left px-4 py-3 rounded-xl text-sm font-bold flex items-center gap-4 transition-all ${a===j.value?"bg-emerald-50 text-emerald-700":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}`,children:[e.jsx("div",{className:`p-1.5 rounded-lg ${a===j.value?"bg-white text-emerald-600 shadow-sm":"text-slate-400 bg-slate-100"}`,children:j.icon}),e.jsx("span",{className:"flex-1",children:j.label}),a===j.value&&e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500"})]},j.value))}),e.jsx("div",{className:"my-6 border-t border-slate-100"}),e.jsx("p",{className:"px-2 text-[10px] font-black text-slate-400 uppercase tracking-widest mb-3",children:"Layanan"}),e.jsxs("button",{onClick:()=>{r("DONASI"),f(!1)},className:"w-full text-left px-4 py-3.5 rounded-xl text-sm font-bold flex items-center gap-4 bg-gradient-to-r from-amber-50 to-orange-50 text-amber-800 border border-amber-100",children:[e.jsx("div",{className:"p-1.5 bg-white text-amber-600 rounded-lg shadow-sm",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),"Donasi & Infaq"]})]}),e.jsxs("div",{className:"p-5 border-t border-slate-100 bg-slate-50",children:[e.jsxs("button",{onClick:()=>{t(),f(!1)},className:"w-full py-3.5 bg-emerald-900 text-white font-bold rounded-xl shadow-lg shadow-emerald-900/10 flex items-center justify-center gap-2 hover:bg-emerald-950 transition-colors",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-emerald-200",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),"Masuk Portal"]}),e.jsx("p",{className:"text-center text-[10px] text-slate-400 mt-4 font-medium",children:K.copyright})]})]})]})]})},Ft=({onNavigate:a})=>{const{fetchData:r,cache:t}=ge(),[o,c]=s.useState(null),k={nama:"Miftahul Huda",sub_nama:"Al-Burhani",logo:"https://imgur.com/5wRslAz.png",deskripsi_singkat:"Mencetak generasi pemimpin yang hafal Al-Qur'an, berwawasan global, dan menguasai teknologi modern.",alamat:"Jl. Pesantren No. 10, Jawa Barat, Indonesia",telepon:"+62 812-3456-7890",email:"info@miftahulhuda.sch.id",copyright:"© 2024 Miftahul Huda Al-Burhani. All rights reserved.",sosial_media:{youtube:"#",instagram:"#",tiktok:"#"}};s.useEffect(()=>{(async()=>{if(t.dasar)c(Array.isArray(t.dasar)?t.dasar[0]:t.dasar);else try{const m=await r("dasar",G.getDasar,"Footer",!1,!1);c(Array.isArray(m)?m[0]:m)}catch{}})()},[r,t.dasar]);const f=o||k,D=f.sosial_media||k.sosial_media,B=p=>{try{const m=p.split("/"),u=m[m.length-1];return u.startsWith("@")?u:"@"+u}catch{return"@miftahulhuda"}};return e.jsx("footer",{className:"hidden md:block bg-white pt-16 pb-8 border-t border-gray-200 font-sans",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-12 mb-12",children:[e.jsxs("div",{className:"col-span-1 md:col-span-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-6 cursor-pointer",onClick:()=>a("HOME"),children:[e.jsx(Oe,{className:"w-10 h-10",src:f.logo}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-serif font-bold text-lg text-emerald-950 leading-none",children:f.nama}),e.jsx("span",{className:"text-[10px] text-emerald-600 uppercase tracking-widest font-bold",children:f.sub_nama})]})]}),e.jsx("p",{className:"text-gray-500 text-sm leading-relaxed mb-6",children:f.deskripsi_singkat})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-4",children:"Informasi"}),e.jsxs("ul",{className:"space-y-3 text-sm text-gray-500",children:[e.jsx("li",{children:e.jsx("button",{onClick:()=>a("PENDAFTARAN"),className:"hover:text-emerald-700 transition-colors",children:"Pendaftaran (PSB)"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>a("PENDAFTARAN"),className:"hover:text-emerald-700 transition-colors",children:"Biaya Pendidikan"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>a("BERITA"),className:"hover:text-emerald-700 transition-colors",children:"Berita Terbaru"})})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-4",children:"Hubungi Kami"}),e.jsxs("ul",{className:"space-y-3 text-sm text-gray-500",children:[e.jsxs("li",{className:"flex items-start gap-3",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-emerald-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{className:"leading-tight",children:f.alamat})]}),e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-emerald-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),e.jsx("span",{children:f.telepon})]}),f.email&&e.jsxs("li",{className:"flex items-center gap-3",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-emerald-600 flex-shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),e.jsx("span",{children:f.email})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-4",children:"Ikuti Kami"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[D.youtube&&e.jsxs("a",{href:D.youtube,target:"_blank",rel:"noreferrer",className:"flex items-center gap-3 text-gray-500 hover:text-red-600 transition-colors group",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center border border-gray-100 group-hover:bg-red-50 group-hover:border-red-100 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"})})}),e.jsxs("span",{className:"text-sm font-medium",children:["YouTube | ",B(D.youtube)]})]}),D.instagram&&e.jsxs("a",{href:D.instagram,target:"_blank",rel:"noreferrer",className:"flex items-center gap-3 text-gray-500 hover:text-pink-600 transition-colors group",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center border border-gray-100 group-hover:bg-pink-50 group-hover:border-pink-100 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"})})}),e.jsxs("span",{className:"text-sm font-medium",children:["Instagram | ",B(D.instagram)]})]}),D.tiktok&&e.jsxs("a",{href:D.tiktok,target:"_blank",rel:"noreferrer",className:"flex items-center gap-3 text-gray-500 hover:text-slate-900 transition-colors group",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center border border-gray-100 group-hover:bg-slate-900 group-hover:text-white group-hover:border-slate-900 transition-colors",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 1 0 1 7.6 6.83 6.83 0 0 0 6-6.8V6a6.82 6.82 0 0 1 2.23 3.79z"})})}),e.jsxs("span",{className:"text-sm font-medium",children:["TikTok | ",B(D.tiktok)]})]})]})]})]}),e.jsxs("div",{className:"border-t border-gray-100 pt-8 flex flex-col md:flex-row justify-between items-center gap-4 text-xs text-gray-400",children:[e.jsx("p",{children:f.copyright}),e.jsx("p",{children:"Developed with ❤️ for Education"})]})]})})},Vt=({activePage:a,onNavigate:r,onLogin:t,forceHide:o=!1})=>{const[c,k]=s.useState(!0),f=s.useRef(null),D=[{label:"Beranda",value:"HOME",icon:p=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 transition-transform duration-300 ${p?"scale-110":"scale-100"}`,viewBox:"0 0 24 24",stroke:"currentColor",fill:p?"currentColor":"none",strokeWidth:p?0:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 01 1v4a1 1 0 001 1m-6 0h6"})})},{label:"Akademik",value:"AKADEMIK",icon:p=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 transition-transform duration-300 ${p?"scale-110":"scale-100"}`,viewBox:"0 0 24 24",stroke:"currentColor",fill:p?"currentColor":"none",strokeWidth:p?0:2,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 14l9-5-9-5-9 5 9 5z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 14l6.16-3.422a12.083 12.083 0 01.665 6.479A11.952 11.952 0 0012 20.055a11.952 11.952 0 00-6.824-2.998 12.078 12.078 0 01.665-6.479L12 14z"})]})},{label:"Daftar",value:"PENDAFTARAN",icon:p=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 transition-transform duration-300 ${p?"scale-110":"scale-100"}`,viewBox:"0 0 24 24",stroke:"currentColor",fill:p?"currentColor":"none",strokeWidth:p?0:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})},{label:"Koperasi",value:"KOPERASI",icon:p=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 transition-transform duration-300 ${p?"scale-110":"scale-100"}`,viewBox:"0 0 24 24",stroke:"currentColor",fill:p?"currentColor":"none",strokeWidth:p?0:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})},{label:"Donasi",value:"DONASI",icon:p=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-6 w-6 transition-transform duration-300 ${p?"scale-110":"scale-100"}`,viewBox:"0 0 24 24",stroke:"currentColor",fill:p?"currentColor":"none",strokeWidth:p?0:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}],B=()=>{f.current&&clearTimeout(f.current),f.current=setTimeout(()=>{k(!1)},2500)};return s.useEffect(()=>{if(o){k(!1),f.current&&clearTimeout(f.current);return}else k(!0),B();const p=()=>{k(!0),B()},m=u=>{u.clientY>window.innerHeight-120?(k(!0),f.current&&clearTimeout(f.current)):c&&!f.current&&B()};return window.addEventListener("scroll",p),window.addEventListener("mousemove",m),window.addEventListener("touchstart",p),B(),()=>{window.removeEventListener("scroll",p),window.removeEventListener("mousemove",m),window.removeEventListener("touchstart",p),f.current&&clearTimeout(f.current)}},[c,o]),e.jsxs("div",{className:`fixed bottom-0 left-0 right-0 z-[50] md:hidden w-full transition-transform duration-500 ease-out will-change-transform ${c&&!o?"translate-y-0":"translate-y-[120%]"}`,children:[e.jsx("div",{className:"bg-white border-t border-slate-100 shadow-[0_-10px_30px_rgba(0,0,0,0.08)] rounded-t-[2rem] px-4 pb-2 h-[80px] flex justify-around items-center relative z-20",children:D.map(p=>{const m=a===p.value;return e.jsxs("button",{onClick:()=>r(p.value),className:"relative w-full h-full flex flex-col items-center justify-center group outline-none",children:[e.jsx("div",{className:`
                  p-3 transition-all duration-300 ease-in-out z-10
                  ${m?"-translate-y-3 scale-90 bg-emerald-600 text-white shadow-lg shadow-emerald-600/30 rounded-full ring-4 ring-white":"translate-y-0 text-slate-400 group-hover:text-emerald-600 bg-transparent rounded-2xl"}
                `,children:p.icon(m)}),e.jsx("span",{className:`
                  absolute bottom-3 text-[10px] font-bold transition-all duration-300 ease-out tracking-wide
                  ${m?"opacity-100 translate-y-0 text-emerald-800 scale-100":"opacity-0 translate-y-2 text-slate-300 scale-75"}
                `,children:p.label})]},p.label)})}),e.jsx("div",{className:"h-[env(safe-area-inset-bottom)] bg-white w-full relative z-20"})]})},ka=({src:a,alt:r="Detail Gambar",isOpen:t,onClose:o})=>(s.useEffect(()=>(t?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]),t?e.jsxs("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 md:p-8 animate-fade-in",onClick:o,children:[e.jsx("div",{className:"absolute inset-0 bg-black/90 backdrop-blur-md transition-opacity"}),e.jsx("button",{onClick:o,className:"absolute top-6 right-6 md:top-8 md:right-8 z-[110] p-3 bg-white/10 hover:bg-white/20 text-white rounded-full transition-all duration-300 group","aria-label":"Tutup Gambar",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 md:h-8 md:w-8 group-hover:rotate-90 transition-transform duration-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("div",{className:"relative z-10 max-w-7xl w-full h-full flex items-center justify-center pointer-events-none",children:e.jsx("img",{src:a,alt:r,className:"max-w-full max-h-[85vh] object-contain rounded-xl shadow-2xl animate-fade-in-scale pointer-events-auto cursor-zoom-out select-none border border-white/5",onClick:c=>{c.stopPropagation()}})})]}):null),fe=({message:a="Memuat...",fullScreen:r=!0})=>{const[t,o]=s.useState(null),c={nama:"Miftahul Huda",sub_nama:"Al-Burhani",logo:"https://imgur.com/5wRslAz.png"};s.useEffect(()=>{(async()=>{try{const m=await G.getDasar();o(Array.isArray(m)?m[0]:m)}catch{}})()},[]);const k=t||c;if(!r)return e.jsx("div",{className:"absolute inset-0 z-[40] bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center rounded-3xl transition-all duration-500",children:e.jsxs("div",{className:"flex flex-col items-center animate-fade-in-up",children:[e.jsxs("div",{className:"relative w-12 h-12 mb-4",children:[e.jsx("div",{className:"absolute inset-0 border-4 border-emerald-100 rounded-full"}),e.jsx("div",{className:"absolute inset-0 border-4 border-emerald-600 rounded-full border-t-transparent animate-spin"})]}),e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest animate-pulse",children:a})]})});const f="fixed inset-0 z-[50] bg-white flex flex-col items-center justify-center overscroll-none touch-none overflow-hidden pb-24 md:pb-0",D=s.useMemo(()=>Array.from({length:15}).map((p,m)=>{const u=m%5===0;return{id:m,left:`${Math.random()*100}%`,animationDuration:`${10+Math.random()*15}s`,animationDelay:`${Math.random()*-20}s`,size:u?"w-10 h-10 md:w-16 md:h-16":"w-4 h-4 md:w-8 md:h-8",opacity:.15+Math.random()*.35,isMoon:u}}),[]),B=e.jsxs("div",{className:f,style:{margin:0},children:[e.jsxs("div",{className:"absolute inset-0 pointer-events-none select-none z-0",children:[D.map(p=>e.jsx("div",{className:`absolute text-yellow-500 ${p.isMoon?"animate-fall-medium":"animate-fall-slow"}`,style:{left:p.left,top:"-15%",animationDuration:p.animationDuration,animationDelay:p.animationDelay,opacity:p.opacity},children:p.isMoon?e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:p.size,children:e.jsx("path",{d:"M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:p.size,children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})},p.id)),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-white via-transparent to-yellow-50/20"})]}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[e.jsxs("div",{className:"mb-8 flex flex-col items-center animate-fade-in-up",children:[e.jsxs("div",{className:"p-5 bg-white rounded-[2rem] border border-emerald-100 shadow-2xl shadow-emerald-900/10 mb-6 relative",children:[e.jsx("div",{className:"absolute inset-0 bg-emerald-50/50 rounded-[2rem] animate-pulse"}),e.jsx(Oe,{className:"w-16 h-16 md:w-24 md:h-24 object-contain relative z-10",src:k.logo})]}),e.jsx("h1",{className:"font-serif text-3xl md:text-4xl font-bold text-emerald-950 tracking-tight text-center",children:k.nama}),e.jsx("p",{className:"font-sans text-[10px] md:text-xs font-bold tracking-[0.4em] text-yellow-500 uppercase mt-2",children:k.sub_nama})]}),e.jsxs("div",{className:"space-y-6 text-center mt-4",children:[e.jsxs("div",{className:"flex justify-center items-center gap-2 h-4",children:[e.jsx("div",{className:"w-3 h-3 bg-emerald-500 rounded-full animate-[bounce_1s_infinite]"}),e.jsx("div",{className:"w-3 h-3 bg-emerald-600 rounded-full animate-[bounce_1s_infinite_200ms]"}),e.jsx("div",{className:"w-3 h-3 bg-emerald-700 rounded-full animate-[bounce_1s_infinite_400ms]"})]}),e.jsx("h3",{className:"text-xs font-bold text-gray-400 font-sans tracking-widest animate-pulse",children:a})]})]})]});return Pa.createPortal(B,document.body)},Ea=a=>a?a.match(/\.(mp4|webm|ogg|mov)$/i):!1,Ha=a=>{const r=[...a];for(let t=r.length-1;t>0;t--){const o=Math.floor(Math.random()*(t+1));[r[t],r[o]]=[r[o],r[t]]}return r},Gt=(a,r)=>{const t=a.toLowerCase();return t.includes("tahun")||t.includes("berdiri")?e.jsxs("svg",{className:r,fill:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M12 2L2 7l10 5 10-5-10-5zm0 9l2.5-1.25L12 8.5l-2.5 1.25L12 11zm0 2.5l-5-2.5-5 2.5V20l10 2 10-2v-6.5l-5-2.5-5 2.5z"}),e.jsx("path",{d:"M4 19h16v-2H4v2zm0-4h16v-2H4v2z",opacity:"0.3"})]}):t.includes("pendidikan")||t.includes("model")||t.includes("kurikulum")?e.jsx("svg",{className:r,fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 3L1 9l4 2.18v6L12 21l7-3.82v-6l2-1.09V17h2V9L12 3zm6.82 6L12 12.72 5.18 9 12 5.28 18.82 9zM17 15.99l-5 2.73-5-2.73v-3.72L12 15l5-2.73v3.72z"})}):t.includes("keterampilan")||t.includes("unit")||t.includes("ekstrakurikuler")?e.jsxs("svg",{className:r,fill:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 14.5v-9l6 4.5-6 4.5z"}),e.jsx("path",{d:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10zm0-18c4.41 0 8 3.59 8 8s-3.59 8-8 8-8-3.59-8-8 3.59-8 8-8z",opacity:"0.3"})]}):e.jsx("svg",{className:r,fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})})},Ut=a=>{const r=a.toLowerCase(),t="w-5 h-5 text-yellow-700";return r.includes("qur")||r.includes("tahfidz")||r.includes("hafal")?e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13M12 6.253V13m0-13c1.667 0 3 1.333 3 3v6.253"})}):r.includes("kitab")||r.includes("kuning")||r.includes("turats")?e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6.042A8.967 8.967 0 006 3.75c-1.052 0-2.062.18-3 .512v14.25A8.987 8.987 0 016 18c2.305 0 4.408.867 6 2.292m0-14.25a8.966 8.966 0 016-2.292c1.052 0 2.062.18 3 .512v14.25A8.987 8.987 0 0018 18c-2.305 0-4.408.867-6 2.292m0-14.25v14.25"})}):r.includes("akhlak")||r.includes("karimah")||r.includes("karakter")?e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}):r.includes("bahasa")||r.includes("dakwah")||r.includes("global")?e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):e.jsx("svg",{className:t,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z"})})},yt=({onNavigate:a,onLogin:r,onNewsClick:t,previewData:o})=>{var oe,xe,H,ee,le;const{fetchData:c,cache:k}=ge(),[f,D]=s.useState(o||k.beranda||null),[B,p]=s.useState(((oe=k.akademik)==null?void 0:oe.jenjang)||null),[m,u]=s.useState([]),[i,g]=s.useState([]),[K,h]=s.useState(!o&&(!k.beranda||!k.akademik||!k.berita||!k.galeri)),[M,w]=s.useState(null),d=null,[C,L]=s.useState(0),[P,y]=s.useState(0),[z,j]=s.useState(0),[N,A]=s.useState(0);s.useEffect(()=>{o&&D(o)},[o]),s.useEffect(()=>{var ne;const O=((ne=f==null?void 0:f.hero)==null?void 0:ne.slides)||[];if(O.length<=1)return;const Q=setInterval(()=>{A(he=>(he+1)%O.length)},12e3);return()=>clearInterval(Q)},[f]);const S=s.useMemo(()=>{const O=new Date,Q=O.getFullYear();return O.getMonth()<6?`${Q-1}/${Q}`:`${Q}/${Q+1}`},[]);s.useEffect(()=>{if(o){h(!1),(!k.akademik||!k.berita)&&(async()=>{try{const[ne,he,Ce]=await Promise.all([c("akademik",G.getAkademik,"Beranda.tsx - Preview Aux"),c("berita",G.getBerita,"Beranda.tsx - Preview Aux",!1,!1),c("galeri",G.getGaleri,"Beranda.tsx - Preview Aux",!1,!1)]),me=Array.isArray(ne)?ne[0]:ne;if(me!=null&&me.jenjang&&p(me.jenjang),he){const be=Array.isArray(he)?he:he.item||[];u(Ha(be).slice(0,3))}}catch{}})();return}(async()=>{(!k.beranda||!k.akademik||!k.berita||!k.galeri)&&h(!0);try{const[Q,ne,he,Ce]=await Promise.all([c("beranda",G.getBeranda,"Beranda.tsx"),c("akademik",G.getAkademik,"Beranda.tsx - Jenjang"),c("berita",G.getBerita,"Beranda.tsx - Berita",!1,!1),c("galeri",G.getGaleri,"Beranda.tsx - Galeri",!1,!1)]);Q&&D(Q);const me=Array.isArray(ne)?ne[0]:ne;if(me&&me.jenjang&&p(me.jenjang),he){const be=Array.isArray(he)?he:he.item||[];u(Ha(be).slice(0,3))}if(Ce){const be=Array.isArray(Ce)?Ce:Ce.item||[],ke=Ha(be).slice(0,6).map((Se,Y)=>{let te="col-span-1 md:col-span-1";return(Y===2||Y===3)&&(te="col-span-1 md:col-span-2"),{gambar:Se.link,kolom:te}});g(ke)}}catch(Q){console.error("Gagal memuat Beranda:",Q)}finally{h(!1)}})()},[c,o]);const b=s.useMemo(()=>Array.from({length:24}).map((O,Q)=>{const ne=Q%2===0,he=Q%3===0,Ce=`${(Q*9+4)%100}%`,me=`${10+Q%4*5}s`,be=`${Q*-2}s`,Me=Q%3===0?"animate-fall-slow":Q%3===1?"animate-fall-medium":"animate-fall-fast",ke=ne?"w-10 h-10 md:w-16 md:h-16":"w-8 h-8 md:w-12 md:h-12",Se=he?"text-yellow-500/20":"text-white/10";return e.jsx("div",{className:`absolute pointer-events-none z-0 ${Me} ${Se}`,style:{left:Ce,animationDuration:me,animationDelay:be,top:"-15%"},children:ne?e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:ke,children:e.jsx("path",{d:"M12 3L1 9l11 6 9-4.91V17h2V9M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82z"})}):e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:ke,children:e.jsx("path",{d:"M4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm16-4H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-1 9H9V9h10v2zm-4 4H9v-2h6v2zm4-8H9V5h10v2z"})})},`acad-fall-${Q}`)}),[]),T=(O,Q)=>{const{scrollLeft:ne,clientWidth:he}=O.currentTarget,Ce=Math.round(ne/he);Q(Ce)},$=({total:O,activeIndex:Q,colorClass:ne="bg-emerald-600",inactiveClass:he="bg-emerald-200"})=>e.jsx("div",{className:"flex justify-center gap-1.5 mt-4 md:mt-6 md:hidden",children:Array.from({length:O}).map((Ce,me)=>e.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${me===Q?`w-6 ${ne}`:`w-1.5 ${he}`}`},me))}),E=(O,Q)=>{O.stopPropagation(),Ea(Q)||w(Q)},F=(O,Q)=>{const ne="md:hover:rotate-0 md:hover:translate-y-0 md:hover:scale-105";return Q===1?"md:scale-110 md:-translate-y-4 md:z-20 md:hover:scale-115":Q===2?O===0?`md:rotate-[-6deg] md:origin-bottom-right md:translate-y-6 ${ne}`:`md:rotate-[6deg] md:origin-bottom-left md:translate-y-6 ${ne}`:Q===4?O===0?`md:rotate-[-12deg] md:origin-bottom-right md:translate-y-12 ${ne}`:O===1?`md:rotate-[-4deg] md:origin-bottom-right md:translate-y-4 ${ne}`:O===2?`md:rotate-[4deg] md:origin-bottom-left md:translate-y-4 ${ne}`:`md:rotate-[12deg] md:origin-bottom-left md:translate-y-12 ${ne}`:O===0?`md:rotate-[-6deg] md:origin-bottom-right md:translate-y-6 ${ne}`:O===1?"md:scale-110 md:-translate-y-4 md:z-20 md:hover:scale-115":`md:rotate-[6deg] md:origin-bottom-left md:translate-y-6 ${ne}`},x=O=>O===1?"md:grid-cols-1 md:max-w-md md:mx-auto":O===2?"md:grid-cols-2 md:max-w-4xl md:mx-auto md:gap-20":O===4?"md:grid-cols-4":"md:grid-cols-3",l=O=>O===1?"md:grid-cols-1 md:max-w-md md:mx-auto":O===2?"md:grid-cols-2":O===3?"md:grid-cols-3":O===4?"md:grid-cols-2 lg:grid-cols-2 md:gap-8 lg:gap-10":"md:grid-cols-3",I=O=>"flex-col md:flex-row items-stretch",_=O=>"w-full md:w-2/5 h-64 md:h-auto relative",n=O=>O===4?"text-lg":"text-xl",v=O=>{if(!O)return"https://placehold.co/600x400/064e3b/ffffff?text=Miftahul+Huda";const Q=O.find(ne=>ne.jenis==="gambar");return Q?Q.isi:"https://placehold.co/600x400/064e3b/ffffff?text=Miftahul+Huda"},R=O=>{if(!O)return"Klik untuk membaca selengkapnya...";const Q=O.find(ne=>ne.jenis==="teks");return Q?Q.isi:"Klik untuk membaca selengkapnya..."},W=O=>O===1?"grid-cols-1 max-w-sm mx-auto":O===2?"grid-cols-2 max-w-2xl mx-auto":O===3?"grid-cols-3":O===4?"grid-cols-2 md:grid-cols-4":"grid-cols-2 md:grid-cols-3 lg:grid-cols-5";if(K||!f)return e.jsx(fe,{message:"Menyiapkan halaman Beranda",fullScreen:!0});const q=((xe=f.hero)==null?void 0:xe.slides)||[],V=q.length>0?q[N]:{judul_awalan:"Miftahul Huda",judul_akhiran:"Al-Burhani",deskripsi:"Pondok Pesantren Miftahul Huda Al-Burhani mencetak santri yang berilmu, berakhlak mulia, dan mandiri."},J=f.statistik||[],U=((H=f.fitur)==null?void 0:H.item)||[],re=((ee=f.fitur)==null?void 0:ee.gambar)||[],Z=f.prestasi||[],ae=f.lokasi||[],_e=(B==null?void 0:B.item)||[];return e.jsxs("div",{className:`font-sans bg-white siku-container overflow-hidden ${o?"pointer-events-none select-none":""}`,children:[e.jsx(ka,{src:M||"",isOpen:!!M,onClose:()=>w(null)}),e.jsxs("section",{className:"relative text-white min-h-[60vh] md:min-h-[75vh] flex flex-col overflow-hidden rounded-b-[2rem] md:rounded-b-[4rem] shadow-2xl persistent-header transition-all duration-300 pt-20 md:pt-24 pb-10 md:pb-20",children:[q.length>0?q.map((O,Q)=>e.jsx("div",{className:"absolute inset-0 transition-opacity duration-1000 ease-in-out z-0",style:{opacity:Q===N?1:0},children:Ea(O.tampilan_background)?e.jsx("video",{src:O.tampilan_background,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover animate-pan-zigzag"}):e.jsx("div",{className:"absolute inset-0 bg-cover bg-center animate-pan-zigzag",style:{backgroundImage:`url(${O.tampilan_background})`}})},Q)):e.jsx("div",{className:"absolute inset-0 bg-emerald-950 z-0"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-[20%] bg-gradient-to-t from-black/90 to-transparent z-10 pointer-events-none"}),e.jsx("div",{className:"absolute inset-y-0 left-0 w-full md:w-[85%] lg:w-[70%] bg-gradient-to-r from-black/90 via-black/60 to-transparent z-10 pointer-events-none"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-6 relative z-20 w-full flex-grow flex flex-col justify-center",children:[d,e.jsx("div",{className:"flex flex-col justify-center h-full",children:e.jsxs("div",{className:"max-w-4xl text-center lg:text-left space-y-4 md:space-y-6",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/10 border border-white/20 backdrop-blur-md justify-center lg:justify-start",children:[e.jsxs("span",{className:"relative flex h-2 w-2",children:[e.jsx("span",{className:"absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-green-500"})]}),e.jsxs("span",{className:"text-[9px] font-bold text-emerald-50 uppercase tracking-[0.2em]",children:["Penerimaan Santri Baru ",S]})]}),e.jsxs("h1",{className:"font-serif text-3xl sm:text-5xl lg:text-7xl font-bold leading-[1.1] tracking-tight text-white drop-shadow-2xl animate-text-cycle",children:[V.judul_awalan," ",e.jsx("br",{}),e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 to-yellow-500",children:V.judul_akhiran})]},N),e.jsx("p",{className:"text-emerald-50/90 text-sm sm:text-lg max-w-lg mx-auto lg:mx-0 leading-relaxed font-medium drop-shadow-md animate-text-cycle line-clamp-3 md:line-clamp-2 mb-2",children:V.deskripsi},`desc-${N}`),e.jsxs("div",{className:"flex flex-row items-center gap-3 w-full justify-center lg:justify-start pt-2",children:[e.jsxs("button",{onClick:r,className:"flex-1 sm:flex-initial w-auto px-6 sm:px-8 py-3 sm:py-3.5 bg-yellow-500 text-emerald-950 font-bold rounded-xl hover:bg-yellow-400 transition-all shadow-xl flex items-center justify-center gap-2 group text-sm sm:text-base",children:[e.jsx("span",{children:"Portal Login"})," ",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 sm:h-5 sm:w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"})})]}),e.jsxs("button",{onClick:()=>a("PENDAFTARAN"),className:"flex-1 sm:flex-initial w-auto px-6 sm:px-8 py-3 sm:py-3.5 border font-bold rounded-xl transition-all flex items-center justify-center gap-2 text-sm sm:text-base backdrop-blur-sm shadow-lg bg-white/10 border-white/20 text-white hover:bg-white/20",children:[e.jsx("span",{children:"Daftar Online"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 sm:h-5 sm:w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})]})]})})]})]}),e.jsx("section",{className:"max-w-6xl mx-auto px-4 md:px-6 relative z-30 -mt-8 md:-mt-12",children:e.jsx("div",{className:"bg-white rounded-[2rem] shadow-[0_20px_50px_rgba(0,0,0,0.1)] border border-gray-100 p-4 md:p-8",children:e.jsx("div",{className:`grid ${W(J.length)} divide-y md:divide-y-0 md:divide-x divide-gray-100 gap-0`,children:J.map((O,Q)=>e.jsxs("div",{className:"flex flex-col items-center p-3 md:p-2 text-center group",children:[e.jsx("div",{className:"mb-2 md:mb-3 p-2 md:p-3 rounded-xl transition-all shadow-sm flex items-center justify-center",style:{backgroundColor:`${O.warna}15`,color:O.warna},children:Gt(O.label,"w-6 h-6 md:w-8 md:h-8")}),e.jsx("span",{className:"text-lg md:text-3xl font-black text-slate-900 mb-0.5 md:mb-1 tracking-tight",children:O.nilai}),e.jsx("span",{className:"text-slate-400 font-bold text-[8px] md:text-[9px] uppercase tracking-[0.1em] md:tracking-[0.2em] whitespace-nowrap",children:O.label})]},Q))})})}),e.jsx("section",{className:"py-10 md:py-16 bg-white relative overflow-hidden siku-container",children:e.jsx("div",{className:"max-w-7xl mx-auto px-6 relative z-10",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12 items-center",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-emerald-600 font-bold tracking-widest uppercase text-[10px] border border-emerald-100 px-3 py-1 rounded-full bg-emerald-50",children:"Keunggulan Kami"}),e.jsx("h2",{className:"font-serif text-2xl md:text-4xl font-bold mt-3 text-slate-900 leading-tight",children:"Mengapa Memilih Miftahul Huda Al-Burhani?"})]}),e.jsx("p",{className:"text-slate-500 text-sm md:text-base leading-relaxed",children:"Kami menyeimbangkan kecerdasan spiritual dan emosional dengan ekosistem digital yang modern demi masa depan santri yang gemilang."}),e.jsx("div",{className:"grid grid-cols-2 gap-4 md:gap-6",children:U.map((O,Q)=>e.jsxs("div",{className:"flex flex-col items-center text-center gap-2 p-3 rounded-xl border border-transparent hover:border-emerald-50 hover:bg-emerald-50/30 transition-all duration-300",children:[e.jsx("div",{className:"mb-2 w-10 h-10 rounded-full bg-yellow-100 text-yellow-700 flex items-center justify-center flex-shrink-0 shadow-sm",children:Ut(O.judul)}),e.jsx("h4",{className:"font-black text-slate-900 text-xs md:text-sm leading-tight",children:O.judul}),e.jsx("p",{className:"text-slate-400 text-[9px] md:text-[10px] leading-relaxed line-clamp-2",children:O.deskripsi})]},Q))})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-48 h-48 bg-emerald-50 rounded-full blur-[60px] -z-10"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:re.map((O,Q)=>e.jsx("div",{className:`relative aspect-[3/4] rounded-2xl shadow-xl transform w-full cursor-zoom-in overflow-hidden hover:scale-105 hover:rotate-0 transition-transform duration-500 ${Q===0?"-rotate-3 translate-y-4 md:translate-y-12 md:-rotate-6":"rotate-3 -translate-y-2 md:-translate-y-4 md:rotate-6"}`,onClick:ne=>E(ne,O),children:Ea(O)?e.jsx("video",{src:O,autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"}):e.jsx("img",{src:O,className:"absolute inset-0 w-full h-full object-cover",alt:"Kegiatan"})},Q))})]})]})})}),e.jsx("section",{className:"py-10 md:py-16 bg-white siku-container",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"text-center mb-8 md:mb-12",children:[e.jsx("span",{className:"text-emerald-600 font-bold tracking-widest uppercase text-[10px]",children:"Pencapaian Institusi"}),e.jsx("h2",{className:"font-serif text-2xl md:text-4xl font-bold text-gray-900 mt-2",children:"Prestasi Luar Biasa"})]}),e.jsx("div",{className:`flex md:grid ${l(Z.length)} gap-6 lg:gap-8 overflow-x-auto snap-x snap-mandatory scrollbar-hide pb-4 -mx-6 px-6 md:mx-0 md:px-0`,onScroll:O=>T(O,L),children:Z.map((O,Q)=>e.jsxs("div",{className:"min-w-[85vw] md:min-w-0 snap-center relative h-full",children:[e.jsxs("div",{className:"md:hidden relative h-[350px] rounded-[2.5rem] overflow-hidden shadow-xl border-4 border-white cursor-pointer",onClick:ne=>E(ne,O.gambar),children:[e.jsx("img",{src:O.gambar,className:"absolute inset-0 w-full h-full object-cover transition-transform duration-700 hover:scale-110",alt:O.judul}),e.jsx("div",{className:"absolute inset-0",style:{background:`linear-gradient(to top, ${O.aksen} 0%, ${O.aksen}CC 20%, transparent 35%)`}}),e.jsx("div",{className:"absolute top-4 right-4 bg-white/20 backdrop-blur-md p-2.5 rounded-full border border-white/30 shadow-lg",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-yellow-400 drop-shadow-sm",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 2a1 1 0 011 1v1.323l3.954 1.582 1.699-3.182A1 1 0 0118 2.818v10.364a1 1 0 01-.5.866l-6 3.5a1 1 0 01-1 0l-6-3.5a1 1 0 01-.5-.866V2.818a1 1 0 011.347-.954L6.954 5.045l3.954-1.582V3a1 1 0 011-1z",clipRule:"evenodd"})})}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full p-6 flex flex-col justify-end h-full pointer-events-none",children:e.jsxs("div",{className:"transform translate-y-0 transition-transform duration-500",children:[e.jsx("span",{className:"inline-block px-3 py-1 bg-yellow-500 text-emerald-950 text-[9px] font-black uppercase tracking-widest rounded-full mb-2 shadow-md",children:O.sub_judul}),e.jsx("h3",{className:"text-2xl font-serif font-bold text-white leading-tight mb-2 drop-shadow-md",children:O.judul}),e.jsx("p",{className:"text-white/90 text-xs leading-relaxed font-medium line-clamp-2",children:O.deskripsi})]})})]}),e.jsxs("div",{className:`hidden md:flex bg-slate-50 rounded-[2rem] overflow-hidden ${I(Z.length)} border border-slate-100 h-full group transition-all hover:shadow-xl duration-500`,children:[e.jsxs("div",{className:`${_(Z.length)} overflow-hidden cursor-zoom-in shrink-0`,onClick:ne=>E(ne,O.gambar),children:[e.jsx("img",{src:O.gambar,className:"absolute inset-0 w-full h-full object-cover group-hover:scale-110 transition-transform duration-700",alt:O.judul}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors"})]}),e.jsxs("div",{className:"p-6 md:w-3/5 flex flex-col justify-center text-left",children:[e.jsx("span",{className:"inline-block px-3 py-0.5 rounded-full text-[9px] font-black uppercase tracking-widest border mb-2 w-fit",style:{backgroundColor:`${O.aksen}15`,color:O.aksen,borderColor:`${O.aksen}30`},children:O.sub_judul}),e.jsx("h3",{className:`font-serif font-bold text-slate-900 leading-tight mb-2 ${n(Z.length)}`,children:O.judul}),e.jsx("p",{className:"text-slate-500 text-[11px] leading-relaxed line-clamp-3",children:O.deskripsi})]})]})]},Q))}),e.jsx($,{total:Z.length,activeIndex:C})]})}),B&&_e.length>0&&e.jsxs("section",{className:"py-10 md:py-16 bg-gradient-to-b from-emerald-950 to-black text-white siku-container overflow-hidden relative",children:[e.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none overflow-hidden",children:b}),e.jsxs("div",{className:"max-w-7xl mx-auto px-6 relative z-10",children:[e.jsxs("div",{className:"text-center mb-8 md:mb-12",children:[e.jsx("span",{className:"text-yellow-500 font-bold tracking-[0.3em] uppercase text-[9px] mb-2 block",children:B.label_atas}),e.jsx("h2",{className:"font-serif text-2xl md:text-4xl font-bold tracking-tight text-white",children:B.judul}),e.jsx("div",{className:"w-16 h-1 bg-yellow-500 mx-auto mt-3 rounded-full shadow-[0_0_15px_rgba(245,158,11,0.5)]"})]}),e.jsx("div",{className:`flex md:grid ${x(_e.length)} gap-6 md:gap-10 overflow-x-auto md:overflow-visible snap-x snap-mandatory scrollbar-hide -mx-6 px-6 md:mx-0 md:px-0 pb-8 md:pb-20 pt-4 md:pt-10 items-center justify-center`,onScroll:O=>T(O,y),children:_e.map((O,Q)=>{const ne=_e.length,he=F(Q,ne);return e.jsx("div",{onClick:()=>a("AKADEMIK"),className:`h-full cursor-pointer min-w-[85vw] md:min-w-0 snap-center transition-all duration-700 ease-out ${he}`,children:e.jsxs("div",{className:"flex flex-col items-center group h-full relative",children:[ne===3&&Q===1&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"hidden md:block absolute top-1/2 -left-12 w-24 h-0.5 bg-gradient-to-r from-transparent via-yellow-500/50 to-transparent -z-10 rotate-12"}),e.jsx("div",{className:"hidden md:block absolute top-1/2 -right-12 w-24 h-0.5 bg-gradient-to-r from-transparent via-yellow-500/50 to-transparent -z-10 -rotate-12"})]}),e.jsxs("div",{className:"relative w-full max-w-[240px] mb-6 mx-auto perspective-1000",children:[e.jsx("div",{className:"absolute inset-0 bg-white/5 rounded-[2rem] scale-95 group-hover:scale-110 transition-transform duration-500 -z-10 rotate-6"}),e.jsx("div",{className:"absolute inset-0 bg-emerald-600/20 rounded-[2rem] scale-95 group-hover:scale-110 transition-transform duration-700 delay-75 -z-10 -rotate-6"}),e.jsxs("div",{className:"relative aspect-[4/5] rounded-[2rem] overflow-hidden border border-white/10 shadow-2xl ring-1 ring-white/20 transform transition-transform duration-500",children:[e.jsx("img",{src:O.gambar,alt:O.judul,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-1000"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/20 to-transparent opacity-80 group-hover:opacity-60 transition-opacity duration-500"}),e.jsxs("div",{className:"absolute bottom-0 left-0 w-full p-6 text-center transform translate-y-2 group-hover:translate-y-0 transition-transform duration-500",children:[e.jsx("h3",{className:"text-xl font-serif font-bold text-white mb-1 drop-shadow-md",children:O.judul}),e.jsx("p",{className:"text-yellow-400 text-[10px] font-black tracking-widest uppercase opacity-0 group-hover:opacity-100 transition-opacity duration-500 delay-100",children:O.sub_judul})]})]})]}),e.jsx("div",{className:"hidden md:block text-center space-y-1 opacity-0 group-hover:opacity-100 transition-opacity duration-500 absolute -bottom-12 left-0 right-0",children:e.jsx("div",{className:"inline-block p-2 rounded-full border border-yellow-500/30 bg-black/50 backdrop-blur-md",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-yellow-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})})})]})},O.id)})}),e.jsx($,{total:_e.length,activeIndex:P,colorClass:"bg-yellow-500",inactiveClass:"bg-emerald-800"})]})]}),e.jsx("section",{className:"py-10 md:py-20 bg-white siku-container",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"flex flex-row justify-between items-end mb-6 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("span",{className:"text-emerald-600 font-bold tracking-[0.2em] uppercase text-[10px]",children:"Update Terbaru"}),e.jsx("h2",{className:"font-serif text-2xl md:text-5xl font-bold text-gray-900 leading-tight",children:"Warta Al-Burhani"})]}),e.jsxs("button",{onClick:()=>a("BERITA"),className:"group flex items-center gap-2 md:gap-3 px-4 md:px-6 py-2 bg-white md:bg-slate-900 text-emerald-800 md:text-white font-bold rounded-lg md:rounded-xl border border-emerald-100 md:border-transparent hover:bg-gray-50 md:hover:bg-emerald-900 transition-all shadow-sm md:shadow-xl whitespace-nowrap text-xs md:text-sm h-fit",children:["Semua Berita",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3 md:h-4 md:w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})]}),e.jsxs("div",{className:"hidden lg:grid grid-cols-12 gap-8",children:[m[0]&&e.jsx("div",{className:"col-span-7",onClick:()=>t?t(m[0]):a("BERITA"),children:e.jsx("div",{className:"group cursor-pointer h-full",children:e.jsxs("div",{className:"relative h-[400px] md:h-[500px] rounded-[2.5rem] overflow-hidden shadow-2xl",children:[e.jsx("img",{src:v(m[0].konten),className:"w-full h-full object-cover",alt:m[0].judul}),e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent flex flex-col justify-end p-8 md:p-12",children:[e.jsx("span",{className:"mb-4 inline-block px-4 py-1 bg-yellow-500 text-emerald-950 text-[10px] font-black uppercase tracking-widest rounded-full w-fit backdrop-blur-md",children:m[0].kategori}),e.jsx("h3",{className:"font-serif text-2xl md:text-4xl font-bold text-white mb-4 leading-tight group-hover:text-yellow-200 transition-colors",children:m[0].judul}),e.jsx("p",{className:"text-white/70 text-sm md:text-base line-clamp-2 font-light mb-6 max-w-2xl",children:R(m[0].konten)}),e.jsxs("div",{className:"flex items-center gap-4 border-t border-white/10 pt-6",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-500/20 backdrop-blur-md flex items-center justify-center text-white border border-white/20 font-bold text-xs uppercase",children:(le=m[0].penulis)==null?void 0:le.slice(0,2)}),e.jsxs("div",{className:"text-xs",children:[e.jsx("p",{className:"text-white font-bold",children:m[0].penulis}),e.jsxs("p",{className:"text-white/50",children:[m[0].timestamp||m[0].tanggal," • 5 mnt baca"]})]})]})]})]})})}),e.jsxs("div",{className:"col-span-5 flex flex-col gap-6",children:[m.slice(1,3).map(O=>e.jsxs("div",{onClick:()=>t?t(O):a("BERITA"),className:"flex-1 bg-slate-50 rounded-[2rem] p-6 border border-slate-100 flex flex-col sm:flex-row gap-6 hover:bg-white hover:shadow-xl hover:border-emerald-100 transition-all cursor-pointer group",children:[e.jsx("div",{className:"w-full sm:w-32 h-32 rounded-2xl overflow-hidden shrink-0 shadow-md",children:e.jsx("img",{src:v(O.konten),className:"w-full h-full object-cover",alt:O.judul})}),e.jsxs("div",{className:"flex flex-col justify-center",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-emerald-600 mb-2",children:O.kategori}),e.jsx("h4",{className:"font-serif text-lg font-bold text-slate-900 group-hover:text-emerald-700 transition-colors leading-tight mb-2",children:O.judul}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-400",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),O.timestamp||O.tanggal]})]})]},O.id)),e.jsxs("div",{className:"flex-1 bg-emerald-950 rounded-[2.5rem] p-8 text-white relative overflow-hidden flex flex-col justify-center group h-full",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.05] bg-grid-white"}),e.jsx("h4",{className:"text-xl font-serif font-bold relative z-10 mb-2",children:"Ingin berkontribusi berita?"}),e.jsx("p",{className:"text-emerald-50/60 text-xs relative z-10 mb-4 font-light",children:"Kirimkan artikel atau foto kegiatan santri ke tim humas kami."}),e.jsxs("a",{href:"#",className:"text-yellow-400 text-xs font-bold flex items-center gap-2 hover:gap-3 transition-all relative z-10",children:["Hubungi Humas ",e.jsx("span",{className:"text-lg",children:"→"})]})]})]})]}),e.jsx("div",{className:"flex lg:hidden overflow-x-auto snap-x snap-mandatory scrollbar-hide -mx-6 px-6 gap-4 pb-8",onScroll:O=>T(O,j),children:m.map((O,Q)=>O&&e.jsx("div",{className:"min-w-[85vw] snap-center py-2",onClick:()=>t?t(O):a("BERITA"),children:e.jsxs("div",{className:"bg-white rounded-[2rem] overflow-hidden border border-gray-100 shadow-lg h-full flex flex-col",children:[e.jsxs("div",{className:"h-48 overflow-hidden relative",children:[e.jsx("img",{src:v(O.konten),className:"w-full h-full object-cover",alt:O.judul}),e.jsx("div",{className:"absolute top-4 left-4 bg-yellow-500 text-emerald-950 text-[9px] font-black uppercase px-3 py-1 rounded-full shadow-md",children:O.kategori})]}),e.jsxs("div",{className:"p-6 flex flex-col flex-1",children:[e.jsx("h3",{className:"font-serif text-lg font-bold text-slate-900 mb-3 leading-tight line-clamp-2",children:O.judul}),e.jsx("p",{className:"text-slate-500 text-xs line-clamp-2 mb-4 flex-1",children:R(O.konten)}),e.jsxs("div",{className:"flex justify-between items-center text-[10px] text-gray-400 border-t border-gray-100 pt-4 mt-auto",children:[e.jsx("span",{className:"font-bold text-emerald-600",children:O.penulis}),e.jsx("span",{children:O.timestamp||O.tanggal})]})]})]})},O.id))}),e.jsx($,{total:m.length,activeIndex:z})]})}),e.jsx("section",{className:"py-10 md:py-16 bg-slate-50 border-y border-gray-100 siku-container",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"flex flex-row justify-between items-end mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-emerald-600 font-bold tracking-widest uppercase text-[10px]",children:"Jejak Langkah"}),e.jsx("h2",{className:"font-serif text-2xl md:text-4xl font-bold text-gray-900 mt-1",children:"Galeri Santri"})]}),e.jsx("button",{onClick:()=>a("GALERI"),className:"flex items-center gap-2 text-emerald-800 font-bold hover:text-emerald-600 transition bg-white px-4 py-2 rounded-lg border border-emerald-100 shadow-sm text-xs whitespace-nowrap h-fit",children:"Lihat Semua"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 md:gap-3 auto-rows-[120px] md:auto-rows-[200px]",children:i.map((O,Q)=>e.jsxs("div",{className:`${O.kolom} relative group overflow-hidden rounded-lg shadow-md cursor-zoom-in`,onClick:ne=>E(ne,O.gambar),children:[e.jsx("img",{src:O.gambar,className:"w-full h-full object-cover group-hover:scale-110 transition duration-700",alt:"Gallery"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-500"})]},Q))})]})}),e.jsx("section",{className:"py-10 md:py-16 bg-gray-50 siku-container overflow-hidden",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"font-serif text-2xl md:text-3xl font-bold text-gray-900 mb-2",children:"Lokasi Kampus"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Kunjungi fasilitas kami secara langsung."})]}),ae.length>0&&e.jsx("div",{className:"rounded-[2rem] overflow-hidden shadow-xl border-4 border-white h-[250px] md:h-[350px] mb-8",children:e.jsx("iframe",{title:ae[0].nama_lokasi,src:ae[0].sumber_peta,width:"100%",height:"100%",style:{border:0},allowFullScreen:!0,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade"})}),ae.length>1&&e.jsx("div",{className:`grid gap-6 ${ae.length===2?"grid-cols-1":ae.length===3?"grid-cols-1 md:grid-cols-2":"grid-cols-1 md:grid-cols-3"}`,children:ae.slice(1).map((O,Q)=>e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex flex-col",children:[e.jsx("h3",{className:"font-bold text-gray-800 mb-1",children:O.nama_lokasi}),e.jsx("p",{className:"text-xs text-gray-500 mb-3",children:O.deskripsi}),e.jsx("div",{className:"rounded-xl overflow-hidden h-[200px] border border-gray-100",children:e.jsx("iframe",{title:O.nama_lokasi,src:O.sumber_peta,width:"100%",height:"100%",style:{border:0},allowFullScreen:!0,loading:"lazy",referrerPolicy:"no-referrer-when-downgrade"})})]},Q))})]})}),e.jsx("section",{className:"py-10 md:py-16 bg-white px-6 siku-container",children:e.jsxs("div",{className:"max-w-5xl mx-auto bg-emerald-950 rounded-[2rem] p-8 md:p-14 text-white text-center relative overflow-hidden shadow-2xl",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.05] bg-grid-white"}),e.jsxs("div",{className:"relative z-10 space-y-4 md:space-y-6",children:[e.jsxs("h2",{className:"text-2xl md:text-5xl font-serif font-bold leading-tight text-white",children:["Siap Menjadi Bagian dari ",e.jsx("br",{}),e.jsx("span",{className:"text-yellow-400",children:"Miftahul Huda?"})]}),e.jsx("p",{className:"text-emerald-100/70 text-sm md:text-lg font-light max-w-xl mx-auto leading-relaxed",children:"Pendaftaran Santri Baru kini telah dibuka secara online."}),e.jsx("div",{className:"flex flex-col sm:flex-row justify-center gap-3 pt-2",children:e.jsx("button",{onClick:()=>a("PENDAFTARAN"),className:"px-10 py-4 font-bold rounded-xl text-base transition transform hover:-translate-y-1 shadow-2xl bg-yellow-500 text-emerald-950 hover:bg-yellow-400",children:"Daftar Sekarang"})})]})]})})]})},Ua=a=>{if(!a)return[];let r=[a];return a.unit_langsung&&a.unit_langsung.forEach(t=>{r=[...r,...Ua(t)]}),a.unit_terkait&&a.unit_terkait.forEach(t=>{r=[...r,...Ua(t)]}),r},Jt=(a,r="w-10 h-10")=>{const t=a.toLowerCase();return t.includes("salaf")||t.includes("adab")||t.includes("kitab")?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M11.25 4.533A9.707 9.707 0 006 3a9.735 9.735 0 00-3.25.555.75.75 0 00-.5.707v14.25a.75.75 0 001 .707A8.237 8.237 0 016 18.75c1.995 0 3.823.707 5.25 1.886V4.533zM12.75 20.636A8.214 8.214 0 0118 18.75c.966 0 1.89.166 2.75.47a.75.75 0 001-.708V4.262a.75.75 0 00-.5-.707A9.735 9.735 0 0018 3a9.707 9.707 0 00-5.25 1.533v16.103z"})}):t.includes("global")||t.includes("ilmu")||t.includes("wawasan")?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zM6.262 6.072a8.25 8.25 0 1010.562-.766 4.5 4.5 0 01-1.318 1.357L14.25 7.5l.165.333A4.5 4.5 0 0113.75 10.5l-.165.333-1.964.982A1.125 1.125 0 0110.125 11v1.125c0 .621.504 1.125 1.125 1.125h.75c.621 0 1.125.504 1.125 1.125v3.375a3 3 0 01-3 3h-.75A8.25 8.25 0 015.625 12a8.232 8.232 0 01.637-3.178 3.001 3.001 0 012.75-2.75z",clipRule:"evenodd"})}):t.includes("mandiri")||t.includes("amal")||t.includes("skill")?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M11.54 22.351l.07.04.028.016a.76.76 0 00.723 0l.028-.015.071-.041a16.975 16.975 0 001.144-.742 19.58 19.58 0 002.683-2.282c1.944-1.99 3.963-4.98 3.963-8.827a8.25 8.25 0 00-16.5 0c0 3.846 2.02 6.837 3.963 8.827a19.58 19.58 0 002.682 2.282 16.975 16.975 0 001.145.742zM12 13.5a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M11.645 20.91l-.007-.003-.022-.012a15.247 15.247 0 01-.383-.218 25.18 25.18 0 01-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0112 5.052 5.5 5.5 0 0116.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 01-4.244 3.17 15.247 15.247 0 01-.383.219l-.022.012-.007.004-.003.001a.752.752 0 01-.704 0l-.003-.001z"})})},qt=(a,r)=>{const t=a.toLowerCase();return t.includes("siddiq")?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}):t.includes("amanah")?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}):t.includes("tabligh")?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}):t.includes("fathanah")?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}):t.includes("ikhlas")?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}):t.includes("ukhuwah")?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:r,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})},Nt=({node:a,type:r="solid"})=>{if(!a)return null;const t=[...(a.unit_langsung||[]).map(c=>({...c,type:"solid"})),...(a.unit_terkait||[]).map(c=>({...c,type:"dashed"}))],o=t.length>0;return e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsxs("div",{className:"relative z-10 w-64 group transition-all duration-300 transform hover:-translate-y-2",children:[e.jsx("div",{className:"absolute -top-3 left-1/2 -translate-x-1/2 w-3 h-3 bg-emerald-500 rounded-full border-2 border-white z-20"}),e.jsxs("div",{className:`bg-white rounded-[1.5rem] overflow-hidden shadow-lg border ${r==="dashed"?"border-dashed border-slate-300":"border-slate-100"} hover:shadow-2xl hover:shadow-emerald-900/10`,children:[e.jsxs("div",{className:"h-20 bg-gradient-to-r from-emerald-800 to-emerald-600 relative",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')] opacity-10"}),r==="dashed"&&e.jsx("div",{className:"absolute top-2 right-2 bg-white/20 backdrop-blur px-2 py-0.5 rounded text-[9px] text-white font-bold uppercase tracking-wider",children:"Unit Terkait"})]}),e.jsxs("div",{className:"px-5 pb-6 pt-0 text-center relative -mt-10",children:[e.jsx("div",{className:"w-20 h-20 mx-auto rounded-2xl border-4 border-white shadow-md overflow-hidden bg-white mb-3",children:e.jsx("img",{src:a.gambar,alt:a.jabatan,className:"w-full h-full object-cover"})}),e.jsx("h4",{className:"text-[10px] font-black uppercase tracking-widest text-emerald-600 mb-1",children:a.jabatan}),e.jsx("h3",{className:"font-serif font-bold text-lg text-slate-900 leading-tight mb-2",children:a.nama}),e.jsx("p",{className:"text-[10px] text-slate-500 leading-relaxed line-clamp-2 px-2",children:a.deskripsi})]})]}),o&&e.jsx("div",{className:"absolute -bottom-3 left-1/2 -translate-x-1/2 w-3 h-3 bg-slate-300 rounded-full border-2 border-white z-20"})]}),o&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-0.5 h-12 bg-slate-300"}),e.jsx("div",{className:"flex justify-center items-start",children:t.map((c,k)=>{const f=k===0,D=k===t.length-1,B=t.length===1;return e.jsxs("div",{className:"flex flex-col items-center relative px-6 md:px-8",children:[!B&&e.jsxs("div",{className:"absolute top-0 left-0 w-full h-6",children:[e.jsx("div",{className:`absolute top-0 right-1/2 w-[calc(50%+1px)] h-[2px] bg-slate-300 ${f?"hidden":"block"}`}),e.jsx("div",{className:`absolute top-0 left-1/2 w-[calc(50%+1px)] h-[2px] bg-slate-300 ${D?"hidden":"block"}`}),e.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-2 h-2 bg-slate-300 rounded-full"})]}),e.jsx("div",{className:`w-0.5 h-10 -mt-[2px] ${c.type==="dashed"?"border-l-2 border-dashed border-slate-300":"bg-slate-300"}`}),e.jsx(Nt,{node:c,type:c.type})]},k)})})]})]})},Yt=({node:a})=>e.jsxs("div",{className:"bg-white rounded-[2rem] p-0 border border-slate-100 shadow-md hover:shadow-2xl transition-all duration-300 hover:-translate-y-2 group relative overflow-hidden h-full flex flex-col",children:[e.jsxs("div",{className:"h-24 bg-slate-100 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-50 to-teal-50 opacity-100"}),e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-emerald-200/20 rounded-full blur-xl -mr-5 -mt-5"})]}),e.jsxs("div",{className:"px-6 pb-8 flex-1 flex flex-col items-center -mt-12 relative z-10",children:[e.jsx("div",{className:"w-24 h-24 rounded-2xl border-4 border-white shadow-lg overflow-hidden bg-white mb-4 group-hover:scale-105 transition-transform duration-500",children:e.jsx("img",{src:a.gambar,alt:a.nama,className:"w-full h-full object-cover"})}),e.jsx("span",{className:"inline-block px-3 py-1 rounded-full bg-emerald-50 text-emerald-700 text-[10px] font-black uppercase tracking-widest mb-3 border border-emerald-100",children:a.jabatan}),e.jsx("h3",{className:"font-serif font-bold text-xl text-slate-900 mb-2 leading-tight text-center",children:a.nama}),e.jsx("p",{className:"text-xs text-slate-500 leading-relaxed text-center opacity-80",children:a.deskripsi})]})]}),_t=({isSearchOpen:a=!1,previewData:r})=>{var l,I,_;const{fetchData:t,cache:o}=ge(),[c,k]=s.useState(r||o.profil||null),[f,D]=s.useState(!r&&!o.profil),[B,p]=s.useState(1),[m,u]=s.useState("tree"),i=s.useRef(null),g=s.useRef(null);s.useEffect(()=>{if(r){k(r);return}(async()=>{o.profil||D(!0);try{const v=await t("profil",G.getProfil,"Profil.tsx");v&&k(v)}catch(v){console.error("Gagal memuat Profil:",v)}finally{D(!1)}})()},[t,r]),s.useLayoutEffect(()=>{if(m==="tree"&&i.current&&g.current){const n=i.current,v=g.current;setTimeout(()=>{const R=v.scrollWidth,W=n.clientWidth;if(R>W){const q=(R-W)/2;n.scrollTo({left:q,behavior:"smooth"})}},100)}},[c,m]);const[K,h]=s.useState(!1),[M,w]=s.useState(0),[d,C]=s.useState(0),L=n=>{!i.current||m!=="tree"||(h(!0),w(n.pageX-i.current.offsetLeft),C(i.current.scrollLeft),i.current.style.cursor="grabbing")},P=()=>{h(!1),i.current&&(i.current.style.cursor=m==="tree"?"grab":"default")},y=()=>{h(!1),i.current&&(i.current.style.cursor=m==="tree"?"grab":"default")},z=n=>{if(!K||!i.current||m!=="tree")return;n.preventDefault();const R=(n.pageX-i.current.offsetLeft-M)*2;i.current.scrollLeft=d-R},j=()=>p(n=>Math.min(n+.1,1.5)),N=()=>p(n=>Math.max(n-.1,.5)),A=()=>p(1),S=s.useMemo(()=>!c||!c.struktur?[]:Ua(c.struktur),[c]);if(f||!c)return e.jsx(fe,{message:"Menyiapkan halaman Profil",fullScreen:!0});const b=c.hero||{label_atas:"",judul_awalan:"",judul_sorotan:"",deskripsi:""},T=c.identitas_inti||[],$=c.visi_misi||{gambar:"",kutipan:"",nama:"",teks_visi:"",misi:[]},E=((l=c.nilai_inti)==null?void 0:l.item)||[],F=((I=c.sejarah)==null?void 0:I.item)||[],x=c.mitra||[];return e.jsxs("div",{className:`min-h-screen bg-white font-sans overflow-x-hidden ${r?"pointer-events-none select-none":""}`,children:[e.jsxs("section",{className:`relative bg-emerald-950 text-white overflow-hidden rounded-b-[2.5rem] shadow-xl transition-all duration-700 persistent-header ${a?"pt-40 pb-16":"pt-28 pb-16"}`,children:[e.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none opacity-20 bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')]"}),e.jsx("div",{className:"absolute top-[-50%] right-[-10%] w-[500px] h-[500px] bg-yellow-500/10 rounded-full blur-[100px] pointer-events-none"}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 relative z-10 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-white/10 border border-white/20 backdrop-blur-md rounded-full mb-6",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-yellow-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black text-yellow-100 uppercase tracking-widest font-sans",children:b.label_atas})]}),e.jsxs("h1",{className:"font-serif text-3xl md:text-5xl font-bold tracking-tight leading-[1.1] mb-4",children:[b.judul_awalan," ",e.jsx("br",{}),e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 via-yellow-400 to-yellow-200",children:b.judul_sorotan})]}),e.jsx("p",{className:"text-emerald-100/70 max-w-lg mx-auto text-sm leading-relaxed font-sans",children:b.deskripsi})]})]}),e.jsx("section",{className:"max-w-7xl mx-auto px-4 md:px-6 -mt-8 relative z-20",children:e.jsx("div",{className:"grid grid-cols-3 gap-2 md:gap-6 md:grid-cols-3",children:T.map((n,v)=>e.jsxs("div",{className:"bg-white border border-gray-100 p-4 md:p-10 rounded-2xl md:rounded-[3rem] shadow-2xl transform hover:-translate-y-1 transition-all duration-500 flex flex-col h-full justify-center items-center md:items-start text-center md:text-left group",children:[e.jsx("div",{className:"mb-2 md:mb-6 w-12 h-12 md:w-20 md:h-20 rounded-2xl flex items-center justify-center bg-emerald-50 text-emerald-700 shadow-sm transition-all duration-500 group-hover:bg-emerald-600 group-hover:text-white",children:Jt(n.judul,"w-6 h-6 md:w-10 md:h-10")}),e.jsx("h3",{className:"text-xs font-serif font-bold md:hidden mb-1 leading-tight text-emerald-950",children:n.judul}),e.jsx("h3",{className:"hidden md:block text-2xl font-serif font-bold mb-3 text-emerald-950",children:n.judul_lengkap}),e.jsx("p",{className:"text-slate-500 text-[9px] md:text-sm leading-tight md:leading-relaxed",children:n.deskripsi})]},v))})}),e.jsx("section",{className:"py-20 md:py-32 bg-white relative",children:e.jsx("div",{className:"max-w-7xl mx-auto px-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 md:gap-20 items-center",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute -inset-4 bg-emerald-50 rounded-[3rem] -rotate-3 transition-transform group-hover:rotate-0 duration-700 -z-10"}),e.jsx("img",{src:$.gambar,className:"rounded-[2.5rem] shadow-2xl w-full aspect-square md:h-[600px] md:aspect-auto object-cover",alt:"Visi Misi"}),e.jsxs("div",{className:"absolute -bottom-6 -right-2 md:bottom-10 md:-right-10 bg-yellow-500 p-6 md:p-10 rounded-[2rem] md:rounded-[3rem] shadow-2xl max-w-[240px] md:max-w-[280px]",children:[e.jsxs("p",{className:"text-emerald-950 font-serif italic text-base md:text-xl font-bold leading-tight",children:['"',$.kutipan,'"']}),$.nama&&e.jsxs("p",{className:"text-emerald-900 font-sans text-xs font-bold mt-3 uppercase tracking-wider",children:["— ",$.nama]})]})]}),e.jsxs("div",{className:"space-y-12 mt-12 md:mt-0",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("span",{className:"text-emerald-600 font-bold tracking-[0.2em] uppercase text-[11px]",children:"Cita-Cita Luhur"}),e.jsx("h2",{className:"text-4xl md:text-6xl font-serif font-bold text-slate-900 leading-tight",children:"Visi Kami"}),e.jsx("div",{className:"relative",children:e.jsxs("p",{className:"text-xl md:text-2xl text-slate-500 font-light italic leading-relaxed border-l-4 border-yellow-500 pl-6",children:['"',$.teks_visi,'"']})})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("h3",{className:"text-xl font-bold text-slate-800 uppercase tracking-widest flex items-center gap-3",children:[e.jsx("span",{className:"w-10 h-px bg-slate-200"}),"Misi Strategis",e.jsx("span",{className:"w-10 h-px bg-slate-200"})]}),e.jsx("div",{className:"space-y-6",children:$.misi.map((n,v)=>e.jsxs("div",{className:"flex gap-6 group",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-emerald-50 rounded-2xl flex items-center justify-center text-emerald-700 group-hover:bg-emerald-600 group-hover:text-white transition-all duration-300 shadow-sm border border-emerald-100",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:n.path_ikon})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900 mb-1",children:n.judul}),e.jsx("p",{className:"text-slate-500 text-sm leading-relaxed",children:n.deskripsi})]})]},v))})]})]})]})})}),e.jsx("section",{className:"py-24 bg-slate-50 border-y border-slate-100 relative",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-6 relative z-10",children:[e.jsxs("div",{className:"text-center mb-12 md:mb-20 space-y-4",children:[e.jsx("h2",{className:"text-3xl md:text-5xl font-serif font-bold text-slate-900 tracking-tight",children:"Budaya & Nilai Inti"}),e.jsx("p",{className:"text-slate-500 max-w-xl mx-auto",children:"Prinsip dasar yang kami tanamkan dalam sanubari setiap santri dan asatidz."})]}),e.jsx("div",{className:"flex flex-wrap justify-center gap-6",children:E.map((n,v)=>{const W={"bg-blue-600":"bg-blue-50 text-blue-700 border-blue-100 hover:shadow-blue-200","bg-emerald-600":"bg-emerald-50 text-emerald-700 border-emerald-100 hover:shadow-emerald-200","bg-amber-600":"bg-amber-50 text-amber-700 border-amber-100 hover:shadow-amber-200","bg-purple-600":"bg-purple-50 text-purple-700 border-purple-100 hover:shadow-purple-200","bg-rose-600":"bg-rose-50 text-rose-700 border-rose-100 hover:shadow-rose-200","bg-cyan-600":"bg-cyan-50 text-cyan-700 border-cyan-100 hover:shadow-cyan-200"}[n.warna]||"bg-white text-slate-700 border-slate-100";return e.jsxs("div",{className:`p-6 rounded-[2rem] border transition-all duration-500 hover:-translate-y-2 hover:shadow-xl flex flex-col items-center justify-center text-center group h-40 md:h-56 w-full sm:w-[calc(50%-1.5rem)] md:w-[calc(33.33%-1.5rem)] lg:w-[calc(16.66%-1.5rem)] min-w-[150px] ${W}`,children:[e.jsx("div",{className:"w-12 h-12 md:w-16 md:h-16 rounded-2xl flex items-center justify-center mb-3 shadow-sm bg-white/60 backdrop-blur-sm transition-transform duration-500 group-hover:scale-110",children:qt(n.nama,"w-6 h-6 md:w-8 md:h-8")}),e.jsx("h4",{className:"text-sm md:text-lg font-bold mb-1 leading-tight",children:n.nama}),e.jsx("p",{className:"text-[10px] uppercase font-bold opacity-60 tracking-widest",children:n.sub})]},v)})})]})}),e.jsx("section",{className:"py-20 md:py-32 bg-white relative overflow-hidden",children:e.jsxs("div",{className:"max-w-full mx-auto px-0 md:px-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end md:items-center px-6 mb-10 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("span",{className:"text-emerald-600 font-bold tracking-[0.2em] uppercase text-[11px]",children:"Tata Kelola Institusi"}),e.jsx("h2",{className:"text-4xl md:text-6xl font-serif font-bold text-slate-900 leading-tight",children:"Struktur Pengurus"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 p-1.5 rounded-2xl border border-slate-200 shadow-sm z-20",children:[e.jsxs("button",{onClick:()=>u("tree"),className:`p-2 rounded-xl transition-all flex items-center gap-2 ${m==="tree"?"bg-white shadow text-emerald-600":"text-slate-400 hover:text-slate-600"}`,title:"Mode Hirarki",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),e.jsx("span",{className:"text-xs font-bold hidden md:inline",children:"Tree"})]}),e.jsxs("button",{onClick:()=>{u("grid"),p(1)},className:`p-2 rounded-xl transition-all flex items-center gap-2 ${m==="grid"?"bg-white shadow text-emerald-600":"text-slate-400 hover:text-slate-600"}`,title:"Mode Grid",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),e.jsx("span",{className:"text-xs font-bold hidden md:inline",children:"List"})]}),e.jsx("div",{className:"w-px h-6 bg-slate-200 mx-1 hidden md:block"}),e.jsxs("div",{className:"hidden md:flex items-center",children:[e.jsx("button",{onClick:N,disabled:m==="grid",className:`p-2 rounded-xl transition-all ${m==="grid"?"text-slate-200 cursor-not-allowed":"text-slate-500 hover:bg-white hover:shadow hover:text-emerald-600"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),e.jsxs("span",{className:`text-xs font-mono font-bold w-12 text-center ${m==="grid"?"text-slate-300":"text-slate-600"}`,children:[Math.round(B*100),"%"]}),e.jsx("button",{onClick:j,disabled:m==="grid",className:`p-2 rounded-xl transition-all ${m==="grid"?"text-slate-200 cursor-not-allowed":"text-slate-500 hover:bg-white hover:shadow hover:text-emerald-600"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})}),e.jsx("button",{onClick:A,disabled:m==="grid",className:`p-2 rounded-xl transition-all ${m==="grid"?"text-slate-200 cursor-not-allowed":"text-slate-400 hover:text-red-500"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]})]})]}),m==="tree"?e.jsx("div",{ref:i,className:"overflow-x-auto overflow-y-hidden pb-20 pt-10 w-full cursor-grab active:cursor-grabbing scrollbar-hide bg-[radial-gradient(#e5e7eb_1px,transparent_1px)] [background-size:16px_16px]",onMouseDown:L,onMouseLeave:P,onMouseUp:y,onMouseMove:z,children:c&&c.struktur&&e.jsx("div",{ref:g,className:"w-fit mx-auto px-10 min-w-min transition-transform duration-300 origin-top",style:{transform:`scale(${B})`},children:e.jsx(Nt,{node:c.struktur})})}):e.jsx("div",{className:"max-w-7xl mx-auto px-6 pb-20",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:S.map((n,v)=>e.jsx(Yt,{node:n},v))})})]})}),e.jsxs("section",{className:"py-24 md:py-32 bg-emerald-950 text-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-5 bg-grid-white animate-grid-flow"}),e.jsxs("div",{className:"max-w-4xl mx-auto px-6 relative z-10",children:[e.jsxs("div",{className:"text-center mb-20",children:[e.jsx("h2",{className:"text-4xl md:text-5xl font-serif font-bold",children:((_=c==null?void 0:c.sejarah)==null?void 0:_.judul)||"Sejarah Kami"}),e.jsx("div",{className:"w-20 h-1.5 bg-yellow-500 mx-auto mt-6 rounded-full shadow-[0_0_20px_rgba(245,158,11,0.5)]"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-8 md:left-1/2 top-0 bottom-0 w-0.5 bg-white/20"}),e.jsx("div",{className:"space-y-16",children:F.map((n,v)=>{const R=v%2===0;return e.jsxs("div",{className:`flex flex-col md:flex-row items-center gap-8 md:gap-16 relative ${R?"md:flex-row-reverse":""}`,children:[e.jsxs("div",{className:`w-full md:w-1/2 pl-24 md:pl-0 ${R?"md:text-right":"md:text-left"}`,children:[e.jsx("h3",{className:"text-yellow-400 font-mono text-4xl font-bold mb-2 drop-shadow-md",children:n.tahun}),e.jsx("h4",{className:"text-2xl font-serif font-bold mb-3 leading-tight",children:n.judul}),e.jsx("p",{className:"text-emerald-100/70 text-sm leading-relaxed",children:n.deskripsi})]}),e.jsx("div",{className:"absolute left-8 md:left-1/2 top-0 md:top-2 -translate-x-1/2 w-4 h-4 bg-emerald-950 border-4 border-yellow-500 rounded-full z-10 shadow-[0_0_15px_rgba(234,179,8,0.6)]"}),e.jsx("div",{className:"hidden md:block md:w-1/2"})]},v)})})]})]})]}),e.jsx("section",{className:"py-24 bg-white border-t border-slate-100",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 text-center",children:[e.jsx("h3",{className:"text-[10px] font-black text-slate-400 uppercase tracking-[0.4em] mb-12",children:"Bekerjasama Dengan"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:x.map((n,v)=>e.jsx("div",{className:"group flex items-center justify-center p-6 rounded-2xl border border-slate-100 bg-slate-50/50 hover:bg-white hover:shadow-xl hover:border-emerald-100 transition-all duration-500 cursor-default",children:e.jsx("span",{className:"text-xl md:text-2xl font-serif font-bold text-slate-400 group-hover:text-emerald-800 transition-colors duration-300",children:n})},v))})]})})]})},Be={hero:{label_atas:"Program Unggulan",judul_awalan:"Kurikulum",judul_sorotan:"Terintegrasi",deskripsi:"Sinergi antara kurikulum Nasional, Pesantren Modern, dan Standar Internasional untuk mencetak ulama intelek yang siap menghadapi tantangan zaman."},pilar:{judul_awalan:"Pilar",judul_sorotan:"Pendidikan",deskripsi:"Sinergi kurikulum yang dirancang untuk melahirkan generasi yang kokoh iman, luas ilmu, dan cakap dalam teknologi."},program:{label_atas:"Flagship Programs",judul:"Program Unggulan",sub_judul:"Al-Burhani",kutipan:"Eksplorasi potensi terbaik santri melalui kurikulum yang adaptif terhadap perubahan zaman."},rutinitas:{judul_awalan:"Rutinitas",judul_sorotan:"Santri",deskripsi:"Disiplin waktu dan keseimbangan antara ibadah, belajar, dan istirahat adalah kunci pembentukan karakter santri."},mapel:{judul:"Kurikulum",sub_judul:"& Mata Pelajaran",deskripsi:"Cakupan keilmuan yang luas dari dasar agama hingga keterampilan hidup."}},oa=(a,r)=>{let t;return/^#([A-Fa-f0-9]{3}){1,2}$/.test(a)?(t=a.substring(1).split(""),t.length==3&&(t=[t[0],t[0],t[1],t[1],t[2],t[2]]),t="0x"+t.join(""),"rgba("+[t>>16&255,t>>8&255,t&255].join(",")+","+r+")"):a},Qt=a=>{const r=a.toLowerCase();return r.includes("nasional")?{gradient:"linear-gradient(to bottom right, #2563eb, #1e3a8a)",shadow:"group-hover:shadow-blue-500/30",bg_color:"bg-blue-600",icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-8 h-8 md:w-10 md:h-10 text-white",children:[e.jsx("path",{d:"M11.7 2.805a.75.75 0 01.6 0A60.65 60.65 0 0122.83 8.72a.75.75 0 01-.231 1.337 49.949 49.949 0 00-9.902 3.912l-.003.002-.34.18a.75.75 0 01-.707 0A50.009 50.009 0 002.21 10.057a.75.75 0 01-.298-1.205A60.517 60.517 0 0111.7 2.805z"}),e.jsx("path",{d:"M13.06 15.473a48.45 48.45 0 017.666-3.282c.134 1.414.22 2.843.255 4.285a.75.75 0 01-.46.71 47.878 47.878 0 00-8.105 4.342.75.75 0 01-.832 0 47.877 47.877 0 00-8.104-4.342.75.75 0 01-.461-.71c.035-1.442.121-2.87.255-4.286A48.4 48.4 0 0110.94 15.473c.196.104.42.104.616 0z"}),e.jsx("path",{d:"M11.467 17.5a.75.75 0 00-1.061-1.06l-4.5 4.5a.75.75 0 001.06 1.06l4.5-4.5z"})]})}:r.includes("pesantren")||r.includes("diniyah")?{gradient:"linear-gradient(to bottom right, #059669, #022c22)",shadow:"group-hover:shadow-emerald-500/30",bg_color:"bg-emerald-600",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-8 h-8 md:w-10 md:h-10 text-white",children:e.jsx("path",{d:"M11.25 4.533A9.707 9.707 0 006 3a9.735 9.735 0 00-3.25.555.75.75 0 00-.5.707v14.25a.75.75 0 001 .707A8.237 8.237 0 016 18.75c1.995 0 3.823.707 5.25 1.886V4.533zM12.75 20.636A8.214 8.214 0 0118 18.75c.966 0 1.89.166 2.75.47a.75.75 0 001-.708V4.262a.75.75 0 00-.5-.707A9.735 9.735 0 0018 3a9.707 9.707 0 00-5.25 1.533v16.103z"})})}:{gradient:"linear-gradient(to bottom right, #d97706, #78350f)",shadow:"group-hover:shadow-amber-500/30",bg_color:"bg-amber-600",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-8 h-8 md:w-10 md:h-10 text-white",children:e.jsx("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zM6.262 6.072a8.25 8.25 0 1010.562-.766 4.5 4.5 0 01-1.318 1.357L14.25 7.5l.165.333A4.5 4.5 0 0113.75 10.5l-.165.333-1.964.982A1.125 1.125 0 0110.125 11v1.125c0 .621.504 1.125 1.125 1.125h.75c.621 0 1.125.504 1.125 1.125v3.375a3 3 0 01-3 3h-.75A8.25 8.25 0 015.625 12a8.232 8.232 0 01.637-3.178 3.001 3.001 0 012.75-2.75z",clipRule:"evenodd"})})}},Xt=a=>{const r=a.toLowerCase();return r.includes("tahfidz")||r.includes("quran")?{iconPath:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13M12 6.253V13m0-13c1.667 0 3 1.333 3 3v6.253",bg:"bg-emerald-50",text:"text-emerald-700",border:"group-hover:border-emerald-200"}:r.includes("bilingual")||r.includes("bahasa")?{iconPath:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z",bg:"bg-blue-50",text:"text-blue-700",border:"group-hover:border-blue-200"}:r.includes("stem")||r.includes("robot")||r.includes("teknologi")?{iconPath:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z",bg:"bg-amber-50",text:"text-amber-700",border:"group-hover:border-amber-200"}:{iconPath:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z",bg:"bg-purple-50",text:"text-purple-700",border:"group-hover:border-purple-200"}},rt=a=>a===1?"md:grid-cols-1 max-w-md mx-auto":a===2?"md:grid-cols-2 max-w-4xl mx-auto":a===3?"md:grid-cols-3":a===4?"md:grid-cols-2 lg:grid-cols-4":"md:grid-cols-3 lg:grid-cols-4",Fe={jenjang:[],pilar:[],program:[]},St=({isSearchOpen:a=!1,previewData:r})=>{var j,N,A,S;const{fetchData:t,cache:o}=ge(),[c,k]=s.useState(r||Fe),[f,D]=s.useState(!r&&!o.akademik),[B,p]=s.useState("Harian");s.useEffect(()=>{if(r){k(r);return}(async()=>{if(o.akademik){k({...Fe,...o.akademik,jenjang:o.akademik.jenjang||Fe.jenjang,pilar:o.akademik.pilar||Fe.pilar,program:o.akademik.program||Fe.program}),D(!1);return}try{const T=await t("akademik",G.getAkademik,"Akademik.tsx");T&&k({...Fe,...T,jenjang:T.jenjang||Fe.jenjang,pilar:T.pilar||Fe.pilar,program:T.program||Fe.program})}catch(T){console.error("Gagal memuat Akademik (Menggunakan data statis):",T)}finally{D(!1)}})()},[t,o.akademik,r]);const m=(b,T)=>{const{scrollLeft:$,clientWidth:E}=b.currentTarget,F=Math.round($/E);T(F)},[u,i]=s.useState(0),[g,K]=s.useState(0),h=({total:b,activeIndex:T,colorClass:$="bg-yellow-500",inactiveClass:E="bg-emerald-800"})=>e.jsx("div",{className:"flex justify-center gap-1.5 mt-6 md:hidden",children:Array.from({length:b}).map((F,x)=>e.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${x===T?`w-6 ${$}`:`w-1.5 ${E}`}`},x))});if(f)return e.jsx(fe,{message:"Menyiapkan halaman Akademik",fullScreen:!0});const M=c.jenjang||[],w=c.pilar||[],d=c.program||[],C=((j=c.kegiatan)==null?void 0:j.harian)||[],L=((N=c.kegiatan)==null?void 0:N.mingguan)||[],P=((A=c.kegiatan)==null?void 0:A.bulanan)||[],y=((S=c.kegiatan)==null?void 0:S.tahunan)||[],z=c.mata_pelajaran||[];return e.jsxs("div",{className:`min-h-screen font-sans bg-white overflow-x-hidden ${r?"pointer-events-none select-none":""}`,children:[e.jsxs("section",{className:`relative bg-emerald-950 text-white overflow-hidden rounded-b-[2.5rem] shadow-xl transition-all duration-700 persistent-header ${a?"pt-40 pb-16":"pt-28 pb-16"}`,children:[e.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none opacity-20 bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')]"}),e.jsx("div",{className:"absolute top-[-50%] right-[-10%] w-[500px] h-[500px] bg-yellow-500/10 rounded-full blur-[100px] pointer-events-none"}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 relative z-10 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-white/10 border border-white/20 backdrop-blur-md rounded-full mb-6",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-yellow-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black text-yellow-100 uppercase tracking-widest font-sans",children:Be.hero.label_atas})]}),e.jsxs("h1",{className:"font-serif text-3xl md:text-5xl font-bold tracking-tight leading-[1.1] mb-4",children:[Be.hero.judul_awalan," ",e.jsx("br",{}),e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 via-yellow-400 to-yellow-200",children:Be.hero.judul_sorotan})]}),e.jsx("p",{className:"text-emerald-100/70 max-w-lg mx-auto text-sm leading-relaxed font-sans",children:Be.hero.deskripsi})]})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-10 md:py-20 space-y-16 md:space-y-32",children:M.map((b,T)=>{var l,I,_,n,v,R,W;const $=T%2===0,E=$?"rotate-3":"-rotate-3",F=$?"lg:flex-row":"lg:flex-row-reverse",x=b.aksen||"#10b981";return e.jsxs(ja.Fragment,{children:[e.jsxs("div",{className:"md:hidden relative mb-16",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("span",{className:"inline-block px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest mb-2",style:{backgroundColor:oa(x,.1),color:x},children:b.sub_judul}),e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[b.logo&&e.jsx("img",{src:b.logo,alt:"Logo",className:"w-8 h-8 object-contain"}),e.jsx("h2",{className:"font-serif text-3xl font-bold text-gray-900 leading-tight",children:b.judul})]})]}),e.jsxs("div",{className:"relative aspect-[4/3] rounded-[2rem] overflow-hidden shadow-lg mx-2 z-0",children:[e.jsx("img",{src:b.gambar&&b.gambar[0]?b.gambar[0]:"",alt:b.judul,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-80"})]}),e.jsxs("div",{className:"relative -mt-10 mx-6 z-10 bg-white p-4 rounded-2xl shadow-xl border border-gray-100 flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden shadow-sm border-2 border-slate-50 shrink-0",children:e.jsx("img",{src:(l=b.kepala)==null?void 0:l.gambar,alt:(I=b.kepala)==null?void 0:I.nama,className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-black text-gray-400 uppercase tracking-widest leading-none mb-1",children:"Kepala Sekolah"}),e.jsx("h4",{className:"text-sm font-bold text-gray-900 leading-tight line-clamp-1",children:(_=b.kepala)==null?void 0:_.nama})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4 px-2",children:[e.jsxs("div",{className:"bg-slate-50 border border-slate-100 px-4 py-3 rounded-2xl flex flex-col items-center justify-center gap-1",children:[e.jsx("div",{className:"text-emerald-500 mb-0.5",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsx("p",{className:"text-lg font-black text-gray-900 leading-none",children:b.santri}),e.jsx("p",{className:"text-[9px] font-black uppercase text-gray-400 leading-none",children:"Santri"})]}),e.jsxs("div",{className:"bg-slate-50 border border-slate-100 px-4 py-3 rounded-2xl flex flex-col items-center justify-center gap-1",children:[e.jsx("div",{className:"text-amber-500 mb-0.5",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13M12 6.253V13"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 13c1.667 0 3-1.333 3-3V6.253"})]})}),e.jsx("p",{className:"text-lg font-black text-gray-900 leading-none",children:b.pengajar}),e.jsx("p",{className:"text-[9px] font-black uppercase text-gray-400 leading-none",children:"Pengajar"})]})]}),e.jsx("p",{className:"text-gray-500 text-sm leading-relaxed text-center px-4 mt-6",children:b.deskripsi})]}),e.jsxs("section",{className:`hidden md:flex flex-col items-center gap-20 ${F}`,children:[e.jsxs("div",{className:"flex-1 space-y-8 text-left",children:[e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("span",{className:"inline-block px-4 py-1.5 rounded-full text-xs font-black uppercase tracking-widest w-fit",style:{backgroundColor:oa(x,.1),color:x},children:b.sub_judul}),e.jsxs("div",{className:"flex items-center gap-4",children:[b.logo&&e.jsx("img",{src:b.logo,alt:"Logo",className:"w-12 h-12 md:w-16 md:h-16 object-contain"}),e.jsx("h2",{className:"font-serif text-3xl md:text-5xl font-bold text-gray-900 leading-none",children:b.judul})]})]}),e.jsx("p",{className:"text-gray-600 text-lg leading-relaxed max-w-xl mx-auto lg:mx-0",children:b.deskripsi}),e.jsxs("div",{className:"inline-flex items-center gap-4 p-4 rounded-3xl border shadow-sm max-w-sm w-full transition-all duration-500 hover:shadow-md hover:translate-x-1",style:{backgroundColor:oa(x,.05),borderColor:oa(x,.2)},children:[e.jsxs("div",{className:"relative shrink-0",children:[e.jsx("div",{className:"w-14 h-14 rounded-2xl overflow-hidden shadow-sm border-2 border-white",children:e.jsx("img",{src:(n=b.kepala)==null?void 0:n.gambar,alt:(v=b.kepala)==null?void 0:v.nama,className:"w-full h-full object-cover"})}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-6 h-6 rounded-full border-2 border-white flex items-center justify-center text-white",style:{backgroundColor:x},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.64.304 1.24.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 010-3.976 3.066 3.066 0 000.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-xs font-black text-gray-400 uppercase tracking-widest leading-none mb-1",children:"Kepala Madrasah"}),e.jsx("h4",{className:"text-sm font-bold text-gray-900 leading-tight mb-1",children:(R=b.kepala)==null?void 0:R.nama}),e.jsxs("p",{className:"text-[10px] font-bold text-gray-500 italic",children:["Telah berpengalaman lebih dari ",(W=b.kepala)==null?void 0:W.pengalaman]})]})]}),e.jsxs("div",{className:"flex flex-wrap justify-start gap-4 pt-4",children:[e.jsxs("div",{className:"bg-slate-50 border border-slate-100 px-6 py-4 rounded-[2rem] flex items-center gap-4 group hover:bg-white hover:shadow-xl transition duration-500",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl flex items-center justify-center shrink-0",style:{backgroundColor:oa(x,.1),color:x},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-[10px] font-black uppercase text-gray-400 leading-none mb-1",children:"Total Santri"}),e.jsx("p",{className:"text-xl font-black text-gray-900 leading-none",children:b.santri})]})]}),e.jsxs("div",{className:"bg-slate-50 border border-slate-100 px-6 py-4 rounded-[2rem] flex items-center gap-4 group hover:bg-white hover:shadow-xl transition duration-500",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl flex items-center justify-center shrink-0",style:{backgroundColor:oa(x,.1),color:x},children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13M12 6.253V13"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 13c1.667 0 3-1.333 3-3V6.253"})]})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-[10px] font-black uppercase text-gray-400 leading-none mb-1",children:"Tenaga Pengajar"}),e.jsx("p",{className:"text-xl font-black text-gray-900 leading-none",children:b.pengajar})]})]})]})]}),e.jsxs("div",{className:"flex-1 relative group w-full max-w-md lg:max-w-none px-6",children:[e.jsx("div",{className:`absolute inset-0 bg-slate-100 rounded-[3rem] shadow-md transform -translate-x-4 translate-y-6 ${E==="rotate-3"?"-rotate-6":"rotate-6"} group-hover:rotate-0 transition duration-700`}),e.jsx("div",{className:`absolute inset-0 rounded-[3rem] shadow-lg transform translate-x-4 translate-y-4 ${E==="rotate-3"?"rotate-6":"-rotate-6"} group-hover:rotate-0 transition duration-700`,style:{backgroundColor:x}}),e.jsxs("div",{className:`relative aspect-video lg:aspect-square bg-slate-200 rounded-[3rem] shadow-2xl overflow-hidden transform transition duration-700 group-hover:scale-[1.02] group-hover:rotate-0 ${E}`,children:[e.jsx("img",{src:b.gambar&&b.gambar[0]?b.gambar[0]:"",alt:b.judul,className:"w-full h-full object-cover grayscale group-hover:grayscale-0 transition duration-700"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 to-transparent"})]})]})]})]},T)})}),e.jsxs("section",{className:"py-32 bg-emerald-950 text-white relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.05] bg-grid-white animate-grid-flow"}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-32 bg-gradient-to-b from-white to-transparent opacity-10"}),e.jsxs("div",{className:"max-w-7xl mx-auto px-6 relative z-10",children:[e.jsxs("div",{className:"text-center mb-20 space-y-4",children:[e.jsx("div",{className:"inline-block px-4 py-1 bg-yellow-500/10 border border-yellow-500/30 rounded-full mb-4",children:e.jsx("span",{className:"text-yellow-500 font-black tracking-[0.4em] uppercase text-[9px]",children:"Struktur Pembelajaran"})}),e.jsxs("h2",{className:"text-4xl md:text-7xl font-serif font-bold leading-tight",children:[Be.pilar.judul_awalan," ",e.jsx("br",{}),Be.pilar.judul_sorotan]}),e.jsx("p",{className:"text-emerald-100/40 max-w-2xl mx-auto text-lg md:text-xl font-light leading-relaxed",children:Be.pilar.deskripsi})]}),e.jsx("div",{className:`flex md:grid ${rt(w.length)} gap-6 overflow-x-auto snap-x snap-mandatory pb-8 -mx-6 px-6 md:mx-0 md:px-0 scrollbar-hide md:overflow-visible md:pb-0`,onScroll:b=>m(b,i),children:w.map((b,T)=>{const $=Qt(b.judul);return e.jsxs("div",{className:"min-w-[85vw] md:min-w-0 snap-center h-full group relative rounded-[2.5rem] overflow-hidden border border-white/10 transition-all duration-700 hover:-translate-y-2 hover:shadow-2xl bg-emerald-900",children:[e.jsx("div",{className:"h-48 relative",children:e.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[e.jsx("img",{src:b.gambar,alt:b.judul,className:"w-full h-full object-cover transition-transform duration-1000 group-hover:scale-110",onError:E=>E.currentTarget.src=`https://placehold.co/600x400/064e3b/ffffff?text=${b.judul}`}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-emerald-900 to-transparent"})]})}),e.jsxs("div",{className:"p-8 pt-10 relative z-10",children:[e.jsx("div",{className:`absolute -top-8 right-6 w-16 h-16 rounded-2xl ${$.bg_color} flex items-center justify-center text-white shadow-lg border-4 border-emerald-900 transition-transform group-hover:rotate-6 z-20`,children:$.icon}),e.jsx("h4",{className:"text-yellow-400 font-black text-xs uppercase tracking-[0.2em] mb-2",children:b.organisasi}),e.jsx("h3",{className:"text-2xl md:text-3xl font-serif font-bold text-white tracking-tight leading-none mb-4",children:b.judul}),e.jsx("p",{className:"text-emerald-100 text-sm leading-relaxed opacity-80",children:b.deskripsi})]})]},T)})}),e.jsx(h,{total:w.length,activeIndex:u,colorClass:"bg-yellow-500",inactiveClass:"bg-white/20"})]})]}),e.jsx("section",{className:"py-24 bg-slate-50 border-t border-slate-200 siku-container",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"text-center mb-16 space-y-4",children:[e.jsx("span",{className:"text-emerald-600 font-bold tracking-[0.2em] uppercase text-[10px]",children:Be.program.label_atas}),e.jsxs("h2",{className:"text-3xl md:text-5xl font-serif font-bold text-slate-900",children:[Be.program.judul," ",e.jsx("span",{className:"text-emerald-600",children:Be.program.sub_judul})]}),e.jsxs("p",{className:"text-slate-500 max-w-2xl mx-auto italic",children:['"',Be.program.kutipan,'"']})]}),e.jsx("div",{className:`flex md:grid ${rt(d.length)} gap-6 overflow-x-auto snap-x snap-mandatory pb-8 -mx-6 px-6 md:mx-0 md:px-0 scrollbar-hide`,onScroll:b=>m(b,K),children:d.map((b,T)=>{const $=Xt(b.judul);return e.jsxs("div",{className:`min-w-[80vw] md:min-w-0 snap-center bg-white p-8 rounded-[2.5rem] border shadow-lg hover:shadow-2xl transition-all duration-500 group relative overflow-hidden flex flex-col ${$.border}`,children:[e.jsx("div",{className:`absolute top-0 right-0 w-24 h-24 rounded-full blur-2xl -mr-10 -mt-10 ${$.bg}`}),e.jsx("div",{className:`w-14 h-14 rounded-2xl ${$.bg} ${$.text} flex items-center justify-center mb-6 shadow-sm group-hover:scale-110 transition-transform`,children:e.jsx("svg",{className:"w-7 h-7",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:1.5,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:$.iconPath})})}),e.jsx("h4",{className:"font-serif font-bold text-xl text-slate-900 mb-2",children:b.judul}),e.jsx("p",{className:"text-slate-500 text-sm leading-relaxed mb-4 flex-1",children:b.deskripsi}),e.jsx("span",{className:"inline-block px-3 py-1 bg-gray-50 border border-gray-100 rounded-lg text-[10px] font-bold uppercase tracking-widest text-gray-400 self-start",children:b.tag})]},T)})}),e.jsx(h,{total:d.length,activeIndex:g})]})}),e.jsx("section",{className:"py-24 bg-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsx("div",{className:"flex flex-col md:flex-row md:items-end justify-between mb-12 gap-6",children:e.jsxs("div",{className:"max-w-2xl",children:[e.jsx("span",{className:"text-emerald-600 font-bold tracking-[0.2em] uppercase text-[10px]",children:Be.mapel.judul}),e.jsx("h2",{className:"text-3xl md:text-5xl font-serif font-bold text-slate-900 mt-2",children:Be.mapel.sub_judul}),e.jsx("p",{className:"text-slate-500 mt-4",children:Be.mapel.deskripsi})]})}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:z.map((b,T)=>e.jsxs("div",{className:"bg-slate-50 p-5 rounded-2xl border border-slate-100 hover:border-emerald-200 hover:shadow-lg transition-all group",children:[e.jsx("div",{className:"mb-3 w-10 h-10 rounded-lg bg-white border border-slate-100 flex items-center justify-center text-emerald-600 shadow-sm group-hover:scale-110 transition-transform",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13M12 6.253V13m0-13c1.667 0 3 1.333 3 3v6.253"})})}),e.jsx("h4",{className:"font-bold text-slate-800 text-sm mb-1 line-clamp-1",title:b.nama,children:b.nama}),e.jsx("p",{className:"text-[10px] text-slate-400 line-clamp-2 leading-relaxed group-hover:text-slate-500",children:b.deskripsi})]},T))})]})}),e.jsx("section",{className:"py-24 bg-slate-50 border-t border-slate-100 relative",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-6",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsxs("h2",{className:"text-3xl md:text-5xl font-serif font-bold text-slate-900",children:[Be.rutinitas.judul_awalan," ",e.jsx("span",{className:"text-emerald-600",children:Be.rutinitas.judul_sorotan})]}),e.jsx("p",{className:"text-slate-500 max-w-2xl mx-auto mt-4",children:Be.rutinitas.deskripsi})]}),e.jsx("div",{className:"flex justify-center mb-10",children:e.jsx("div",{className:"bg-white p-1.5 rounded-full border border-slate-200 shadow-sm inline-flex",children:["Harian","Mingguan","Berkala"].map(b=>e.jsx("button",{onClick:()=>p(b),className:`px-6 py-2.5 rounded-full text-sm font-bold transition-all ${B===b?"bg-emerald-600 text-white shadow-md":"text-slate-500 hover:text-emerald-700"}`,children:b},b))})}),e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl border border-slate-200 overflow-hidden animate-fade-in-up min-h-[400px]",children:[B==="Harian"&&e.jsx("div",{className:"overflow-x-auto w-full",children:e.jsxs("table",{className:"w-full text-left border-collapse min-w-max",children:[e.jsx("thead",{className:"bg-emerald-50/50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-5 pl-8 text-xs font-black text-emerald-800 uppercase tracking-widest whitespace-nowrap w-[50px]",children:"No"}),e.jsx("th",{className:"p-5 text-xs font-black text-emerald-800 uppercase tracking-widest whitespace-nowrap w-[150px]",children:"Waktu"}),e.jsx("th",{className:"p-5 pr-8 text-xs font-black text-emerald-800 uppercase tracking-widest whitespace-nowrap",children:"Kegiatan"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:C.map(b=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"p-5 pl-8 font-mono text-emerald-600 font-bold text-sm whitespace-nowrap",children:b.no}),e.jsx("td",{className:"p-5 font-bold text-slate-700 text-sm whitespace-nowrap",children:b.jam}),e.jsx("td",{className:"p-5 pr-8 text-slate-600 text-sm font-medium whitespace-nowrap",children:b.kegiatan})]},b.no))})]})}),B==="Mingguan"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 divide-y md:divide-y-0 md:divide-x divide-slate-100",children:L.map((b,T)=>e.jsxs("div",{className:"p-6 md:p-8 hover:bg-slate-50 transition-colors flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-indigo-50 text-indigo-600 flex items-center justify-center font-bold text-xl shrink-0",children:b.no}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900 text-lg mb-1",children:b.waktu}),e.jsx("p",{className:"text-slate-500",children:b.kegiatan})]})]},T))}),B==="Berkala"&&e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-black text-slate-400 uppercase tracking-widest mb-4 border-b border-slate-100 pb-2",children:"Bulanan"}),e.jsx("div",{className:"space-y-3",children:P.map((b,T)=>e.jsxs("div",{className:"flex items-center gap-4 bg-slate-50 p-4 rounded-xl border border-slate-100",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-amber-500"}),e.jsx("span",{className:"font-medium text-slate-700",children:b.kegiatan})]},T))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-black text-slate-400 uppercase tracking-widest mb-4 border-b border-slate-100 pb-2",children:"Tahunan"}),e.jsx("div",{className:"space-y-3",children:y.map((b,T)=>e.jsxs("div",{className:"flex items-center gap-4 bg-emerald-50 p-4 rounded-xl border border-emerald-100",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"}),e.jsx("span",{className:"font-medium text-emerald-900",children:b.kegiatan})]},T))})]})]})]})]})}),e.jsx("section",{className:"py-20 bg-white border-t border-slate-200",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-6 text-center space-y-8",children:[e.jsx("h2",{className:"text-3xl md:text-5xl font-serif font-bold text-slate-900 leading-tight",children:"Konsultasi Pendidikan"}),e.jsx("p",{className:"text-slate-500 text-lg leading-relaxed",children:"Bingung memilih jenjang atau ingin tahu lebih dalam tentang kurikulum kami? Hubungi konsultan kami."}),e.jsx("div",{className:"flex justify-center gap-4",children:e.jsx("button",{className:"px-8 py-4 bg-emerald-950 text-white font-bold rounded-xl shadow-xl hover:bg-black transition hover:-translate-y-1",children:"Unduh Brosur Akademik"})})]})})]})},Zt=({isSearchOpen:a=!1,previewData:r})=>{const{fetchData:t,cache:o}=ge(),[c,k]=s.useState(r||(Array.isArray(o.galeri)?o.galeri:null)),[f,D]=s.useState(null),[B,p]=s.useState(!r&&!o.galeri),[m,u]=s.useState(null);s.useEffect(()=>{if(r){k(r);return}(async()=>{o.galeri||p(!0);try{const K=await t("galeri",G.getGaleri,"Fasilitas.tsx",!1,!1);K&&Array.isArray(K)?k(K):(console.error("Format data galeri tidak valid untuk fasilitas (harus array)."),k([]))}catch(K){console.error("Gagal memuat data:",K)}finally{p(!1)}})()},[t,r,o.galeri]);const i=s.useMemo(()=>!c||!Array.isArray(c)?[]:c.filter(g=>g.tipe==="Fasilitas"),[c]);return B&&!c?e.jsx(fe,{message:"Menyiapkan halaman Fasilitas",fullScreen:!0}):e.jsxs("div",{className:`min-h-screen font-sans bg-white overflow-hidden ${r?"pointer-events-none select-none":""}`,children:[e.jsx(ka,{src:m||"",isOpen:!!m,onClose:()=>u(null)}),e.jsxs("section",{className:`relative bg-emerald-950 text-white overflow-hidden rounded-b-[2.5rem] shadow-xl transition-all duration-700 persistent-header ${a?"pt-40 pb-16":"pt-28 pb-16"}`,children:[e.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none opacity-20 bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')]"}),e.jsx("div",{className:"absolute top-[-50%] right-[-10%] w-[500px] h-[500px] bg-yellow-500/10 rounded-full blur-[100px] pointer-events-none"}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 relative z-10 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-white/10 border border-white/20 backdrop-blur-md rounded-full mb-6",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-yellow-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black text-yellow-100 uppercase tracking-widest font-sans",children:"Sarana & Prasarana"})]}),e.jsxs("h1",{className:"font-serif text-3xl md:text-5xl font-bold tracking-tight leading-[1.1] mb-4",children:["Fasilitas ",e.jsx("br",{}),e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 via-yellow-400 to-yellow-200",children:"Unggulan"})]}),e.jsx("p",{className:"text-emerald-100/70 max-w-lg mx-auto text-sm leading-relaxed font-sans",children:"Infrastruktur modern yang dirancang untuk mendukung kenyamanan ibadah dan produktivitas belajar santri."})]})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 md:px-6 py-12 md:py-32",children:i.length===0?e.jsx("div",{className:"text-center text-gray-400 py-12",children:"Belum ada data fasilitas yang diunggah ke Galeri."}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:i.map((g,K)=>e.jsxs("div",{className:"group flex flex-col h-full cursor-zoom-in",onClick:()=>u(g.link),children:[e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:`absolute inset-0 ${K%2===0?"bg-emerald-900":"bg-amber-900"} rounded-[2rem] shadow-lg transform rotate-2 group-hover:rotate-0 transition duration-500`}),e.jsxs("div",{className:"relative aspect-[4/3] bg-slate-200 rounded-[2rem] shadow-xl overflow-hidden transform -rotate-1 group-hover:rotate-0 group-hover:scale-[1.02] transition duration-700",children:[e.jsx("img",{src:g.link,alt:g.judul,className:"w-full h-full object-cover grayscale group-hover:grayscale-0 transition duration-700 scale-110 group-hover:scale-100"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 flex flex-col justify-end p-6",children:e.jsxs("span",{className:"text-white text-xs font-bold flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})}),"Perbesar"]})})]})]}),e.jsxs("div",{className:"text-center px-4",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-[0.2em] text-emerald-600 mb-2 block",children:"Fasilitas Al-Burhani"}),e.jsx("h3",{className:"font-serif text-2xl font-bold text-gray-900 leading-tight",children:g.judul})]})]},K))})}),e.jsx("section",{className:"py-24 bg-slate-50 border-t border-slate-100",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-6 text-center",children:[e.jsx("h3",{className:"font-serif text-3xl md:text-5xl font-bold text-slate-900 mb-6 tracking-tight",children:"Kunjungi Kampus Kami"}),e.jsx("p",{className:"text-slate-500 mb-10 text-lg md:text-xl font-light leading-relaxed",children:"Rasakan langsung suasana belajar yang asri dan fasilitas lengkap yang kami sediakan."}),e.jsx("div",{className:"flex flex-col sm:flex-row justify-center gap-4",children:e.jsx("button",{className:"px-10 py-5 bg-emerald-950 text-white font-bold rounded-2xl shadow-2xl hover:bg-black transition transform hover:-translate-y-1",children:"Jadwalkan Kunjungan"})})]})})]})},ya={label_atas:"Jejak Digital",judul_awalan:"Galeri",judul_sorotan:"Al-Burhani",deskripsi:"Kumpulan momen berharga santri dalam menuntut ilmu, beribadah, dan mengukir prestasi gemilang."},es=a=>{const r=[...a];for(let t=r.length-1;t>0;t--){const o=Math.floor(Math.random()*(t+1));[r[t],r[o]]=[r[o],r[t]]}return r},as=({isSearchOpen:a=!1,previewData:r})=>{const{fetchData:t,cache:o}=ge(),[c,k]=s.useState(r||(Array.isArray(o.galeri)?o.galeri:[])),[f,D]=s.useState(!r&&!o.galeri),[B,p]=s.useState("Semua"),[m,u]=s.useState(null);s.useEffect(()=>{if(r){k(Array.isArray(r)?r:[]);return}(async()=>{o.galeri||D(!0);try{const M=await t("galeri",G.getGaleri,"Galeri.tsx",!1,!1);M&&Array.isArray(M)?k(es(M)):(console.error("❌ ERROR: Format data galeri tidak valid (harus array).",M),k([]))}catch(M){console.error("❌ CRITICAL ERROR saat memuat Galeri:",M)}finally{D(!1)}})()},[t,r,o.galeri]);const i=s.useMemo(()=>!c||!Array.isArray(c)?["Semua"]:["Semua",...Array.from(new Set(c.map(M=>M.tipe).filter(Boolean)))],[c]),g=s.useMemo(()=>{const h=Array.isArray(c)?c:[];return B==="Semua"?h:h.filter(M=>M.tipe===B)},[B,c]),K=h=>h==="16:9"?"col-span-2 md:col-span-2":h==="9:16"?"col-span-1 row-span-2 md:col-span-1 md:row-span-2":"col-span-1";return f&&(!c||Array.isArray(c)&&c.length===0)?e.jsx(fe,{message:"Menyiapkan halaman Galeri",fullScreen:!0}):e.jsxs("div",{className:"min-h-screen bg-white font-sans overflow-hidden ",children:[e.jsx(ka,{src:m||"",isOpen:!!m,onClose:()=>u(null)}),e.jsxs("section",{className:`relative bg-emerald-950 text-white overflow-hidden rounded-b-[2.5rem] shadow-xl transition-all duration-700 persistent-header ${a?"pt-40 pb-16":"pt-28 pb-16"}`,children:[e.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none opacity-20 bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')]"}),e.jsx("div",{className:"absolute top-[-50%] right-[-10%] w-[500px] h-[500px] bg-yellow-500/10 rounded-full blur-[100px] pointer-events-none"}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 relative z-10 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-white/10 border border-white/20 backdrop-blur-md rounded-full mb-6",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-yellow-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black text-yellow-100 uppercase tracking-widest font-sans",children:ya.label_atas})]}),e.jsxs("h1",{className:"font-serif text-3xl md:text-5xl font-bold tracking-tight leading-[1.1] mb-4",children:[ya.judul_awalan," ",e.jsx("br",{}),e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 via-yellow-400 to-yellow-200",children:ya.judul_sorotan})]}),e.jsx("p",{className:"text-emerald-100/70 max-w-lg mx-auto text-sm leading-relaxed font-sans",children:ya.deskripsi})]})]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-6 py-12 md:py-24",children:[e.jsx("div",{className:"flex overflow-x-auto md:flex-wrap md:justify-center gap-2 md:gap-4 mb-8 md:mb-20 pb-4 px-4 md:px-0 -mx-4 md:mx-0 scrollbar-hide snap-x",children:i.map(h=>e.jsx("button",{onClick:()=>p(h),className:`flex-shrink-0 snap-center px-6 py-2.5 md:px-8 md:py-3 rounded-full md:rounded-2xl text-xs md:text-sm font-black uppercase tracking-widest transition-all duration-500 whitespace-nowrap ${B===h?"bg-emerald-950 text-white shadow-xl shadow-emerald-900/20 transform scale-105":"bg-slate-50 text-slate-400 border border-slate-100 hover:bg-white hover:text-emerald-900 hover:shadow-lg"}`,children:h},h))}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-6 auto-rows-[180px] md:auto-rows-[280px] animate-fade-in grid-flow-dense",children:g.map((h,M)=>e.jsxs("div",{onClick:()=>u(h.link),className:`group relative overflow-hidden rounded-xl md:rounded-[2rem] cursor-pointer shadow-md hover:shadow-2xl transition-all duration-500 bg-slate-100 ${K(h.ratio)}`,children:[e.jsx("img",{src:h.link,alt:h.judul,className:"w-full h-full object-cover transition-transform duration-700 ease-out group-hover:scale-110 group-hover:rotate-1"}),e.jsx("div",{className:"absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/95 via-black/60 to-transparent opacity-0 group-hover:opacity-100 transition-all duration-300 flex flex-col justify-end p-5 md:p-6 translate-y-4 group-hover:translate-y-0",children:e.jsxs("div",{className:"transform transition-transform duration-300 delay-75",children:[e.jsx("div",{className:"mb-2",children:e.jsx("span",{className:"inline-block px-3 py-1 bg-yellow-400 text-emerald-950 text-[8px] md:text-[10px] font-black uppercase tracking-widest rounded-full shadow-lg",children:h.tipe})}),e.jsx("h3",{className:"text-white font-serif text-lg md:text-2xl font-bold leading-tight drop-shadow-lg line-clamp-2 mb-2",children:h.judul}),e.jsx("div",{className:"w-12 h-1 bg-emerald-500 rounded-full shadow-sm"})]})})]},`${h.judul}-${M}`))})]})]})},Je={hero:{label_atas:"Warta Terkini",judul_awalan:"Informasi",judul_sorotan:"Al-Burhani",deskripsi:"Liputan mendalam seputar kegiatan akademik, prestasi santri, dan perkembangan fasilitas pendidikan kami."},buletin:{judul:"Warta via WhatsApp",deskripsi:"Dapatkan update kabar prestasi dan pengumuman mendesak langsung ke gadget Anda."},ajakan_bertindak:{judul:"Punya Kabar Prestasi?",deskripsi:"Berikan kontribusi warta kegiatan atau pencapaian santri melalui kanal resmi Humas Al-Burhani."}},ts=a=>{const r=[...a];for(let t=r.length-1;t>0;t--){const o=Math.floor(Math.random()*(t+1));[r[t],r[o]]=[r[o],r[t]]}return r},ss=({onNewsSelect:a,isSearchOpen:r=!1})=>{const{fetchData:t,cache:o}=ge(),[c,k]=s.useState([]),[f,D]=s.useState(!o.berita);s.useEffect(()=>{(async()=>{o.berita||D(!0);try{const K=await t("berita",G.getBerita,"Berita.tsx",!1,!1);let h=[];K&&Array.isArray(K)?h=K:K&&K.item&&Array.isArray(K.item)?h=K.item:console.error("❌ ERROR: Format data berita tidak valid (harus array).",K),h.length>0?k(ts(h)):k([])}catch(K){console.error("❌ CRITICAL ERROR saat memuat Berita:",K)}finally{D(!1)}})()},[t]);const B=g=>{const K=g.judul.replace(/\s+/g,"+");window.location.hash=`/berita/${K}`},p=g=>{if(!g||!Array.isArray(g))return"https://placehold.co/600x400/064e3b/ffffff?text=Al-Burhani";const K=g.find(h=>h.jenis==="gambar");return K?K.isi:"https://placehold.co/600x400/064e3b/ffffff?text=Al-Burhani"},m=g=>{if(!g||!Array.isArray(g))return"Klik untuk membaca selengkapnya...";const K=g.find(h=>h.jenis==="teks");return K?K.isi.length>150?K.isi.substring(0,150)+"...":K.isi:"Klik untuk membaca selengkapnya..."};if(f)return e.jsx(fe,{message:"Menyiapkan halaman Berita",fullScreen:!0});const u=c[0],i=c.slice(1);return e.jsxs("div",{className:"min-h-screen font-sans bg-white overflow-hidden",children:[e.jsxs("section",{className:`relative bg-emerald-950 text-white overflow-hidden rounded-b-[2.5rem] shadow-xl transition-all duration-700 persistent-header ${r?"pt-40 pb-16":"pt-28 pb-16"}`,children:[e.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none opacity-20 bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')]"}),e.jsx("div",{className:"absolute top-[-50%] right-[-10%] w-[500px] h-[500px] bg-yellow-500/10 rounded-full blur-[100px] pointer-events-none"}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 relative z-10 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-white/10 border border-white/20 backdrop-blur-md rounded-full mb-6",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-yellow-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black text-yellow-100 uppercase tracking-widest font-sans",children:Je.hero.label_atas})]}),e.jsxs("h1",{className:"font-serif text-3xl md:text-5xl font-bold tracking-tight leading-[1.1] mb-4",children:[Je.hero.judul_awalan," ",e.jsx("br",{}),e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 via-yellow-400 to-yellow-200",children:Je.hero.judul_sorotan})]}),e.jsx("p",{className:"text-emerald-100/70 max-w-lg mx-auto text-sm leading-relaxed font-sans",children:Je.hero.deskripsi})]})]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-24 animate-fade-in",children:[e.jsxs("div",{className:"lg:hidden space-y-12 mb-12",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-serif text-2xl font-bold text-gray-900",children:"Sorotan Utama"}),e.jsx("span",{className:"text-xs font-bold text-emerald-600 bg-emerald-50 px-3 py-1 rounded-full",children:"Hot News"})]}),e.jsx("div",{className:"flex overflow-x-auto snap-x snap-mandatory gap-4 pb-6 -mx-4 px-4 scrollbar-hide",children:c.slice(0,3).map((g,K)=>e.jsxs("div",{onClick:()=>B(g),className:"snap-center shrink-0 w-[85vw] relative rounded-[2rem] overflow-hidden aspect-[4/3] shadow-lg group",children:[e.jsx("img",{src:p(g.konten),alt:g.judul,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110"}),e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent p-6 flex flex-col justify-end",children:[e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest text-yellow-400 mb-2",children:g.kategori}),e.jsx("h4",{className:"font-serif text-xl font-bold text-white leading-tight line-clamp-2 mb-2",children:g.judul}),e.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-white/70",children:[e.jsx("span",{children:g.timestamp||g.tanggal}),e.jsx("span",{className:"w-1 h-1 bg-white/50 rounded-full"}),e.jsx("span",{children:g.penulis})]}),g.tag&&g.tag.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:g.tag.slice(0,2).map((h,M)=>e.jsx("span",{className:"text-[8px] bg-white/20 backdrop-blur-md px-2 py-0.5 rounded-full text-white",children:h},M))})]})]},K))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-serif text-xl font-bold text-gray-900 mb-4",children:"Terkini"}),e.jsx("div",{className:"flex flex-col gap-4",children:c.slice(3,5).map((g,K)=>e.jsxs("div",{onClick:()=>B(g),className:"flex gap-4 bg-white p-3 rounded-2xl border border-gray-100 shadow-sm active:scale-[0.98] transition-transform",children:[e.jsx("div",{className:"w-24 h-24 rounded-xl overflow-hidden shrink-0 bg-gray-200",children:e.jsx("img",{src:p(g.konten),alt:g.judul,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex flex-col justify-center",children:[e.jsx("span",{className:"text-[9px] font-black uppercase text-emerald-600 tracking-widest mb-1",children:g.kategori}),e.jsx("h4",{className:"font-bold text-sm text-gray-900 leading-tight line-clamp-2 mb-2",children:g.judul}),e.jsx("p",{className:"text-[10px] text-gray-400 mb-1",children:g.timestamp||g.tanggal}),g.tag&&e.jsx("div",{className:"flex gap-1 overflow-hidden",children:g.tag.slice(0,2).map((h,M)=>e.jsx("span",{className:"text-[8px] text-gray-500 bg-gray-100 px-1.5 py-0.5 rounded",children:h},M))})]})]},K))})]})]}),e.jsxs("div",{className:"hidden lg:grid grid-cols-12 gap-12 mb-20",children:[u&&e.jsx("div",{className:"col-span-8",children:e.jsxs("article",{onClick:()=>B(u),className:"group cursor-pointer space-y-8",children:[e.jsxs("div",{className:"relative aspect-[21/9] rounded-[2.5rem] overflow-hidden shadow-2xl transition-all duration-700 group-hover:shadow-emerald-900/20",children:[e.jsx("img",{src:p(u.konten),alt:u.judul,className:"w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-1000"}),e.jsx("div",{className:"absolute top-8 left-8",children:e.jsx("span",{className:"px-5 py-1.5 bg-yellow-500 text-emerald-950 text-[10px] font-black uppercase tracking-widest rounded-full backdrop-blur-md shadow-lg",children:"Berita Utama"})}),u.tag&&e.jsx("div",{className:"absolute bottom-8 left-8 flex flex-wrap gap-2",children:u.tag.map((g,K)=>e.jsx("span",{className:"px-3 py-1 bg-black/40 backdrop-blur-md text-white text-xs font-medium rounded-full",children:g},K))})]}),e.jsxs("div",{className:"px-2 space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-black uppercase tracking-[0.2em] text-emerald-600",children:[e.jsx("span",{children:u.timestamp||u.tanggal}),e.jsx("span",{className:"w-1 h-1 bg-emerald-200 rounded-full"}),e.jsx("span",{children:u.penulis})]}),e.jsx("h2",{className:"font-serif text-5xl font-bold text-gray-900 group-hover:text-emerald-800 transition-colors leading-tight",children:u.judul}),e.jsx("p",{className:"text-gray-500 text-lg leading-relaxed font-light line-clamp-3",children:m(u.konten)}),e.jsxs("button",{className:"flex items-center gap-2 text-emerald-900 font-bold text-sm uppercase tracking-widest group-hover:gap-4 transition-all",children:["Baca Selengkapnya",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})]})]})}),e.jsxs("div",{className:"col-span-4 space-y-12",children:[e.jsxs("div",{className:"bg-slate-50 p-8 rounded-[2.5rem] border border-slate-100",children:[e.jsx("h3",{className:"font-serif text-2xl font-bold text-gray-900 mb-8",children:"Informasi Penting"}),e.jsx("div",{className:"space-y-8",children:c.slice(0,3).map((g,K)=>e.jsxs("div",{onClick:()=>B(g),className:"group cursor-pointer flex gap-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl overflow-hidden shrink-0 shadow-md",children:e.jsx("img",{src:p(g.konten),className:"w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-500",alt:g.judul})}),e.jsxs("div",{className:"space-y-1 overflow-hidden",children:[e.jsx("span",{className:"text-[9px] font-black text-emerald-600 uppercase tracking-widest",children:g.kategori}),e.jsx("h4",{className:"font-bold text-gray-800 text-xs leading-tight group-hover:text-emerald-700 transition-colors line-clamp-2",children:g.judul}),e.jsx("p",{className:"text-[10px] text-gray-400 font-mono mb-1",children:g.timestamp||g.tanggal}),g.tag&&g.tag.length>0&&e.jsx("div",{className:"flex gap-1",children:e.jsxs("span",{className:"text-[8px] bg-white border border-gray-200 px-1.5 rounded text-gray-500",children:["#",g.tag[0]]})})]})]},K))})]}),e.jsxs("div",{className:"bg-emerald-950 rounded-[2.5rem] p-10 text-white relative overflow-hidden group shadow-2xl",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.05] bg-grid-white animate-grid-flow"}),e.jsx("h4",{className:"font-serif text-2xl font-bold relative z-10 mb-4",children:Je.buletin.judul}),e.jsx("p",{className:"text-emerald-50/60 text-xs relative z-10 mb-8 leading-relaxed font-light",children:Je.buletin.deskripsi}),e.jsxs("div",{className:"relative z-10 space-y-3",children:[e.jsx("input",{type:"tel",placeholder:"No. WhatsApp Anda...",className:"w-full bg-white/10 border border-white/20 rounded-2xl px-5 py-3 text-sm focus:ring-2 focus:ring-yellow-400 outline-none transition"}),e.jsx("button",{className:"w-full bg-yellow-500 text-emerald-950 font-bold py-3 rounded-2xl hover:bg-yellow-400 transition transform active:scale-95",children:"Langganan Sekarang"})]})]})]})]}),e.jsxs("div",{className:"border-t border-gray-100 pt-8 md:pt-16",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end mb-6 md:mb-10 gap-4",children:[e.jsx("h3",{className:"font-serif text-2xl md:text-3xl font-bold text-gray-900",children:"Berita Terbaru Lainnya"}),e.jsx("p",{className:"text-gray-400 text-sm max-w-md text-right hidden md:block",children:"Ikuti terus perkembangan santri dan kegiatan pesantren kami."})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-8",children:i.map((g,K)=>e.jsxs("article",{onClick:()=>B(g),className:"group cursor-pointer flex flex-col h-full bg-white md:bg-transparent rounded-2xl md:rounded-none border md:border-none border-gray-100 shadow-sm md:shadow-none overflow-hidden md:overflow-visible",children:[e.jsxs("div",{className:"relative aspect-square md:aspect-[4/3] rounded-none md:rounded-[2rem] overflow-hidden md:shadow-xl transition-all duration-700 group-hover:shadow-emerald-900/10 mb-0 md:mb-6",children:[e.jsx("img",{src:p(g.konten),alt:g.judul,className:"w-full h-full object-cover transform group-hover:scale-105 transition-transform duration-1000"}),e.jsx("div",{className:"absolute top-2 left-2 md:top-4 md:left-4",children:e.jsx("span",{className:"px-2 py-1 md:px-3 bg-emerald-950/80 text-white text-[8px] md:text-[9px] font-black uppercase tracking-widest rounded-full backdrop-blur-md",children:g.kategori})})]}),e.jsxs("div",{className:"p-4 md:p-1 space-y-2 md:space-y-3 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2 text-[8px] font-black uppercase tracking-[0.15em] text-emerald-600",children:[e.jsx("span",{children:g.timestamp||g.tanggal}),e.jsx("span",{className:"w-1 h-1 bg-emerald-200 rounded-full hidden md:block"}),e.jsx("span",{className:"truncate max-w-[80px] hidden md:block",children:g.penulis})]}),e.jsx("h3",{className:"font-serif text-sm md:text-xl font-bold text-gray-900 group-hover:text-emerald-800 transition-colors leading-tight line-clamp-3",children:g.judul}),e.jsx("p",{className:"text-gray-500 text-xs md:text-sm line-clamp-2 md:line-clamp-3 leading-relaxed mb-0 md:mb-4 hidden md:block",children:m(g.konten)}),g.tag&&e.jsx("div",{className:"hidden md:flex flex-wrap gap-2 mt-2",children:g.tag.slice(0,3).map((h,M)=>e.jsxs("span",{className:"text-[10px] text-gray-500 bg-gray-50 border border-gray-100 px-2 py-0.5 rounded-full",children:["#",h]},M))}),e.jsx("div",{className:"mt-auto pt-2 md:pt-4 hidden md:block",children:e.jsxs("button",{className:"flex items-center gap-2 text-emerald-900 font-bold text-[10px] uppercase tracking-widest group-hover:gap-3 transition-all",children:["Selengkapnya",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})})]})]},K))})]})]}),e.jsx("section",{className:"py-24 bg-slate-50 border-t border-slate-100",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-6 text-center",children:[e.jsx("h3",{className:"font-serif text-3xl md:text-5xl font-bold text-gray-900 mb-6 tracking-tight",children:Je.ajakan_bertindak.judul}),e.jsx("p",{className:"text-gray-500 mb-10 text-lg md:text-xl font-light leading-relaxed",children:Je.ajakan_bertindak.deskripsi}),e.jsx("button",{className:"px-10 py-5 bg-emerald-950 text-white font-bold rounded-2xl shadow-2xl hover:bg-black transition transform hover:-translate-y-1",children:"Hubungi Tim Humas"})]})})]})},xa={title_small:"Ahlan Wa Sahlan",title_main:`Penerimaan
Santri Baru`,title_accent:"2026",description:"Menyiapkan generasi Rabbani yang unggul dalam Imtaq dan Iptek, berakhlak mulia, serta siap memimpin masa depan dengan landasan Al-Qur'an dan As-Sunnah."},ns=({onStart:a,onOpenGuide:r,onCheckStatus:t,previewData:o})=>{const{fetchData:c,cache:k}=ge(),[f,D]=s.useState([]),[B,p]=s.useState([]),[m,u]=s.useState(!0),i=s.useRef(null),[g,K]=s.useState(0);s.useEffect(()=>{(async()=>{u(!0);try{let w=null;if(o)w=o;else{const d=await c("pendaftaranPage",G.getPendaftaranPage,"Welcoming.tsx");w=Array.isArray(d)?d[0]:d}if(w&&w.jadwal){const d=new Date().getTime(),C=w.jadwal.map((z,j)=>{const N=new Date(z.waktu.mulai).getTime(),A=new Date(z.waktu.selesai).getTime();let S="upcoming";d>=N&&d<=A?S="active":d>A&&(S="finished");const b=T=>new Date(T).toLocaleDateString("id-ID",{day:"numeric",month:"short"});return{id:j+1,gel:`Gelombang ${z.gelombang}`,label:z.label,start:z.waktu.mulai,end:z.waktu.selesai,daftar:`${b(z.waktu.mulai)} - ${b(z.waktu.selesai)}`,tes:z.waktu.tes,status:S}}),L=C.find(z=>z.status==="active"),P=C.filter(z=>z.status!=="active");let y=[];if(L){const z=P[0],j=P[1];z&&y.push(z),y.push(L),j&&y.push(j),P.length>2&&y.push(...P.slice(2))}else y=C;D(y)}if(w&&w.kontak){const d=[],C=w.kontak.find(P=>P.nama.toLowerCase().includes("putra"))||w.kontak[0];C&&d.push({title:C.nama,subtitle:"Santri Laki-laki",theme:"emerald",icon:e.jsx("svg",{className:"w-5 h-5 md:w-8 md:h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),contacts:[{label:"WhatsApp",phone:C.telpon,display:C.telpon.replace(/(\d{4})(\d{4})(\d{4})/,"$1-$2-$3")}]});const L=w.kontak.find(P=>P.nama.toLowerCase().includes("putri"))||w.kontak[1];L&&d.push({title:L.nama,subtitle:"Santri Perempuan",theme:"rose",icon:e.jsx("svg",{className:"w-5 h-5 md:w-8 md:h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),contacts:[{label:"WhatsApp",phone:L.telpon,display:L.telpon.replace(/(\d{4})(\d{4})(\d{4})/,"$1-$2-$3")}]}),p(d)}}catch(w){console.error("Gagal memuat data pendaftaran:",w)}finally{u(!1)}})()},[c,o]),s.useEffect(()=>{if(!m&&i.current&&window.innerWidth<768){const M=i.current.children;if(M.length>=2){const w=M[1],d=i.current,C=w.offsetLeft-d.clientWidth/2+w.clientWidth/2;K(1),setTimeout(()=>{d.scrollTo({left:C,behavior:"smooth"})},100)}}},[m,f]),s.useEffect(()=>{const M=setInterval(()=>{if(window.innerWidth<768&&i.current&&f.length>0){const w=i.current,d=w.children;if(d.length===0)return;const C=(g+1)%f.length,L=d[C];if(L){const P=L.offsetLeft-w.clientWidth/2+L.clientWidth/2;w.scrollTo({left:P,behavior:"smooth"})}}},7e3);return()=>clearInterval(M)},[g,f.length]);const h=M=>{const{scrollLeft:w,clientWidth:d}=M.currentTarget,C=Math.round(w/d);C!==g&&K(C)};return e.jsxs("div",{className:`fixed inset-0 z-[9999] bg-slate-50 font-sans h-[100dvh] w-full ${o?"absolute":""}`,children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')] opacity-[0.04] pointer-events-none"}),e.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-b from-emerald-900/5 via-transparent to-emerald-900/5 pointer-events-none"}),e.jsx("div",{className:"absolute top-[-10%] right-[-10%] w-[500px] h-[500px] bg-emerald-500/10 rounded-full blur-[100px] pointer-events-none animate-float-slow"}),e.jsx("div",{className:"absolute bottom-[-10%] left-[-10%] w-[400px] h-[400px] bg-yellow-500/10 rounded-full blur-[80px] pointer-events-none animate-float-medium"}),e.jsx("div",{className:"w-full h-full overflow-y-auto overflow-x-hidden relative z-10 custom-scrollbar",children:e.jsxs("div",{className:"w-full max-w-6xl mx-auto px-4 md:px-6 pt-24 md:pt-32 pb-32 flex flex-col items-center",children:[e.jsxs("div",{className:"text-center space-y-6 max-w-3xl mx-auto animate-fade-in-up mb-8 md:mb-12",children:[e.jsx("div",{className:"inline-flex justify-center mb-2",children:e.jsx(Oe,{className:"w-20 h-20 md:w-28 md:h-28 drop-shadow-2xl filter"})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"font-serif text-2xl md:text-3xl text-slate-400 font-medium italic",children:xa.title_small}),e.jsxs("h1",{className:"font-serif text-4xl md:text-6xl font-bold text-emerald-950 tracking-tight leading-[1.1] whitespace-pre-line",children:[xa.title_main.replace(xa.title_accent,"")," ",e.jsx("br",{}),e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-emerald-600 to-yellow-500",children:xa.title_accent})]})]}),e.jsx("p",{className:"text-slate-500 text-sm md:text-lg leading-relaxed max-w-xl mx-auto px-4 font-medium",children:xa.description})]}),e.jsx("div",{className:"w-full mb-10 animate-fade-in-up delay-100",children:m?e.jsx("div",{className:"flex justify-center p-8",children:e.jsx("span",{className:"text-emerald-600 animate-pulse font-bold",children:"Memuat Jadwal..."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:i,onScroll:h,className:"flex md:grid md:grid-cols-3 gap-4 md:gap-6 w-[calc(100%+2rem)] -mx-4 px-4 md:w-full md:mx-0 md:px-0 overflow-x-auto snap-x snap-mandatory scrollbar-hide py-12 -my-8 md:py-0 md:my-0 md:overflow-visible",children:f.map((M,w)=>{const d=M.status==="active",C=M.status==="finished";return e.jsxs("div",{className:`relative group overflow-hidden rounded-[2rem] p-6 border transition-all duration-500 flex flex-col min-w-[280px] md:min-w-0 snap-center ${d?"bg-emerald-900 text-white shadow-2xl shadow-emerald-900/40 scale-[1.02] md:scale-105 border-emerald-800 z-10 order-first md:order-none ring-4 ring-emerald-500/20":"bg-white text-slate-600 border-slate-200 hover:border-emerald-200 hover:shadow-xl"}`,children:[d&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/5 rounded-full blur-3xl -mr-20 -mt-20"}),e.jsx("div",{className:"absolute top-6 right-6",children:e.jsxs("span",{className:"relative flex h-3 w-3",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-emerald-500"})]})})]}),C&&e.jsx("div",{className:"absolute top-6 right-6 text-slate-300 bg-slate-100 rounded-full p-2",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[e.jsx("div",{className:"mb-4",children:e.jsx("span",{className:`px-3 py-1 rounded-lg text-[9px] font-black uppercase tracking-widest ${d?"bg-yellow-500 text-emerald-950":"bg-slate-100 text-slate-500"}`,children:M.label})}),e.jsx("h3",{className:`font-serif text-2xl md:text-3xl font-bold mb-4 leading-tight ${d?"text-white":"text-slate-800"}`,children:M.gel}),e.jsxs("div",{className:"space-y-2 mt-auto",children:[e.jsxs("div",{className:`p-3 rounded-xl flex justify-between items-center ${d?"bg-white/10 border border-white/10":"bg-slate-50 border border-slate-100"}`,children:[e.jsx("p",{className:`text-[9px] font-bold uppercase ${d?"text-emerald-300":"text-slate-400"}`,children:"Pendaftaran"}),e.jsx("p",{className:`text-xs font-bold ${d?"text-white":"text-slate-700"}`,children:M.daftar})]}),e.jsxs("div",{className:`p-3 rounded-xl flex justify-between items-center ${d?"bg-white/10 border border-white/10":"bg-slate-50 border border-slate-100"}`,children:[e.jsx("p",{className:`text-[9px] font-bold uppercase ${d?"text-emerald-300":"text-slate-400"}`,children:"Ujian Masuk"}),e.jsx("p",{className:`text-xs font-bold ${d?"text-white":"text-slate-700"}`,children:M.tes})]})]}),e.jsx("div",{className:`mt-5 text-center text-[10px] font-bold uppercase tracking-widest ${d?"text-emerald-300 animate-pulse":C?"text-rose-400 line-through decoration-2":"text-emerald-600"}`,children:d?"Sedang Berlangsung":C?"Telah Berakhir":"Segera Dibuka"})]})]},w)})}),e.jsx("div",{className:"flex justify-center gap-1.5 mt-4 md:hidden",children:f.map((M,w)=>e.jsx("div",{className:`h-1.5 rounded-full transition-all duration-300 ${w===g?"w-5 bg-emerald-500":"w-1.5 bg-emerald-200"}`},w))})]})}),e.jsxs("div",{className:"w-full max-w-4xl mb-8 animate-fade-in-up delay-200",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"h-px bg-slate-200 flex-1"}),e.jsx("span",{className:"text-[9px] md:text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Pusat Bantuan"}),e.jsx("div",{className:"h-px bg-slate-200 flex-1"})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-2 gap-3 md:gap-4",children:B.map((M,w)=>e.jsxs("div",{className:`bg-white rounded-2xl md:rounded-[2rem] p-3 md:p-6 border transition-all duration-300 shadow-sm hover:shadow-lg ${M.theme==="emerald"?"border-emerald-100":"border-rose-100"}`,children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-2 md:gap-4 mb-3 md:mb-6",children:[e.jsx("div",{className:`w-8 h-8 md:w-12 md:h-12 rounded-xl md:rounded-2xl flex items-center justify-center text-white shadow-md ${M.theme==="emerald"?"bg-gradient-to-br from-emerald-500 to-emerald-700":"bg-gradient-to-br from-rose-500 to-rose-700"}`,children:M.icon}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-serif font-bold text-xs md:text-lg text-slate-800",children:M.title}),e.jsx("p",{className:"hidden md:block text-xs text-slate-500",children:M.subtitle})]})]}),e.jsx("div",{className:"space-y-2 md:space-y-3",children:M.contacts.map((d,C)=>e.jsx("a",{href:`https://wa.me/${d.phone}`,target:"_blank",rel:"noreferrer",className:`flex flex-col md:flex-row md:items-center justify-between p-2 md:p-3 rounded-lg md:rounded-xl border transition-all duration-200 group/btn ${M.theme==="emerald"?"bg-emerald-50/50 border-emerald-100 hover:bg-emerald-100/50 hover:border-emerald-300":"bg-rose-50/50 border-rose-100 hover:bg-rose-100/50 hover:border-rose-300"}`,children:e.jsxs("div",{className:"flex items-center gap-2 md:gap-3",children:[e.jsx("div",{className:`p-1 md:p-1.5 rounded-full ${M.theme==="emerald"?"bg-emerald-100 text-emerald-600":"bg-rose-100 text-rose-600"}`,children:e.jsx("svg",{className:"w-3 h-3 md:w-4 md:h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[9px] md:text-[10px] font-bold text-gray-400 uppercase",children:d.label}),e.jsx("span",{className:"text-[10px] md:text-sm font-bold text-gray-700 font-mono leading-tight",children:d.display})]})]})},C))})]},w))})]}),e.jsx("div",{className:"w-full max-w-4xl pb-12 animate-fade-in-up delay-300",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("button",{onClick:r,className:"col-span-1 py-4 bg-white border-2 border-slate-100 text-slate-600 font-bold rounded-2xl hover:border-emerald-200 hover:text-emerald-700 hover:bg-emerald-50 transition-all shadow-sm flex flex-col items-center justify-center gap-2 group h-full order-1 md:order-1",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center group-hover:bg-white group-hover:text-emerald-600 transition-colors",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13M12 6.253V13m0-13c1.667 0 3 1.333 3 3v6.253"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 13c1.667 0 3-1.333 3-3V6.253"})]})}),e.jsx("span",{className:"text-xs uppercase tracking-widest",children:"Panduan"})]}),e.jsxs("button",{onClick:t,className:"col-span-1 py-4 bg-white border-2 border-slate-100 text-slate-600 font-bold rounded-2xl hover:border-blue-200 hover:text-blue-700 hover:bg-blue-50 transition-all shadow-sm flex flex-col items-center justify-center gap-2 group h-full order-2 md:order-3",children:[e.jsx("div",{className:"w-10 h-10 bg-slate-100 rounded-full flex items-center justify-center group-hover:bg-white group-hover:text-blue-600 transition-colors",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("span",{className:"text-xs uppercase tracking-widest",children:"Cek Status"})]}),e.jsxs("button",{onClick:a,className:"col-span-2 py-5 bg-gradient-to-r from-yellow-400 to-orange-500 text-white font-black text-lg rounded-2xl shadow-xl shadow-orange-500/30 hover:shadow-2xl hover:scale-[1.02] transition-all duration-300 flex flex-col items-center justify-center gap-1 group relative overflow-hidden h-full order-3 md:order-2",children:[e.jsx("div",{className:"absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-500 rounded-2xl"}),e.jsxs("div",{className:"relative z-10 flex items-center gap-2",children:[e.jsx("span",{children:"Isi Formulir"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]}),e.jsx("span",{className:"relative z-10 text-[10px] font-bold text-yellow-100 uppercase tracking-widest",children:"Daftar Sekarang"})]})]})})]})})]})},de=({id:a,label:r,options:t,value:o,onChange:c,className:k})=>{const[f,D]=s.useState(!1),[B,p]=s.useState(""),m=s.useRef(null);s.useEffect(()=>{const g=t.find(K=>K.value===o);g?p(g.label):o||p("")},[o,t]),s.useEffect(()=>{function g(K){if(m.current&&!m.current.contains(K.target)){D(!1);const h=t.find(M=>M.value===o);h?p(h.label):o||p("")}}return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[o,t]);const u=t.filter(g=>(g.label||"").toLowerCase().includes(B.toLowerCase())),i=g=>{c(g.value),p(g.label),D(!1)};return e.jsxs("div",{className:`floating-group ${k||""}`,ref:m,children:[e.jsx("input",{type:"text",id:a,className:"floating-input peer pr-12 bg-transparent",placeholder:" ",value:B,onChange:g=>{p(g.target.value),D(!0),g.target.value===""&&c("")},onFocus:()=>{D(!0),p("")},autoComplete:"off"}),e.jsx("label",{htmlFor:a,className:"floating-label",children:r}),e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-emerald-600 z-20",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 transition-transform duration-300 ${f?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M19 9l-7 7-7-7"})})}),e.jsx("div",{className:`absolute z-50 w-full bg-white rounded-2xl shadow-2xl border border-slate-100 mt-2 max-h-60 overflow-y-auto scrollbar-hide transition-all ${f?"opacity-100 visible translate-y-0":"opacity-0 invisible -translate-y-2"}`,children:u.length>0?e.jsx("ul",{className:"p-2",children:u.map(g=>e.jsx("li",{onClick:()=>i(g),className:`px-4 py-3 text-xs font-bold rounded-xl cursor-pointer mb-1 transition-colors ${o===g.value?"bg-emerald-600 text-white":"text-slate-600 hover:bg-slate-50"}`,children:g.label},g.value))}):e.jsx("div",{className:"p-6 text-center text-xs font-bold text-slate-400",children:"Tidak ditemukan"})})]})},ze=({id:a,label:r,value:t,onChange:o,className:c})=>{const[k,f]=s.useState(!1),[D,B]=s.useState(new Date),p=s.useRef(null);s.useEffect(()=>{if(t){const z=new Date(t);isNaN(z.getTime())||B(z)}},[k]),s.useEffect(()=>{function z(j){p.current&&!p.current.contains(j.target)&&f(!1)}return document.addEventListener("mousedown",z),()=>document.removeEventListener("mousedown",z)},[]);const m=(z,j)=>new Date(z,j+1,0).getDate(),u=(z,j)=>new Date(z,j,1).getDay(),i=z=>{if(!z)return"";const j=new Date(z);return isNaN(j.getTime())?"":new Intl.DateTimeFormat("id-ID",{day:"numeric",month:"long",year:"numeric"}).format(j)},g=z=>{const j=new Date(D.getFullYear(),D.getMonth(),z),N=j.getFullYear(),A=String(j.getMonth()+1).padStart(2,"0"),S=String(z).padStart(2,"0");o(`${N}-${A}-${S}`),f(!1)},K=z=>{B(new Date(D.getFullYear(),parseInt(z.target.value),1))},h=z=>{B(new Date(parseInt(z.target.value),D.getMonth(),1))},M=new Date().getFullYear(),w=Array.from({length:100},(z,j)=>M-80+j).reverse(),d=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],C=m(D.getFullYear(),D.getMonth()),L=u(D.getFullYear(),D.getMonth()),P=Array.from({length:L},(z,j)=>j),y=Array.from({length:C},(z,j)=>j+1);return e.jsxs("div",{className:`floating-group relative ${c}`,ref:p,children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",id:a,className:"floating-input peer pr-10 cursor-pointer",placeholder:" ",value:i(t),readOnly:!0,onClick:()=>f(!k)}),e.jsx("label",{htmlFor:a,className:"floating-label",children:r}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 cursor-pointer p-1 text-emerald-800",onClick:()=>f(!k),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]}),e.jsxs("div",{className:`absolute z-50 w-[300px] sm:w-[320px] bg-white rounded-xl shadow-2xl border border-emerald-100 mt-2 p-4 transition-all duration-200 origin-top-left ${k?"opacity-100 scale-100 visible":"opacity-0 scale-95 invisible"}`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 gap-2",children:[e.jsx("select",{value:D.getMonth(),onChange:K,className:"flex-1 p-2 bg-gray-50 border border-gray-200 rounded-lg text-sm font-bold text-gray-700 outline-none focus:ring-1 focus:ring-emerald-500 cursor-pointer",children:d.map((z,j)=>e.jsx("option",{value:j,children:z},j))}),e.jsx("select",{value:D.getFullYear(),onChange:h,className:"w-24 p-2 bg-gray-50 border border-gray-200 rounded-lg text-sm font-bold text-gray-700 outline-none focus:ring-1 focus:ring-emerald-500 cursor-pointer",children:w.map(z=>e.jsx("option",{value:z,children:z},z))})]}),e.jsx("div",{className:"grid grid-cols-7 text-center mb-2",children:["Min","Sen","Sel","Rab","Kam","Jum","Sab"].map(z=>e.jsx("div",{className:"text-xs font-bold text-gray-400 py-1",children:z},z))}),e.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[P.map(z=>e.jsx("div",{className:"h-9"},`blank-${z}`)),y.map(z=>{const j=t&&new Date(t).getDate()===z&&new Date(t).getMonth()===D.getMonth()&&new Date(t).getFullYear()===D.getFullYear(),N=new Date().getDate()===z&&new Date().getMonth()===D.getMonth()&&new Date().getFullYear()===D.getFullYear();return e.jsx("button",{onClick:A=>{A.preventDefault(),g(z)},className:`h-9 w-9 rounded-full flex items-center justify-center text-sm transition-all duration-200
                            ${j?"bg-emerald-600 text-white font-bold shadow-md transform scale-105":N?"bg-yellow-100 text-yellow-700 font-bold border border-yellow-300":"hover:bg-emerald-50 text-gray-700 hover:text-emerald-700"}
                        `,children:z},z)})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-100 text-center",children:e.jsx("button",{onClick:z=>{z.preventDefault(),B(new Date)},className:"text-xs font-bold text-emerald-600 hover:text-emerald-800 hover:underline",children:"Kembali ke Hari Ini"})})]})]})},$a=({id:a,label:r,value:t,onChange:o,required:c})=>{const[k,f]=s.useState(""),D=p=>{const m=p.replace(/\D/g,"");return m.length<4?m:m.length<8?`${m.slice(0,3)} - ${m.slice(3)}`:`${m.slice(0,3)} - ${m.slice(3,7)} - ${m.slice(7,12)}`};s.useEffect(()=>{f(D(t))},[t]);const B=p=>{let m=p.target.value.replace(/\D/g,"");m.startsWith("62")?m=m.substring(2):m.startsWith("0")&&(m=m.substring(1)),o(m)};return e.jsxs("div",{className:"floating-group",children:[e.jsxs("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 flex items-center gap-1.5 border-r border-slate-200 pr-3 z-10 pointer-events-none",children:[e.jsx("span",{className:"text-[10px] font-black text-slate-400",children:"ID"}),e.jsx("span",{className:"text-sm font-bold text-slate-800",children:"+62"})]}),e.jsx("input",{type:"tel",id:a,className:"floating-input peer pl-[5.2rem]",placeholder:" ",value:k,onChange:B,required:c}),e.jsx("label",{htmlFor:a,className:"floating-label !left-[4.8rem]",children:r})]})},Na="https://www.emsifa.com/api-wilayah-indonesia/api",Lt=({provinceId:a,regencyId:r,districtId:t,villageId:o,onChange:c})=>{const[k,f]=s.useState([]),[D,B]=s.useState([]),[p,m]=s.useState([]),[u,i]=s.useState([]);s.useEffect(()=>{fetch(`${Na}/provinces.json`).then(h=>h.json()).then(h=>f(h)).catch(h=>console.error("Gagal memuat provinsi",h))},[]),s.useEffect(()=>{a?isNaN(Number(a))||fetch(`${Na}/regencies/${a}.json`).then(h=>h.json()).then(h=>B(h)).catch(h=>console.error("Gagal memuat kabupaten",h)):B([])},[a]),s.useEffect(()=>{r&&!isNaN(Number(r))?fetch(`${Na}/districts/${r}.json`).then(h=>h.json()).then(h=>m(h)).catch(h=>console.error("Gagal memuat kecamatan",h)):m([])},[r]),s.useEffect(()=>{t&&!isNaN(Number(t))?fetch(`${Na}/villages/${t}.json`).then(h=>h.json()).then(h=>i(h)).catch(h=>console.error("Gagal memuat desa",h)):i([])},[t]);const g=h=>h.map(M=>({value:M.id,label:M.name})),K=(h,M)=>{var w;return((w=h.find(d=>d.id===M))==null?void 0:w.name)||""};return e.jsxs(e.Fragment,{children:[e.jsx(de,{id:"wilayah-provinsi",label:"Provinsi",value:a,onChange:h=>c("province",h,K(k,h)),options:g(k),className:"w-full !mb-0"}),e.jsx(de,{id:"wilayah-kabupaten",label:"Kota / Kabupaten",value:r,onChange:h=>c("regency",h,K(D,h)),options:g(D),className:"w-full !mb-0"}),e.jsx(de,{id:"wilayah-kecamatan",label:"Kecamatan",value:t,onChange:h=>c("district",h,K(p,h)),options:g(p),className:"w-full !mb-0"}),e.jsx(de,{id:"wilayah-desa",label:"Desa / Kelurahan",value:o,onChange:h=>c("village",h,K(u,h)),options:g(u),className:"w-full !mb-0"})]})},lt=[{id:"daftar",label:"Pendaftaran",price:2e5,category:"Administrasi"},{id:"bangunan",label:"Infaq Bangunan",price:6e5,category:"Administrasi"},{id:"syahriah",label:"Infaq Syahriah",price:1e5,category:"Administrasi"},{id:"makan",label:"Uang Makan",price:4e5,category:"Administrasi"},{id:"kts",label:"Kartu Tanda Santri",price:5e4,category:"Perlengkapan"},{id:"raport",label:"Buku Rapor",price:8e4,category:"Perlengkapan"},{id:"jas",label:"Jas Almamater",price:25e4,category:"Seragam"},{id:"seragam",label:"Baju Seragam",price:3e5,category:"Seragam"},{id:"kopontren",label:"Pendaftaran Kopontren",price:1e5,category:"Administrasi"},{id:"phbi",label:"PHBI",price:1e5,category:"Kegiatan"},{id:"lemari_2",label:"Lemari 2 Pintu",price:7e5,category:"Fasilitas Asrama"},{id:"lemari_1",label:"Lemari 1 Pintu",price:55e4,category:"Fasilitas Asrama"},{id:"kasur",label:"Kasur",price:35e4,category:"Fasilitas Asrama"},{id:"kitab",label:"Kitab Paket Awal",price:25e4,category:"Perlengkapan"},{id:"mukena",label:"Mukena Seragam (Putri)",price:2e5,category:"Seragam"}],Oa=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a).replace("Rp","Rp."),ea=({title:a,subtitle:r})=>e.jsxs("div",{className:"mb-6 border-b border-gray-100 pb-4",children:[e.jsx("h3",{className:"text-xl font-serif font-bold text-emerald-950",children:a}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:r})]}),ha=({label:a,value:r,onChange:t,placeholder:o})=>e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:a}),e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("svg",{className:"h-5 w-5 text-gray-400 group-focus-within:text-emerald-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})})}),e.jsx("input",{type:"text",className:"block w-full pl-10 pr-12 py-3 border border-gray-200 rounded-xl leading-5 bg-gray-50 placeholder-gray-400 focus:outline-none focus:bg-white focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition sm:text-sm font-medium",placeholder:o||"Tempel link Google Drive di sini...",value:r,onChange:c=>t(c.target.value)}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx("button",{type:"button",onClick:()=>window.open("https://drive.google.com","_blank"),className:"p-1 hover:bg-gray-200 rounded text-gray-400 hover:text-emerald-600 transition",title:"Buka Google Drive",children:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})})})]}),e.jsx("p",{className:"mt-1 text-[10px] text-gray-400",children:"Pastikan link dapat diakses publik (Anyone with the link)."})]}),rs=()=>e.jsxs("div",{className:"mb-8 p-4 bg-emerald-50/50 rounded-2xl border border-emerald-100 flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-10 h-10 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-emerald-900",children:"Butuh Bantuan?"}),e.jsx("p",{className:"text-[10px] text-emerald-600",children:"Hubungi admin jika mengalami kendala teknis."})]})]}),e.jsxs("a",{href:"https://wa.me/6281213951696",target:"_blank",rel:"noreferrer",className:"text-[10px] font-bold bg-white border border-emerald-200 text-emerald-700 px-4 py-2 rounded-lg hover:bg-emerald-50 transition flex items-center gap-2",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12.04 2c-5.46 0-9.91 4.45-9.91 9.91 0 1.75.46 3.45 1.32 4.95L2.05 22l5.25-1.38c1.45.79 3.08 1.21 4.74 1.21 5.46 0 9.91-4.45 9.91-9.91 0-2.65-1.03-5.14-2.9-7.01A9.816 9.816 0 0012.04 2z"})}),"Chat Admin"]})]}),ls=({onClose:a})=>e.jsxs("div",{className:"fixed inset-0 z-[99999] flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:a}),e.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-sm w-full relative z-10 text-center shadow-2xl animate-fade-in-up",children:[e.jsx("div",{className:"w-20 h-20 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"font-serif text-2xl font-bold text-gray-900 mb-2",children:"Alhamdulillah!"}),e.jsx("p",{className:"text-gray-500 text-sm mb-8 leading-relaxed",children:"Data pendaftaran Anda berhasil terkirim. Admin kami akan segera memverifikasi dan menghubungi Anda melalui WhatsApp."}),e.jsx("button",{onClick:a,className:"w-full py-3.5 bg-emerald-600 text-white rounded-xl font-bold hover:bg-emerald-700 transition shadow-lg shadow-emerald-600/20",children:"Kembali ke Beranda"})]})]}),is=({onBack:a,isSearchOpen:r=!1})=>{const[t,o]=s.useState(1),[c,k]=s.useState(!1),[f,D]=s.useState(!1),B=s.useRef(null),[p,m]=s.useState(new Set(["daftar","bangunan","syahriah","makan","kts","raport","jas","seragam","kopontren","phbi"])),[u,i]=s.useState({nama_lengkap:"",nama_panggilan:"",nik:"",tempat_lahir:"",tanggal_lahir:"",jenis_kelamin:"",asal_sekolah:"",pendidikan_terakhir:"",rencana_pendidikan:"",program_pesantren:"",provinsiId:"",alamatProvinsi:"",kabupatenId:"",alamatKabupaten:"",kecamatanId:"",alamatKecamatan:"",desaId:"",alamatDesa:"",kode_pos:"",rt:"",rw:"",detail_alamat:"",nama_ayah:"",pekerjaan_ayah:"",nama_ibu:"",pekerjaan_ibu:"",wa_ortu:"",email_ortu:"",kk:"",ktp_ortu:"",akta:"",ijazah:"",bukti_bayar:""}),g=(z,j,N)=>{i(A=>{const S={...A};return z==="province"?(S.provinsiId=j,S.alamatProvinsi=N,S.kabupatenId="",S.kecamatanId="",S.desaId="",S.alamatKabupaten="",S.alamatKecamatan="",S.alamatDesa=""):z==="regency"?(S.kabupatenId=j,S.alamatKabupaten=N,S.kecamatanId="",S.desaId="",S.alamatKecamatan="",S.alamatDesa=""):z==="district"?(S.kecamatanId=j,S.alamatKecamatan=N,S.desaId="",S.alamatDesa=""):z==="village"&&(S.desaId=j,S.alamatDesa=N),S})},K=z=>{const j=new Set(p);j.has(z)?j.delete(z):j.add(z),m(j)},h=()=>lt.reduce((z,j)=>p.has(j.id)?z+j.price:z,0),M=[{id:1,title:"Calon Santri",subtitle:"Identitas Diri"},{id:2,title:"Pendidikan",subtitle:"Program & Jenjang"},{id:3,title:"Orang Tua",subtitle:"Data Wali"},{id:4,title:"Alamat",subtitle:"Domisili"},{id:5,title:"Dokumen",subtitle:"Upload Berkas"},{id:6,title:"Pembayaran",subtitle:"Rincian & Bukti"}];s.useEffect(()=>{if(B.current&&window.innerWidth<1024){const z=B.current.children[t-1];z&&z.scrollIntoView({behavior:"smooth",block:"nearest",inline:"center"})}},[t]);const w=()=>{if(t===1&&(!u.nama_lengkap||!u.nik)){alert("Mohon lengkapi Nama Lengkap dan NIK.");return}if(t===2){if(!u.asal_sekolah||!u.pendidikan_terakhir){alert("Mohon lengkapi Asal Sekolah dan Pendidikan Terakhir.");return}if(!u.rencana_pendidikan||!u.program_pesantren){alert("Mohon pilih Jenjang Pendidikan dan Program Kepesantrenan.");return}}if(t<M.length){o(j=>j+1);const z=document.getElementById("form-scroll-container");z&&(z.scrollTop=0),window.scrollTo({top:0,behavior:"smooth"})}else L()},d=()=>{t>1?o(z=>z-1):a()},C=()=>{D(!1),window.location.hash="/"},L=async()=>{if(!u.nama_lengkap||!u.wa_ortu){alert("Mohon lengkapi Nama Lengkap dan No. WhatsApp Orang Tua.");return}k(!0);try{const z=new Date().getFullYear(),j=z+3,A={verifikasi_santri:{id_santri:`REG-${z}-${Math.floor(Math.random()*1e4)+1e3}`,status:"Menunggu",bergabung:new Date().toLocaleDateString("id-ID")},data_santri:{nik:u.nik,nama_lengkap:u.nama_lengkap,nama_panggilan:u.nama_panggilan,tempat_lahir:u.tempat_lahir,tanggal_lahir:u.tanggal_lahir,jenis_kelamin:u.jenis_kelamin,golongan_darah:"",hobi:"",anak_ke:0,foto_profil:""},data_akademik:{nisn:"",jenjang:u.rencana_pendidikan,kelas:"",jurusan:"",tahun_masuk:z.toString(),tahun_lulus:j.toString(),asal_sekolah:u.asal_sekolah,program_pesantren:u.program_pesantren},alamat_domisili:{jalan:u.detail_alamat,rt:u.rt,rw:u.rw,kode_pos:u.kode_pos,desa:u.alamatDesa,kecamatan:u.alamatKecamatan,kabupaten:u.alamatKabupaten,provinsi:u.alamatProvinsi},data_keluarga:{ayah:{nama:u.nama_ayah,nik:"",pekerjaan:u.pekerjaan_ayah,penghasilan:0,no_wa:u.wa_ortu,email:""},ibu:{nama:u.nama_ibu,nik:"",pekerjaan:u.pekerjaan_ibu,penghasilan:0,no_wa:u.wa_ortu,email:u.email_ortu},wali:{nik:"",nama:"",hubungan:"",pekerjaan:"",penghasilan:0,no_wa:"",email:""}},dokumen_arsip:{kk:u.kk,ktp_ortu:u.ktp_ortu,akta:u.akta,ijazah:u.ijazah,kartu_santri:"",pas_foto:"",bukti_bayar:u.bukti_bayar}};let S=[];try{const T=await G.getPendaftar();S=Array.isArray(T)?T:[T]}catch{console.log("No existing data found, starting fresh.")}const b=[...S,A];await G.updatePendaftarList(b),D(!0)}catch(z){console.error(z),alert("Gagal mengirim data. Silakan coba lagi. Pastikan koneksi internet stabil.")}finally{k(!1)}},P=z=>{if(z.key==="Enter"){const j=z.target;if(j.tagName==="TEXTAREA"||j.tagName==="BUTTON")return;z.preventDefault();const N=z.currentTarget,S=Array.from(N.querySelectorAll('input:not([type="hidden"]):not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled])')),b=S.indexOf(j);b>-1&&b<S.length-1&&S[b+1].focus()}},y=()=>{switch(t){case 1:return e.jsxs("div",{className:"animate-fade-in",children:[e.jsx(ea,{title:"Informasi Calon Santri",subtitle:"Isi data diri calon santri dengan benar sesuai akta kelahiran."}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer focus:bg-white",placeholder:" ",value:u.nama_lengkap,onChange:j=>i({...u,nama_lengkap:j.target.value})}),e.jsx("label",{className:"floating-label",children:"Nama Lengkap (Sesuai Akta)"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer focus:bg-white",placeholder:" ",value:u.nama_panggilan,onChange:j=>i({...u,nama_panggilan:j.target.value})}),e.jsx("label",{className:"floating-label",children:"Nama Panggilan"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"tel",className:"floating-input peer focus:bg-white",placeholder:" ",value:u.nik,onChange:j=>i({...u,nik:j.target.value})}),e.jsx("label",{className:"floating-label",children:"NIK"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer focus:bg-white",placeholder:" ",value:u.tempat_lahir,onChange:j=>i({...u,tempat_lahir:j.target.value})}),e.jsx("label",{className:"floating-label",children:"Tempat Lahir"})]}),e.jsx(ze,{id:"tgl-lahir",label:"Tanggal Lahir",value:u.tanggal_lahir,onChange:j=>i({...u,tanggal_lahir:j}),className:"!mb-0"}),e.jsx(de,{id:"jenis-kelamin",label:"Jenis Kelamin",value:u.jenis_kelamin,onChange:j=>i({...u,jenis_kelamin:j}),options:[{value:"L",label:"Laki-laki"},{value:"P",label:"Perempuan"}],className:"!mb-0"})]})]});case 2:return e.jsxs("div",{className:"animate-fade-in space-y-8",children:[e.jsx(ea,{title:"Pesantren & Pendidikan",subtitle:"Pilih rencana jenjang pendidikan dan program kepesantrenan."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer focus:bg-white",placeholder:" ",value:u.asal_sekolah,onChange:j=>i({...u,asal_sekolah:j.target.value})}),e.jsx("label",{className:"floating-label",children:"Asal Sekolah"})]}),e.jsx(de,{id:"pendidikan_terakhir",label:"Pendidikan Terakhir",value:u.pendidikan_terakhir,onChange:j=>i({...u,pendidikan_terakhir:j}),options:[{value:"TK/RA",label:"TK / RA / PAUD"},{value:"SD/MI",label:"SD / MI / Sederajat"},{value:"SMP/MTs",label:"SMP / MTs / Sederajat"}],className:"!mb-0"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-3",children:"Rencana Pendidikan Formal"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[{id:"SMP",label:"SMP IT Darussalam",desc:"Menengah Pertama"},{id:"MA",label:"MA Darussalam",desc:"Menengah Atas"},{id:"Pesantren",label:"Pesantren",desc:"Fokus Diniyah"}].map(j=>e.jsxs("div",{onClick:()=>i({...u,rencana_pendidikan:j.id}),className:`cursor-pointer p-4 rounded-xl border-2 transition-all duration-300 flex flex-col items-center text-center ${u.rencana_pendidikan===j.id?"border-emerald-500 bg-emerald-50 shadow-md transform scale-[1.02]":"border-gray-100 bg-white hover:border-emerald-200 hover:shadow-sm"}`,children:[e.jsx("span",{className:`font-bold text-sm mb-1 ${u.rencana_pendidikan===j.id?"text-emerald-800":"text-gray-700"}`,children:j.label}),e.jsx("span",{className:"text-[10px] text-gray-500",children:j.desc})]},j.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-3",children:"Pilihan Program Kepesantrenan"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{id:"Tahfidz",label:"Tahfidz Al-Qur'an",desc:"Fokus pada hafalan 30 Juz mutqin bersanad.",icon:e.jsx("svg",{className:"w-8 h-8 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13M12 6.253V13m0-13c1.667 0 3 1.333 3 3v6.253"})})},{id:"Kitab",label:"Kitab Kuning (Turats)",desc:"Pendalaman Fiqh, Ushul, Nahwu, dan Sharaf.",icon:e.jsx("svg",{className:"w-8 h-8 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}].map(j=>e.jsxs("div",{onClick:()=>i({...u,program_pesantren:j.id}),className:`relative overflow-hidden cursor-pointer p-5 rounded-2xl border-2 transition-all duration-300 flex items-start gap-4 ${u.program_pesantren===j.id?"border-yellow-400 bg-yellow-50 shadow-md":"border-gray-100 bg-white hover:border-yellow-200 hover:shadow-sm"}`,children:[e.jsx("div",{className:"shrink-0",children:j.icon}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-bold text-base ${u.program_pesantren===j.id?"text-yellow-800":"text-gray-800"}`,children:j.label}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 leading-relaxed",children:j.desc})]}),u.program_pesantren===j.id&&e.jsx("div",{className:"absolute top-2 right-2 text-yellow-500",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]},j.id))}),u.program_pesantren&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-100 rounded-xl flex gap-3 animate-fade-in",children:[e.jsx("div",{className:"shrink-0 text-blue-500",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsxs("h5",{className:"font-bold text-xs text-blue-800 mb-1",children:["Informasi Program ",u.program_pesantren]}),e.jsx("p",{className:"text-[11px] text-blue-700 leading-relaxed",children:u.program_pesantren==="Tahfidz"?"Santri program Tahfidz wajib menyetorkan hafalan minimal 1 halaman per hari dan mengikuti ujian Tasmi setiap 5 Juz.":"Santri program Kitab wajib mengikuti Bahtsul Masail mingguan dan menguasai dasar Bahasa Arab (Nahwu Sharaf) dalam 6 bulan pertama."})]})]})]})]});case 3:return e.jsxs("div",{className:"animate-fade-in",children:[e.jsx(ea,{title:"Informasi Orang Tua",subtitle:"Data ayah dan ibu kandung atau wali."}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer focus:bg-white",placeholder:" ",value:u.nama_ayah,onChange:j=>i({...u,nama_ayah:j.target.value})}),e.jsx("label",{className:"floating-label",children:"Nama Ayah Kandung"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer focus:bg-white",placeholder:" ",value:u.pekerjaan_ayah,onChange:j=>i({...u,pekerjaan_ayah:j.target.value})}),e.jsx("label",{className:"floating-label",children:"Pekerjaan Ayah"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer focus:bg-white",placeholder:" ",value:u.nama_ibu,onChange:j=>i({...u,nama_ibu:j.target.value})}),e.jsx("label",{className:"floating-label",children:"Nama Ibu Kandung"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer focus:bg-white",placeholder:" ",value:u.pekerjaan_ibu,onChange:j=>i({...u,pekerjaan_ibu:j.target.value})}),e.jsx("label",{className:"floating-label",children:"Pekerjaan Ibu"})]}),e.jsx($a,{id:"wa-ortu",label:"No. WhatsApp Orang Tua",value:u.wa_ortu,onChange:j=>i({...u,wa_ortu:j})}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"email",className:"floating-input peer focus:bg-white",placeholder:" ",value:u.email_ortu,onChange:j=>i({...u,email_ortu:j.target.value})}),e.jsx("label",{className:"floating-label",children:"Email Orang Tua"})]})]})]});case 4:return e.jsxs("div",{className:"animate-fade-in",children:[e.jsx(ea,{title:"Informasi Alamat",subtitle:"Alamat domisili santri saat ini."}),e.jsxs("div",{className:"space-y-5",children:[e.jsx(Lt,{provinceId:u.provinsiId||u.alamatProvinsi,regencyId:u.kabupatenId||u.alamatKabupaten,districtId:u.kecamatanId||u.alamatKecamatan,villageId:u.desaId||u.alamatDesa,onChange:(j,N,A)=>g(j,N,A)}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"tel",className:"floating-input peer focus:bg-white",placeholder:" ",value:u.kode_pos,onChange:j=>i({...u,kode_pos:j.target.value})}),e.jsx("label",{className:"floating-label",children:"Kode Pos"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"tel",className:"floating-input peer focus:bg-white",placeholder:" ",value:u.rt,onChange:j=>i({...u,rt:j.target.value})}),e.jsx("label",{className:"floating-label",children:"RT"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"tel",className:"floating-input peer focus:bg-white",placeholder:" ",value:u.rw,onChange:j=>i({...u,rw:j.target.value})}),e.jsx("label",{className:"floating-label",children:"RW"})]})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer focus:bg-white",placeholder:" ",value:u.detail_alamat,onChange:j=>i({...u,detail_alamat:j.target.value})}),e.jsx("label",{className:"floating-label",children:"Jalan / Gang / No. Rumah"})]})]})]});case 5:return e.jsxs("div",{className:"animate-fade-in",children:[e.jsx(ea,{title:"Dokumen Persyaratan",subtitle:"Lampirkan link Google Drive untuk dokumen berikut."}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ha,{label:"Link Scan Kartu Keluarga",value:u.kk,onChange:j=>i({...u,kk:j})}),e.jsx(ha,{label:"Link Scan Akta Kelahiran",value:u.akta,onChange:j=>i({...u,akta:j})}),e.jsx(ha,{label:"Link Scan KTP Orang Tua",value:u.ktp_ortu,onChange:j=>i({...u,ktp_ortu:j})}),e.jsx(ha,{label:"Link Scan Ijazah/SKL (Jika ada)",value:u.ijazah,onChange:j=>i({...u,ijazah:j})})]})]});case 6:const z=h();return e.jsxs("div",{className:"animate-fade-in space-y-8",children:[e.jsx(ea,{title:"Rincian Pembayaran",subtitle:"Pilih item pembayaran untuk melihat total tagihan."}),e.jsxs("div",{className:"bg-white border border-gray-100 rounded-2xl shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-5 py-3 border-b border-gray-100 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest",children:"Item Pembayaran"}),e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest",children:"Nominal"})]}),e.jsx("div",{className:"divide-y divide-gray-50",children:lt.map(j=>{const N=p.has(j.id);return e.jsxs("div",{className:`flex items-center justify-between px-5 py-4 cursor-pointer transition-colors hover:bg-slate-50 ${N?"bg-emerald-50/30":""}`,onClick:()=>K(j.id),children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center transition-colors ${N?"bg-emerald-600 border-emerald-600":"bg-white border-gray-300"}`,children:N&&e.jsx("svg",{className:"w-3.5 h-3.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsx("span",{className:`text-sm font-medium ${N?"text-emerald-900 font-bold":"text-gray-600"}`,children:j.label})]}),e.jsx("span",{className:"text-[10px] text-gray-400 pl-8",children:j.category})]}),e.jsx("span",{className:`text-sm font-mono transition-opacity duration-300 ${N?"opacity-100 text-emerald-700 font-bold":"opacity-60 text-gray-400"}`,children:Oa(j.price)})]},j.id)})}),e.jsxs("div",{className:"bg-emerald-900 px-6 py-5 flex justify-between items-center text-white",children:[e.jsx("span",{className:"text-sm font-bold uppercase tracking-widest text-emerald-200",children:"Total Yang Harus Dibayar"}),e.jsx("span",{className:"text-2xl font-bold font-mono tracking-tight",children:Oa(z)})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 p-6 rounded-2xl text-white shadow-xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full blur-2xl -mr-10 -mt-10"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("img",{src:"https://placehold.co/40x15/ffffff/064e3b?text=BSI",alt:"BSI",className:"h-5 rounded opacity-90"}),e.jsx("span",{className:"text-xs text-gray-300 font-medium",children:"Bank Syariah Indonesia"})]}),e.jsx("button",{className:"text-[10px] bg-white/10 hover:bg-white/20 text-white px-3 py-1 rounded-lg font-bold transition",onClick:()=>navigator.clipboard.writeText("7193493728"),children:"Salin Nomor"})]}),e.jsx("div",{className:"text-center mb-2",children:e.jsx("span",{className:"font-mono text-3xl font-bold tracking-widest text-white drop-shadow-md",children:"7193 4937 28"})}),e.jsxs("div",{className:"text-center border-t border-white/10 pt-3 mt-3",children:[e.jsx("p",{className:"text-[10px] text-gray-400 uppercase tracking-wider",children:"Atas Nama"}),e.jsx("p",{className:"text-sm font-bold text-emerald-100 mt-0.5",children:"Kopontren Miftahul Huda"})]})]})]}),e.jsxs("div",{children:[e.jsx(ea,{title:"Bukti Transfer",subtitle:"Upload bukti transfer sesuai nominal total di atas."}),e.jsx(ha,{label:"Link Bukti Transfer",value:u.bukti_bayar,onChange:j=>i({...u,bukti_bayar:j})})]}),e.jsx("div",{className:"mt-8 pt-6 border-t border-gray-100",children:e.jsxs("a",{href:`https://wa.me/6281213951696?text=Assalamu'alaikum,%20saya%20sudah%20melakukan%20pembayaran%20pendaftaran%20sebesar%20${Oa(z)}.%20Mohon%20dicek.`,target:"_blank",rel:"noreferrer",className:"w-full flex items-center justify-center gap-3 p-4 bg-green-50 border border-green-200 rounded-2xl text-green-700 hover:bg-green-100 hover:border-green-300 transition-all group",children:[e.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-full flex items-center justify-center text-white shadow-md group-hover:scale-110 transition-transform",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-sm",children:"Konfirmasi Pembayaran"}),e.jsx("p",{className:"text-xs text-green-600/80",children:"Kirim bukti via WhatsApp Admin"})]})]})})]})}};return e.jsxs(e.Fragment,{children:[f&&e.jsx(ls,{onClose:C}),e.jsx("div",{className:`min-h-screen flex flex-col justify-center items-center transition-all duration-700 bg-emerald-950 lg:bg-gray-50 lg:p-8 ${r?"pt-48":"pt-0 lg:pt-36"}`,children:e.jsxs("div",{className:"bg-transparent lg:bg-white w-full max-w-6xl lg:rounded-[2.5rem] lg:shadow-2xl lg:overflow-hidden flex flex-col lg:flex-row h-auto min-h-screen lg:min-h-0 lg:h-[650px] lg:border lg:border-gray-100 animate-fade-in-up",children:[e.jsxs("div",{className:"w-full lg:w-[35%] bg-gradient-to-br from-emerald-900 to-emerald-950 p-6 pt-28 pb-10 lg:pb-32 lg:p-12 flex flex-col justify-between relative overflow-hidden text-white shrink-0 rounded-b-[3rem] lg:rounded-none z-10 relative lg:static shadow-xl lg:shadow-none",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/5 rounded-full blur-[80px] -mr-20 -mt-20"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-[50%] lg:h-full bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')] opacity-5"}),e.jsxs("div",{className:"relative z-10 flex flex-col h-full",children:[e.jsxs("div",{className:"mb-8 lg:mb-12",children:[e.jsx("h2",{className:"text-3xl font-serif font-bold mb-2",children:"Formulir PSB"}),e.jsx("p",{className:"text-sm text-emerald-100/70 leading-relaxed",children:"Lengkapi data diri calon santri untuk memulai perjalanan pendidikan terbaik."})]}),e.jsx("div",{ref:B,className:"flex flex-row lg:flex-col gap-4 lg:gap-0 overflow-x-auto lg:overflow-visible pb-4 lg:pb-0 scrollbar-hide snap-x snap-mandatory lg:space-y-0 flex-1 lg:flex-initial items-start px-4 lg:px-0 py-4 lg:py-0",children:M.map((z,j)=>{const N=z.id===t,A=z.id<t,S=j===M.length-1;return e.jsxs("div",{className:"relative flex lg:gap-5 group min-w-[140px] lg:min-w-0 snap-center items-center lg:items-start flex-col lg:flex-row text-center lg:text-left",children:[!S&&e.jsx("div",{className:`hidden lg:block absolute left-[15px] top-8 bottom-0 w-[1px] h-[calc(100%-10px)] ${A?"bg-emerald-400":"bg-white/10"}`}),!S&&e.jsx("div",{className:`block lg:hidden absolute top-4 left-[50%] w-full h-[2px] -z-10 ${A?"bg-emerald-400":"bg-white/10"}`}),e.jsx("div",{className:`relative z-10 w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold border-2 transition-all duration-500 shrink-0 mx-auto lg:mx-0 ${N?"bg-white border-white text-emerald-900 scale-110 shadow-lg":A?"bg-emerald-600 border-emerald-600 text-white":"bg-emerald-900 border-white/30 text-white/50"}`,children:A?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):z.id}),e.jsxs("div",{className:`mt-2 lg:mt-0 lg:pb-8 transition-all duration-300 ${N?"opacity-100 lg:translate-x-1":"opacity-60"}`,children:[e.jsx("h4",{className:`font-bold text-xs lg:text-sm whitespace-nowrap ${N?"text-white":"text-emerald-100"}`,children:z.title}),e.jsx("p",{className:"hidden lg:block text-[10px] text-emerald-200/60 mt-0.5 uppercase tracking-wider font-bold",children:z.subtitle})]})]},z.id)})})]})]}),e.jsxs("div",{className:"flex-1 bg-white flex flex-col relative lg:h-full rounded-b-none rounded-t-[2.5rem] lg:rounded-none -mt-10 lg:mt-0 z-20 shadow-[0_-10px_40px_rgba(0,0,0,0.1)] min-h-screen lg:min-h-0",children:[e.jsxs("div",{id:"form-scroll-container",className:"w-full px-6 pt-6 md:p-14 lg:overflow-y-auto lg:custom-scrollbar lg:flex-1 pb-48 lg:pb-32",onKeyDown:P,children:[e.jsx(rs,{}),y()]}),e.jsxs("div",{className:"sticky bottom-0 lg:absolute lg:bottom-0 lg:left-0 lg:right-0 p-6 px-8 md:px-14 lg:py-8 bg-white/95 backdrop-blur-sm flex justify-between items-center z-20 border-t border-gray-100 lg:shadow-none shadow-[0_-10px_30px_rgba(0,0,0,0.05)]",children:[e.jsxs("button",{onClick:d,className:"px-6 py-3 rounded-xl text-sm font-bold text-gray-500 hover:bg-gray-50 hover:text-gray-900 transition-colors flex items-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Kembali"]}),e.jsx("button",{onClick:w,disabled:c,className:"px-8 py-3 bg-emerald-900 text-white rounded-xl font-bold text-sm shadow-lg shadow-emerald-900/20 hover:bg-emerald-800 hover:shadow-xl hover:-translate-y-0.5 transition-all flex items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed",children:c?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Memproses..."]}):t===M.length?e.jsxs(e.Fragment,{children:["Kirim Pendaftaran ",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]}):e.jsxs(e.Fragment,{children:["Lanjut ",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]})]})]})})]})},os=({onBack:a})=>{const r=[{id:1,title:"Persiapan Berkas Fisik",subtitle:"Tahap Awal",icon:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),color:"bg-slate-700",content:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed",children:["Sebelum memulai, kumpulkan dokumen fisik berikut ke dalam ",e.jsx("strong",{children:"Map Plastik"})," (Merah: Putra, Kuning: Putri). Dokumen ini akan diverifikasi saat tes offline."]}),e.jsxs("div",{className:"relative mt-4 pl-4",children:[e.jsx("div",{className:"absolute top-0 left-0 bottom-0 w-1 bg-gray-200 rounded-full"}),e.jsx("div",{className:"space-y-3",children:[{label:"Kartu Keluarga (KK)",sub:"Pastikan NIK & Nama sesuai Akta (2 Rangkap)",req:"Wajib"},{label:"Akte Kelahiran",sub:"Fotocopy jelas (2 Rangkap)",req:"Wajib"},{label:"KTP Kedua Orang Tua",sub:"Fotocopy diperbesar 150% (2 Rangkap)",req:"Wajib"},{label:"Ijazah / SKL",sub:"Legalisir sekolah asal (2 Rangkap)",req:"Wajib"},{label:"Pas Foto 3x4",sub:"Latar Merah (2 Lembar)",req:"Wajib"},{label:"Kartu KIP / PKH / KKS",sub:"Bagi yang memiliki bantuan pemerintah",req:"Opsional"}].map((t,o)=>e.jsxs("div",{className:"bg-white border border-gray-100 p-3 rounded-xl shadow-sm flex justify-between items-center group hover:border-slate-300 transition-all",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-bold text-gray-800",children:t.label}),e.jsx("p",{className:"text-[10px] text-gray-500",children:t.sub})]}),e.jsx("span",{className:`text-[9px] font-bold px-2 py-1 rounded ${t.req==="Wajib"?"bg-red-50 text-red-600":"bg-blue-50 text-blue-600"}`,children:t.req})]},o))})]})]})},{id:2,title:"Digitalisasi Dokumen",subtitle:"Upload Cloud",icon:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12"})}),color:"bg-blue-600",content:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed",children:["Scan berkas fisik di atas menjadi format ",e.jsx("strong",{children:"PDF atau JPG"}),". Upload ke Google Drive pribadi Anda untuk mendapatkan link."]}),e.jsxs("div",{className:"bg-blue-50/50 rounded-2xl border border-blue-100 p-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-2 right-2 text-blue-200",children:e.jsx("svg",{className:"w-16 h-16 opacity-20",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})})}),e.jsx("h4",{className:"font-bold text-blue-800 text-sm mb-3",children:"Cara Mengatur Akses Link (Penting!)"}),e.jsxs("div",{className:"space-y-3 text-xs text-blue-900",children:[e.jsxs("div",{className:"flex gap-3 items-center bg-white p-2 rounded-lg shadow-sm",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center font-bold text-blue-600",children:"1"}),e.jsxs("p",{children:["Klik kanan file di Google Drive → ",e.jsx("strong",{children:"Share"})]})]}),e.jsxs("div",{className:"flex gap-3 items-center bg-white p-2 rounded-lg shadow-sm",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center font-bold text-blue-600",children:"2"}),e.jsxs("p",{children:['Ubah "Restricted" menjadi ',e.jsx("strong",{className:"text-green-600",children:"Anyone with the link"})]})]}),e.jsxs("div",{className:"flex gap-3 items-center bg-white p-2 rounded-lg shadow-sm border border-green-200",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-green-100 flex items-center justify-center font-bold text-green-600",children:"3"}),e.jsx("p",{children:"Salin Link (Copy Link) & tempel di formulir."})]})]})]})]})},{id:3,title:"Pengisian Formulir Online",subtitle:"Input Data Utama",icon:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),color:"bg-emerald-600",content:e.jsxs("div",{className:"space-y-6",children:[e.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:"Isi data calon santri dengan teliti. Kesalahan data (seperti NIK atau Nama) akan menghambat proses penerbitan ijazah kelak."}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-2xl p-5 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 bg-emerald-100 text-emerald-800 text-[9px] font-bold px-3 py-1 rounded-bl-xl uppercase tracking-widest",children:"Contoh Pengisian"}),e.jsxs("div",{className:"space-y-4 mt-2",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase mb-1 block",children:"Nama Lengkap"}),e.jsxs("div",{className:"border border-gray-300 bg-white p-2 rounded-lg text-sm font-bold text-gray-800 flex items-center justify-between",children:[e.jsx("span",{children:"MUHAMMAD FATIH AL KAHFI"}),e.jsx("svg",{className:"w-4 h-4 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})]}),e.jsxs("div",{className:"hidden group-hover:block absolute z-10 bottom-full left-0 mb-2 w-48 bg-gray-800 text-white text-[10px] p-2 rounded-lg shadow-lg",children:["Sesuai Akta Kelahiran, Jangan disingkat (Mhd. → Muhammad).",e.jsx("div",{className:"absolute top-full left-4 -mt-1 border-4 border-transparent border-t-gray-800"})]})]}),e.jsxs("div",{className:"relative group",children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase mb-1 block",children:"NIK (Nomor Induk Kependudukan)"}),e.jsxs("div",{className:"border border-emerald-500 bg-emerald-50/30 p-2 rounded-lg text-sm font-bold text-emerald-800 font-mono tracking-wider flex items-center justify-between",children:[e.jsx("span",{children:"3273012005100001"}),e.jsx("span",{className:"text-[9px] bg-emerald-200 text-emerald-800 px-1.5 rounded",children:"16 Digit"})]}),e.jsx("p",{className:"text-[9px] text-emerald-600 mt-1",children:"*Cek bagian atas Kartu Keluarga"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase mb-1 block",children:"Jenjang"}),e.jsx("div",{className:"border border-gray-300 bg-white p-2 rounded-lg text-sm text-gray-800",children:"MTs (SMP)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[10px] font-bold text-gray-400 uppercase mb-1 block",children:"Program"}),e.jsx("div",{className:"border border-gray-300 bg-white p-2 rounded-lg text-sm text-gray-800",children:"Tahfidz"})]})]})]})]})]})},{id:4,title:"Pembayaran & Konfirmasi",subtitle:"Biaya Pendaftaran",icon:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),color:"bg-yellow-500",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:"Lakukan transfer biaya pendaftaran sesuai total yang tertera di formulir akhir."}),e.jsxs("div",{className:"bg-white p-0 rounded-xl shadow-lg border border-gray-100 overflow-hidden max-w-sm mx-auto transform rotate-1 hover:rotate-0 transition-transform duration-300",children:[e.jsxs("div",{className:"bg-emerald-900 p-3 text-center",children:[e.jsx("p",{className:"text-emerald-100 text-[10px] uppercase tracking-widest font-bold",children:"Total Tagihan (Estimasi)"}),e.jsx("p",{className:"text-white text-2xl font-mono font-bold",children:"Rp 2.180.000"}),e.jsx("p",{className:"text-white/50 text-[10px] italic",children:"*Belum termasuk fasilitas asrama"})]}),e.jsxs("div",{className:"p-4 space-y-2 bg-yellow-50",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 border-b border-gray-200 pb-1",children:[e.jsx("span",{children:"Pendaftaran"}),e.jsx("span",{children:"Rp 200.000"})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 border-b border-gray-200 pb-1",children:[e.jsx("span",{children:"Infaq Bangunan"}),e.jsx("span",{children:"Rp 600.000"})]}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-600 border-b border-gray-200 pb-1",children:[e.jsx("span",{children:"Seragam, Rapor, dll"}),e.jsx("span",{children:"Rp 1.380.000"})]}),e.jsxs("div",{className:"pt-2 text-center",children:[e.jsx("p",{className:"text-[10px] text-gray-400 uppercase font-bold",children:"Transfer Ke:"}),e.jsx("p",{className:"text-sm font-bold text-gray-800",children:"BSI 7193-4937-28"}),e.jsx("p",{className:"text-[10px] text-gray-500",children:"a.n Kopontren Miftahul Huda"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-yellow-50 p-3 rounded-lg border border-yellow-100 text-xs text-yellow-800",children:[e.jsx("svg",{className:"w-5 h-5 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("p",{children:"Jangan lupa screenshot bukti transfer untuk diupload di formulir."})]})]})},{id:5,title:"Cetak Kartu Ujian",subtitle:"Bukti Peserta",icon:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"})}),color:"bg-indigo-500",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Setelah formulir diverifikasi admin (1x24 Jam), Anda akan mendapatkan pesan WhatsApp berisi link untuk mencetak Kartu Ujian."}),e.jsxs("div",{className:"relative w-full max-w-[280px] mx-auto bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"h-2 bg-emerald-600"}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold text-xs text-gray-800 uppercase",children:"Kartu Peserta"}),e.jsx("p",{className:"text-[10px] text-gray-500",children:"PSB 2026"})]})]}),e.jsxs("div",{className:"space-y-2 text-xs",children:[e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-1",children:[e.jsx("span",{className:"text-gray-400",children:"No. Peserta"}),e.jsx("span",{className:"font-mono font-bold text-gray-800",children:"2026-001"})]}),e.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-1",children:[e.jsx("span",{className:"text-gray-400",children:"Nama"}),e.jsx("span",{className:"font-bold text-gray-800",children:"Fulan bin Fulan"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-400",children:"Ruang"}),e.jsx("span",{className:"font-bold text-gray-800",children:"R. 02 (Lt. 2)"})]})]}),e.jsx("div",{className:"mt-4 flex justify-center",children:e.jsx("div",{className:"h-6 w-32 bg-gray-800 mask-image: repeating-linear-gradient(90deg, black, black 1px, transparent 1px, transparent 3px)"})})]})]}),e.jsx("p",{className:"text-[10px] text-center text-gray-400 italic",children:"Kartu wajib dibawa saat tes seleksi."})]})},{id:6,title:"Pelaksanaan Tes Seleksi",subtitle:"Ujian Masuk",icon:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13M12 6.253V13m0-13c1.667 0 3 1.333 3 3v6.253"})}),color:"bg-rose-500",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Calon santri wajib mengikuti tes seleksi secara offline di Pesantren sesuai jadwal yang tertera di Kartu Ujian."}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-3 bg-slate-50 border border-slate-100 rounded-xl text-center",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Materi 1"}),e.jsx("p",{className:"font-bold text-slate-800 text-sm",children:"Baca Tulis Al-Qur'an"})]}),e.jsxs("div",{className:"p-3 bg-slate-50 border border-slate-100 rounded-xl text-center",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Materi 2"}),e.jsx("p",{className:"font-bold text-slate-800 text-sm",children:"Pengetahuan Agama"})]}),e.jsxs("div",{className:"p-3 bg-slate-50 border border-slate-100 rounded-xl text-center col-span-2",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase",children:"Materi 3"}),e.jsx("p",{className:"font-bold text-slate-800 text-sm",children:"Wawancara Santri & Wali"})]})]})]})},{id:7,title:"Pengumuman Kelulusan",subtitle:"Cek Status",icon:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"bg-teal-500",content:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Hasil seleksi dapat dicek melalui menu ",e.jsx("strong",{children:'"Cek Status"'})," di halaman depan pendaftaran atau melalui WhatsApp."]}),e.jsxs("div",{className:"bg-white border border-green-200 rounded-xl p-4 shadow-sm relative overflow-hidden",children:[e.jsx("div",{className:"absolute -right-4 -top-4 w-16 h-16 bg-green-500 rounded-full blur-xl opacity-20"}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center text-green-600",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsx("span",{className:"font-bold text-green-700 text-sm uppercase tracking-widest",children:"DITERIMA / LULUS"})]}),e.jsxs("p",{className:"text-xs text-gray-600 leading-relaxed",children:["Selamat! Ananda ",e.jsx("strong",{children:"Fulan bin Fulan"})," dinyatakan lulus seleksi masuk MTs Miftahul Huda."]})]})]})},{id:8,title:"Daftar Ulang & Masuk Asrama",subtitle:"Tahap Akhir",icon:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h-5 10v-5a1 1 0 011-1h2a1 1 0 01 1v5m-4 0h4"})}),color:"bg-slate-800",content:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Lakukan pembayaran Daftar Ulang sesuai ketentuan dan siapkan perlengkapan santri untuk masuk asrama."}),e.jsxs("ul",{className:"text-xs text-gray-600 space-y-2 list-disc pl-4",children:[e.jsx("li",{children:"Pelunasan Uang Pangkal (Infaq Bangunan, Seragam, dll)."}),e.jsx("li",{children:"Pengukuran Seragam Santri."}),e.jsx("li",{children:"Penyerahan Berkas Fisik (Map Merah/Kuning)."}),e.jsx("li",{children:"Sowan ke Pimpinan Pondok (Masuk Asrama)."})]})]})}];return e.jsx("div",{className:"min-h-screen bg-slate-50 font-sans pt-24 pb-20 animate-fade-in",children:e.jsxs("div",{className:"max-w-3xl mx-auto px-6",children:[e.jsxs("div",{className:"text-center mb-16",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-white px-4 py-2 rounded-full shadow-sm border border-emerald-100 mb-4",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),e.jsx("span",{className:"text-[10px] font-bold text-emerald-800 uppercase tracking-widest",children:"Panduan Resmi PPDB 2026"})]}),e.jsx("h1",{className:"font-serif text-3xl md:text-5xl font-bold text-emerald-950 mb-4 leading-tight",children:"Alur Pendaftaran"}),e.jsx("p",{className:"text-gray-500 text-sm md:text-base max-w-lg mx-auto leading-relaxed",children:"Ikuti 8 langkah mudah berikut untuk menjadi bagian dari keluarga besar Pesantren Miftahul Huda Al-Burhani."})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-8 top-8 bottom-0 w-0.5 bg-gray-200"}),e.jsx("div",{className:"space-y-16",children:r.map((t,o)=>e.jsxs("div",{className:"relative pl-24 md:pl-32 group",children:[e.jsx("div",{className:`absolute left-0 w-16 h-16 rounded-2xl ${t.color} flex items-center justify-center shadow-lg border-4 border-white z-10 transition-transform group-hover:scale-110 duration-300 ring-1 ring-gray-100`,children:t.icon}),o!==r.length-1&&e.jsx("div",{className:"absolute left-8 top-16 bottom-[-64px] w-0.5 bg-emerald-500 origin-top transform scale-y-0 group-hover:scale-y-100 transition-transform duration-700"}),e.jsxs("div",{className:"bg-white rounded-3xl p-6 md:p-8 shadow-xl shadow-gray-200/50 border border-gray-100 relative transition-all duration-300 hover:border-emerald-200 hover:-translate-y-1",children:[e.jsx("div",{className:"absolute -top-4 -right-4 w-10 h-10 bg-slate-800 text-white rounded-xl flex items-center justify-center font-serif font-bold text-lg shadow-lg transform rotate-3 group-hover:rotate-12 transition-transform border-2 border-white",children:t.id}),e.jsxs("div",{className:"mb-6 pb-4 border-b border-gray-50",children:[e.jsx("h4",{className:"text-[10px] font-black text-gray-400 uppercase tracking-[0.2em] mb-1",children:t.subtitle}),e.jsx("h3",{className:"text-xl md:text-2xl font-bold text-emerald-950",children:t.title})]}),e.jsx("div",{className:"animate-fade-in",children:t.content})]})]},t.id))}),e.jsxs("div",{className:"relative pl-24 md:pl-32 mt-16 opacity-50 pb-12",children:[e.jsx("div",{className:"absolute left-3 w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center border-4 border-white z-10",children:e.jsx("svg",{className:"w-5 h-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("p",{className:"text-sm font-bold text-gray-400 pt-2",children:"Resmi Menjadi Santri"})]})]}),e.jsx("div",{className:"mt-8 text-center sticky bottom-8 z-30",children:e.jsxs("button",{onClick:a,className:"inline-flex items-center gap-3 px-8 py-4 bg-emerald-900 border border-emerald-800 rounded-full shadow-2xl text-white font-bold text-sm hover:bg-emerald-800 transition-all transform hover:-translate-y-1 hover:scale-105",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Kembali ke Menu Utama"]})})]})})},ds=({onBack:a})=>{var u,i,g,K,h,M,w,d,C,L;const[r,t]=s.useState(""),[o,c]=s.useState(!1),[k,f]=s.useState(null),[D,B]=s.useState(!1),p=async P=>{if(P.preventDefault(),!!r.trim()){c(!0),B(!0),f(null);try{const y=await G.getPendaftar(),j=(Array.isArray(y)?y:[y]).find(N=>{var A,S,b,T;return((S=(A=N.verifikasi_santri)==null?void 0:A.id_santri)==null?void 0:S.toLowerCase())===r.toLowerCase()||((T=(b=N.data_santri)==null?void 0:b.nama_lengkap)==null?void 0:T.toLowerCase().includes(r.toLowerCase()))});j&&f(j)}catch(y){console.error("Error checking status:",y)}finally{c(!1)}}},m=P=>{const y=(P||"").toLowerCase();return y.includes("aktif")||y.includes("diterima")||y.includes("lulus")||y.includes("terverifikasi")?e.jsxs("div",{className:"flex flex-col items-center gap-2 text-emerald-600",children:[e.jsx("div",{className:"w-16 h-16 bg-emerald-100 rounded-full flex items-center justify-center animate-bounce",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-xl font-bold uppercase tracking-widest",children:P||"DITERIMA"}),e.jsx("p",{className:"text-sm text-center text-gray-500 max-w-xs",children:"Selamat! Data Anda telah valid atau Anda dinyatakan lulus seleksi."})]}):y.includes("tolak")||y.includes("gagal")||y.includes("tidak lulus")?e.jsxs("div",{className:"flex flex-col items-center gap-2 text-rose-600",children:[e.jsx("div",{className:"w-16 h-16 bg-rose-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h3",{className:"text-xl font-bold uppercase tracking-widest",children:P}),e.jsx("p",{className:"text-sm text-center text-gray-500 max-w-xs",children:"Mohon maaf, Anda belum memenuhi kriteria atau berkas tidak valid."})]}):e.jsxs("div",{className:"flex flex-col items-center gap-2 text-amber-600",children:[e.jsx("div",{className:"w-16 h-16 bg-amber-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"text-xl font-bold uppercase tracking-widest",children:P||"MENUNGGU"}),e.jsx("p",{className:"text-sm text-center text-gray-500 max-w-xs",children:"Data Anda sedang dalam proses verifikasi oleh panitia."})]})};return e.jsx("div",{className:"min-h-screen bg-slate-50 font-sans flex flex-col items-center justify-center p-6 pt-24 animate-fade-in",children:e.jsxs("div",{className:"w-full max-w-lg",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"font-serif text-3xl font-bold text-emerald-950 mb-2",children:"Cek Status Penerimaan"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Masukkan Nama Lengkap atau ID Pendaftaran (REG-xxxx) Anda."})]}),e.jsxs("form",{onSubmit:p,className:"bg-white p-2 rounded-2xl shadow-xl shadow-emerald-900/5 border border-emerald-100 flex gap-2 mb-8",children:[e.jsx("input",{type:"text",value:r,onChange:P=>t(P.target.value),placeholder:"Contoh: Muhammad Fatih atau REG-2026-101",className:"flex-1 px-4 py-3 bg-transparent outline-none text-gray-700 font-medium placeholder-gray-300"}),e.jsx("button",{type:"submit",disabled:o||!r,className:"bg-emerald-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-emerald-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:o?"...":"Cek"})]}),o&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block w-8 h-8 border-4 border-emerald-200 border-t-emerald-600 rounded-full animate-spin"}),e.jsx("p",{className:"text-gray-400 text-xs mt-2 font-bold uppercase tracking-widest",children:"Mencari Data..."})]}),!o&&D&&!k&&e.jsxs("div",{className:"bg-white p-8 rounded-3xl border border-gray-200 text-center animate-fade-in-up",children:[e.jsx("div",{className:"inline-flex p-3 bg-gray-100 rounded-full text-gray-400 mb-4",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx("h3",{className:"font-bold text-gray-900",children:"Data Tidak Ditemukan"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Mohon periksa kembali ejaan nama atau ID pendaftaran Anda."})]}),!o&&k&&e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-2xl border border-emerald-100 overflow-hidden animate-fade-in-up",children:[e.jsxs("div",{className:"bg-emerald-950 p-6 text-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 opacity-10 bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')]"}),e.jsx("p",{className:"text-emerald-200 text-[10px] font-bold uppercase tracking-widest relative z-10 mb-1",children:"Hasil Pencarian"}),e.jsx("h2",{className:"text-2xl font-serif font-bold text-white relative z-10",children:(u=k.data_santri)==null?void 0:u.nama_lengkap}),e.jsx("span",{className:"inline-block mt-2 px-3 py-1 bg-white/10 text-white rounded-lg text-xs font-mono relative z-10 border border-white/20",children:(i=k.verifikasi_santri)==null?void 0:i.id_santri})]}),e.jsxs("div",{className:"p-8 flex flex-col items-center gap-6",children:[m((g=k.verifikasi_santri)==null?void 0:g.status),e.jsxs("div",{className:"w-full bg-gray-50 rounded-2xl p-4 border border-gray-100 text-sm space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Jenjang Tujuan"}),e.jsx("span",{className:"font-bold text-gray-800",children:(K=k.data_akademik)==null?void 0:K.jenjang})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Program"}),e.jsx("span",{className:"font-bold text-gray-800",children:(h=k.data_akademik)==null?void 0:h.program_pesantren})]}),((M=k.data_akademik)==null?void 0:M.asal_sekolah)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Asal Sekolah"}),e.jsx("span",{className:"font-bold text-gray-800",children:(w=k.data_akademik)==null?void 0:w.asal_sekolah})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Tanggal Daftar"}),e.jsx("span",{className:"font-bold text-gray-800",children:(d=k.verifikasi_santri)==null?void 0:d.bergabung})]})]}),(((C=k.verifikasi_santri)==null?void 0:C.status)==="Terverifikasi"||((L=k.verifikasi_santri)==null?void 0:L.status)==="Lulus")&&e.jsx("button",{className:"w-full py-3 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-700 transition shadow-lg shadow-emerald-600/20",children:"Cetak Kartu Ujian"})]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx("button",{onClick:a,className:"text-sm font-bold text-gray-400 hover:text-emerald-600 transition",children:"← Kembali ke Menu Utama"})})]})})},Ct=({isSearchOpen:a=!1,previewData:r})=>{const t=()=>{const p=window.location.hash.toLowerCase();return p.includes("/panduan")?"guide":p.includes("/cek")?"status":p.includes("/formulir")?"form":"welcome"},[o,c]=s.useState(t());s.useEffect(()=>{const p=()=>{const m=t();m!==o&&(c(m),window.scrollTo({top:0,behavior:"smooth"}))};return window.addEventListener("hashchange",p),p(),()=>window.removeEventListener("hashchange",p)},[o]);const k=()=>{window.location.hash="/pendaftaran/formulir"},f=()=>{window.location.hash="/pendaftaran/panduan"},D=()=>{window.location.hash="/pendaftaran/cek"},B=()=>{window.location.hash="/pendaftaran"};return e.jsxs(e.Fragment,{children:[o==="welcome"&&e.jsx(ns,{onStart:k,onOpenGuide:f,onCheckStatus:D,previewData:r}),o==="form"&&e.jsx(is,{onBack:B,isSearchOpen:a}),o==="guide"&&e.jsx(os,{onBack:B}),o==="status"&&e.jsx(ds,{onBack:B})]})},Fa=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a).replace("Rp","Rp "),it=a=>a>=1e9?(a/1e9).toFixed(1).replace(/\.0$/,"")+" M":a>=1e6?(a/1e6).toFixed(1).replace(/\.0$/,"")+" Jt":a>=1e3?(a/1e3).toFixed(1).replace(/\.0$/,"")+" rb":a.toString(),_a={hero:{label_atas:"Sedekah Jariyah",judul_awalan:"Membangun",judul_sorotan:"Peradaban Quran",deskripsi:"Setiap rupiah yang Anda titipkan adalah investasi cahaya bagi masa depan santri dan bekal abadi di akhirat kelak."}},cs=({isSearchOpen:a,campaigns:r,recentTransactions:t,globalStats:o,onSelectCampaign:c,onDonateGeneral:k})=>{const f=s.useMemo(()=>Array.from({length:15}).map((p,m)=>e.jsx("div",{className:"absolute text-emerald-400/10 pointer-events-none z-0 animate-float-slow",style:{left:`${(m*13+7)%100}%`,animationDuration:`${15+m%3*5}s`,animationDelay:`${m*-3}s`,top:"0"},children:m%5===0?e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-12 h-12",children:e.jsx("path",{d:"M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",className:"w-6 h-6",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})},`don-float-${m}`)),[]),D=r.find(p=>p.id_donasi==="umum"),B=r.filter(p=>p.id_donasi!=="umum");return e.jsxs("div",{className:"animate-fade-in font-sans bg-gray-50 min-h-screen",children:[e.jsxs("section",{className:`relative bg-gradient-to-b from-emerald-950 to-emerald-900 text-white overflow-hidden rounded-b-[3rem] md:rounded-b-[5rem] shadow-2xl transition-all duration-700 persistent-header ${a?"pt-40 lg:pt-56 pb-24 md:pb-36":"pt-32 pb-24 md:pb-36"}`,children:[e.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none opacity-20 bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')]"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-emerald-950/80 to-transparent"}),e.jsx("div",{className:"absolute top-[-50%] left-[-10%] w-[600px] h-[600px] bg-emerald-500/20 rounded-full blur-[120px] pointer-events-none"}),e.jsx("div",{className:"absolute bottom-[-20%] right-[-10%] w-[500px] h-[500px] bg-yellow-500/10 rounded-full blur-[100px] pointer-events-none"}),e.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none opacity-40",children:f}),e.jsxs("div",{className:"max-w-5xl mx-auto px-6 relative z-10 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-white/5 border border-white/10 backdrop-blur-md rounded-full mb-8 shadow-lg ring-1 ring-white/10",children:[e.jsxs("span",{className:"relative flex h-2.5 w-2.5",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-yellow-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2.5 w-2.5 bg-yellow-500"})]}),e.jsx("span",{className:"text-[10px] md:text-xs font-bold text-yellow-300 uppercase tracking-[0.25em]",children:_a.hero.label_atas})]}),e.jsxs("h1",{className:"font-sans text-4xl sm:text-5xl md:text-7xl font-extrabold tracking-tight mb-6 leading-[1.1] drop-shadow-xl",children:[_a.hero.judul_awalan," ",e.jsx("br",{}),e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 via-yellow-400 to-yellow-200 animate-text-shimmer",children:_a.hero.judul_sorotan})]}),e.jsx("p",{className:"text-emerald-100/80 max-w-2xl mx-auto text-base md:text-xl font-medium leading-relaxed mb-10 px-2",children:_a.hero.deskripsi})]})]}),e.jsx("section",{className:"max-w-6xl mx-auto px-4 md:px-6 -mt-16 relative z-20 mb-20",children:e.jsx("div",{className:"bg-white rounded-[2.5rem] shadow-[0_20px_50px_rgba(0,0,0,0.08)] border border-slate-100 p-2",children:e.jsx("div",{className:"grid grid-cols-3 divide-x divide-slate-100",children:o.map((p,m)=>e.jsxs("div",{className:"flex flex-col items-center py-6 md:py-8 px-2 text-center group cursor-default",children:[e.jsx("span",{className:"text-2xl md:text-4xl font-sans font-black text-slate-900 mb-2 tabular-nums tracking-tight group-hover:text-emerald-600 transition-colors",children:m===0?Fa(p.nilai).replace("Rp ",""):it(p.nilai)}),e.jsx("span",{className:"text-slate-400 font-bold text-[9px] md:text-xs uppercase tracking-[0.15em]",children:p.label})]},m))})})}),e.jsxs("section",{className:"max-w-7xl mx-auto px-4 md:px-6 pb-24",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-end justify-between mb-12 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-emerald-600 font-bold tracking-[0.2em] uppercase text-xs",children:"Ladang Amal"}),e.jsx("h2",{className:"font-sans text-3xl md:text-4xl font-bold text-slate-900 mt-2",children:"Program Pilihan"})]}),e.jsx("p",{className:"text-slate-500 text-sm max-w-md text-right hidden md:block",children:"Pilih program kebaikan yang ingin Anda bantu. Insya Allah menjadi amal jariyah yang tak terputus."})]}),D&&e.jsx("div",{className:"w-full mb-12 animate-fade-in-up",children:e.jsxs("div",{onClick:()=>k(D),className:"bg-gradient-to-r from-emerald-900 via-emerald-800 to-teal-800 rounded-[2.5rem] p-8 md:p-12 text-white shadow-2xl shadow-emerald-900/20 relative overflow-hidden cursor-pointer group hover:shadow-emerald-900/40 transition-all duration-500 transform hover:-translate-y-1",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"}),e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-emerald-500/20 rounded-full blur-3xl -mr-20 -mt-20 pointer-events-none group-hover:bg-emerald-400/20 transition-colors duration-500"}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-8",children:[e.jsxs("div",{className:"space-y-4 text-center md:text-left flex-1",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-emerald-800/50 backdrop-blur-md px-4 py-1.5 rounded-full border border-emerald-700/50",children:[e.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-emerald-100",children:"Dana Operasional"})]}),e.jsx("h3",{className:"font-sans text-3xl md:text-5xl font-bold leading-tight tracking-tight",children:"Infaq Umum Pesantren"}),e.jsx("p",{className:"text-emerald-100/80 text-sm md:text-lg font-medium leading-relaxed max-w-2xl",children:"Dukungan untuk operasional harian, pemeliharaan fasilitas, dan pengembangan pendidikan santri."})]}),e.jsx("div",{className:"shrink-0 w-full md:w-auto",children:e.jsxs("button",{className:"w-full md:w-auto bg-white text-emerald-900 px-8 py-4 rounded-2xl font-bold shadow-lg hover:bg-emerald-50 transition-all flex items-center justify-center gap-3 group/btn",children:[e.jsx("span",{children:"Infaq Sekarang"}),e.jsx("div",{className:"w-8 h-8 bg-emerald-100 rounded-full flex items-center justify-center text-emerald-700 group-hover/btn:translate-x-1 transition-transform",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})})]})})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8",children:B.map(p=>{const m=p.target.nominal>0?Math.min(100,Math.round((p.terkumpul||0)/p.target.nominal*100)):0;return e.jsxs("div",{onClick:()=>c(p),className:"bg-white rounded-[2rem] border border-gray-100 overflow-hidden shadow-lg hover:shadow-2xl hover:border-emerald-100 hover:-translate-y-2 transition-all duration-500 cursor-pointer group flex flex-col h-full font-sans",children:[e.jsxs("div",{className:"relative aspect-[4/3] overflow-hidden",children:[e.jsx("img",{src:p.gambar[0],className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700",alt:p.judul}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-80 transition-opacity duration-300"}),e.jsx("div",{className:"absolute top-4 left-4 z-10",children:e.jsx("span",{className:"px-3 py-1.5 bg-white/90 backdrop-blur-md text-emerald-900 text-[10px] font-bold uppercase tracking-wider rounded-lg shadow-sm border border-white/50",children:p.kategori})}),p.user_has_donated&&e.jsxs("div",{className:"absolute top-4 right-4 z-10 bg-emerald-600/90 backdrop-blur-md text-white px-3 py-1.5 rounded-lg text-[10px] font-bold shadow-sm flex items-center gap-1.5",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Donatur"]})]}),e.jsxs("div",{className:"p-6 flex-1 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-sans font-bold text-xl text-slate-900 mb-3 leading-snug line-clamp-2 group-hover:text-emerald-700 transition-colors",children:p.judul}),e.jsx("p",{className:"text-slate-500 text-sm line-clamp-2 leading-relaxed mb-6",children:p.deskripsi})]}),e.jsxs("div",{className:"mt-auto",children:[e.jsxs("div",{className:"flex justify-between items-end mb-2",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-0.5",children:"Terkumpul"}),e.jsx("span",{className:"text-emerald-600 font-bold text-base tabular-nums",children:Fa(p.terkumpul)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-0.5",children:"Target"}),e.jsx("span",{className:"text-slate-600 font-bold text-sm tabular-nums",children:it(p.target.nominal)})]})]}),e.jsx("div",{className:"w-full h-2.5 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-emerald-400 rounded-full relative transition-all duration-1000 ease-out shadow-[0_0_10px_rgba(16,185,129,0.4)]",style:{width:`${m}%`}})}),e.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t border-slate-50 text-xs font-bold text-slate-400",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-emerald-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsxs("span",{className:"text-slate-600",children:[p.donatur||0," Donatur"]})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("span",{className:"text-slate-600",children:[p.sisa_hari," Hari Lagi"]})]})]})]})]})]},p.id_donasi)})})]}),e.jsx("section",{className:"max-w-4xl mx-auto px-6 pb-32 animate-fade-in-up delay-100",children:e.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-200 shadow-xl overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-emerald-500 via-yellow-400 to-emerald-500"}),e.jsx("div",{className:"bg-slate-50/80 backdrop-blur px-8 py-5 border-b border-slate-100 flex items-center justify-between",children:e.jsxs("h3",{className:"font-sans font-bold text-slate-800 text-base flex items-center gap-2",children:[e.jsxs("span",{className:"relative flex h-2.5 w-2.5",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-2.5 w-2.5 bg-emerald-500"})]}),"Donasi Terbaru"]})}),e.jsx("div",{className:"divide-y divide-slate-100 max-h-[400px] overflow-y-auto custom-scrollbar",children:t.length>0?t.map((p,m)=>{var h;const u=((h=r.find(M=>M.id_donasi===p.id_donasi))==null?void 0:h.judul)||(p.id_donasi==="umum"?"Infaq Operasional":"Program Donasi"),i=p.donatur.nama.charAt(0),g=["bg-emerald-100 text-emerald-700","bg-blue-100 text-blue-700","bg-amber-100 text-amber-700","bg-rose-100 text-rose-700","bg-purple-100 text-purple-700"],K=g[i.charCodeAt(0)%g.length];return e.jsxs("div",{className:"flex items-center justify-between p-5 hover:bg-slate-50 transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm border-2 border-white shadow-sm ${K}`,children:i}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-800 text-sm",children:p.donatur.nama}),e.jsxs("p",{className:"text-[10px] text-slate-400 mt-0.5 font-medium",children:[new Date(p.timestamp).toLocaleDateString("id-ID",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}),e.jsx("span",{className:"mx-1.5 text-slate-300",children:"•"}),e.jsx("span",{className:"text-emerald-600",children:u})]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-sans font-bold text-emerald-600 text-sm tabular-nums group-hover:scale-105 transition-transform origin-right",children:["+",Fa(p.nominal).replace("Rp ","")]})})]},m)}):e.jsx("div",{className:"text-center py-12 text-slate-400 text-sm italic",children:"Belum ada data donasi terbaru."})}),e.jsx("div",{className:"bg-slate-50 px-6 py-4 text-center border-t border-slate-100",children:e.jsx("p",{className:"text-[10px] text-slate-400 font-medium",children:"Jazakumullah Khairan Katsiran kepada seluruh donatur."})})]})})]})},ot=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a).replace("Rp","Rp "),ms=a=>a>=1e9?(a/1e9).toFixed(1).replace(/\.0$/,"")+" M":a>=1e6?(a/1e6).toFixed(1).replace(/\.0$/,"")+" Jt":a>=1e3?(a/1e3).toFixed(1).replace(/\.0$/,"")+" rb":a.toString(),us=({campaign:a,onBack:r,onDonate:t,onCopyLink:o,copyLinkState:c})=>{var i;const k=a.gambar||[],[f,D]=s.useState(k[0]||"");s.useEffect(()=>{k.length>0&&D(k[0])},[a]);const B=((i=a.target)==null?void 0:i.nominal)||1,p=a.terkumpul||0,m=Math.min(100,Math.round(p/B*100)),u=a.donor_list||[];return e.jsxs("div",{className:"animate-fade-in bg-white min-h-screen pb-32 pt-20 md:pt-24 font-sans",children:[e.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white/90 backdrop-blur-lg border-b border-slate-100 py-3 md:py-4 transition-all shadow-sm",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:r,className:"p-2 md:p-2.5 rounded-xl hover:bg-slate-100 text-slate-600 transition-colors flex items-center justify-center border border-transparent hover:border-slate-200",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-sm text-slate-900 leading-none",children:"Detail Program"}),e.jsx("span",{className:"text-[10px] text-slate-500 font-medium mt-0.5 truncate max-w-[150px] md:max-w-none",children:a.judul})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:o,className:`p-2.5 rounded-xl transition-all border flex items-center gap-2 ${c?"bg-emerald-50 border-emerald-200 text-emerald-600":"bg-white border-slate-200 text-slate-500 hover:bg-slate-50"}`,children:c?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"text-xs font-bold hidden md:inline",children:"Tersalin"})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})}),e.jsx("span",{className:"text-xs font-bold hidden md:inline",children:"Bagikan"})]})})})]})}),e.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 mt-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-8 lg:gap-12",children:[e.jsxs("div",{className:"lg:col-span-7 space-y-8",children:[e.jsxs("div",{className:"relative rounded-[2.5rem] overflow-hidden shadow-2xl group border border-slate-100 aspect-[4/3] md:aspect-[16/9]",children:[e.jsx("img",{src:f,alt:a.judul,className:"w-full h-full object-cover transition-transform duration-1000 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent opacity-80"}),e.jsx("div",{className:"absolute top-6 left-6 z-10",children:e.jsx("span",{className:"px-4 py-2 bg-white/20 backdrop-blur-md border border-white/20 text-white text-[10px] font-black uppercase tracking-widest rounded-full shadow-lg",children:a.kategori})}),k.length>1&&e.jsx("div",{className:"absolute bottom-6 right-6 flex gap-3 z-20 overflow-x-auto max-w-[200px] scrollbar-hide p-1",children:k.map((g,K)=>e.jsx("div",{onClick:h=>{h.stopPropagation(),D(g)},className:`w-14 h-14 rounded-xl overflow-hidden cursor-pointer border-2 transition-all shadow-lg ${f===g?"border-yellow-400 scale-110 ring-2 ring-black/20":"border-white/50 opacity-80 hover:opacity-100"}`,children:e.jsx("img",{src:g,className:"w-full h-full object-cover",alt:`Thumb ${K}`})},K))})]}),e.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-100 shadow-xl p-8 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-emerald-50 rounded-bl-full -mr-10 -mt-10 z-0"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-end mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 font-bold text-xs uppercase tracking-widest mb-1",children:"Terkumpul"}),e.jsx("div",{className:"flex items-baseline gap-2",children:e.jsx("span",{className:"text-4xl md:text-5xl font-sans font-extrabold text-emerald-600 tracking-tight tabular-nums",children:ot(p)})})]}),e.jsxs("div",{className:"text-right hidden sm:block",children:[e.jsx("p",{className:"text-slate-400 text-xs font-bold uppercase tracking-widest mb-1",children:"Target"}),e.jsx("p",{className:"text-slate-600 text-lg font-mono font-bold",children:ms(B)})]})]}),e.jsx("div",{className:"w-full h-4 bg-slate-100 rounded-full overflow-hidden border border-slate-200",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-teal-400 rounded-full shadow-[0_0_15px_rgba(16,185,129,0.4)] relative transition-all duration-1000 ease-out",style:{width:`${m}%`},children:e.jsx("div",{className:"absolute top-0 bottom-0 right-0 w-px bg-white/50"})})}),e.jsxs("div",{className:"flex justify-between items-center mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-emerald-50 px-3 py-1.5 rounded-lg border border-emerald-100",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsxs("span",{className:"text-xs font-bold text-emerald-800",children:[a.donatur||0," Donatur"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-500",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("span",{className:"text-xs font-bold",children:[a.sisa_hari," Hari Lagi"]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-100 p-8 shadow-sm",children:[e.jsxs("h3",{className:"font-sans font-bold text-lg text-slate-900 mb-6 flex items-center gap-3",children:[e.jsx("span",{className:"w-1 h-6 bg-yellow-400 rounded-full"}),"Cerita Program"]}),e.jsx("div",{className:"prose prose-sm md:prose-base prose-slate max-w-none text-slate-600 leading-relaxed font-sans",children:a.deskripsi?a.deskripsi.split(`

`).map((g,K)=>e.jsx("p",{className:"mb-4",children:g},K)):e.jsx("p",{className:"italic text-gray-400",children:"Belum ada deskripsi detail."})})]})]}),e.jsxs("div",{className:"lg:col-span-5 space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-200 shadow-xl p-6 lg:sticky lg:top-24 z-10",children:[e.jsx("h2",{className:"font-serif text-2xl font-bold text-slate-900 leading-tight mb-4",children:a.judul}),e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-500 mb-6 bg-slate-50 p-3 rounded-xl border border-slate-100",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})}),e.jsx("span",{children:"Terverifikasi oleh Yayasan Miftahul Huda"})]}),e.jsxs("button",{onClick:t,className:"w-full py-4 bg-yellow-500 text-emerald-950 font-bold rounded-xl shadow-lg shadow-yellow-500/20 hover:bg-yellow-400 hover:scale-[1.02] transition-all transform flex items-center justify-center gap-2 group mb-4",children:[e.jsx("span",{children:"Donasi Sekarang"}),e.jsx("div",{className:"w-6 h-6 bg-black/10 rounded-full flex items-center justify-center group-hover:translate-x-1 transition-transform",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})})]}),e.jsx("p",{className:"text-center text-[10px] text-slate-400 font-medium",children:"Pembayaran aman & terverifikasi otomatis."})]}),e.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-100 shadow-sm p-6 lg:p-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"font-bold text-slate-900 text-lg",children:"Donatur Terbaru"}),e.jsx("span",{className:"text-[10px] font-bold bg-emerald-50 text-emerald-700 px-2 py-1 rounded-md border border-emerald-100",children:"Live Update"})]}),e.jsx("div",{className:"space-y-4 max-h-[500px] overflow-y-auto custom-scrollbar pr-2",children:u.length>0?u.map((g,K)=>{var d,C,L;const h=((C=(d=g.donatur)==null?void 0:d.nama)==null?void 0:C.charAt(0))||"?",M=["bg-rose-100 text-rose-700","bg-blue-100 text-blue-700","bg-emerald-100 text-emerald-700","bg-amber-100 text-amber-700","bg-purple-100 text-purple-700"],w=M[h.charCodeAt(0)%M.length];return e.jsxs("div",{className:"flex gap-3 p-3 bg-slate-50/50 rounded-xl border border-slate-100 hover:border-slate-200 transition-colors",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center font-bold text-sm shrink-0 shadow-sm ${w}`,children:h}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h4",{className:"font-bold text-slate-800 text-sm truncate",children:((L=g.donatur)==null?void 0:L.nama)||"Hamba Allah"}),e.jsx("span",{className:"text-xs font-mono font-bold text-emerald-600",children:ot(g.nominal)})]}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-0.5",children:g.timestamp?new Date(g.timestamp).toLocaleDateString("id-ID",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"}):"-"}),g.catatan&&e.jsxs("div",{className:"mt-2 text-xs text-slate-600 italic bg-white p-2 rounded-lg border border-slate-100",children:['"',g.catatan,'"']})]})]},K)}):e.jsxs("div",{className:"text-center py-12 flex flex-col items-center justify-center border-2 border-dashed border-slate-100 rounded-2xl bg-slate-50/50",children:[e.jsx("div",{className:"w-12 h-12 bg-slate-200 rounded-full flex items-center justify-center text-slate-400 mb-3",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),e.jsx("p",{className:"text-slate-500 text-sm font-medium",children:"Jadilah donatur pertama!"}),e.jsx("button",{onClick:t,className:"mt-2 text-xs font-bold text-emerald-600 hover:underline",children:"Donasi Sekarang"})]})})]})]})]})}),e.jsx("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-slate-200 shadow-[0_-5px_20px_rgba(0,0,0,0.05)] z-40",children:e.jsxs("button",{onClick:t,className:"w-full py-3.5 bg-yellow-500 text-emerald-950 font-bold rounded-xl shadow-lg flex items-center justify-center gap-2",children:[e.jsx("span",{children:"Donasi Sekarang"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})})]})},Ee=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a).replace("Rp","Rp "),xs=a=>a>=1e9?(a/1e9).toFixed(1).replace(/\.0$/,"")+" M":a>=1e6?(a/1e6).toFixed(1).replace(/\.0$/,"")+" Jt":a>=1e3?(a/1e3).toFixed(1).replace(/\.0$/,"")+" rb":a.toString(),hs=a=>!a||a.trim()===""?"":a.split(" ").map(r=>r.length<3?r:r[0]+"*".repeat(r.length-2)+r[r.length-1]).join(" "),ps={pembayaran:{nominal_cepat:[5e4,1e5,25e4,5e5,1e6]}},dt=a=>{const r=a.toLowerCase();return r.includes("bsi")||r.includes("syariah")?"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a0/Bank_Syariah_Indonesia.svg/960px-Bank_Syariah_Indonesia.svg.png":r.includes("mandiri")?"https://upload.wikimedia.org/wikipedia/commons/thumb/a/ad/Bank_Mandiri_logo_2016.svg/250px-Bank_Mandiri_logo_2016.svg.png":r.includes("bca")?"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTQGnSX7D6wci0SA0G0c-K64mIPqbE9IWbs0A&s":r.includes("gopay")?"https://upload.wikimedia.org/wikipedia/commons/thumb/8/86/Gopay_logo.svg/2560px-Gopay_logo.svg.png":r.includes("dana")?"https://upload.wikimedia.org/wikipedia/commons/5/52/Dana_logo.png":r.includes("ovo")?"https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Logo_ovo_purple.svg/1200px-Logo_ovo_purple.svg.png":r.includes("qris")?"https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQBSPMt-f3R4oDq74YE9CtgvSBtewheAS5z4w&s":`https://placehold.co/100x56/f1f5f9/334155?text=${a.substring(0,3).toUpperCase()}`},za=({campaign:a,donasiInfo:r,onBack:t,onCopyLink:o,copyLinkState:c,items:k=[]})=>{const[f,D]=s.useState(null),[B,p]=s.useState(""),[m,u]=s.useState(null),[i,g]=s.useState(null),[K,h]=s.useState(""),[M,w]=s.useState(""),[d,C]=s.useState(""),[L,P]=s.useState("public"),[y,z]=s.useState(!1),[j,N]=s.useState(""),[A,S]=s.useState([]),[b,T]=s.useState({prov:"",kab:"",kec:"",kel:""}),[$,E]=s.useState({prov:"",kab:"",kec:"",kel:""}),[F,x]=s.useState(""),[l,I]=s.useState(""),[_,n]=s.useState(!1),[v,R]=s.useState("SELECTION"),[W,q]=s.useState(600),[V,J]=s.useState(null),[U,re]=s.useState(!1),Z=s.useMemo(()=>Array.from({length:15}).map((Y,te)=>e.jsx("div",{className:"absolute text-yellow-200/10 animate-pulse",style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*5}s`},children:e.jsx("svg",{className:"w-3 h-3",viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})},`star-${te}`)),[]),ae=a.kategori==="Koperasi"||a.id_donasi.startsWith("KOP"),_e=ae?"Data Pemesan":"Data Donatur",oe=ae&&a.target?a.target.nominal:0,xe=oe>0?oe:f||parseInt(B.replace(/\D/g,""))||0;s.useEffect(()=>{n(!0);const Y=localStorage.getItem("pesantrenku_guest_data");if(Y)try{const te=JSON.parse(Y);te.name&&h(te.name),te.email&&w(te.email),te.phone&&C(te.phone),te.detailAlamat&&x(te.detailAlamat)}catch{}return ae&&(async()=>{try{const X=await G.getDatabaseSantri();S(Array.isArray(X)?X:[])}catch(X){console.error(X)}})(),()=>n(!1)},[ae]),s.useEffect(()=>{if(v==="PROCESSING"&&W>0){const Y=setInterval(()=>{q(te=>te-1)},1e3);return()=>clearInterval(Y)}},[v,W]);const H=Y=>{const te=Math.floor(Y/60),X=Y%60;return`${te.toString().padStart(2,"0")} : ${X.toString().padStart(2,"0")}`},ee=(Y,te)=>{Y==="name"&&h(te),Y==="email"&&w(te),Y==="phone"&&C(te),Y==="detailAlamat"&&x(te);const X={name:Y==="name"?te:K,email:Y==="email"?te:M,phone:Y==="phone"?te:d,detailAlamat:Y==="detailAlamat"?te:F};localStorage.setItem("pesantrenku_guest_data",JSON.stringify(X))},le=(Y,te,X)=>{Y==="province"?(T({prov:te,kab:"",kec:"",kel:""}),E({prov:X,kab:"",kec:"",kel:""})):Y==="regency"?(T(se=>({...se,kab:te,kec:"",kel:""})),E(se=>({...se,kab:X,kec:"",kel:""}))):Y==="district"?(T(se=>({...se,kec:te,kel:""})),E(se=>({...se,kec:X,kel:""}))):Y==="village"&&(T(se=>({...se,kel:te})),E(se=>({...se,kel:X})))},O=s.useMemo(()=>A.map(Y=>{var te,X,se;return{value:((te=Y.verifikasi_santri)==null?void 0:te.id_santri)||"",label:`${(X=Y.data_santri)==null?void 0:X.nama_lengkap} (${(se=Y.verifikasi_santri)==null?void 0:se.id_santri})`}}),[A]),Q=Y=>{var X;N(Y);const te=A.find(se=>{var ue;return((ue=se.verifikasi_santri)==null?void 0:ue.id_santri)===Y});te&&h(((X=te.data_santri)==null?void 0:X.nama_lengkap)||"")},ne=()=>{if(!xe){alert("Mohon pilih atau masukkan nominal.");return}if(!i){alert("Mohon pilih metode pembayaran.");return}if(!d){alert("Mohon lengkapi nomor WhatsApp.");return}if(!ae&&L!=="hidden"&&!K){alert("Mohon isi nama Anda.");return}if(ae&&!K){alert("Mohon lengkapi nama pemesan.");return}if(ae&&!y&&(!F||!b.prov||!b.kab)){alert("Mohon lengkapi alamat pengiriman.");return}R("PROCESSING"),window.scrollTo(0,0)},he=async()=>{if(U)return;re(!0);let Y=K;ae||(L==="hidden"?Y="Hamba Allah":L==="masked"&&(Y=hs(K)));const te=Date.now();try{if(ae){const Ae=`TRX-KOP-${te}`,Te=k.map($e=>({id_produk:$e.id,kategori:"Umum",nama:$e.name,qty:$e.qty,harga_beli:0,harga_jual:$e.price})),De={id_transaksi:Ae,jenis_transaksi:{tanggal:new Date().toISOString().split("T")[0],jenis:"Pemasukan",metode:"Transfer",keterangan:`Pesanan Website: ${k.length} Item`,total_nominal:xe,status:"Menunggu"},produk:Te,pihak:{kategori:y?"Santri":"Umum",nama:Y,id_akun:y?j:`GST-${d}`}},Ke=await G.getKoperasiTransaksi(),We=Array.isArray(Ke)?[De,...Ke]:[De];await G.updateKoperasiTransaksi(We)}else{const Ae=`TRX-DON-${te}`,Te=a.id_donasi!=="umum"&&!a.id_donasi.startsWith("CMP");let De="DONASI";ae?De="Koperasi":a.pos?De=a.pos:Te?De="TAGIHAN":a.id_donasi==="umum"&&(De="Operasional");const Ke={id_transaksi:Ae,tanggal:new Date().toISOString(),jenis:"masuk",status:"Menunggu",pihak:{id:!ae&&L==="hidden"?"hamba-allah":`DNR-${d}`,nama:Y},peruntukan:{pos:De,kategori:a.kategori||"Infaq",id_ref:a.id_donasi},pembayaran:{metode:"Transfer",sistem:(i==null?void 0:i.type)==="BANK"?"Bank":(i==null?void 0:i.type)==="EWALLET"?"E-Wallet":"QRIS",penyedia:(i==null?void 0:i.name)||"-",no_rek:(i==null?void 0:i.number)||"-",penerima:(i==null?void 0:i.owner)||"-",nominal:xe,catatan:l||"-"}},We=await G.getKeuanganTransaksi(),$e=Array.isArray(We)?[Ke,...We]:[Ke];if(await G.updateKeuanganTransaksi($e),!Te){const ia={id_donatur:`DNR-${d}`,nama:Y,email:M||"-",telpon:d,jumlah_donasi:xe};await G.submitDonation(Ke,ia)}}}catch(Ae){console.error("Gagal menyimpan transaksi:",Ae)}const X=r!=null&&r.kontak&&r.kontak.length>0?r.kontak[0]:"6281234567890",ue=`${ae?`Assalamu'alaikum, saya ${Y} sudah melakukan pembayaran pesanan Koperasi.
`:`Assalamu'alaikum, saya ${Y} sudah transfer donasi untuk "${a==null?void 0:a.judul}".
`}
Nominal: ${Ee(xe)}
Ke: ${i==null?void 0:i.name} (${i==null?void 0:i.number})
Catatan: ${l||"-"}

Mohon segera diproses. Terima kasih.`,je=`https://wa.me/${X}?text=${encodeURIComponent(ue)}`;window.open(je,"_blank"),re(!1)},Ce=(r==null?void 0:r.bank)||[],me=(r==null?void 0:r.ewallet)||[],be=r==null?void 0:r.QRIS,Me=[...Ce.map((Y,te)=>({type:"BANK",id:`bank-${te}`,name:Y.bank,number:Y.rekening,owner:Y.pemilik,image:""})),...me.map((Y,te)=>({type:"EWALLET",id:`ewallet-${te}`,name:Y.jenis,number:Y.nomor,owner:Y.pemilik,image:""})),...be?[{type:"QRIS",id:"qris",name:"QRIS",number:"",owner:be.pemilik,image:be.gambar}]:[]],ke=()=>e.jsxs("div",{className:"flex-1 bg-white relative flex flex-col h-full overflow-hidden",children:[e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 lg:p-12 relative pb-32",children:e.jsxs("div",{className:"max-w-xl mx-auto space-y-8",children:[!ae&&e.jsxs("div",{className:"animate-fade-in-up",children:[e.jsxs("h3",{className:"font-bold text-slate-800 text-sm uppercase tracking-wide mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center text-xs",children:"1"})," Pilih Nominal"]}),e.jsx("div",{className:"grid grid-cols-3 gap-3 mb-4",children:ps.pembayaran.nominal_cepat.map(Y=>e.jsx("button",{onClick:()=>{D(Y),p("")},className:`py-3 rounded-xl text-xs font-bold border transition-all ${f===Y?"bg-emerald-600 text-white border-emerald-600 shadow-lg shadow-emerald-600/20":"bg-white text-gray-500 border-gray-200 hover:border-emerald-200 hover:bg-slate-50"}`,children:xs(Y)},Y))}),e.jsxs("div",{className:"relative group/input",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-400 font-bold text-sm",children:"Rp"}),e.jsx("input",{type:"number",placeholder:"Nominal Lainnya...",value:B,onChange:Y=>{p(Y.target.value),D(null)},className:"w-full pl-10 pr-4 py-3.5 bg-gray-50 border border-gray-200 rounded-xl font-bold text-gray-800 focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 outline-none transition"})]})]}),e.jsxs("div",{className:"animate-fade-in-up",style:{animationDelay:"100ms"},children:[e.jsxs("h3",{className:"font-bold text-slate-800 text-sm uppercase tracking-wide mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center text-xs",children:ae?"1":"2"})," ",_e]}),e.jsxs("div",{className:"space-y-5",children:[ae&&e.jsxs("div",{className:"p-4 rounded-2xl bg-purple-50 border border-purple-100",children:[e.jsxs("label",{className:"flex items-center gap-3 cursor-pointer",children:[e.jsx("div",{className:`w-5 h-5 rounded border flex items-center justify-center bg-white ${y?"border-purple-600":"border-gray-300"}`,children:y&&e.jsx("div",{className:"w-3 h-3 bg-purple-600 rounded-sm"})}),e.jsx("input",{type:"checkbox",checked:y,onChange:Y=>{z(Y.target.checked),Y.target.checked||(N(""),h(""))},className:"hidden"}),e.jsx("span",{className:"text-sm font-bold text-purple-900",children:"Pesanan untuk Santri?"})]}),y&&e.jsx("div",{className:"mt-4",children:e.jsx(de,{id:"search-santri",label:"Cari Santri",value:j,onChange:Q,options:O,className:"!mb-0 bg-white"})})]}),!ae&&e.jsx("div",{className:"flex gap-3 mb-2",children:[{id:"public",label:"Tampilkan Nama"},{id:"hidden",label:"Hamba Allah"},{id:"masked",label:"Samarkan Nama"}].map(Y=>e.jsx("button",{onClick:()=>P(Y.id),className:`flex-1 py-2 rounded-lg text-[10px] font-bold uppercase tracking-wide border transition-all ${L===Y.id?"bg-purple-600 text-white border-purple-600 shadow-md":"bg-white text-slate-500 border-slate-200 hover:border-purple-300"}`,children:Y.label},Y.id))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:`floating-input peer bg-gray-50 focus:bg-white ${L==="hidden"&&!ae?"opacity-50 cursor-not-allowed":""}`,placeholder:" ",value:!ae&&L==="hidden"?"Hamba Allah":K,onChange:Y=>h(Y.target.value),disabled:!ae&&L==="hidden"}),e.jsx("label",{className:"floating-label",children:"Nama Lengkap"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"email",className:"floating-input peer bg-gray-50 focus:bg-white",placeholder:" ",value:M,onChange:Y=>ee("email",Y.target.value)}),e.jsx("label",{className:"floating-label",children:"Email (Opsional)"})]})]}),e.jsx("div",{className:"relative",children:e.jsx($a,{id:"wa-donatur",label:"No. WhatsApp (Wajib)",value:d,onChange:Y=>ee("phone",Y),required:!0})}),ae&&!y&&e.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-100",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:"Alamat Pengiriman"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.jsx(Lt,{provinceId:b.prov,regencyId:b.kab,districtId:b.kec,villageId:b.kel,onChange:le})}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("textarea",{className:"floating-input peer bg-gray-50 focus:bg-white h-20 py-3 resize-none",placeholder:" ",value:F,onChange:Y=>ee("detailAlamat",Y.target.value)}),e.jsx("label",{className:"floating-label",children:"Jalan / Patokan"})]})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("textarea",{className:"floating-input peer bg-gray-50 focus:bg-white h-24 py-3 resize-none",placeholder:" ",value:l,onChange:Y=>I(Y.target.value)}),e.jsx("label",{className:"floating-label",children:ae?"Catatan Pesanan":"Doa & Harapan"})]})]})]}),e.jsxs("div",{className:"animate-fade-in-up",style:{animationDelay:"200ms"},children:[e.jsxs("h3",{className:"font-bold text-slate-800 text-sm uppercase tracking-wide mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-6 h-6 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center text-xs",children:ae?"2":"3"})," Metode Pembayaran"]}),e.jsx("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-3",children:Me.map(Y=>{const te=m===Y.id;return e.jsxs("div",{className:`relative border rounded-2xl cursor-pointer transition-all duration-300 flex items-center justify-center aspect-[16/9] p-3 overflow-hidden group ${te?"border-emerald-500 bg-emerald-50 ring-2 ring-emerald-500/20":"border-gray-200 bg-white hover:border-emerald-300"}`,onClick:()=>{u(Y.id),g(Y)},children:[e.jsx("img",{src:dt(Y.name),alt:Y.name,className:"w-full h-full object-contain"}),te&&e.jsx("div",{className:"absolute top-1 right-1 bg-emerald-500 text-white rounded-full p-0.5",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]},Y.id)})})]}),e.jsx("div",{className:"h-10"})]})}),e.jsxs("div",{className:"bg-white border-t border-gray-100 p-6 flex items-center justify-between gap-4 mt-auto shadow-[0_-5px_20px_rgba(0,0,0,0.02)] fixed bottom-0 lg:absolute w-full z-20",children:[e.jsxs("div",{className:"hidden md:block",children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Total Pembayaran"}),e.jsx("p",{className:"text-2xl font-mono font-bold text-emerald-900",children:Ee(xe)})]}),e.jsxs("button",{onClick:ne,className:"w-full md:w-auto px-8 py-4 bg-emerald-900 text-white rounded-xl font-bold shadow-xl shadow-emerald-900/20 hover:bg-emerald-800 hover:-translate-y-1 transition-all flex items-center justify-center gap-3 group",children:[e.jsx("span",{children:"Bayar Sekarang"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-emerald-200 group-hover:translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})]})]}),Se=()=>e.jsxs("div",{className:"fixed inset-0 z-[300] bg-gray-50 flex flex-col items-center justify-center p-4 animate-fade-in",children:[e.jsxs("div",{className:"absolute top-0 left-0 right-0 bg-emerald-950 text-white p-4 flex justify-between items-center z-10 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>R("SELECTION"),className:"p-2 bg-white/10 rounded-full hover:bg-white/20 transition",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("span",{className:"font-bold text-sm tracking-wider uppercase",children:"Selesaikan Pembayaran"})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-red-600/90 px-3 py-1.5 rounded-lg border border-red-400/30",children:[e.jsx("svg",{className:"w-4 h-4 animate-pulse",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"font-mono font-bold",children:H(W)})]})]}),e.jsxs("div",{className:"w-full max-w-md w-full mt-20 mb-24 overflow-y-auto custom-scrollbar px-2 pb-8",children:[e.jsxs("div",{className:"relative aspect-[1.586/1] rounded-3xl bg-gradient-to-br from-slate-900 via-slate-800 to-emerald-900 p-6 md:p-8 text-white shadow-2xl mb-8 overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/5 rounded-full blur-3xl -mr-20 -mt-20"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-full bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')] opacity-10 mix-blend-overlay"}),e.jsxs("div",{className:"relative z-10 flex flex-col justify-between h-full",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("img",{src:dt((i==null?void 0:i.name)||""),alt:"Bank Logo",className:"h-8 md:h-10 object-contain bg-white/90 rounded px-2 py-1"}),e.jsx("span",{className:"font-mono text-emerald-300 font-bold tracking-widest text-lg md:text-xl",children:"DEBIT"})]}),e.jsxs("div",{className:"my-4",children:[e.jsxs("div",{className:"w-10 h-8 md:w-12 md:h-9 bg-yellow-200/80 rounded-md border border-yellow-400/50 mb-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-1/2 left-0 w-full h-[1px] bg-yellow-600/40"}),e.jsx("div",{className:"absolute top-0 left-1/3 h-full w-[1px] bg-yellow-600/40"}),e.jsx("div",{className:"absolute top-0 right-1/3 h-full w-[1px] bg-yellow-600/40"})]}),(i==null?void 0:i.type)==="QRIS"?e.jsx("div",{className:"text-center bg-white p-2 rounded-xl w-32 mx-auto",children:e.jsx("img",{src:i.image,className:"w-full h-full object-contain"})}):e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("p",{className:"font-mono text-2xl md:text-3xl font-bold tracking-widest text-shadow-sm truncate",children:i==null?void 0:i.number}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText((i==null?void 0:i.number)||""),J("atm"),setTimeout(()=>J(null),2e3)},className:"p-1.5 bg-white/20 hover:bg-white/30 rounded-lg transition",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),V==="atm"&&e.jsx("span",{className:"text-[10px] bg-emerald-500 text-white px-2 py-0.5 rounded-full animate-fade-in-up",children:"Copied"})]})]}),e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] uppercase tracking-widest text-emerald-200/80 mb-0.5",children:"Atas Nama"}),e.jsx("p",{className:"font-bold text-sm md:text-base tracking-wide uppercase",children:i==null?void 0:i.owner})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[9px] uppercase tracking-widest text-emerald-200/80 mb-0.5",children:"Total Bayar"}),e.jsx("p",{className:"font-bold text-xl md:text-2xl tracking-wide",children:Ee(xe)})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm p-5 mb-6",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4 border-b border-gray-100 pb-2",children:"Rincian Tagihan"}),e.jsxs("div",{className:"space-y-3",children:[k.length>0?k.map((Y,te)=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("span",{className:"text-gray-600 truncate max-w-[200px]",children:[Y.name," ",e.jsxs("span",{className:"text-gray-400 text-xs",children:["x",Y.qty]})]}),e.jsx("span",{className:"font-bold text-gray-800",children:Ee(Y.price*Y.qty)})]},te)):e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-600",children:a.judul}),e.jsx("span",{className:"font-bold text-gray-800",children:Ee(xe)})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm font-bold text-emerald-600 pt-3 border-t border-dashed border-gray-200 mt-2",children:[e.jsx("span",{children:"Total Transfer"}),e.jsx("span",{children:Ee(xe)})]})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-gray-50 border-b border-gray-100",children:e.jsxs("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Cara Pembayaran"]})}),e.jsxs("div",{className:"p-5 text-sm text-gray-600 space-y-3",children:[e.jsx("p",{children:"1. Buka aplikasi M-Banking atau ATM Bank Anda."}),e.jsxs("p",{children:["2. Pilih menu ",e.jsx("strong",{children:"Transfer"})," ke Bank Lain (jika beda bank)."]}),e.jsxs("p",{children:["3. Masukkan Nomor Rekening: ",e.jsx("span",{className:"font-mono font-bold bg-gray-100 px-1 rounded text-gray-800",children:i==null?void 0:i.number}),"."]}),e.jsxs("p",{children:["4. Masukkan Nominal: ",e.jsx("span",{className:"font-mono font-bold bg-gray-100 px-1 rounded text-gray-800",children:xe})," (Harus Tepat)."]}),e.jsxs("p",{children:["5. Pastikan nama penerima adalah ",e.jsx("strong",{children:i==null?void 0:i.owner}),"."]}),e.jsx("p",{children:"6. Simpan bukti transfer & klik tombol konfirmasi di bawah."})]})]})]}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-gray-200 z-50",children:e.jsx("button",{onClick:he,disabled:U,className:"w-full py-4 bg-emerald-600 text-white rounded-xl font-bold shadow-lg hover:bg-emerald-700 transition flex items-center justify-center gap-3 active:scale-95 disabled:opacity-70 disabled:cursor-not-allowed",children:U?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Memproses..."]}):e.jsx(e.Fragment,{children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})})})})})]});return!_||typeof document>"u"?null:Pa.createPortal(e.jsxs(e.Fragment,{children:[v==="SELECTION"&&e.jsxs("div",{className:"fixed inset-0 z-[200] flex flex-col lg:flex-row bg-white font-sans overflow-hidden",children:[e.jsxs("div",{className:"hidden lg:flex w-[40%] bg-emerald-950 relative overflow-hidden flex-col justify-between p-12 text-white",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.03] bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')]"}),e.jsx("div",{className:"absolute top-0 right-0 w-[400px] h-[400px] bg-emerald-900/50 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-[300px] h-[300px] bg-yellow-500/10 rounded-full blur-3xl translate-y-1/3 -translate-x-1/3"}),e.jsx("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:Z}),e.jsxs("div",{className:"relative z-10 shrink-0",children:[e.jsxs("button",{onClick:t,className:"flex items-center gap-2 text-emerald-200 hover:text-white transition mb-8 group",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 transform group-hover:-translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7 7-7m8 14l-7-7 7-7"})}),e.jsx("span",{className:"font-bold text-sm",children:"Kembali"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Oe,{className:"w-10 h-10 brightness-0 invert"}),e.jsxs("div",{children:[e.jsx("h1",{className:"font-serif font-bold text-2xl leading-none",children:"Miftahul Huda"}),e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest text-emerald-400 mt-1",children:"Payment Gateway"})]})]})]}),e.jsxs("div",{className:"relative z-10 flex-1 overflow-y-auto custom-scrollbar py-8 pr-2",children:[e.jsx("p",{className:"text-emerald-300 text-sm font-bold uppercase tracking-widest mb-4 sticky top-0 bg-emerald-950/90 backdrop-blur-sm py-2 z-10",children:ae?"Rincian Pesanan":"Tujuan Donasi"}),k.length>0?e.jsx("div",{className:"space-y-4",children:k.map((Y,te)=>e.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl bg-white/5 border border-white/10",children:[Y.image?e.jsx("img",{src:Y.image,alt:Y.name,className:"w-12 h-12 rounded-lg object-cover bg-white/10"}):e.jsxs("div",{className:"w-12 h-12 rounded-lg bg-emerald-800 flex items-center justify-center text-emerald-300 font-bold",children:[Y.qty,"x"]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-bold text-white truncate",children:Y.name}),e.jsxs("p",{className:"text-xs text-emerald-200/70",children:[Ee(Y.price),e.jsxs("span",{className:"text-white font-bold ml-1 opacity-80",children:["x ",Y.qty]})]})]}),e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"font-mono font-bold text-sm text-yellow-400",children:Ee(Y.price*Y.qty)})})]},te))}):e.jsx("div",{className:"p-6 bg-white/5 backdrop-blur-md border border-white/10 rounded-2xl",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-emerald-800 rounded-xl text-emerald-200",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-emerald-200 uppercase font-bold mb-1",children:ae?"Pembayaran Untuk":"Donasi Program"}),e.jsx("p",{className:"font-serif text-xl font-bold leading-tight",children:a.judul})]})]})})]}),e.jsx("div",{className:"relative z-10 pt-6 border-t border-white/10 shrink-0",children:e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-emerald-300 font-medium mb-1",children:["Total ",ae?"Tagihan":"Donasi"]}),e.jsxs("div",{className:"text-5xl font-mono font-bold tracking-tighter text-white text-shadow-sm",children:[e.jsx("span",{className:"text-xl text-emerald-400 align-top mr-1",children:"Rp"}),Ee(xe).replace("Rp ","")]})]}),k.length>0&&e.jsx("div",{className:"text-right",children:e.jsxs("span",{className:"text-xs font-bold bg-white/20 px-3 py-1 rounded-full",children:[k.reduce((Y,te)=>Y+te.qty,0)," Items"]})})]})})]}),e.jsxs("div",{className:"flex-1 bg-white relative flex flex-col h-full overflow-hidden",children:[e.jsxs("div",{className:"lg:hidden bg-emerald-950 text-white p-6 pb-8 rounded-b-[2.5rem] shadow-xl relative shrink-0 z-20",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("button",{onClick:t,className:"p-2 bg-white/10 rounded-full hover:bg-white/20",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx("span",{className:"font-serif font-bold text-lg",children:"Pembayaran"}),e.jsx("button",{onClick:o,className:"p-2 bg-white/10 rounded-full hover:bg-white/20",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-emerald-300 text-xs font-bold uppercase tracking-wider mb-1",children:"Total Nominal"}),e.jsx("h2",{className:"text-4xl font-mono font-bold",children:Ee(xe)}),e.jsx("p",{className:"text-emerald-200/70 text-xs mt-2 truncate px-4",children:a.judul})]})]}),ke()]})]}),v==="PROCESSING"&&Se()]}),document.body)},gs=({isSearchOpen:a=!1,initialSelectedCampaign:r,previewData:t})=>{const{fetchData:o}=ge(),[c,k]=s.useState([]),[f,D]=s.useState(null),[B,p]=s.useState(!0),[m,u]=s.useState("LIST"),[i,g]=s.useState(null),[K,h]=s.useState([]),[M,w]=s.useState(!1);s.useEffect(()=>{r&&(g(r),r.id_donasi==="umum"?u("PAYMENT"):u("DETAIL"))},[r]),s.useEffect(()=>{(async()=>{p(!0);try{let y=[];if(t&&Array.isArray(t))y=t;else{const l=await o("donasi",G.getDonasiRencana,"Donasi.tsx (Master)",!1,!1);y=Array.isArray(l)?l:(l==null?void 0:l.rencana)||[]}const[z,j]=await Promise.all([o("rekening",G.getRekening,"Donasi.tsx (Info)",!1,!1),o("keuanganTransaksi",G.getKeuanganTransaksi,"Donasi.tsx (Transactions)",!0,!1)]),N=Array.isArray(z)?z[0]:z;D(N||null);const S=(Array.isArray(j)?j:[]).filter(l=>{var n,v,R;if(l.jenis!=="masuk"&&((n=l.jenis_transaksi)==null?void 0:n.jenis)!=="Pemasukan")return!1;const I=(((v=l.peruntukan)==null?void 0:v.pos)||"").toUpperCase(),_=(((R=l.peruntukan)==null?void 0:R.kategori)||"").toLowerCase();return _.includes("spp")||_.includes("syariah")||_.includes("makan")||_.includes("tabungan")?!1:I==="DONASI"||I==="BANGUNAN"||I==="PHBI"||_.includes("donasi")||_.includes("wakaf")||_.includes("infaq")}).map(l=>{var R,W,q,V,J,U,re,Z;const I=l.status||((R=l.jenis_transaksi)==null?void 0:R.status)||"Pending",_=["Lunas","Selesai","Success","Verified"].includes(I),n=(W=l.pembayaran)!=null&&W.nominal?Number(l.pembayaran.nominal):Number(l.nominal)||0;let v=((q=l.peruntukan)==null?void 0:q.id_ref)||l.id_donasi||"umum";return{timestamp:l.tanggal||((V=l.jenis_transaksi)==null?void 0:V.tanggal),id_donasi:v,nominal:n,donatur:{nama:((J=l.pihak)==null?void 0:J.nama)||((U=l.donatur)==null?void 0:U.nama)||"Hamba Allah",whatsapp:"-",email:"-"},status:_?"Verified":"Pending",catatan:((re=l.pembayaran)==null?void 0:re.catatan)||l.catatan||"",_originalCategory:((Z=l.peruntukan)==null?void 0:Z.kategori)||""}}),b=S.filter(l=>l.status==="Verified").sort((l,I)=>new Date(I.timestamp).getTime()-new Date(l.timestamp).getTime()).slice(0,5);h(b);const T=S.filter(l=>l.id_donasi==="umum"&&l.status==="Verified"),$=T.reduce((l,I)=>l+(Number(I.nominal)||0),0),E=new Set(T.map(l=>{var I;return((I=l.donatur)==null?void 0:I.nama)||""})).size,F={id_donasi:"umum",kategori:"Operasional",judul:"Infaq Operasional Pesantren",gambar:["https://placehold.co/800x600/064e3b/ffffff?text=Infaq+Umum"],target:{waktu:"-",nominal:0},deskripsi:"Donasi ini akan dialokasikan oleh pengurus untuk kebutuhan operasional pesantren yang paling mendesak, seperti biaya listrik, air, kebersihan, dan pemeliharaan fasilitas umum.",terkumpul:$,donatur:E,sisa_hari:0,donor_list:T.sort((l,I)=>new Date(I.timestamp).getTime()-new Date(l.timestamp).getTime())},x=y.map(l=>{const I=S.filter(J=>{var ae;if(J.status!=="Verified")return!1;if(J.id_donasi===l.id_donasi)return!0;const U=((ae=J._originalCategory)==null?void 0:ae.toLowerCase())||"",re=l.kategori.toLowerCase(),Z=l.judul.toLowerCase();return!!(l.kategori==="Pembangunan"&&(U.includes("bangunan")||U.includes("gedung"))||l.kategori==="Wakaf"&&U.includes("wakaf")||Z.includes(U)&&U.length>3)}),_=I.sort((J,U)=>new Date(U.timestamp).getTime()-new Date(J.timestamp).getTime()),n=I.reduce((J,U)=>J+(Number(U.nominal)||0),0),v=new Set(I.map(J=>{var U;return((U=J.donatur)==null?void 0:U.nama)||""})).size,R=new Date(l.target.waktu).getTime(),W=new Date().getTime(),q=Math.ceil((R-W)/(1e3*60*60*24)),V=Array.isArray(l.gambar)?l.gambar:[l.gambar];return{...l,gambar:V,terkumpul:n,donatur:v>0?v:0,sisa_hari:q>0?q:0,donor_list:_}});k([F,...x])}catch(y){console.error("Gagal memuat Data Donasi:",y)}finally{p(!1)}})()},[o,t]),s.useEffect(()=>{if(i&&c.length>0){const P=c.find(y=>y.id_donasi===i.id_donasi);P&&(P.terkumpul!==i.terkumpul||P.donor_list.length!==i.donor_list.length)&&g(P)}},[c,i]),s.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[m]);const d=ja.useMemo(()=>{const P=c.reduce((z,j)=>z+j.terkumpul,0),y=c.reduce((z,j)=>z+j.donatur,0);return[{label:"Infaq Tersalurkan",nilai:P},{label:"Donatur Aktif",nilai:y},{label:"Program Aktif",nilai:c.length-1}]},[c]),C=()=>{navigator.clipboard.writeText(window.location.href).then(()=>{w(!0),setTimeout(()=>w(!1),2e3)})},L=()=>{m==="PAYMENT"?(i==null?void 0:i.id_donasi)==="umum"?(u("LIST"),window.location.hash="/donasi"):u("DETAIL"):m==="DETAIL"&&(u("LIST"),window.location.hash="/donasi")};return B?e.jsx(fe,{message:"Menyiapkan halaman Donasi",fullScreen:!0}):e.jsxs("div",{className:`min-h-screen bg-white font-sans overflow-hidden ${t?"pointer-events-none select-none":""}`,children:[m==="LIST"&&e.jsx(cs,{isSearchOpen:a,campaigns:c,recentTransactions:K,globalStats:d,onSelectCampaign:P=>{const y=P.judul.replace(/\s+/g,"+");window.location.hash=`/donasi/${y}`,g(P),u("DETAIL")},onDonateGeneral:P=>{g(P),u("PAYMENT"),window.scrollTo(0,0)}}),m==="DETAIL"&&i&&e.jsx(us,{campaign:i,onBack:L,onDonate:()=>u("PAYMENT"),onCopyLink:C,copyLinkState:M}),m==="PAYMENT"&&i&&e.jsx(za,{campaign:i,donasiInfo:f,onBack:L,onCopyLink:C,copyLinkState:M})]})},Sa=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a).replace("Rp","Rp "),bs=({isSearchOpen:a=!1})=>{const{fetchData:r,cache:t}=ge(),[o,c]=s.useState([]),[k,f]=s.useState([]),[D,B]=s.useState(!0),[p,m]=s.useState("Semua"),[u,i]=s.useState(""),[g,K]=s.useState(8),[h,M]=s.useState([]),[w,d]=s.useState(!1),[C,L]=s.useState(!1),[P,y]=s.useState("CATALOG"),[z,j]=s.useState(null),[N,A]=s.useState(null);s.useEffect(()=>{(async()=>{B(!0);try{let v=t.koperasiProduk;if(!v){const V=await r("koperasiProduk",G.getKoperasiProduk,"KoperasiPublic",!1,!1);v=Array.isArray(V)?V:[]}const R=v.map(V=>{const J=Math.random()*.04999999999999999+.1,U=V.harga_jual*(1+J),re=Math.ceil(U/100)*100,Z=(Math.random()*(4.8-4.3)+4.3).toFixed(1),ae=Math.floor(Math.random()*51)+300;return{...V,harga_coret:re,rating:Z,fake_terjual:ae}});c(R);const W=await r("koperasiTambahan",G.getKoperasiTambahan,"KoperasiPublic",!1,!1);f(Array.isArray(W)?W:[]);const q=await r("rekening",G.getRekening,"KoperasiPaymentInfo",!1,!1);j(Array.isArray(q)?q[0]:q)}catch(v){console.error("Gagal memuat produk:",v)}finally{B(!1)}})()},[r,t]);const S=s.useMemo(()=>{const n=new Set(o.map(v=>v.kategori));return["Semua",...Array.from(n)]},[o]),b=s.useMemo(()=>{let n=o;if(p!=="Semua"&&(n=n.filter(v=>v.kategori===p)),u){const v=u.toLowerCase();n=n.filter(R=>R.nama.toLowerCase().includes(v)||R.kategori.toLowerCase().includes(v))}return n},[o,p,u]),T=s.useMemo(()=>b.slice(0,g),[b,g]),$=n=>{if(n.stok<=0)return alert("Stok habis");M(v=>{const R=v.find(W=>W.product.id_produk===n.id_produk);return R?R.qty>=n.stok?(alert("Stok tidak mencukupi"),v):v.map(W=>W.product.id_produk===n.id_produk?{...W,qty:W.qty+1}:W):[...v,{product:n,qty:1}]}),L(!0),setTimeout(()=>L(!1),300)},E=n=>{if(n.stok<=0)return alert("Stok habis");$(n),d(!1),y("PAYMENT"),window.scrollTo(0,0)},F=(n,v)=>{M(R=>R.map(W=>{if(W.product.id_produk===n){const q=W.qty+v;return q>W.product.stok?(alert(`Stok hanya tersedia ${W.product.stok}`),W):{...W,qty:Math.max(1,q)}}return W}))},x=n=>{M(v=>v.filter(R=>R.product.id_produk!==n))},l=h.reduce((n,v)=>n+v.qty,0),I=h.reduce((n,v)=>n+v.qty*v.product.harga_jual,0),_=()=>{h.length!==0&&(d(!1),y("PAYMENT"),window.scrollTo(0,0))};if(D)return e.jsx(fe,{message:"Menyiapkan Toko...",fullScreen:!0});if(P==="PAYMENT"){const n={id_donasi:"KOP-ORDER",kategori:"Koperasi",judul:"Pembayaran Pesanan Koperasi",target:{nominal:I,waktu:"-"},terkumpul:0,donatur:0,sisa_hari:0,gambar:[],donor_list:[],deskripsi:""},v=h.map(R=>{var W;return{id:R.product.id_produk,name:R.product.nama,qty:R.qty,price:R.product.harga_jual,image:(W=R.product.gambar)==null?void 0:W[0]}});return e.jsx(za,{campaign:n,donasiInfo:z,onBack:()=>{y("CATALOG"),d(!0)},onCopyLink:()=>{},copyLinkState:!1,items:v})}return e.jsxs("div",{className:`min-h-screen bg-slate-50 font-sans ${w?"overflow-hidden":""}`,children:[e.jsx(ka,{src:N||"",isOpen:!!N,onClose:()=>A(null)}),e.jsxs("section",{className:`relative bg-emerald-950 text-white overflow-hidden rounded-b-[2.5rem] shadow-xl transition-all duration-700 persistent-header ${a?"pt-40 pb-16":"pt-28 pb-16"}`,children:[e.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none opacity-20 bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')]"}),e.jsx("div",{className:"absolute top-[-50%] right-[-10%] w-[500px] h-[500px] bg-yellow-500/10 rounded-full blur-[100px] pointer-events-none"}),e.jsxs("div",{className:"max-w-6xl mx-auto px-6 relative z-10 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-white/10 border border-white/20 backdrop-blur-md rounded-full mb-6",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-yellow-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black text-yellow-100 uppercase tracking-widest",children:"Kopontren Al-Burhani"})]}),e.jsxs("h1",{className:"font-serif text-3xl md:text-5xl font-bold tracking-tight mb-4 leading-tight",children:["Belanja Kebutuhan ",e.jsx("br",{}),e.jsx("span",{className:"text-emerald-400",children:"Mudah & Amanah"})]}),e.jsx("p",{className:"text-emerald-100/70 max-w-xl mx-auto text-sm leading-relaxed font-sans",children:"Menyediakan seragam, kitab, perlengkapan asrama, dan kebutuhan harian santri dengan harga terjangkau."})]})]}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 md:px-6 -mt-8 relative z-20 pb-24",children:[e.jsx("div",{className:"bg-white p-4 rounded-3xl shadow-lg border border-slate-100 mb-8 relative z-30 transition-all duration-300",children:e.jsxs("div",{className:"flex flex-col-reverse md:flex-row gap-4 justify-between items-center",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto w-full md:w-auto scrollbar-hide pb-1",children:S.map(n=>e.jsx("button",{onClick:()=>{m(n),K(8)},className:`px-4 py-3 rounded-xl text-xs font-bold whitespace-nowrap transition-all border ${p===n?"bg-emerald-600 text-white border-emerald-600 shadow-md":"bg-white text-slate-500 border-slate-200 hover:bg-slate-50 hover:text-slate-800"}`,children:n},n))}),e.jsxs("div",{className:"flex w-full md:w-auto gap-3 items-center flex-1 justify-end",children:[e.jsxs("div",{className:"relative w-full md:max-w-xs",children:[e.jsx("input",{type:"text",placeholder:"Cari produk...",value:u,onChange:n=>{i(n.target.value),K(8)},className:"w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-2xl text-sm font-medium focus:ring-2 focus:ring-emerald-500 outline-none transition font-sans"}),e.jsx("svg",{className:"w-4 h-4 text-slate-400 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsxs("button",{onClick:()=>d(!0),className:`relative shrink-0 w-12 h-12 flex items-center justify-center bg-emerald-600 text-white rounded-2xl shadow-lg hover:bg-emerald-700 transition-all ${C?"scale-110":"scale-100"}`,children:[e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),l>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-[10px] font-bold h-5 w-5 flex items-center justify-center rounded-full border-2 border-white shadow-sm",children:l})]})]})]})}),T.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6 animate-fade-in-up",children:T.map(n=>e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm hover:shadow-xl transition-all duration-300 group overflow-hidden flex flex-col h-full cursor-pointer",children:[e.jsxs("div",{className:"relative aspect-square bg-slate-100 overflow-hidden",children:[n.gambar&&n.gambar[0]?e.jsx("img",{src:n.gambar[0],alt:n.nama,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500",onError:v=>v.currentTarget.src=`https://placehold.co/400x400/e2e8f0/94a3b8?text=${n.nama.charAt(0)}`,onClick:()=>n.gambar&&n.gambar[0]&&A(n.gambar[0])}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-300",children:e.jsx("svg",{className:"w-12 h-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),n.stok<=0&&e.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-[2px] flex items-center justify-center",children:e.jsx("span",{className:"bg-red-500 text-white px-3 py-1 rounded-full text-xs font-bold uppercase tracking-widest shadow-lg transform -rotate-12 font-sans",children:"Habis"})}),e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx("span",{className:"bg-white/90 backdrop-blur text-slate-800 text-[9px] font-bold px-2 py-1 rounded shadow-sm border border-slate-200 uppercase tracking-wide font-sans",children:n.kategori})}),n.harga_coret&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("span",{className:"bg-red-500 text-white text-[9px] font-bold px-2 py-1 rounded shadow-sm uppercase tracking-wide font-sans",children:"Promo"})})]}),e.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[e.jsx("h3",{className:"font-bold text-slate-900 text-sm mb-1 leading-snug line-clamp-2 font-sans",title:n.nama,children:n.nama}),e.jsxs("div",{className:"flex items-center gap-1.5 mb-2 text-[10px]",children:[e.jsx("svg",{className:"w-3 h-3 text-yellow-400",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),e.jsx("span",{className:"font-bold text-slate-700 font-sans",children:n.rating}),e.jsx("span",{className:"text-slate-300 mx-0.5",children:"•"}),e.jsxs("span",{className:"text-slate-500 font-sans",children:["Terjual ",n.fake_terjual]})]}),e.jsxs("div",{className:"mb-3 flex flex-col items-start",children:[n.harga_coret&&e.jsx("span",{className:"text-xs text-slate-400 line-through font-medium mb-0.5 font-sans tabular-nums",children:Sa(n.harga_coret)}),e.jsx("span",{className:"text-emerald-700 font-sans font-bold text-base tabular-nums",children:Sa(n.harga_jual)})]}),e.jsxs("div",{className:"mt-auto pt-3 border-t border-slate-50 flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] text-slate-400 font-sans font-medium",children:["Stok: ",n.stok]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:v=>{v.stopPropagation(),$(n)},disabled:n.stok<=0,title:"Tambah ke Keranjang",className:"w-9 h-9 rounded-xl bg-emerald-50 hover:bg-emerald-100 text-emerald-600 flex items-center justify-center transition-all disabled:opacity-50 disabled:cursor-not-allowed border border-emerald-100",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),e.jsx("button",{onClick:v=>{v.stopPropagation(),E(n)},disabled:n.stok<=0,title:"Beli Langsung",className:"w-9 h-9 rounded-xl bg-emerald-600 hover:bg-emerald-700 text-white flex items-center justify-center transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-md shadow-emerald-200",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})})]})]})]})]},n.id_produk))}),b.length>g&&e.jsx("div",{className:"mt-8 text-center animate-fade-in",children:e.jsx("button",{onClick:()=>K(n=>n+8),className:"bg-white border-2 border-slate-100 text-slate-500 font-bold px-8 py-3 rounded-2xl hover:border-emerald-200 hover:text-emerald-700 hover:bg-emerald-50 transition-all shadow-sm",children:"Lihat Produk Lainnya"})})]}):e.jsxs("div",{className:"text-center py-20 bg-white rounded-3xl border border-dashed border-slate-200",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-300",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("p",{className:"text-slate-500 font-medium font-sans",children:"Produk tidak ditemukan."})]})]}),k.length>0&&e.jsx("section",{className:"bg-white py-16 border-t border-slate-100",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx("span",{className:"text-emerald-600 font-bold text-[10px] uppercase tracking-[0.2em] bg-emerald-50 px-3 py-1 rounded-full border border-emerald-100",children:"Kemandirian Ekonomi"}),e.jsx("h2",{className:"font-serif text-3xl md:text-4xl font-bold text-emerald-950 mt-3",children:"Ekosistem Bisnis Pesantren"}),e.jsx("p",{className:"text-slate-500 text-sm mt-3 max-w-2xl mx-auto leading-relaxed",children:"Unit usaha produktif yang dikelola oleh santri dan profesional sebagai laboratorium kewirausahaan."})]}),e.jsx("div",{className:"space-y-20",children:k.map((n,v)=>e.jsxs("div",{className:`flex flex-col ${v%2===0?"lg:flex-row":"lg:flex-row-reverse"} gap-8 lg:gap-16 items-center`,children:[e.jsxs("div",{className:"w-full lg:w-1/2 relative group",children:[e.jsx("div",{className:`absolute top-4 ${v%2===0?"-left-4 bg-yellow-400":"-right-4 bg-emerald-500"} w-full h-full rounded-[2.5rem] opacity-20 transition-transform group-hover:scale-105 duration-500`}),e.jsxs("div",{className:"relative rounded-[2.5rem] overflow-hidden shadow-2xl border-4 border-white aspect-video",children:[e.jsx("img",{src:n.gambar[0],alt:n.nama,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-110",onError:R=>R.currentTarget.src="https://placehold.co/800x600?text=Business+Unit"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),e.jsx("div",{className:"absolute bottom-6 left-6",children:e.jsx("span",{className:"px-3 py-1 bg-white/90 backdrop-blur rounded-lg text-[10px] font-bold uppercase tracking-wider text-slate-900 border border-slate-200",children:n.kategori})})]}),n.gambar.length>1&&e.jsx("div",{className:`absolute -bottom-6 ${v%2===0?"right-6":"left-6"} flex gap-3`,children:n.gambar.slice(1,3).map((R,W)=>e.jsx("div",{className:"w-16 h-16 rounded-xl border-4 border-white shadow-lg overflow-hidden cursor-zoom-in hover:scale-110 transition-transform",onClick:()=>A(R),children:e.jsx("img",{src:R,className:"w-full h-full object-cover",alt:"Detail"})},W))})]}),e.jsxs("div",{className:"w-full lg:w-1/2 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`w-8 h-1 rounded-full ${v%2===0?"bg-emerald-500":"bg-yellow-500"}`}),e.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:n.pasar})]}),e.jsx("h3",{className:"font-serif text-3xl font-bold text-slate-900 leading-tight",children:n.nama})]}),e.jsx("p",{className:"text-slate-600 text-sm leading-relaxed text-justify",children:n.deskripsi}),e.jsx("div",{className:"grid grid-cols-3 gap-4 border-y border-slate-100 py-6",children:n.statistik.map((R,W)=>e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg font-black text-emerald-800 font-sans",children:R.value}),e.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-wider",children:R.label})]},W))}),e.jsx("div",{children:e.jsxs("a",{href:n.tautan.url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 text-sm font-bold text-emerald-700 hover:text-emerald-900 hover:gap-3 transition-all group/link",children:[n.tautan.label,e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})]})})]})]},n.id))})]})}),w&&Pa.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[100] flex justify-end",children:[e.jsx("div",{className:"absolute inset-0 bg-slate-900/60 backdrop-blur-md transition-opacity",onClick:()=>d(!1)}),e.jsxs("div",{className:"relative w-full max-w-md bg-white h-full shadow-2xl flex flex-col animate-slide-in-right font-sans",children:[e.jsxs("div",{className:"p-5 border-b border-slate-100 flex justify-between items-center bg-emerald-950 text-white",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-sans font-bold text-xl",children:"Keranjang Belanja"}),e.jsxs("p",{className:"text-xs text-emerald-200",children:[l," Item dipilih"]})]}),e.jsx("button",{onClick:()=>d(!1),className:"p-2 hover:bg-white/10 rounded-full transition",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-5 custom-scrollbar",children:h.length>0?e.jsx("div",{className:"space-y-4",children:h.map(n=>e.jsxs("div",{className:"flex gap-4 p-3 bg-slate-50 rounded-2xl border border-slate-100",children:[e.jsx("div",{className:"w-16 h-16 bg-white rounded-xl overflow-hidden shrink-0 border border-slate-200",children:n.product.gambar&&n.product.gambar[0]?e.jsx("img",{src:n.product.gambar[0],alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-300",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),e.jsxs("div",{className:"flex-1 flex flex-col justify-between",children:[e.jsx("h4",{className:"font-bold text-slate-800 text-sm line-clamp-1",children:n.product.nama}),e.jsx("p",{className:"text-xs text-emerald-600 font-sans font-bold tabular-nums",children:Sa(n.product.harga_jual)}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"flex items-center bg-white rounded-lg border border-slate-200 h-8",children:[e.jsx("button",{onClick:()=>n.qty>1?F(n.product.id_produk,-1):x(n.product.id_produk),className:"px-2.5 h-full text-slate-500 hover:bg-slate-100 hover:text-rose-500 rounded-l-lg transition",children:"-"}),e.jsx("span",{className:"w-8 text-center text-xs font-bold text-slate-800",children:n.qty}),e.jsx("button",{onClick:()=>F(n.product.id_produk,1),className:"px-2.5 h-full text-slate-500 hover:bg-slate-100 hover:text-emerald-600 rounded-r-lg transition",children:"+"})]}),e.jsx("button",{onClick:()=>x(n.product.id_produk),className:"text-slate-400 hover:text-rose-500 p-1",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]},n.product.id_produk))}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-400 opacity-60",children:[e.jsx("svg",{className:"w-16 h-16 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),e.jsx("p",{className:"text-sm font-medium",children:"Keranjang masih kosong"})]})}),e.jsxs("div",{className:"p-6 border-t border-slate-100 bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("span",{className:"text-slate-500 text-sm font-medium",children:"Total Pesanan"}),e.jsx("span",{className:"text-xl font-sans font-bold text-slate-900 tabular-nums",children:Sa(I)})]}),e.jsxs("button",{onClick:_,disabled:h.length===0,className:"w-full py-4 bg-emerald-600 text-white rounded-xl font-bold shadow-lg shadow-emerald-600/30 hover:bg-emerald-700 transition flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"Checkout Pesanan"]})]})]})]}),document.body)]})},ct=({onBack:a})=>e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-6 animate-fade-in font-sans",children:e.jsxs("div",{className:"max-w-md w-full text-center",children:[e.jsxs("div",{className:"relative mb-8 flex justify-center",children:[e.jsx("h1",{className:"text-[150px] font-black text-emerald-950/5 leading-none select-none absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2",children:"404"}),e.jsx("div",{className:"relative z-10 w-40 h-40 bg-white rounded-full shadow-2xl flex items-center justify-center border-4 border-emerald-50",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-20 w-20 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),e.jsxs("div",{className:"space-y-4 relative z-10",children:[e.jsx("h2",{className:"text-3xl font-serif font-bold text-emerald-950",children:"Halaman Tidak Ditemukan"}),e.jsx("p",{className:"text-gray-500 text-sm leading-relaxed",children:"Mohon maaf, halaman yang Anda tuju mungkin telah dihapus, dipindahkan, atau alamat URL yang Anda masukkan salah."})]}),e.jsx("div",{className:"mt-10 flex flex-col gap-3",children:e.jsxs("button",{onClick:a,className:"w-full py-4 bg-emerald-900 text-white rounded-2xl font-bold shadow-xl shadow-emerald-900/20 hover:bg-emerald-800 hover:-translate-y-1 transition-all flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 01 1v4a1 1 0 001 1m-6 0h6"})}),"Kembali ke Beranda"]})}),e.jsx("div",{className:"mt-12",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 rounded-full border border-emerald-100",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-500 animate-pulse"}),e.jsx("span",{className:"text-[10px] font-bold text-emerald-700 uppercase tracking-widest",children:"Miftahul Huda Al-Burhani"})]})})]})}),mt=()=>{const a=()=>{window.location.reload()};return e.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-6 animate-fade-in font-sans",children:e.jsxs("div",{className:"max-w-md w-full text-center",children:[e.jsxs("div",{className:"relative mb-8 inline-block",children:[e.jsx("div",{className:"absolute inset-0 bg-rose-100 rounded-full animate-ping opacity-75"}),e.jsx("div",{className:"relative w-24 h-24 bg-white rounded-full shadow-xl flex items-center justify-center border-4 border-rose-50",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-10 w-10 text-rose-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M18.364 5.636a9 9 0 010 12.728m0 0l-2.829-2.829m2.829 2.829L21 21M15.536 8.464a5 5 0 010 7.072m0 0l-2.829-2.829m-4.243 2.829a4.978 4.978 0 01-1.414-2.83m-1.414 5.658a9 9 0 01-2.167-9.238m7.824 2.167a1 1 0 111.414 1.414m-1.414-1.414L3 3m8.293 8.293l1.414 1.414"})})})]}),e.jsxs("div",{className:"space-y-4 relative z-10",children:[e.jsx("h2",{className:"text-2xl font-serif font-bold text-slate-800",children:"Koneksi Terputus"}),e.jsx("p",{className:"text-gray-500 text-sm leading-relaxed max-w-xs mx-auto",children:"Sepertinya perangkat Anda sedang offline. Mohon periksa koneksi internet WiFi atau Data Seluler Anda."})]}),e.jsx("div",{className:"mt-10",children:e.jsxs("button",{onClick:a,className:"w-full py-4 bg-white border border-gray-200 text-slate-700 rounded-2xl font-bold shadow-sm hover:bg-gray-50 hover:border-gray-300 transition-all flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),"Coba Lagi"]})})]})})},fs="https://website.server-miftahulhuda.workers.dev/api",Mt=async(a,r)=>{try{const t=new AbortController,o=setTimeout(()=>t.abort(),15e3),c=await fetch(`${fs}/ai/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({history:a,message:r}),signal:t.signal});if(clearTimeout(o),!c.ok){if(c.status===503)return"Mohon maaf, saat ini antrian Ustadz AI sedang penuh. Mohon coba lagi dalam beberapa detik.";try{const f=await c.json();console.warn("AI Backend Error:",f)}catch{}throw new Error(`Server Error: ${c.status}`)}return(await c.json()).reply||"Maaf, saya tidak dapat memproses pertanyaan tersebut saat ini."}catch(t){return t.name==="AbortError"?"Koneksi ke Ustadz AI memakan waktu terlalu lama. Periksa koneksi internet Anda.":(console.error("AI Service Error:",t),"Assalamu'alaikum. Mohon maaf, terjadi gangguan koneksi ke server Ustadz AI. Silakan periksa internet Anda atau coba lagi nanti.")}},js=({onOpenFullChat:a})=>{const[r,t]=s.useState(!1),[o,c]=s.useState([{id:"welcome",role:"model",text:"Assalamu'alaikum. Saya SantriSmart Assistance. Ada yang dapat saya bantu mengenai informasi akademik atau fitur aplikasi?",timestamp:new Date}]),[k,f]=s.useState(""),[D,B]=s.useState(!1),p=s.useRef(null),[m,u]=s.useState(null),i=s.useRef(null),g=s.useRef({x:0,y:0}),K=s.useRef(!1);s.useEffect(()=>{r&&p.current&&p.current.scrollIntoView({behavior:"smooth"})},[o,r]);const h=L=>{if(!i.current)return;const P=i.current.getBoundingClientRect();g.current={x:L.clientX-P.left,y:L.clientY-P.top},u({top:P.top,left:P.left}),K.current=!0,document.addEventListener("mousemove",M),document.addEventListener("mouseup",w),L.preventDefault()},M=L=>{if(!K.current)return;const P=L.clientX-g.current.x,y=L.clientY-g.current.y;u({left:P,top:y})},w=()=>{K.current=!1,document.removeEventListener("mousemove",M),document.removeEventListener("mouseup",w)},d=async()=>{if(!k.trim()||D)return;const L={id:Date.now().toString(),role:"user",text:k,timestamp:new Date};c(P=>[...P,L]),f(""),B(!0);try{const P=o.map(j=>({role:j.role,text:j.text})),y=await Mt(P,L.text),z={id:(Date.now()+1).toString(),role:"model",text:y,timestamp:new Date};c(j=>[...j,z])}catch(P){console.error(P)}finally{B(!1)}},C=()=>{r||u(null),t(!r)};return e.jsxs(e.Fragment,{children:[r&&e.jsxs("div",{ref:i,className:`fixed z-[60] w-80 sm:w-96 bg-white rounded-3xl shadow-2xl border border-gray-100 overflow-hidden flex flex-col h-[500px] animate-fade-in-up ${m===null?"bottom-24 right-6":""}`,style:m?{top:m.top,left:m.left,margin:0}:{},children:[e.jsxs("div",{className:"bg-emerald-950 p-4 flex items-center justify-between text-white shadow-md cursor-move select-none",onMouseDown:h,children:[e.jsxs("div",{className:"flex items-center gap-3 pointer-events-none",children:[e.jsx("div",{className:"w-9 h-9 rounded-full bg-white/10 flex items-center justify-center border border-white/20",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-serif font-bold text-sm tracking-wide leading-none",children:"SantriSmart"}),e.jsx("p",{className:"text-[9px] font-sans uppercase tracking-widest opacity-80 mt-0.5",children:"Assistance"})]})]}),e.jsxs("div",{className:"flex items-center gap-1",onMouseDown:L=>L.stopPropagation(),children:[e.jsx("button",{onClick:a,className:"p-1.5 hover:bg-white/10 rounded-full transition-colors text-emerald-200 hover:text-white",title:"Buka Layar Penuh",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4"})})}),e.jsx("button",{onClick:()=>t(!1),className:"p-1.5 hover:bg-red-500/20 rounded-full transition-colors hover:text-red-300",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 bg-slate-50 space-y-4 custom-scrollbar",onMouseDown:L=>L.stopPropagation(),children:[o.map(L=>e.jsx("div",{className:`flex ${L.role==="user"?"justify-end":"justify-start"}`,children:e.jsx("div",{className:`max-w-[85%] rounded-2xl px-4 py-3 text-sm shadow-sm ${L.role==="user"?"bg-emerald-600 text-white rounded-tr-none":"bg-white text-gray-800 rounded-tl-none border border-gray-100"}`,children:L.text})},L.id)),D&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"bg-white border border-gray-100 rounded-2xl rounded-tl-none px-4 py-3 shadow-sm",children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce"}),e.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce delay-100"}),e.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce delay-200"})]})})}),e.jsx("div",{ref:p})]}),e.jsxs("div",{className:"p-3 bg-white border-t border-gray-100",onMouseDown:L=>L.stopPropagation(),children:[e.jsxs("div",{className:"relative flex items-center",children:[e.jsx("input",{value:k,onChange:L=>f(L.target.value),onKeyDown:L=>L.key==="Enter"&&d(),className:"w-full bg-gray-100 border-transparent focus:bg-white focus:border-emerald-500 focus:ring-4 focus:ring-emerald-500/10 rounded-full py-3 pl-5 pr-12 text-sm transition-all duration-300 outline-none",placeholder:"Tanya SantriSmart..."}),e.jsx("button",{onClick:d,disabled:!k.trim()||D,className:"absolute right-1.5 p-2 bg-emerald-600 text-white rounded-full hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-md hover:shadow-lg transform active:scale-95 flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),e.jsx("div",{className:"text-[9px] text-center text-gray-400 mt-2 font-medium",children:"SantriSmart dapat membuat kesalahan. Mohon verifikasi informasi penting."})]})]}),!r&&e.jsxs("button",{onClick:C,className:"fixed bottom-24 md:bottom-12 right-6 z-[60] group flex items-center justify-center w-14 h-14 bg-emerald-950 text-white rounded-full shadow-2xl hover:bg-black transition-all duration-300 hover:scale-110 active:scale-95 ring-4 ring-emerald-500/30",children:[e.jsx("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full border-2 border-white animate-pulse"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-7 h-7 group-hover:rotate-12 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})})]})]})},ks=({onNavigate:a})=>{const[r,t]=s.useState([{id:"welcome",role:"model",text:"Assalamu'alaikum. Saya SantriSmart Assistance. Selamat datang. Ada yang bisa saya bantu terkait informasi pondok, akademik, atau pendaftaran?",timestamp:new Date}]),[o,c]=s.useState(""),[k,f]=s.useState(!1),D=s.useRef(null);s.useEffect(()=>{var p;(p=D.current)==null||p.scrollIntoView({behavior:"smooth"})},[r]);const B=async()=>{if(!o.trim()||k)return;const p={id:Date.now().toString(),role:"user",text:o,timestamp:new Date};t(m=>[...m,p]),c(""),f(!0);try{const m=r.map(g=>({role:g.role,text:g.text})),u=await Mt(m,p.text),i={id:(Date.now()+1).toString(),role:"model",text:u,timestamp:new Date};t(g=>[...g,i])}catch(m){console.error(m)}finally{f(!1)}};return e.jsxs("div",{className:"flex flex-col h-[100dvh] pt-16 md:pt-20 bg-slate-50 font-sans",children:[e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6 space-y-6",children:[r.map(p=>e.jsx("div",{className:`flex ${p.role==="user"?"justify-end":"justify-start"}`,children:e.jsxs("div",{className:`flex gap-3 max-w-[85%] md:max-w-[70%] ${p.role==="user"?"flex-row-reverse":"flex-row"}`,children:[e.jsx("div",{className:`w-9 h-9 rounded-2xl flex items-center justify-center shrink-0 shadow-sm self-end mb-1 ${p.role==="user"?"bg-emerald-100 text-emerald-700":"bg-white border border-gray-100 text-emerald-900"}`,children:p.role==="user"?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"})})}),e.jsx("div",{className:`rounded-[1.2rem] px-5 py-3.5 text-sm md:text-base shadow-sm leading-relaxed ${p.role==="user"?"bg-emerald-600 text-white rounded-tr-none":"bg-white text-gray-800 rounded-tl-none border border-gray-100"}`,children:p.text})]})},p.id)),k&&e.jsx("div",{className:"flex justify-start",children:e.jsx("div",{className:"ml-12 bg-white border border-gray-100 rounded-2xl rounded-tl-none px-5 py-4 shadow-sm",children:e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce"}),e.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce delay-100"}),e.jsx("span",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full animate-bounce delay-200"})]})})}),e.jsx("div",{ref:D,className:"h-4"})]})}),e.jsx("div",{className:"shrink-0 bg-white border-t border-gray-200 shadow-[0_-10px_40px_rgba(0,0,0,0.03)] z-[110] sticky bottom-0",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 md:py-6",children:[e.jsxs("div",{className:"relative flex items-center gap-3",children:[e.jsx("input",{value:o,onChange:p=>c(p.target.value),onKeyDown:p=>p.key==="Enter"&&B(),className:"flex-1 bg-gray-50 border border-gray-200 focus:bg-white focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20 rounded-full py-3.5 pl-6 pr-4 text-sm md:text-base transition-all duration-300 outline-none shadow-inner",placeholder:"Ketik pesan Anda...",autoFocus:!0}),e.jsx("button",{onClick:B,disabled:!o.trim()||k,className:"p-3.5 bg-emerald-600 text-white rounded-full hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all shadow-lg shadow-emerald-600/30 transform active:scale-95 flex items-center justify-center shrink-0",children:e.jsx("svg",{className:"w-5 h-5 md:w-6 md:h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]}),e.jsx("p",{className:"text-[10px] text-center text-gray-400 mt-3 font-medium",children:"SantriSmart dapat memberikan informasi yang kurang tepat. Verifikasi informasi penting."})]})})]})},vs=a=>{const t=a.filter(c=>c.jenis==="teks").map(c=>c.isi).join(" ").split(/\s+/).length;return Math.ceil(t/200)},ws=a=>{try{const r=new Date(a);return isNaN(r.getTime())?a:new Intl.DateTimeFormat("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"}).format(r)}catch{return a}},ys=({news:a,onNewsClick:r})=>{const{fetchData:t,cache:o}=ge(),[c,k]=s.useState(!1),[f,D]=s.useState(0),[B,p]=s.useState([]);s.useEffect(()=>{(async()=>{let M=o.berita;if(!M)try{const w=await t("berita",G.getBerita,"DetailBerita",!1,!1);M=Array.isArray(w)?w:(w==null?void 0:w.item)||[]}catch{}if(M&&Array.isArray(M)){const w=M.filter(d=>d.judul!==a.judul).slice(0,4);p(w)}})(),window.scrollTo(0,0)},[a,o.berita,t]),s.useEffect(()=>{const h=()=>{const M=document.documentElement.scrollTop,w=document.documentElement.scrollHeight-document.documentElement.clientHeight,d=`${M/w}`;D(Number(d))};return window.addEventListener("scroll",h),()=>window.removeEventListener("scroll",h)},[]);const m=()=>{navigator.share?navigator.share({title:a.judul,text:`Baca berita ini: ${a.judul}`,url:window.location.href}).catch(console.error):navigator.clipboard.writeText(window.location.href).then(()=>{k(!0),setTimeout(()=>k(!1),2e3)})},u=h=>{if(!h)return"";const M=h.find(w=>w.jenis==="gambar");return M?M.isi:""},i=s.useMemo(()=>vs(a.konten||[]),[a]),g=u(a.konten),K=(h,M)=>{switch(h.jenis){case"gambar":return M===0&&h.isi===g?null:e.jsxs("figure",{className:"my-8 relative group",children:[e.jsx("img",{src:h.isi,alt:"Ilustrasi Berita",className:"w-full rounded-xl shadow-md border border-gray-100 object-cover"}),e.jsx("figcaption",{className:"mt-2 text-center text-xs text-gray-500 italic",children:"Dokumentasi PesantrenKu"})]},M);case"teks":const w=M===0||M===1&&a.konten[0].jenis==="gambar";return e.jsx("div",{className:`mb-6 text-slate-700 leading-8 text-[1.05rem] md:text-[1.125rem] font-serif tracking-wide ${w?"first-letter:text-5xl first-letter:font-bold first-letter:text-emerald-900 first-letter:float-left first-letter:mr-3 first-letter:mt-[-4px]":""}`,children:h.isi.split(`
`).map((d,C)=>e.jsx("p",{className:"mb-4 last:mb-0 text-justify md:text-left",children:d},C))},M);case"tombol":return e.jsx("div",{className:"my-8 p-6 bg-slate-50 rounded-2xl border border-slate-100 text-center",children:e.jsxs("a",{href:h.hyperlink||"#",target:"_blank",rel:"noreferrer",className:"inline-flex items-center gap-2 px-8 py-3.5 bg-emerald-900 text-white font-bold rounded-xl hover:bg-emerald-800 transition shadow-xl shadow-emerald-900/10 transform hover:-translate-y-1",children:[h.isi,e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})},M);default:return null}};return e.jsxs("div",{className:"bg-white min-h-screen font-sans",children:[e.jsx("div",{className:"fixed top-0 left-0 right-0 h-1 bg-gray-100 z-[60]",children:e.jsx("div",{className:"h-full bg-emerald-600 transition-all duration-150 ease-out",style:{width:`${f*100}%`}})}),e.jsx("header",{className:"fixed top-0 left-0 right-0 z-50 bg-white/95 backdrop-blur-md border-b border-gray-100 h-16 md:h-20 flex items-center transition-all",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:r,className:"p-2 -ml-2 rounded-full text-slate-500 hover:text-emerald-700 hover:bg-emerald-50 transition-colors flex items-center gap-2 group",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 md:h-6 md:w-6 transform group-hover:-translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),e.jsx("span",{className:"hidden md:inline font-bold text-sm",children:"Kembali"})]}),e.jsx("div",{className:"h-6 w-px bg-gray-200 hidden md:block"}),e.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>window.location.hash="/",children:[e.jsx(Oe,{className:"w-8 h-8"}),e.jsx("span",{className:"font-serif font-bold text-emerald-950 text-lg hidden sm:block",children:"Miftahul Huda"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:m,className:"p-2.5 rounded-full bg-gray-50 text-slate-600 hover:bg-emerald-50 hover:text-emerald-700 transition relative group",title:"Bagikan",children:[c&&e.jsx("span",{className:"absolute top-10 right-0 bg-black text-white text-[10px] px-2 py-1 rounded shadow-lg whitespace-nowrap",children:"Link Tersalin!"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.368 2.684 3 3 0 00-5.368-2.684z"})})]})})]})}),e.jsx("main",{className:"pt-24 md:pt-32 pb-20",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-12",children:[e.jsxs("article",{className:"lg:col-span-8",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-slate-400 uppercase tracking-wider mb-6",children:[e.jsx("span",{className:"hover:text-emerald-600 cursor-pointer",onClick:()=>window.location.hash="/",children:"Beranda"}),e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),e.jsx("span",{className:"hover:text-emerald-600 cursor-pointer",onClick:r,children:"Berita"}),e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),e.jsx("span",{className:"text-emerald-600",children:a.kategori})]}),e.jsx("h1",{className:"font-serif text-3xl md:text-5xl font-bold text-slate-900 leading-[1.15] mb-6",children:a.judul}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 md:gap-6 border-b border-gray-100 pb-8 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-700 font-bold border-2 border-white shadow-sm",children:a.penulis.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-slate-900 uppercase",children:"Penulis"}),e.jsx("p",{className:"text-sm text-slate-600 font-medium",children:a.penulis})]})]}),e.jsx("div",{className:"h-8 w-px bg-gray-200 hidden sm:block"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-slate-900 uppercase",children:"Tanggal"}),e.jsx("p",{className:"text-sm text-slate-600 font-medium",children:ws(a.timestamp||a.tanggal||"")})]}),e.jsx("div",{className:"h-8 w-px bg-gray-200 hidden sm:block"}),e.jsxs("div",{className:"flex items-center gap-1 text-slate-500 bg-slate-50 px-3 py-1.5 rounded-full",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("span",{className:"text-xs font-bold",children:[i," Menit Baca"]})]})]}),g&&e.jsxs("div",{className:"relative w-full aspect-video md:aspect-[21/9] rounded-2xl overflow-hidden shadow-lg mb-10 group",children:[e.jsx("img",{src:g,alt:a.judul,className:"w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"})]}),e.jsx("div",{className:"max-w-none text-gray-800",children:a.konten&&a.konten.map((h,M)=>K(h,M))}),a.tag&&a.tag.length>0&&e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-100",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-3",children:"Topik Terkait"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.tag.map((h,M)=>e.jsxs("span",{className:"px-3 py-1.5 bg-gray-50 border border-gray-200 rounded-full text-xs font-bold text-slate-600 hover:bg-emerald-50 hover:text-emerald-700 hover:border-emerald-200 transition cursor-default",children:["#",h]},M))})]}),e.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200 flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsx("p",{className:"text-sm font-bold text-slate-500 italic",children:"Bagikan kebaikan ini:"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:m,className:"flex items-center gap-2 px-5 py-2.5 bg-[#25D366] text-white rounded-lg hover:opacity-90 transition font-bold text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"WhatsApp"]}),e.jsx("button",{onClick:()=>{navigator.clipboard.writeText(window.location.href),k(!0),setTimeout(()=>k(!1),2e3)},className:"flex items-center gap-2 px-5 py-2.5 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition font-bold text-sm",children:c?"Tersalin":"Salin Link"})]})]})]}),e.jsx("aside",{className:"lg:col-span-4 relative",children:e.jsxs("div",{className:"sticky top-28 space-y-6",children:[e.jsxs("div",{className:"bg-emerald-900 rounded-2xl p-8 text-white text-center relative overflow-hidden shadow-xl",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-2xl -mr-10 -mt-10"}),e.jsx("h3",{className:"font-serif font-bold text-xl mb-2 relative z-10",children:"Pendaftaran Santri Baru"}),e.jsx("p",{className:"text-emerald-200 text-sm mb-6 relative z-10",children:"Bergabunglah bersama kami membangun generasi Rabbani."}),e.jsx("button",{onClick:()=>window.location.hash="/pendaftaran",className:"relative z-10 w-full py-3 bg-yellow-500 text-emerald-950 font-bold rounded-xl hover:bg-yellow-400 transition shadow-lg transform hover:-translate-y-0.5 active:scale-95",children:"Daftar Sekarang"})]}),e.jsxs("div",{className:"bg-slate-50 rounded-2xl p-6 border border-slate-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"font-serif font-bold text-xl text-slate-900",children:"Berita Lainnya"}),e.jsx("div",{className:"w-8 h-1 bg-emerald-500 rounded-full"})]}),e.jsxs("div",{className:"space-y-6",children:[B.map((h,M)=>e.jsxs("div",{className:"group cursor-pointer flex gap-4 items-start",onClick:()=>window.location.hash=`/berita/${h.judul.replace(/\s+/g,"+")}`,children:[e.jsx("div",{className:"w-20 h-20 rounded-xl overflow-hidden shrink-0 relative bg-gray-200",children:e.jsx("img",{src:u(h.konten),alt:"",className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-[10px] font-bold text-emerald-600 uppercase tracking-wider mb-1 block",children:h.kategori}),e.jsx("h4",{className:"font-bold text-slate-800 text-sm leading-snug group-hover:text-emerald-700 transition-colors line-clamp-2",children:h.judul}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:h.timestamp||h.tanggal})]})]},M)),B.length===0&&e.jsx("p",{className:"text-sm text-gray-500 italic",children:"Belum ada berita lainnya."})]}),e.jsx("button",{onClick:r,className:"w-full mt-8 py-3 text-sm font-bold text-slate-600 border border-slate-200 rounded-xl hover:bg-white hover:border-emerald-200 hover:text-emerald-700 transition",children:"Lihat Semua Berita"})]})]})})]})})})]})},At=({children:a,title:r,subTitle:t,activeModule:o,navItems:c,navGroups:k,onNavigate:f,onLogout:D,onNotificationClick:B,userName:p,userRole:m,userInitial:u,accentColor:i="emerald"})=>{const[g,K]=s.useState(!1),{fetchData:h,cache:M}=ge(),[w,d]=s.useState(null),[C,L]=s.useState([]),P=s.useRef(null),y={nama:"Miftahul Huda",sub_nama:"Al-Burhani",logo:"https://imgur.com/5wRslAz.png",copyright:"© 2024 Miftahul Huda Al-Burhani. Sistem Informasi Manajemen Pesantren Terpadu."};s.useEffect(()=>{(async()=>{if(M.dasar)d(Array.isArray(M.dasar)?M.dasar[0]:M.dasar);else try{const T=await h("dasar",G.getDasar,"LayoutPrivat",!1,!1);d(Array.isArray(T)?T[0]:T)}catch{}})()},[h,M.dasar]);const z=w||y;s.useEffect(()=>{c.forEach(b=>{b.subItems&&b.subItems.some($=>$.id===o)&&!C.includes(b.id)&&L($=>[...$,b.id])})},[o,c]),s.useEffect(()=>{P.current&&P.current.scrollTo({top:0,behavior:"smooth"})},[o]);const j=b=>{L(T=>T.includes(b)?T.filter($=>$!==b):[...T,b])},N=b=>{f(b.id),C.includes(b.id)||L(T=>[...T,b.id]),K(!1)},A=b=>{f(b),K(!1)},S=(b,T=!1)=>{var l,I;const $=o===b.id,E=b.subItems&&b.subItems.length>0,F=C.includes(b.id),x=E&&((l=b.subItems)==null?void 0:l.some(_=>_.id===o));return e.jsxs("div",{className:"mb-1",children:[e.jsxs("div",{className:`
                flex items-center justify-between rounded-xl transition-all duration-200 group relative
                ${$||x&&!F?`bg-${i}-50 text-${i}-700 shadow-sm`:T?"text-gray-500 hover:text-gray-900 hover:bg-gray-50":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}
                ${T?"pl-4 py-2.5 text-xs":"px-4 py-3 text-sm"}
            `,children:[e.jsxs("button",{onClick:()=>T?A(b.id):N(b),className:"flex-1 flex items-center gap-3 text-left focus:outline-none min-w-0",children:[e.jsx("span",{className:`shrink-0 transition-colors duration-200 ${$||x?`text-${i}-600`:"text-gray-400 group-hover:text-gray-600"}`,children:b.icon}),e.jsx("span",{className:`truncate font-sans tracking-wide ${T?"font-medium":"font-bold"}`,children:b.name})]}),E&&e.jsx("button",{onClick:_=>{_.stopPropagation(),j(b.id)},className:`p-1.5 rounded-lg hover:bg-black/5 transition-colors ${F||x?`text-${i}-600`:"text-gray-400"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-4 w-4 transition-transform duration-300 ${F?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}),$&&!T&&e.jsx("span",{className:`absolute left-0 top-1/2 -translate-y-1/2 h-8 w-1 rounded-r-full bg-${i}-600`})]}),E&&e.jsx("div",{className:`overflow-hidden transition-all duration-300 ease-in-out ${F?"max-h-96 opacity-100 mt-1":"max-h-0 opacity-0"}`,children:e.jsx("div",{className:"ml-4 border-l-2 border-gray-100 pl-2 space-y-1",children:(I=b.subItems)==null?void 0:I.map(_=>S(_,!0))})})]},b.id)};return e.jsxs("div",{className:"flex h-screen bg-[#F8F9FA] font-sans overflow-hidden",children:[g&&e.jsx("div",{className:"fixed inset-0 z-40 bg-black/40 backdrop-blur-sm lg:hidden transition-opacity",onClick:()=>K(!1)}),e.jsxs("aside",{className:`
          fixed inset-y-0 left-0 z-50 w-[70%] sm:w-72 bg-white border-r border-gray-200 flex flex-col transition-transform duration-300 ease-in-out shadow-2xl lg:shadow-none lg:static lg:translate-x-0 lg:w-72
          ${g?"translate-x-0":"-translate-x-full"}
        `,children:[e.jsxs("div",{className:"h-20 flex items-center px-6 gap-3 shrink-0 border-b border-gray-100",children:[e.jsx(Oe,{className:"w-9 h-9",src:z.logo}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"text-xl font-bold text-gray-900 tracking-tight font-sans leading-none truncate",children:z.nama}),e.jsx("span",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest mt-1 truncate",children:z.sub_nama})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-6 custom-scrollbar",children:k.map((b,T)=>e.jsxs("div",{className:"mb-6",children:[b.title&&e.jsx("div",{className:"px-4 mb-3 text-[10px] font-black text-gray-400 uppercase tracking-widest font-sans",children:b.title}),e.jsx("div",{className:"space-y-1",children:b.items.map($=>{const E=c.find(F=>F.id===$);return E?S(E):null})})]},T))}),e.jsx("div",{className:"p-4 border-t border-gray-100 shrink-0 bg-gray-50/30",children:e.jsxs("button",{onClick:D,className:"w-full flex items-center gap-3 px-4 py-3 rounded-xl text-sm font-bold text-red-600 hover:bg-red-50 transition-colors group",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-red-400 group-hover:text-red-600 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"})}),"Keluar Aplikasi"]})})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 h-full relative",children:[e.jsxs("header",{className:"h-20 bg-white/80 backdrop-blur-md border-b border-gray-200/80 flex items-center justify-between px-4 lg:px-8 shrink-0 sticky top-0 z-30 transition-all duration-300",children:[e.jsxs("div",{className:"flex items-center gap-4 min-w-0",children:[e.jsx("button",{onClick:()=>K(!g),className:"lg:hidden p-2 text-gray-500 hover:bg-gray-100 rounded-xl transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})})}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-black text-gray-900 leading-tight truncate tracking-tight",children:r}),e.jsx("p",{className:"text-xs md:text-sm text-gray-500 font-medium truncate",children:t})]})]}),e.jsxs("div",{className:"flex items-center gap-3 md:gap-5 shrink-0",children:[e.jsx("div",{className:"flex items-center gap-1 bg-gray-100/50 p-1 rounded-full border border-gray-200/50",children:B&&e.jsxs("button",{onClick:B,className:"relative p-2.5 text-gray-500 hover:text-gray-700 hover:bg-white rounded-full transition shadow-sm hover:shadow-md",title:"Notifikasi",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),e.jsx("span",{className:"absolute top-2.5 right-3 w-2 h-2 bg-red-500 rounded-full border border-white"})]})}),e.jsxs("div",{className:"hidden md:flex items-center gap-3 pl-3 border-l border-gray-200",children:[e.jsxs("div",{className:"text-right hidden lg:block",children:[e.jsx("p",{className:"text-sm font-bold text-gray-800 leading-none",children:p}),e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-wider text-emerald-600 mt-1 bg-emerald-50 px-2 py-0.5 rounded-md inline-block",children:m})]}),e.jsx("div",{className:`w-10 h-10 rounded-2xl flex items-center justify-center font-bold text-base text-white shadow-lg shadow-${i}-200 bg-${i}-600 border-2 border-white`,children:u})]})]})]}),e.jsx("main",{ref:P,className:"flex-1 overflow-y-auto p-4 lg:p-8 relative scroll-smooth",children:e.jsxs("div",{className:"max-w-[1600px] mx-auto animate-fade-in-up pb-10 min-h-full flex flex-col",children:[e.jsx("div",{className:"flex-1",children:a}),e.jsxs("footer",{className:"mt-12 pt-6 border-t border-gray-200 flex flex-col md:flex-row justify-between items-center text-center md:text-left gap-2 shrink-0",children:[e.jsx("p",{className:"text-[10px] font-medium text-gray-400",children:z.copyright}),e.jsx("div",{className:"flex gap-4",children:e.jsx("span",{className:"text-[10px] font-bold text-gray-300",children:"v1.1.0 SuperApp"})})]})]})})]})]})},na=({children:a})=>e.jsx("div",{className:"space-y-6 animate-fade-in font-sans pb-32 md:pb-12 relative min-h-[600px] text-slate-800 px-4 md:px-0 max-w-7xl mx-auto",children:a}),ra=({title:a,subtitle:r,action:t})=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6 pt-2 md:pt-0",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-slate-900 tracking-tight font-sans",children:a}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 font-medium font-sans",children:r})]}),t&&e.jsx("div",{className:"shrink-0 flex gap-3 self-start md:self-auto",children:t})]}),Ve=({children:a,className:r="",title:t,action:o,noPadding:c=!1})=>e.jsxs("div",{className:`bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden font-sans ${r}`,children:[(t||o)&&e.jsxs("div",{className:"px-5 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50",children:[t&&e.jsx("h3",{className:"font-bold text-slate-800 text-sm uppercase tracking-wide font-sans",children:t}),o&&e.jsx("div",{children:o})]}),e.jsx("div",{className:c?"":"p-5",children:a})]}),Va=({label:a,value:r,icon:t,color:o="emerald",desc:c,onClick:k})=>{const f={emerald:"bg-emerald-50 text-emerald-600 border-emerald-100",blue:"bg-blue-50 text-blue-600 border-blue-100",amber:"bg-amber-50 text-amber-600 border-amber-100",rose:"bg-rose-50 text-rose-600 border-rose-100",slate:"bg-slate-50 text-slate-600 border-slate-200",indigo:"bg-indigo-50 text-indigo-600 border-indigo-100"};return e.jsxs("div",{onClick:k,className:`p-5 rounded-2xl border transition-all duration-300 ${k?"cursor-pointer hover:shadow-md hover:-translate-y-1":""} bg-white border-slate-100 flex flex-col justify-between h-full relative overflow-hidden group font-sans`,children:[e.jsx("div",{className:`absolute top-0 right-0 w-16 h-16 rounded-bl-full opacity-20 transition-transform group-hover:scale-110 ${f[o].split(" ")[0]}`}),e.jsx("div",{className:"flex justify-between items-start mb-3 relative z-10",children:e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-lg shadow-sm ${f[o]}`,children:t})}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest text-slate-400 mb-1 font-sans",children:a}),e.jsx("h3",{className:"text-xl md:text-2xl font-bold text-slate-900 leading-none tracking-tight font-sans tabular-nums",children:r}),c&&e.jsx("p",{className:"text-xs text-slate-400 mt-1 font-medium line-clamp-1 font-sans",children:c})]})]})},Ns=({tabs:a,activeTab:r,onChange:t})=>e.jsx("div",{className:"flex bg-slate-100 p-1 rounded-xl overflow-x-auto scrollbar-hide w-full max-w-full font-sans",children:a.map(o=>e.jsxs("button",{onClick:()=>t(o.id),className:`
                    flex-1 px-4 py-2.5 rounded-lg text-xs font-bold transition-all whitespace-nowrap flex items-center justify-center gap-2 min-w-[100px]
                    ${r===o.id?"bg-white text-emerald-700 shadow-sm":"text-slate-500 hover:text-slate-700 hover:bg-slate-200/50"}
                `,children:[o.label,o.count!==void 0&&e.jsx("span",{className:`px-1.5 py-0.5 rounded-md text-[9px] ${r===o.id?"bg-emerald-100 text-emerald-700":"bg-slate-200 text-slate-600"}`,children:o.count})]},o.id))}),Ja=({status:a})=>{let r="bg-slate-100 text-slate-600 border-slate-200";const t=(a||"").toLowerCase();return["lunas","selesai","sukses","success","verified","aktif","terverifikasi","diterima"].some(o=>t.includes(o))?r="bg-emerald-50 text-emerald-700 border-emerald-200":["proses","menunggu","pending","cicil","sebagian"].some(o=>t.includes(o))?r="bg-amber-50 text-amber-700 border-amber-200":["gagal","batal","failed","tunggakan","belum","ditolak","keluar"].some(o=>t.includes(o))?r="bg-rose-50 text-rose-700 border-rose-200":["biru","info"].some(o=>t.includes(o))&&(r="bg-blue-50 text-blue-700 border-blue-200"),e.jsx("span",{className:`px-2.5 py-1 rounded-lg text-[10px] font-bold uppercase tracking-wider border font-sans ${r}`,children:a||"-"})},ma=({message:a="Data tidak ditemukan.",icon:r})=>e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-slate-400 bg-slate-50 rounded-2xl border border-dashed border-slate-200 font-sans",children:[e.jsx("div",{className:"w-12 h-12 bg-white rounded-full flex items-center justify-center mb-3 shadow-sm text-slate-300",children:r||e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"})})}),e.jsx("p",{className:"text-xs font-bold",children:a})]}),ve=({steps:a,tourId:r,onFinish:t,forceShow:o=!1})=>{const[c,k]=s.useState(0),[f,D]=s.useState(!1),[B,p]=s.useState(null),[m,u]=s.useState({w:window.innerWidth,h:window.innerHeight});s.useEffect(()=>{(!localStorage.getItem(`pesantrenku_tour_${r}`)||o)&&setTimeout(()=>D(!0),800)},[r,o]),s.useEffect(()=>{const L=()=>u({w:window.innerWidth,h:window.innerHeight});return window.addEventListener("resize",L),()=>window.removeEventListener("resize",L)},[]),s.useEffect(()=>{if(!f)return;const L=a[c];if(L.targetId){const P=document.getElementById(L.targetId);P?(P.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{const y=P.getBoundingClientRect();p(y)},500)):p(null)}else p(null)},[c,f,a,m]);const i=()=>{c<a.length-1?k(L=>L+1):K()},g=()=>{K()},K=()=>{localStorage.setItem(`pesantrenku_tour_${r}`,"true"),D(!1),t&&t()};if(!f)return null;const h=a[c],M=c===a.length-1,w=!B;let d={},C="";if(!w&&B){const P=h.position||"bottom";P==="bottom"?(d={top:B.bottom+12,left:B.left+B.width/2-150},C="bottom-full left-1/2 -translate-x-1/2 border-b-white"):P==="top"?(d={top:B.top-12-200,left:B.left+B.width/2-150},C="top-full left-1/2 -translate-x-1/2 border-t-white"):P==="right"?(d={top:B.top,left:B.right+12},C="right-full top-6 border-r-white"):P==="left"&&(d={top:B.top,left:B.left-12-300},C="left-full top-6 border-l-white"),typeof d.left=="number"&&(d.left<10&&(d.left=10),d.left+300>window.innerWidth&&(d.left=window.innerWidth-310))}return Pa.createPortal(e.jsxs("div",{className:"fixed inset-0 z-[9999] font-sans",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 transition-all duration-500"}),B&&e.jsx("div",{className:"absolute border-4 border-white/50 rounded-lg shadow-[0_0_0_9999px_rgba(0,0,0,0.6)] transition-all duration-500 ease-in-out pointer-events-none",style:{top:B.top-4,left:B.left-4,width:B.width+8,height:B.height+8,zIndex:10},children:e.jsxs("span",{className:"absolute -top-1 -right-1 flex h-3 w-3",children:[e.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-yellow-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-yellow-500"})]})}),e.jsxs("div",{className:`absolute bg-white p-6 rounded-2xl shadow-2xl transition-all duration-500 ease-in-out flex flex-col gap-4 z-20 ${w?"top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-md text-center":"w-[300px]"}`,style:w?{}:d,children:[!w&&e.jsx("div",{className:`absolute w-0 h-0 border-[8px] border-transparent ${C}`}),e.jsxs("div",{className:`flex items-center gap-3 ${w?"justify-center flex-col":""}`,children:[e.jsx("div",{className:"w-10 h-10 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center font-bold text-sm shrink-0 shadow-sm border border-emerald-200",children:c+1}),e.jsx("div",{className:"flex-1",children:e.jsx("h3",{className:"text-lg font-bold text-slate-900 leading-tight",children:h.title})})]}),e.jsx("p",{className:"text-sm text-slate-500 leading-relaxed",children:h.description}),e.jsxs("div",{className:"flex items-center justify-between pt-2 mt-2 border-t border-slate-100",children:[e.jsx("button",{onClick:g,className:"text-xs font-bold text-slate-400 hover:text-slate-600 px-2 py-1 rounded hover:bg-slate-50",children:"Lewati"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex gap-1 items-center mr-2",children:a.map((L,P)=>e.jsx("div",{className:`w-1.5 h-1.5 rounded-full transition-all ${P===c?"bg-emerald-500 w-3":"bg-slate-200"}`},P))}),e.jsxs("button",{onClick:i,className:"bg-emerald-600 text-white px-5 py-2 rounded-xl text-xs font-bold shadow-lg shadow-emerald-600/20 hover:bg-emerald-700 transition-all flex items-center gap-2",children:[M?"Selesai":"Lanjut",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M9 5l7 7-7 7"})})]})]})]})]})]}),document.body)},_s=[{title:"Ringkasan Dashboard",description:"Halaman utama untuk melihat status keuangan dan aktivitas santri secara cepat."},{targetId:"wali-stats-grid",title:"Info Saldo & Tagihan",description:"Cek sisa uang jajan santri dan tagihan SPP yang belum lunas di sini. Klik kartu untuk melihat detail.",position:"bottom"},{targetId:"wali-trx-list",title:"Aktivitas Terakhir",description:"Daftar transaksi terbaru santri, termasuk belanja di kantin atau setoran tabungan.",position:"top"},{targetId:"wali-quick-menu",title:"Menu Cepat",description:"Akses pintas ke fitur-fitur penting lainnya.",position:"left"}],ut=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(a).replace("Rp","Rp "),xt=({onNavigate:a,services:r})=>{const[t,o]=s.useState({saldo_utama:0,pemegang_kartu:""}),[c,k]=s.useState([]),[f,D]=s.useState(0),[B,p]=s.useState(null),[m,u]=s.useState(!0),[i,g]=s.useState("Santri");if(s.useEffect(()=>{(async()=>{u(!0);try{const M=localStorage.getItem("pesantrenku_user");let w="STR-2024-001";if(M)try{const $=JSON.parse(M);$.id_santri?w=$.id_santri:$.id_referensi&&(w=$.id_referensi),$.nama_santri&&g($.nama_santri)}catch($){console.error($)}const[d,C,L]=await Promise.all([G.getKeuanganTransaksi(),G.getKeuanganBiaya(),G.getWaliNotifikasi()]),P=Array.isArray(d)?d:[],y=Array.isArray(C)?C:[],z=P.filter($=>{var E;return((E=$.pihak)==null?void 0:E.id)===w}),N=z.filter($=>{var E,F,x,l;return((E=$.peruntukan)==null?void 0:E.pos)==="Jajan"||((F=$.peruntukan)==null?void 0:F.pos)==="Harian"||((l=(x=$.peruntukan)==null?void 0:x.kategori)==null?void 0:l.includes("Tabungan"))}).reduce(($,E)=>E.jenis==="masuk"?$+E.pembayaran.nominal:$-E.pembayaran.nominal,0),A=z.sort(($,E)=>new Date(E.tanggal).getTime()-new Date($.tanggal).getTime()).slice(0,5).map($=>{var E,F,x,l,I;return{id:$.id_transaksi,tanggal:new Date($.tanggal).toLocaleDateString("id-ID",{day:"numeric",month:"short"}),merchant:((E=$.pembayaran)==null?void 0:E.penerima)||"Sistem",deskripsi:((F=$.pembayaran)==null?void 0:F.catatan)||((x=$.peruntukan)==null?void 0:x.kategori),nominal:(l=$.pembayaran)==null?void 0:l.nominal,tipe:$.jenis,kategori:(I=$.peruntukan)==null?void 0:I.pos,status:$.status}});o({saldo_utama:N,pemegang_kartu:i}),k(A);let S=0;y.forEach($=>{z.filter(F=>{var x;return((x=F.peruntukan)==null?void 0:x.id_ref)===$.id_biaya}).reduce((F,x)=>F+x.pembayaran.nominal,0)<$.nominal&&S++}),D(S);const T=(Array.isArray(L)?L:[]).filter($=>$.verifikasi_akun.id_santri===w).map($=>({id:$.verifikasi_akun.id_notifikasi,kategori:$.notifikasi.kategori,judul:$.notifikasi.judul,pesan:$.notifikasi.pesan,waktu:$.notifikasi.waktu,dibaca:$.notifikasi.dibaca})).find($=>$.kategori==="info"||$.kategori==="academic");T&&p(T)}catch(M){console.error(M)}finally{u(!1)}})()},[i]),m)return e.jsx(fe,{message:"Menyiapkan Dashboard...",fullScreen:!0});const K=h=>h==="Jajan"||h==="Makan"?e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17"})}):h==="Topup"||h==="Tabungan"?e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})});return e.jsxs(na,{children:[e.jsx(ve,{tourId:"wali_dashboard",steps:_s}),e.jsx(ra,{title:"Dashboard Wali",subtitle:`Assalamu'alaikum, ${i}`}),e.jsxs("div",{id:"wali-stats-grid",className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx(Va,{label:"Saldo Tabungan",value:ut(t.saldo_utama),icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),color:"emerald",desc:"Sisa saldo uang saku",onClick:()=>a("buku_tabungan")}),e.jsx(Va,{label:"Tagihan Aktif",value:f>0?`${f} Item`:"Lunas",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),color:f>0?"rose":"blue",desc:f>0?"Segera selesaikan":"Tidak ada tunggakan",onClick:()=>a("buku_tagihan")}),e.jsx(Va,{label:"Total Transaksi",value:c.length,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"indigo",desc:"Riwayat aktivitas",onClick:()=>a("buku_tabungan")})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{id:"wali-trx-list",className:"lg:col-span-2",children:e.jsx(Ve,{title:"Aktivitas Terakhir",action:e.jsx("button",{onClick:()=>a("buku_tabungan"),className:"text-xs font-bold text-emerald-600 hover:text-emerald-700",children:"Lihat Semua"}),noPadding:!0,children:e.jsxs("div",{className:"divide-y divide-slate-100",children:[c.slice(0,5).map((h,M)=>e.jsxs("div",{className:"flex items-center justify-between p-4 hover:bg-slate-50 transition-colors group gap-3",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center shrink-0 ${h.tipe==="masuk"?"bg-emerald-100 text-emerald-600":"bg-rose-100 text-rose-600"}`,children:K(h.kategori)}),e.jsxs("div",{className:"overflow-hidden min-w-0",children:[e.jsx("p",{className:"text-sm font-bold text-slate-800 truncate font-sans",children:h.deskripsi||h.merchant}),e.jsxs("p",{className:"text-xs text-slate-400 font-medium font-sans",children:[h.tanggal," • ",h.kategori]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 shrink-0",children:[e.jsxs("p",{className:`text-sm font-bold font-sans tabular-nums whitespace-nowrap ${h.tipe==="masuk"?"text-emerald-600":"text-slate-800"}`,children:[h.tipe==="masuk"?"+":"-"," ",ut(h.nominal).replace("Rp ","")]}),e.jsx("div",{className:"shrink-0",children:e.jsx(Ja,{status:h.status||"Selesai"})})]})]},M)),c.length===0&&e.jsx(ma,{message:"Belum ada transaksi."})]})})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{id:"wali-quick-menu",children:e.jsx(Ve,{title:"Menu Cepat",children:e.jsx("div",{className:"grid grid-cols-3 gap-3",children:r.map(h=>e.jsxs("button",{onClick:()=>a(h.id),className:"flex flex-col items-center justify-center gap-2 p-3 rounded-xl border border-slate-100 hover:border-emerald-200 hover:bg-emerald-50/50 transition-all group",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center text-white shadow-sm bg-gradient-to-br ${h.gradient}`,children:h.icon}),e.jsx("span",{className:"text-[10px] font-bold text-slate-600 text-center leading-tight group-hover:text-emerald-700 font-sans",children:h.name})]},h.id))})})}),B&&e.jsxs("div",{className:"bg-gradient-to-br from-blue-500 to-indigo-600 rounded-2xl p-5 text-white shadow-lg relative overflow-hidden font-sans",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-white/10 rounded-full blur-xl -mr-8 -mt-8"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"bg-white/20 px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wider",children:"Info Terbaru"}),e.jsx("span",{className:"text-[10px] opacity-80",children:B.waktu})]}),e.jsx("h4",{className:"font-bold text-base mb-1 line-clamp-1",children:B.judul}),e.jsx("p",{className:"text-xs opacity-90 line-clamp-2 leading-relaxed",children:B.pesan}),e.jsx("button",{onClick:()=>a("notifikasi"),className:"mt-3 text-[10px] font-bold underline opacity-80 hover:opacity-100",children:"Baca Selengkapnya"})]})]})]})]})]})},Ss=[{title:"Profil Santri",description:"Halaman ini memuat biodata lengkap santri, data akademik, dan informasi orang tua."},{targetId:"wali-profil-card",title:"Identitas Utama",description:"Foto profil, Nama Lengkap, dan Status Akademik santri.",position:"bottom"},{targetId:"wali-profil-details",title:"Detail Data",description:"Anda dapat melihat dan memperbarui data alamat serta kontak orang tua di sini.",position:"top"}],qe=({label:a,value:r,id:t,isEditing:o,onChange:c,readOnly:k=!1})=>e.jsxs("div",{className:`p-3 rounded-xl border transition-all ${o&&!k?"bg-white border-emerald-500 ring-1 ring-emerald-500/10":"bg-slate-50 border-slate-100"}`,children:[e.jsx("label",{className:"text-[9px] font-bold uppercase tracking-widest text-slate-400 block mb-1 font-sans",children:a}),o&&!k?e.jsx("input",{type:"text",value:r,onChange:f=>c(t,f.target.value),className:"w-full bg-transparent border-none p-0 focus:ring-0 text-slate-900 font-bold text-sm outline-none placeholder-slate-300 font-sans"}):e.jsx("div",{className:`text-slate-900 font-bold text-sm break-words font-sans ${k?"opacity-70":""}`,children:r||"-"})]}),Ls=()=>{const[a,r]=s.useState(!1),[t,o]=s.useState(!0),[c,k]=s.useState(null),[f,D]=s.useState(null),[B,p]=s.useState(null);s.useEffect(()=>{(async()=>{var i,g,K,h,M,w,d,C,L,P,y,z,j,N;o(!0);try{const A=localStorage.getItem("pesantrenku_user");if(!A)throw new Error("Sesi habis.");const S=JSON.parse(A),b=S.id_santri||S.id_referensi,T=await G.getDatabaseSantri(),E=(Array.isArray(T)?T:[T]).find(F=>F.verifikasi_santri.id_santri===b);if(!E)throw new Error("Data santri tidak ditemukan.");k({nama_lengkap:E.data_santri.nama_lengkap,nisn:((i=E.data_akademik)==null?void 0:i.nisn)||"-",jenjang:((g=E.data_akademik)==null?void 0:g.jenjang)||"-",kelas:((K=E.data_akademik)==null?void 0:K.kelas)||"-",program:((h=E.data_akademik)==null?void 0:h.program_pesantren)||"-",tempat_lahir:E.data_santri.tempat_lahir,tgl_lahir:E.data_santri.tanggal_lahir,gender:E.data_santri.jenis_kelamin==="L"?"Laki-laki":"Perempuan",status_santri:((M=E.verifikasi_santri)==null?void 0:M.status)||"Aktif",ayah_nama:((d=(w=E.data_keluarga)==null?void 0:w.ayah)==null?void 0:d.nama)||"",ayah_wa:((L=(C=E.data_keluarga)==null?void 0:C.ayah)==null?void 0:L.no_wa)||"",ibu_nama:((y=(P=E.data_keluarga)==null?void 0:P.ibu)==null?void 0:y.nama)||"",alamat_jalan:((z=E.alamat_domisili)==null?void 0:z.jalan)||"",alamat_kota:((j=E.alamat_domisili)==null?void 0:j.kabupaten)||""}),D({foto:E.data_santri.foto_profil,kk:(N=E.dokumen_arsip)==null?void 0:N.kk})}catch(A){p(A.message||"Gagal memuat data.")}finally{o(!1)}})()},[]);const m=(u,i)=>k(g=>({...g,[u]:i}));return t?e.jsx("div",{className:"p-8 text-center text-slate-400 font-medium font-sans",children:"Memuat profil..."}):B?e.jsx("div",{className:"p-8 text-center text-rose-500 font-medium font-sans",children:B}):e.jsxs(na,{children:[e.jsx(ve,{tourId:"wali_profil",steps:Ss}),e.jsx(ra,{title:"Profil Santri",subtitle:"Informasi akademik dan biodata santri."}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 font-sans",children:[e.jsxs("div",{id:"wali-profil-card",className:"lg:col-span-1 space-y-6",children:[e.jsxs(Ve,{className:"text-center p-6",children:[e.jsx("div",{className:"w-32 h-32 mx-auto bg-slate-100 rounded-full border-4 border-white shadow-lg overflow-hidden mb-4 relative group",children:f!=null&&f.foto?e.jsx("img",{src:f.foto,alt:"Profil",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-300 text-4xl font-bold bg-slate-100",children:c.nama_lengkap.charAt(0)})}),e.jsx("h2",{className:"text-xl font-bold text-slate-900 leading-tight mb-1 font-sans",children:c.nama_lengkap}),e.jsx("p",{className:"text-sm text-emerald-600 font-medium mb-4 font-sans",children:c.nisn}),e.jsxs("div",{className:"flex justify-center gap-2 mb-4",children:[e.jsx("span",{className:"px-3 py-1 bg-emerald-50 text-emerald-700 text-[10px] font-bold uppercase rounded-full border border-emerald-100 font-sans",children:c.status_santri}),e.jsx("span",{className:"px-3 py-1 bg-blue-50 text-blue-700 text-[10px] font-bold uppercase rounded-full border border-blue-100 font-sans",children:c.jenjang})]})]}),e.jsx(Ve,{title:"Status Akademik",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between border-b border-slate-50 pb-2",children:[e.jsx("span",{className:"text-xs text-slate-500 font-sans",children:"Kelas"}),e.jsx("span",{className:"text-xs font-bold text-slate-800 font-sans",children:c.kelas})]}),e.jsxs("div",{className:"flex justify-between border-b border-slate-50 pb-2",children:[e.jsx("span",{className:"text-xs text-slate-500 font-sans",children:"Program"}),e.jsx("span",{className:"text-xs font-bold text-slate-800 font-sans",children:c.program})]})]})})]}),e.jsxs("div",{id:"wali-profil-details",className:"lg:col-span-2 space-y-6",children:[e.jsx(Ve,{title:"Biodata Diri",action:a?e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>r(!1),className:"text-xs font-bold text-slate-400 hover:text-slate-600 font-sans",children:"Batal"}),e.jsx("button",{onClick:()=>{r(!1),alert("Data tersimpan (Simulasi)")},className:"text-xs font-bold text-emerald-600 hover:text-emerald-700 font-sans",children:"Simpan"})]}):e.jsx("button",{onClick:()=>r(!0),className:"text-xs font-bold text-emerald-600 hover:text-emerald-700 font-sans",children:"Edit Data"}),children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(qe,{label:"Tempat Lahir",id:"tempat_lahir",value:c.tempat_lahir,isEditing:a,onChange:m}),e.jsx(qe,{label:"Tanggal Lahir",id:"tgl_lahir",value:c.tgl_lahir,isEditing:a,onChange:m}),e.jsx(qe,{label:"Jenis Kelamin",id:"gender",value:c.gender,isEditing:a,onChange:m})]})}),e.jsx(Ve,{title:"Alamat Domisili",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(qe,{label:"Jalan / Komplek",id:"alamat_jalan",value:c.alamat_jalan,isEditing:a,onChange:m}),e.jsx(qe,{label:"Kota / Kabupaten",id:"alamat_kota",value:c.alamat_kota,isEditing:a,onChange:m})]})}),e.jsx(Ve,{title:"Data Orang Tua",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(qe,{label:"Nama Ayah",id:"ayah_nama",value:c.ayah_nama,isEditing:a,onChange:m}),e.jsx(qe,{label:"WhatsApp Ayah",id:"ayah_wa",value:c.ayah_wa,isEditing:a,onChange:m}),e.jsx(qe,{label:"Nama Ibu",id:"ibu_nama",value:c.ibu_nama,isEditing:a,onChange:m})]})})]})]})]})},Cs=[{title:"Pusat Notifikasi",description:"Dapatkan informasi penting, pengumuman akademik, dan konfirmasi pembayaran di sini."},{targetId:"wali-notif-list",title:"Daftar Pesan",description:"Pesan terbaru akan muncul di bagian atas. Klik untuk membaca detail.",position:"top"}],Ms=()=>{const[a,r]=s.useState([]),[t,o]=s.useState(!0);s.useEffect(()=>{(async()=>{o(!0);try{const D=localStorage.getItem("pesantrenku_user");let B="STR-2024-001";D&&(B=JSON.parse(D).id_santri||B);const m=(await G.getWaliNotifikasi()).filter(u=>u.verifikasi_akun.id_santri===B).map(u=>({id:u.verifikasi_akun.id_notifikasi,kategori:u.notifikasi.kategori,judul:u.notifikasi.judul,pesan:u.notifikasi.pesan,waktu:u.notifikasi.waktu,dibaca:u.notifikasi.dibaca}));r(m)}catch(D){console.error(D)}finally{o(!1)}})()},[]);const c=f=>f==="payment"?e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):f==="academic"?e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13M12 6.253V13"})}):e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),k=f=>f==="payment"?"bg-emerald-100 text-emerald-600":f==="academic"?"bg-blue-100 text-blue-600":"bg-amber-100 text-amber-600";return e.jsxs(na,{children:[e.jsx(ve,{tourId:"wali_notifikasi",steps:Cs}),e.jsx(ra,{title:"Notifikasi",subtitle:"Pesan dan pemberitahuan penting.",action:e.jsx("button",{className:"text-xs font-bold text-emerald-600 hover:underline",children:"Tandai Dibaca"})}),t?e.jsx("div",{className:"py-20 text-center text-slate-400",children:"Memuat..."}):a.length>0?e.jsx("div",{id:"wali-notif-list",className:"space-y-3",children:a.map(f=>e.jsxs("div",{className:`p-4 rounded-2xl border transition-all flex gap-4 items-start ${f.dibaca?"bg-white border-slate-100":"bg-blue-50/40 border-blue-100"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center shrink-0 ${k(f.kategori)}`,children:c(f.kategori)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h4",{className:`text-sm font-bold ${f.dibaca?"text-slate-800":"text-slate-900"}`,children:f.judul}),e.jsx("span",{className:"text-[10px] text-slate-400 font-medium whitespace-nowrap ml-2",children:f.waktu})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1 leading-relaxed",children:f.pesan})]}),!f.dibaca&&e.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 mt-2 shrink-0"})]},f.id))}):e.jsx(ma,{message:"Tidak ada notifikasi baru."})]})},As=[{title:"Pengaturan Akun",description:"Kelola data pribadi dan keamanan akun Anda di sini."},{targetId:"wali-settings-card",title:"Profil Pengguna",description:"Informasi dasar akun Anda.",position:"bottom"},{targetId:"wali-settings-form",title:"Edit Data & Password",description:"Perbarui nama, email, dan kata sandi Anda secara berkala untuk keamanan.",position:"top"}],Ts=({id_akun:a,userName:r,userRole:t,userInitial:o,email:c="",accentColor:k="emerald"})=>{const[f,D]=s.useState({nama:r,email:c,password:""}),[B,p]=s.useState(!1);s.useEffect(()=>{D(g=>({...g,nama:r,email:c}))},[r,c]);const m=()=>{switch(k){case"cyan":return"bg-cyan-600 hover:bg-cyan-700 shadow-cyan-600/20";case"yellow":return"bg-amber-600 hover:bg-amber-700 shadow-amber-600/20";case"indigo":return"bg-indigo-600 hover:bg-indigo-700 shadow-indigo-600/20";default:return"bg-emerald-800 hover:bg-emerald-900 shadow-emerald-800/20"}},u=()=>{switch(k){case"cyan":return"bg-cyan-100 text-cyan-600";case"yellow":return"bg-amber-100 text-amber-600";case"indigo":return"bg-indigo-100 text-indigo-600";default:return"bg-emerald-100 text-emerald-800"}},i=()=>{alert("Simulasi: Perubahan disimpan.")};return e.jsxs("div",{className:"space-y-8 animate-fade-in max-w-5xl mx-auto pb-20 font-sans",children:[e.jsx(ve,{tourId:"wali_settings",steps:As}),e.jsxs("div",{id:"wali-settings-card",className:"bg-white p-8 rounded-[2.5rem] shadow-sm border border-gray-200 flex flex-col md:flex-row items-center gap-8 relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 right-0 w-48 h-48 opacity-10 rounded-bl-[4rem] ${u().split(" ")[0]}`}),e.jsxs("div",{className:"relative shrink-0",children:[e.jsx("div",{className:`w-32 h-32 rounded-[2rem] flex items-center justify-center font-bold text-4xl border-[6px] border-white shadow-2xl ${u()}`,children:o}),e.jsx("div",{className:`absolute -bottom-2 -right-2 text-white px-3 py-1 rounded-xl shadow-lg text-[10px] font-black uppercase tracking-widest ${m().split(" ")[0]}`,children:t})]}),e.jsxs("div",{className:"text-center md:text-left flex-1 relative z-10 space-y-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-sans font-bold text-gray-900 leading-tight",children:r}),e.jsx("p",{className:"text-emerald-600 font-medium text-sm mb-4 font-sans",children:"Status: Terverifikasi"})]}),e.jsx("div",{className:"flex flex-wrap justify-center md:justify-start gap-2 mt-2",children:e.jsxs("span",{className:"px-3 py-1.5 bg-gray-100 text-gray-600 rounded-lg text-[10px] font-bold uppercase tracking-wider border border-gray-200 flex items-center gap-2 font-sans",children:["ID: ",a||"-"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{id:"wali-settings-form",className:"lg:col-span-2 space-y-8",children:e.jsxs("div",{className:"bg-white p-8 rounded-[2.5rem] shadow-sm border border-gray-200",children:[e.jsx("div",{className:"flex justify-between items-center mb-8 border-b border-gray-100 pb-4",children:e.jsx("h3",{className:"font-sans font-bold text-xl text-gray-900",children:"Informasi Akun"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",value:a,readOnly:!0,className:"floating-input peer bg-gray-50 text-gray-500 cursor-not-allowed border-gray-200 font-sans",placeholder:" "}),e.jsx("label",{className:"floating-label font-sans",children:"ID Akun"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",value:t,readOnly:!0,className:"floating-input peer bg-gray-50 text-gray-500 cursor-not-allowed border-gray-200 font-sans",placeholder:" "}),e.jsx("label",{className:"floating-label font-sans",children:"Peran"})]})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",value:f.nama,onChange:g=>D({...f,nama:g.target.value}),className:"floating-input peer focus:bg-white font-bold text-gray-800 font-sans",placeholder:" "}),e.jsx("label",{className:"floating-label font-sans",children:"Nama Lengkap"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"email",value:f.email,onChange:g=>D({...f,email:g.target.value}),className:"floating-input peer font-bold text-gray-800 font-sans",placeholder:" "}),e.jsx("label",{className:"floating-label font-sans",children:"Email"})]}),e.jsxs("div",{className:"floating-group !mb-0 relative",children:[e.jsx("input",{type:B?"text":"password",value:f.password,onChange:g=>D({...f,password:g.target.value}),className:"floating-input peer font-bold text-gray-800 pr-10 font-sans",placeholder:" "}),e.jsx("label",{className:"floating-label font-sans",children:"Password"}),e.jsx("button",{type:"button",onClick:()=>p(!B),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-emerald-600 font-sans font-bold text-xs",children:B?"Hide":"Show"})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{onClick:i,className:`text-white font-bold py-3.5 px-8 rounded-2xl transition shadow-lg transform hover:-translate-y-1 active:scale-95 text-sm font-sans ${m()}`,children:"Simpan Perubahan"})})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white p-6 rounded-[2.5rem] shadow-sm border border-gray-200 h-full",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 border-b border-gray-100 pb-4",children:[e.jsx("div",{className:"p-2 bg-slate-100 rounded-xl text-slate-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-sans font-bold text-lg text-gray-900",children:"Catatan"}),e.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-wider font-sans",children:"Info Penting"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-xs text-gray-600 leading-relaxed font-sans",children:"Pastikan data email dan nomor telepon selalu aktif untuk menerima notifikasi penting terkait aktivitas santri."}),e.jsxs("div",{className:"bg-amber-50 p-4 rounded-xl border border-amber-100",children:[e.jsx("p",{className:"text-[10px] font-bold text-amber-700 uppercase mb-1 font-sans",children:"Perubahan Password"}),e.jsx("p",{className:"text-[10px] text-amber-600 leading-relaxed font-sans",children:"Jika Anda mengubah password, Anda harus login ulang di semua perangkat yang terhubung."})]})]})]})})]})]})},Ds=[{title:"Koperasi & Mart",description:"Belanja kebutuhan santri seperti kitab, seragam, dan perlengkapan harian secara online."},{targetId:"wali-kop-filter",title:"Kategori Produk",description:"Temukan barang dengan cepat melalui filter kategori.",position:"bottom"},{targetId:"wali-kop-search",title:"Cari & Keranjang",description:"Gunakan pencarian untuk menemukan item spesifik. Ikon keranjang akan muncul di sini.",position:"bottom"},{targetId:"wali-kop-grid",title:"Katalog Produk",description:"Klik produk untuk melihat detail, atau gunakan tombol 'Beli Langsung' untuk checkout cepat.",position:"top"}],da=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a).replace("Rp","Rp "),Bs=()=>{const{fetchData:a,cache:r}=ge(),[t,o]=s.useState([]),[c,k]=s.useState(!0),[f,D]=s.useState("Semua"),[B,p]=s.useState(""),[m,u]=s.useState([]),[i,g]=s.useState(!1),[K,h]=s.useState(!1),[M,w]=s.useState("CATALOG"),[d,C]=s.useState(null),[L,P]=s.useState(null),[y,z]=s.useState(null);s.useEffect(()=>{(async()=>{k(!0);try{let I=r.koperasiProduk;if(!I){const v=await a("koperasiProduk",G.getKoperasiProduk,"KoperasiWali",!1,!1);I=Array.isArray(v)?v:[]}const _=I.map(v=>{const R=Math.random()*.04999999999999999+.1,W=v.harga_jual*(1+R),q=Math.ceil(W/100)*100,V=(Math.random()*(4.8-4.3)+4.3).toFixed(1),J=Math.floor(Math.random()*51)+300;return{...v,harga_coret:q,rating:V,fake_terjual:J}});o(_);const n=await a("rekening",G.getRekening,"KoperasiPaymentInfo",!1,!1);P(Array.isArray(n)?n[0]:n)}catch(I){console.error("Gagal memuat produk:",I)}finally{k(!1)}})()},[a,r]);const j=s.useMemo(()=>{const l=new Set(t.map(I=>I.kategori));return["Semua",...Array.from(l)]},[t]),N=s.useMemo(()=>{let l=t;if(f!=="Semua"&&(l=l.filter(I=>I.kategori===f)),B){const I=B.toLowerCase();l=l.filter(_=>_.nama.toLowerCase().includes(I)||_.kategori.toLowerCase().includes(I))}return l},[t,f,B]),A=l=>{if(l.stok<=0)return alert("Stok habis");u(I=>{const _=I.find(n=>n.product.id_produk===l.id_produk);return _?_.qty>=l.stok?(alert("Stok tidak mencukupi"),I):I.map(n=>n.product.id_produk===l.id_produk?{...n,qty:n.qty+1}:n):[...I,{product:l,qty:1}]}),h(!0),setTimeout(()=>h(!1),300)},S=l=>{C(l),w("DETAIL"),window.scrollTo(0,0)},b=l=>{if(l.stok<=0)return alert("Stok habis");A(l),g(!1),w("PAYMENT"),window.scrollTo(0,0)},T=(l,I)=>{u(_=>_.map(n=>{if(n.product.id_produk===l){const v=n.qty+I;return v>n.product.stok?(alert(`Stok hanya tersedia ${n.product.stok}`),n):{...n,qty:Math.max(1,v)}}return n}))},$=l=>{u(I=>I.filter(_=>_.product.id_produk!==l))},E=m.reduce((l,I)=>l+I.qty,0),F=m.reduce((l,I)=>l+I.qty*I.product.harga_jual,0),x=()=>{m.length!==0&&(g(!1),w("PAYMENT"),window.scrollTo(0,0))};if(c)return e.jsx(fe,{message:"Menyiapkan Toko...",fullScreen:!1});if(M==="DETAIL"&&d)return e.jsxs("div",{className:"font-sans animate-fade-in-up",children:[e.jsxs("button",{onClick:()=>w("CATALOG"),className:"flex items-center gap-2 text-slate-500 hover:text-emerald-600 mb-6 group transition-colors px-4 md:px-0",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center group-hover:border-emerald-200 shadow-sm",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 transform group-hover:-translate-x-0.5 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7 7-7m8 14l-7-7 7-7"})})}),e.jsx("span",{className:"font-bold text-sm",children:"Kembali ke Katalog"})]}),e.jsx("div",{className:"bg-white rounded-[2rem] border border-slate-200 shadow-xl overflow-hidden relative mb-24 md:mb-0",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2",children:[e.jsxs("div",{className:"relative aspect-square md:aspect-[4/3] bg-slate-100 overflow-hidden group",children:[d.gambar&&d.gambar[0]?e.jsx("img",{src:d.gambar[0],alt:d.nama,className:"w-full h-full object-cover cursor-zoom-in",onClick:()=>d.gambar&&z(d.gambar[0])}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-300",children:e.jsx("svg",{className:"w-20 h-20",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("span",{className:"bg-white/90 backdrop-blur text-slate-800 text-xs font-bold px-3 py-1.5 rounded-full shadow-sm uppercase tracking-wide border border-slate-200",children:d.kategori})})]}),e.jsxs("div",{className:"p-6 md:p-10 flex flex-col h-full",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"font-serif font-bold text-2xl md:text-4xl text-slate-900 leading-tight mb-2",children:d.nama}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-500",children:[e.jsxs("div",{className:"flex items-center gap-1 text-yellow-500",children:[e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),e.jsx("span",{className:"font-bold text-slate-700",children:d.rating})]}),e.jsx("span",{className:"w-1 h-1 bg-slate-300 rounded-full"}),e.jsxs("span",{children:["Terjual ",d.fake_terjual]}),e.jsx("span",{className:"w-1 h-1 bg-slate-300 rounded-full"}),e.jsx("span",{className:d.stok>0?"text-emerald-600 font-bold":"text-rose-600 font-bold",children:d.stok>0?`Stok: ${d.stok}`:"Stok Habis"})]})]}),e.jsxs("div",{className:"space-y-4 mb-8 flex-1",children:[e.jsxs("div",{children:[d.harga_coret&&e.jsx("p",{className:"text-slate-400 line-through text-sm font-medium mb-1",children:da(d.harga_coret)}),e.jsx("p",{className:"text-4xl font-sans font-black text-emerald-700 tracking-tight tabular-nums",children:da(d.harga_jual)})]}),e.jsxs("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-100 text-sm text-slate-600 leading-relaxed",children:[e.jsx("p",{className:"font-bold text-slate-800 mb-1 uppercase text-[10px] tracking-widest",children:"Deskripsi"}),"Produk berkualitas dari Koperasi Pesantren. Dijamin halal, amanah, dan mendukung kemandirian ekonomi pesantren."]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 p-3 rounded-xl border border-blue-100 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white rounded-lg text-blue-600 shadow-sm",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-blue-600 font-bold uppercase",children:"Kualitas"}),e.jsx("p",{className:"text-xs font-bold text-slate-700",children:"Terjamin"})]})]}),e.jsxs("div",{className:"bg-purple-50 p-3 rounded-xl border border-purple-100 flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-white rounded-lg text-purple-600 shadow-sm",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-purple-600 font-bold uppercase",children:"Pengiriman"}),e.jsx("p",{className:"text-xs font-bold text-slate-700",children:"Cepat"})]})]})]})]}),e.jsxs("div",{className:"hidden md:flex gap-4 pt-6 border-t border-slate-100",children:[e.jsxs("button",{onClick:()=>A(d),disabled:d.stok<=0,className:"flex-1 py-4 bg-white border-2 border-emerald-600 text-emerald-700 font-bold rounded-xl hover:bg-emerald-50 transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),"Tambah Keranjang"]}),e.jsx("button",{onClick:()=>b(d),disabled:d.stok<=0,className:"flex-1 py-4 bg-emerald-600 text-white font-bold rounded-xl shadow-lg shadow-emerald-600/30 hover:bg-emerald-700 hover:-translate-y-1 transition-all flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:"Beli Langsung"})]})]})]})}),e.jsxs("div",{className:"md:hidden fixed bottom-0 left-0 right-0 p-4 bg-white border-t border-slate-200 shadow-[0_-5px_20px_rgba(0,0,0,0.05)] z-40 flex gap-3",children:[e.jsx("button",{onClick:()=>A(d),disabled:d.stok<=0,className:"flex-1 py-3 bg-white border border-emerald-200 text-emerald-700 font-bold rounded-xl hover:bg-emerald-50 transition-all flex items-center justify-center gap-2 disabled:opacity-50",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsx("button",{onClick:()=>b(d),disabled:d.stok<=0,className:"flex-[2] py-3 bg-emerald-600 text-white font-bold rounded-xl shadow-md hover:bg-emerald-700 transition-all disabled:opacity-50",children:"Beli Langsung"})]})]});if(M==="PAYMENT"){const l={id_donasi:"KOP-ORDER-WALI",kategori:"Koperasi Wali",judul:"Pembayaran Belanja Kebutuhan Santri",target:{nominal:F,waktu:"-"},terkumpul:0,donatur:0,sisa_hari:0,gambar:[],donor_list:[],deskripsi:""},I=m.map(_=>{var n;return{id:_.product.id_produk,name:_.product.nama,qty:_.qty,price:_.product.harga_jual,image:(n=_.product.gambar)==null?void 0:n[0]}});return e.jsx("div",{className:"bg-white min-h-[80vh] rounded-[2rem] overflow-hidden shadow-sm border border-slate-200 font-sans animate-fade-in-up",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>{w("CATALOG"),g(!0)},className:"absolute top-4 left-4 z-50 p-2 bg-white rounded-full shadow-md text-slate-600 hover:text-emerald-600 transition",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx(za,{campaign:l,donasiInfo:L,onBack:()=>{w("CATALOG"),g(!0)},onCopyLink:()=>{},copyLinkState:!1,items:I})]})})}return e.jsxs("div",{className:`font-sans ${i?"overflow-hidden":""}`,children:[e.jsx(ka,{src:y||"",isOpen:!!y,onClose:()=>z(null)}),e.jsx(ve,{tourId:"wali_koperasi",steps:Ds}),e.jsxs("div",{className:"relative bg-emerald-950 text-white overflow-hidden rounded-[2.5rem] shadow-xl mb-8",children:[e.jsx("div",{className:"absolute inset-0 z-0 pointer-events-none opacity-20 bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')]"}),e.jsx("div",{className:"absolute top-[-50%] right-[-10%] w-[400px] h-[400px] bg-yellow-500/10 rounded-full blur-[80px] pointer-events-none"}),e.jsxs("div",{className:"relative z-10 px-8 py-10 md:py-14 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 px-3 py-1 bg-white/10 border border-white/20 backdrop-blur-md rounded-full mb-4",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-yellow-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-[10px] font-black text-yellow-100 uppercase tracking-widest font-sans",children:"Koperasi Wali Santri"})]}),e.jsxs("h1",{className:"font-sans text-3xl md:text-4xl font-bold tracking-tight mb-3 leading-tight",children:["Belanja Keperluan ",e.jsx("br",{}),e.jsx("span",{className:"text-emerald-400",children:"Ananda Tercinta"})]}),e.jsx("p",{className:"text-emerald-100/70 max-w-lg mx-auto text-sm leading-relaxed font-sans",children:"Penuhi kebutuhan kitab, seragam, dan perlengkapan asrama santri langsung dari aplikasi. Amanah dan Terpercaya."})]})]}),e.jsxs("div",{className:"relative z-20 pb-24",children:[e.jsx("div",{className:"bg-white p-4 rounded-3xl shadow-sm border border-slate-200 mb-8 relative z-30 transition-all duration-300",children:e.jsxs("div",{className:"flex flex-col-reverse md:flex-row gap-4 justify-between items-center",children:[e.jsx("div",{id:"wali-kop-filter",className:"flex gap-2 overflow-x-auto w-full md:w-auto scrollbar-hide pb-1",children:j.map(l=>e.jsx("button",{onClick:()=>D(l),className:`px-4 py-2.5 rounded-xl text-xs font-bold whitespace-nowrap transition-all border font-sans ${f===l?"bg-emerald-600 text-white border-emerald-600 shadow-md":"bg-slate-50 text-slate-500 border-slate-100 hover:bg-slate-100 hover:text-slate-800"}`,children:l},l))}),e.jsxs("div",{id:"wali-kop-search",className:"flex w-full md:w-auto gap-3 items-center flex-1 justify-end",children:[e.jsxs("div",{className:"relative w-full md:max-w-xs",children:[e.jsx("input",{type:"text",placeholder:"Cari produk...",value:B,onChange:l=>p(l.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-slate-50 border border-slate-200 rounded-xl text-sm font-medium focus:ring-2 focus:ring-emerald-500 outline-none transition font-sans"}),e.jsx("svg",{className:"w-4 h-4 text-slate-400 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsxs("button",{onClick:()=>g(!0),className:`relative shrink-0 w-11 h-11 flex items-center justify-center bg-emerald-600 text-white rounded-xl shadow-lg hover:bg-emerald-700 transition-all ${K?"scale-110":"scale-100"}`,children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"})}),E>0&&e.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-[9px] font-bold h-4 w-4 flex items-center justify-center rounded-full border border-white shadow-sm font-sans",children:E})]})]})]})}),e.jsx("div",{id:"wali-kop-grid",children:N.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6 animate-fade-in-up",children:N.map(l=>e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-100 shadow-sm hover:shadow-xl transition-all duration-300 group overflow-hidden flex flex-col h-full cursor-pointer relative",onClick:()=>S(l),children:[e.jsxs("div",{className:"relative aspect-square bg-slate-50 overflow-hidden",children:[l.gambar&&l.gambar[0]?e.jsx("img",{src:l.gambar[0],alt:l.nama,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500",onError:I=>I.currentTarget.src=`https://placehold.co/400x400/e2e8f0/94a3b8?text=${l.nama.charAt(0)}`}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-300",children:e.jsx("svg",{className:"w-10 h-10",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),l.stok<=0&&e.jsx("div",{className:"absolute inset-0 bg-white/60 backdrop-blur-[2px] flex items-center justify-center",children:e.jsx("span",{className:"bg-red-500 text-white px-3 py-1 rounded-full text-xs font-bold uppercase tracking-widest shadow-lg transform -rotate-12 font-sans",children:"Habis"})}),e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx("span",{className:"bg-white/90 backdrop-blur text-slate-700 text-[9px] font-bold px-2 py-1 rounded shadow-sm border border-slate-200 uppercase tracking-wide font-sans",children:l.kategori})}),l.harga_coret&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("span",{className:"bg-red-500 text-white text-[9px] font-bold px-2 py-1 rounded shadow-sm uppercase tracking-wide font-sans",children:"Promo"})})]}),e.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[e.jsx("h3",{className:"font-bold text-slate-900 text-sm mb-1 leading-snug line-clamp-2 font-sans",title:l.nama,children:l.nama}),e.jsxs("div",{className:"flex items-center gap-1.5 mb-2 text-[10px]",children:[e.jsx("svg",{className:"w-3 h-3 text-yellow-400",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})}),e.jsx("span",{className:"font-bold text-slate-700 font-sans",children:l.rating}),e.jsx("span",{className:"text-slate-300 mx-0.5",children:"•"}),e.jsxs("span",{className:"text-slate-500 font-sans",children:["Terjual ",l.fake_terjual]})]}),e.jsxs("div",{className:"mb-3 flex flex-col items-start",children:[l.harga_coret&&e.jsx("span",{className:"text-[10px] text-slate-400 line-through font-medium mb-0.5 font-sans tabular-nums",children:da(l.harga_coret)}),e.jsx("span",{className:"text-emerald-700 font-sans font-bold text-base tabular-nums",children:da(l.harga_jual)})]}),e.jsxs("div",{className:"mt-auto pt-3 border-t border-slate-50 flex items-center justify-between",children:[e.jsxs("span",{className:"text-[10px] text-slate-400 font-sans font-medium",children:["Stok: ",l.stok]}),e.jsx("span",{className:"text-[10px] font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded",children:"Detail"})]})]})]},l.id_produk))}):e.jsxs("div",{className:"text-center py-20 bg-white rounded-3xl border border-dashed border-slate-200",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-50 rounded-full flex items-center justify-center mx-auto mb-4 text-slate-300",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),e.jsx("p",{className:"text-slate-500 font-medium font-sans",children:"Produk tidak ditemukan."})]})})]}),i&&e.jsxs("div",{className:"fixed inset-0 z-[70] flex justify-end",children:[e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity",onClick:()=>g(!1)}),e.jsxs("div",{className:"relative w-full max-w-md bg-white h-full shadow-2xl flex flex-col animate-slide-in-right font-sans",children:[e.jsxs("div",{className:"p-5 border-b border-slate-100 flex justify-between items-center bg-emerald-950 text-white",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"font-sans font-bold text-xl",children:"Keranjang Belanja"}),e.jsxs("p",{className:"text-xs text-emerald-200",children:[E," Item dipilih"]})]}),e.jsx("button",{onClick:()=>g(!1),className:"p-2 hover:bg-white/10 rounded-full transition",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-5 custom-scrollbar",children:m.length>0?e.jsx("div",{className:"space-y-4",children:m.map(l=>e.jsxs("div",{className:"flex gap-4 p-3 bg-slate-50 rounded-2xl border border-slate-100",children:[e.jsx("div",{className:"w-16 h-16 bg-white rounded-xl overflow-hidden shrink-0 border border-slate-200",children:l.product.gambar&&l.product.gambar[0]?e.jsx("img",{src:l.product.gambar[0],alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-slate-300",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})})}),e.jsxs("div",{className:"flex-1 flex flex-col justify-between",children:[e.jsx("h4",{className:"font-bold text-slate-800 text-sm line-clamp-1",children:l.product.nama}),e.jsx("p",{className:"text-xs text-emerald-600 font-sans font-bold tabular-nums",children:da(l.product.harga_jual)}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsxs("div",{className:"flex items-center bg-white rounded-lg border border-slate-200 h-8",children:[e.jsx("button",{onClick:()=>l.qty>1?T(l.product.id_produk,-1):$(l.product.id_produk),className:"px-2.5 h-full text-slate-500 hover:bg-slate-100 hover:text-rose-500 rounded-l-lg transition",children:"-"}),e.jsx("span",{className:"w-8 text-center text-xs font-bold text-slate-800",children:l.qty}),e.jsx("button",{onClick:()=>T(l.product.id_produk,1),className:"px-2.5 h-full text-slate-500 hover:bg-slate-100 hover:text-emerald-600 rounded-r-lg transition",children:"+"})]}),e.jsx("button",{onClick:()=>$(l.product.id_produk),className:"text-slate-400 hover:text-rose-500 p-1",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]},l.product.id_produk))}):e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-slate-400 opacity-60",children:[e.jsx("svg",{className:"w-16 h-16 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),e.jsx("p",{className:"text-sm font-medium",children:"Keranjang masih kosong"})]})}),e.jsxs("div",{className:"p-6 border-t border-slate-100 bg-white",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("span",{className:"text-slate-500 text-sm font-medium",children:"Total Pesanan"}),e.jsx("span",{className:"text-xl font-sans font-bold text-slate-900 tabular-nums",children:da(F)})]}),e.jsxs("button",{onClick:x,disabled:m.length===0,className:"w-full py-4 bg-emerald-600 text-white rounded-xl font-bold shadow-lg shadow-emerald-600/30 hover:bg-emerald-700 transition flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:[e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})}),"Checkout"]})]})]})]})]})},Is=[{title:"Program Donasi & Wakaf",description:"Salurkan sedekah terbaik Anda untuk mendukung pembangunan dan operasional pesantren."},{targetId:"wali-donasi-tabs",title:"Riwayat Donasi",description:"Klik tab 'Riwayat Saya' untuk melihat catatan infaq yang pernah Anda berikan.",position:"bottom"},{targetId:"wali-donasi-content",title:"Pilih Program",description:"Pilih kampanye yang ingin Anda bantu. Klik untuk melihat detail dan cara berdonasi.",position:"top"}],pa=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a).replace("Rp","Rp "),ht=a=>a>=1e9?(a/1e9).toFixed(1).replace(/\.0$/,"")+" M":a>=1e6?(a/1e6).toFixed(1).replace(/\.0$/,"")+" Jt":(a/1e3).toFixed(0)+" rb",Ps=()=>{const{fetchData:a}=ge(),[r,t]=s.useState("Program"),[o,c]=s.useState(!0),[k,f]=s.useState([]),[D,B]=s.useState([]),[p,m]=s.useState(null),[u,i]=s.useState("LIST"),[g,K]=s.useState(null);if(s.useEffect(()=>{(async()=>{c(!0);try{const d=localStorage.getItem("pesantrenku_user");let C=[];if(d){const F=JSON.parse(d);F.id_akun&&C.push(F.id_akun),F.userId&&C.push(F.userId),F.id_santri&&C.push(F.id_santri),F.id_referensi&&C.push(F.id_referensi)}const[L,P,y]=await Promise.all([a("donasi",G.getDonasiRencana,"DonasiWali",!1,!1),a("keuanganTransaksi",G.getKeuanganTransaksi,"DonasiWali",!0,!1),a("rekening",G.getRekening,"DonasiWali",!1,!1)]),z=Array.isArray(L)?L:(L==null?void 0:L.rencana)||[],j=Array.isArray(P)?P:[],N=Array.isArray(y)?y[0]:y;m(N);const A=z.map(F=>{const l=j.filter(q=>{var U;const V=q.status||((U=q.jenis_transaksi)==null?void 0:U.status)||"";return["Selesai","Lunas","Verified","Success","Terverifikasi"].includes(V)}).filter(q=>{var re,Z;const V=((re=q.peruntukan)==null?void 0:re.id_ref)||q.id_donasi,J=(((Z=q.peruntukan)==null?void 0:Z.kategori)||"").toLowerCase(),U=F.judul.toLowerCase();return!!(V===F.id_donasi||F.kategori==="Pembangunan"&&J.includes("bangunan")||F.kategori==="Wakaf"&&J.includes("wakaf"))}),I=l.reduce((q,V)=>{var U;const J=(U=V.pembayaran)!=null&&U.nominal?Number(V.pembayaran.nominal):Number(V.nominal)||0;return q+J},0),_=new Set(l.map(q=>{var V,J;return((V=q.pihak)==null?void 0:V.nama)||((J=q.donatur)==null?void 0:J.nama)})).size,n=l.some(q=>{var J,U;const V=((J=q.pihak)==null?void 0:J.id)||((U=q.donatur)==null?void 0:U.id_donatur);return C.includes(V)}),v=new Date(F.target.waktu).getTime(),R=new Date().getTime(),W=Math.ceil((v-R)/(1e3*60*60*24));return{...F,terkumpul:I>0?I:F.terkumpul||0,donatur:_>0?_:F.donatur||0,sisa_hari:W>0?W:0,user_has_donated:n}}),S=j.filter(F=>{var _,n;const x=((_=F.peruntukan)==null?void 0:_.id_ref)||F.id_donasi,l=F.status||((n=F.jenis_transaksi)==null?void 0:n.status)||"",I=["Selesai","Lunas","Verified","Success"].includes(l);return x==="umum"&&I}),b=S.reduce((F,x)=>{var l;return F+(((l=x.pembayaran)==null?void 0:l.nominal)||0)},0),T=S.some(F=>{var x;return C.includes((x=F.pihak)==null?void 0:x.id)}),$={id_donasi:"umum",kategori:"Operasional",judul:"Infaq Operasional Pesantren",gambar:["https://placehold.co/800x600/064e3b/ffffff?text=Infaq+Umum"],target:{waktu:"-",nominal:0},deskripsi:"Donasi untuk kebutuhan operasional harian pesantren, pemeliharaan fasilitas, dan kegiatan santri.",terkumpul:b,donatur:S.length,sisa_hari:0,user_has_donated:T};f([$,...A]);const E=j.filter(F=>{var v,R,W,q;const x=((v=F.pihak)==null?void 0:v.id)||((R=F.donatur)==null?void 0:R.id_donatur),l=C.includes(x),I=(((W=F.peruntukan)==null?void 0:W.pos)||"").toLowerCase(),_=(((q=F.peruntukan)==null?void 0:q.kategori)||"").toLowerCase(),n=I==="donasi"||I==="bangunan"||I==="phbi"||I==="wakaf"||_.includes("infaq")||_.includes("sedekah");return l&&n}).map(F=>{var x,l,I;return{id:F.id_transaksi,tanggal:F.tanggal||F.timestamp,judul:((x=F.peruntukan)==null?void 0:x.kategori)||F.catatan||"Donasi",nominal:((l=F.pembayaran)==null?void 0:l.nominal)||F.nominal||0,status:F.status||"Pending",metode:((I=F.pembayaran)==null?void 0:I.metode)||"Transfer"}}).sort((F,x)=>new Date(x.tanggal).getTime()-new Date(F.tanggal).getTime());B(E)}catch(d){console.error(d)}finally{c(!1)}})()},[a]),o)return e.jsx(fe,{message:"Memuat Program Donasi...",fullScreen:!1});if(u==="PAYMENT"&&g)return e.jsx("div",{className:"bg-white min-h-[80vh] rounded-[2rem] overflow-hidden shadow-sm border border-slate-200 relative z-50 font-sans",children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>i("DETAIL"),className:"absolute top-4 left-4 z-50 p-2 bg-white rounded-full shadow-md text-slate-600 hover:text-emerald-600 transition",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsx(za,{campaign:g,donasiInfo:p,onBack:()=>i("DETAIL"),onCopyLink:()=>{},copyLinkState:!1})]})});const h=k.find(w=>w.id_donasi==="umum"),M=k.filter(w=>w.id_donasi!=="umum");return e.jsxs(na,{children:[e.jsx(ve,{tourId:"wali_donasi",steps:Is}),e.jsx(ra,{title:"Program Donasi",subtitle:"Salurkan infaq terbaik Anda untuk kemajuan pesantren.",action:r==="Program"&&u==="LIST"&&e.jsx("div",{id:"wali-donasi-tabs",children:e.jsx(Ns,{tabs:[{id:"Program",label:"Program Aktif"},{id:"Riwayat",label:"Riwayat Saya",count:D.length}],activeTab:r,onChange:w=>t(w)})})}),u==="LIST"&&e.jsx("div",{id:"wali-donasi-content",children:r==="Program"?e.jsxs("div",{className:"space-y-8 animate-fade-in-up",children:[h&&e.jsxs("div",{onClick:()=>{K(h),i("PAYMENT"),window.scrollTo(0,0)},className:"w-full bg-gradient-to-r from-emerald-800 to-emerald-600 rounded-[2rem] p-6 md:p-10 text-white shadow-xl relative overflow-hidden cursor-pointer group hover:shadow-emerald-900/20 transition-all duration-300 transform hover:-translate-y-1",children:[e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex-1 space-y-3 text-center md:text-left",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-white/10 backdrop-blur-md px-3 py-1 rounded-full border border-white/20",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-yellow-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-[9px] font-bold uppercase tracking-widest text-emerald-100",children:"Rutin & Operasional"})]}),e.jsx("h3",{className:"font-serif text-2xl md:text-4xl font-bold leading-tight",children:h.judul}),e.jsx("p",{className:"text-emerald-100/90 text-sm leading-relaxed max-w-xl",children:h.deskripsi}),h.user_has_donated&&e.jsx("div",{className:"inline-block mt-2 px-3 py-1 bg-emerald-500/30 rounded-lg text-xs font-medium border border-emerald-400/30",children:"Jazakumullah Khairan, Anda telah berdonasi di program ini."})]}),e.jsx("div",{className:"shrink-0 w-full md:w-auto",children:e.jsxs("button",{className:"w-full md:w-auto bg-yellow-500 text-emerald-950 px-6 py-3.5 rounded-xl font-bold shadow-lg hover:bg-yellow-400 transition-colors flex items-center justify-center gap-2 group-hover:scale-105 duration-300",children:[e.jsx("span",{children:"Infaq Sekarang"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})})]}),e.jsx("div",{className:"absolute top-0 right-0 w-48 h-48 bg-white/5 rounded-full blur-3xl -mr-10 -mt-10 pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-full bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')] opacity-10 pointer-events-none"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:M.map(w=>{const d=w.target.nominal>0?Math.min(100,Math.round((w.terkumpul||0)/w.target.nominal*100)):0;return e.jsxs("div",{onClick:()=>{K(w),i("DETAIL"),window.scrollTo(0,0)},className:"bg-white rounded-[1.5rem] border border-slate-200 overflow-hidden shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300 cursor-pointer group flex flex-col h-full relative font-sans",children:[e.jsxs("div",{className:"relative h-48 bg-slate-100 overflow-hidden",children:[e.jsx("img",{src:w.gambar[0],alt:w.judul,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-700",onError:C=>C.currentTarget.src="https://placehold.co/600x400?text=No+Image"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent opacity-60"}),e.jsx("div",{className:"absolute top-3 left-3 flex gap-2",children:e.jsx("span",{className:"bg-white/90 backdrop-blur px-3 py-1 rounded-full text-[10px] font-bold uppercase text-slate-800 shadow-sm border border-white/20 font-sans",children:w.kategori})}),e.jsxs("div",{className:"absolute bottom-3 right-3 flex items-center gap-1.5 text-white/90 text-xs font-medium bg-black/20 backdrop-blur-md px-2 py-1 rounded-lg border border-white/10 font-sans",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M13 6a3 3 0 11-6 0 3 3 0 016 0zM18 8a2 2 0 11-4 0 2 2 0 014 0zM14 15a4 4 0 00-8 0v3h8v-3zM6 8a2 2 0 11-4 0 2 2 0 014 0zM16 18v-3a5.972 5.972 0 00-.75-2.906A3.005 3.005 0 0119 15v3h-3zM4.75 12.094A5.973 5.973 0 004 15v3H1v-3a3 3 0 013.75-2.906z"})}),ht(w.donatur||0)," Donatur"]})]}),e.jsxs("div",{className:"p-5 flex-1 flex flex-col",children:[e.jsx("h3",{className:"font-bold text-slate-900 text-lg mb-3 leading-snug line-clamp-2 group-hover:text-emerald-700 transition-colors font-sans",children:w.judul}),w.user_has_donated&&e.jsxs("div",{className:"mb-3 inline-flex items-center gap-1.5 text-[10px] font-bold text-emerald-600 bg-emerald-50 px-2 py-1 rounded border border-emerald-100 w-fit font-sans",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Anda telah berdonasi"]}),e.jsxs("div",{className:"mt-auto space-y-3",children:[e.jsx("div",{className:"w-full h-2.5 bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-teal-400 rounded-full transition-all duration-1000 ease-out",style:{width:`${d}%`}})}),e.jsxs("div",{className:"flex justify-between items-end",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-wider mb-0.5 font-sans",children:"Terkumpul"}),e.jsx("p",{className:"text-emerald-600 font-sans font-bold text-sm tabular-nums",children:pa(w.terkumpul||0)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold tracking-wider mb-0.5 font-sans",children:"Target"}),e.jsx("p",{className:"text-slate-600 font-sans font-bold text-xs tabular-nums",children:ht(w.target.nominal)})]})]})]})]})]},w.id_donasi)})})]}):e.jsx("div",{className:"animate-fade-in-up",children:D.length>0?e.jsxs("div",{className:"bg-white rounded-[2rem] border border-slate-200 shadow-sm overflow-hidden font-sans",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 bg-slate-50/50 flex justify-between items-center",children:[e.jsx("h3",{className:"font-bold text-slate-900 font-sans",children:"Jejak Kebaikan Anda"}),e.jsxs("span",{className:"text-xs font-bold text-emerald-600 bg-emerald-100 px-3 py-1 rounded-full",children:[D.length," Transaksi"]})]}),e.jsx("div",{className:"divide-y divide-slate-100",children:D.map(w=>e.jsxs("div",{className:"p-6 hover:bg-slate-50 transition flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center text-xl shadow-sm ${w.status==="Selesai"||w.status==="Verified"?"bg-emerald-100 text-emerald-600":"bg-amber-100 text-amber-600"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-900 text-sm mb-1 font-sans",children:w.judul}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-500 font-sans",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})," ",new Date(w.tanggal).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})]}),e.jsx("span",{className:"w-1 h-1 bg-slate-300 rounded-full"}),e.jsx("span",{children:w.metode})]})]})]}),e.jsxs("div",{className:"flex items-center justify-between w-full sm:w-auto sm:block text-right",children:[e.jsx("p",{className:"font-sans tabular-nums font-bold text-emerald-600 text-base",children:pa(w.nominal)}),e.jsx("div",{className:"mt-1 flex justify-end",children:e.jsx(Ja,{status:w.status})})]})]},w.id))})]}):e.jsx(ma,{message:"Anda belum memiliki riwayat donasi.",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-slate-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})})}),u==="DETAIL"&&g&&e.jsxs("div",{className:"animate-fade-in-up font-sans",children:[e.jsxs("button",{onClick:()=>i("LIST"),className:"flex items-center gap-2 text-sm font-bold text-slate-500 hover:text-emerald-600 mb-6 transition-colors group font-sans",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-white border border-slate-200 flex items-center justify-center group-hover:border-emerald-200 shadow-sm",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 transform group-hover:-translate-x-0.5 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7 7-7m8 14l-7-7 7-7"})})}),"Kembali ke Daftar"]}),e.jsxs("div",{className:"bg-white rounded-[3rem] p-6 md:p-10 border border-slate-200 shadow-xl overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-emerald-50 rounded-bl-full opacity-50 -z-0"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-10 relative z-10",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"rounded-[2rem] overflow-hidden shadow-2xl shadow-emerald-900/10 border-4 border-white rotate-1 hover:rotate-0 transition-transform duration-500",children:e.jsx("img",{src:g.gambar[0],alt:g.judul,className:"w-full h-full object-cover aspect-[4/3]"})}),g.id_donasi!=="umum"&&e.jsxs("div",{className:"bg-emerald-900 p-6 rounded-2xl text-white shadow-lg relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/5 rounded-full blur-2xl -mr-10 -mt-10"}),e.jsxs("div",{className:"flex justify-between items-end mb-4 relative z-10",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-emerald-300 text-xs font-bold uppercase tracking-widest mb-1 font-sans",children:"Terkumpul"}),e.jsx("p",{className:"text-3xl font-sans font-bold tabular-nums",children:pa(g.terkumpul||0)})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-emerald-400 text-[10px] uppercase font-bold tracking-widest mb-1 font-sans",children:"Target"}),e.jsx("p",{className:"text-white/80 text-sm font-sans tabular-nums",children:pa(g.target.nominal)})]})]}),e.jsx("div",{className:"w-full h-3 bg-emerald-950/50 rounded-full overflow-hidden border border-white/10",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-yellow-400 to-yellow-500 rounded-full shadow-[0_0_10px_rgba(250,204,21,0.5)]",style:{width:`${Math.min(100,(g.terkumpul||0)/g.target.nominal*100)}%`}})}),e.jsxs("div",{className:"flex gap-4 mt-6 pt-4 border-t border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-400 animate-pulse"}),e.jsxs("span",{className:"text-xs font-bold font-sans",children:[g.donatur||0," Donatur"]})]}),g.sisa_hari!==void 0&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-yellow-400"}),e.jsxs("span",{className:"text-xs font-bold font-sans",children:[g.sisa_hari," Hari Lagi"]})]})]})]}),g.id_donasi==="umum"&&e.jsxs("div",{className:"bg-gradient-to-br from-emerald-50 to-teal-50 p-6 rounded-2xl border border-emerald-100",children:[e.jsxs("p",{className:"text-xs font-bold text-emerald-800 uppercase tracking-widest mb-2 flex items-center gap-2 font-sans",children:[e.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-emerald-600"})," Total Infaq Tersalurkan"]}),e.jsx("p",{className:"text-4xl font-sans font-black text-emerald-700 tracking-tight tabular-nums",children:pa(g.terkumpul||0)}),e.jsxs("p",{className:"text-xs text-emerald-600 mt-3 font-medium bg-white/50 w-fit px-3 py-1 rounded-full font-sans",children:["Dari ",g.donatur," donatur baik hati."]})]})]}),e.jsxs("div",{className:"flex flex-col justify-center space-y-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:"inline-block text-emerald-600 font-bold text-[10px] uppercase tracking-[0.2em] bg-emerald-50 px-3 py-1 rounded-full border border-emerald-100 mb-4 font-sans",children:g.kategori}),e.jsx("h2",{className:"font-bold text-3xl md:text-5xl text-slate-900 leading-[1.1] font-sans",children:g.judul})]}),e.jsx("div",{className:"prose prose-sm text-slate-600 leading-relaxed text-base font-sans",children:g.deskripsi.split(`
`).map((w,d)=>e.jsx("p",{className:"mb-3",children:w},d))}),e.jsxs("div",{className:"pt-4 mt-auto",children:[e.jsxs("button",{onClick:()=>{i("PAYMENT"),window.scrollTo(0,0)},className:"w-full py-4 bg-yellow-500 text-emerald-950 rounded-2xl font-bold shadow-xl shadow-yellow-500/20 hover:bg-yellow-400 transition-all transform hover:-translate-y-1 flex items-center justify-center gap-3 group font-sans",children:[e.jsx("span",{children:"Salurkan Donasi"}),e.jsx("div",{className:"w-8 h-8 bg-black/10 rounded-full flex items-center justify-center group-hover:bg-black/20 transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 8l4 4m0 0l-4 4m4-4H3"})})})]}),e.jsx("p",{className:"text-center text-[10px] text-slate-400 mt-3 font-medium font-sans",children:"Insya Allah menjadi amal jariyah yang tak terputus."})]})]})]})]})]})]})},$s=[{title:"Buku Tabungan",description:"Halaman ini menampilkan saldo uang saku santri yang tersimpan di koperasi/kantin."},{targetId:"wali-saldo-card",title:"Informasi Saldo",description:"Sisa saldo saat ini yang dapat digunakan untuk belanja kebutuhan sehari-hari di lingkungan pesantren.",position:"bottom"},{targetId:"wali-mutasi-list",title:"Riwayat Transaksi",description:"Daftar penggunaan uang saku (jajan) dan riwayat pengisian saldo (deposit).",position:"top"}],La=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a).replace("Rp","Rp "),zs=()=>{const{fetchData:a}=ge(),[r,t]=s.useState(!0),[o,c]=s.useState([]),[k,f]=s.useState(0),[D,B]=s.useState({in:0,out:0}),[p,m]=s.useState("Santri");return s.useEffect(()=>{(async()=>{t(!0);try{const i=localStorage.getItem("pesantrenku_user");let g="STR-2024-001";if(i){const L=JSON.parse(i);g=L.id_santri||L.id_referensi||g,m(L.nama_santri||"Ananda")}const K=await a("keuanganTransaksi",G.getKeuanganTransaksi,"BukuTabungan",!0,!1),M=(Array.isArray(K)?K:[]).filter(L=>{var N,A,S;if(((N=L.pihak)==null?void 0:N.id)!==g)return!1;const P=(((A=L.peruntukan)==null?void 0:A.pos)||"").toLowerCase(),y=(((S=L.peruntukan)==null?void 0:S.kategori)||"").toLowerCase(),z=y.includes("tabungan")||y.includes("deposit")||y.includes("saku")||y.includes("topup"),j=P==="jajan"||P==="koperasi"||y.includes("belanja")||y.includes("jajan");return z||j}),w=M.filter(L=>L.jenis==="masuk").reduce((L,P)=>{var y;return L+(((y=P.pembayaran)==null?void 0:y.nominal)||0)},0),d=M.filter(L=>L.jenis==="keluar").reduce((L,P)=>{var y;return L+(((y=P.pembayaran)==null?void 0:y.nominal)||0)},0);f(w-d),B({in:w,out:d});const C=M.sort((L,P)=>new Date(P.tanggal).getTime()-new Date(L.tanggal).getTime());c(C)}catch(i){console.error(i)}finally{t(!1)}})()},[a]),r?e.jsx(fe,{message:"Sinkronisasi Tabungan...",fullScreen:!1}):e.jsxs(na,{children:[e.jsx(ve,{tourId:"wali_tabungan",steps:$s}),e.jsx(ra,{title:"Buku Saku Santri",subtitle:"Monitoring uang jajan harian dan saldo tabungan."}),e.jsxs("div",{id:"wali-saldo-card",className:"relative w-full bg-gradient-to-br from-emerald-600 to-teal-800 rounded-[2rem] p-8 text-white shadow-2xl overflow-hidden mb-8",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-full bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')] opacity-10 pointer-events-none"}),e.jsxs("div",{className:"relative z-10 flex flex-col justify-between h-full min-h-[160px]",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-emerald-100 text-xs font-bold uppercase tracking-widest mb-1 font-sans",children:"Sisa Saldo Jajan"}),e.jsx("h2",{className:"text-5xl font-sans font-bold tracking-tighter tabular-nums",children:La(k)})]}),e.jsx("div",{className:"w-12 h-12 bg-white/20 backdrop-blur-md rounded-2xl flex items-center justify-center border border-white/20",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6",children:[e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/10",children:[e.jsx("p",{className:"text-[10px] text-emerald-100 uppercase font-bold",children:"Total Deposit"}),e.jsxs("p",{className:"font-mono font-bold text-sm",children:["+ ",La(D.in).replace("Rp","")]})]}),e.jsxs("div",{className:"bg-white/10 backdrop-blur-sm rounded-xl p-3 border border-white/10",children:[e.jsx("p",{className:"text-[10px] text-rose-100 uppercase font-bold",children:"Total Jajan"}),e.jsxs("p",{className:"font-mono font-bold text-sm text-rose-200",children:["- ",La(D.out).replace("Rp","")]})]})]})]})]}),e.jsx("div",{id:"wali-mutasi-list",children:e.jsx(Ve,{title:"Riwayat Transaksi Jajan",children:e.jsx("div",{className:"space-y-2",children:o.length>0?o.map((u,i)=>{var g,K,h;return e.jsxs("div",{className:"flex items-center justify-between p-4 rounded-2xl hover:bg-slate-50 transition border border-transparent hover:border-slate-100 group",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center shrink-0 text-xl shadow-sm ${u.jenis==="masuk"?"bg-emerald-100 text-emerald-600":"bg-rose-50 text-rose-500"}`,children:u.jenis==="masuk"?e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-800 text-sm font-sans",children:((g=u.pembayaran)==null?void 0:g.catatan)||((K=u.peruntukan)==null?void 0:K.kategori)}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[e.jsx("span",{className:"text-[10px] text-slate-400 font-sans",children:new Date(u.tanggal).toLocaleDateString("id-ID",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})}),e.jsx("span",{className:`text-[9px] font-bold px-1.5 py-0.5 rounded ${u.jenis==="masuk"?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:u.jenis==="masuk"?"Deposit":"Belanja"})]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:`font-sans tabular-nums font-bold text-base ${u.jenis==="masuk"?"text-emerald-600":"text-slate-900"}`,children:[u.jenis==="masuk"?"+":"-"," ",La(((h=u.pembayaran)==null?void 0:h.nominal)||0).replace("Rp","")]})})]},i)}):e.jsx(ma,{message:"Belum ada aktivitas jajan."})})})})]})},Ks=[{title:"Buku Tagihan",description:"Monitoring kewajiban pembayaran seperti SPP, Uang Gedung, dan biaya lainnya."},{targetId:"wali-tagihan-summary",title:"Ringkasan Kewajiban",description:"Lihat total tagihan, jumlah yang sudah dibayar, dan sisa tunggakan yang harus diselesaikan.",position:"bottom"},{targetId:"wali-tagihan-list",title:"Rincian Item",description:"Daftar detail setiap pos pembayaran. Anda bisa melihat status lunas atau belum di sini.",position:"top"}],ga=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a).replace("Rp","Rp "),Rs=()=>{const{fetchData:a}=ge(),[r,t]=s.useState(!0),[o,c]=s.useState([]),[k,f]=s.useState({total_wajib:0,total_bayar:0,total_tunggakan:0});return s.useEffect(()=>{(async()=>{var B;t(!0);try{const p=localStorage.getItem("pesantrenku_user");let m="STR-2024-001";if(p){const A=JSON.parse(p);m=A.id_santri||A.id_referensi||m}const[u,i,g]=await Promise.all([a("databaseSantri",G.getDatabaseSantri,"BukuTagihan",!1,!1),a("keuanganBiaya",G.getKeuanganBiaya,"BukuTagihan",!1,!1),a("keuanganTransaksi",G.getKeuanganTransaksi,"BukuTagihan",!0,!1)]),K=Array.isArray(u)?u:[],h=Array.isArray(i)?i:[],M=Array.isArray(g)?g:[],w=K.find(A=>{var S;return((S=A.verifikasi_santri)==null?void 0:S.id_santri)===m});if(!w)throw new Error("Data santri tidak ditemukan");const d=(B=w.verifikasi_santri)==null?void 0:B.bergabung;let C=new Date(d);isNaN(C.getTime())&&(C=new Date(new Date().getFullYear(),0,1));const L=new Date,P=[],y=M.filter(A=>{var S;return((S=A.pihak)==null?void 0:S.id)===m&&A.jenis==="masuk"&&["Selesai","Lunas","Verified","Success"].includes(A.status)});h.forEach(A=>{let S=y.filter(b=>{var T,$,E;return((T=b.peruntukan)==null?void 0:T.id_ref)===A.id_biaya||((E=($=b.peruntukan)==null?void 0:$.kategori)==null?void 0:E.toLowerCase().includes(A.kategori.toLowerCase()))}).reduce((b,T)=>{var $;return b+((($=T.pembayaran)==null?void 0:$.nominal)||0)},0);if(A.periode==="bulanan"){let b=new Date(C.getFullYear(),C.getMonth(),1);const T=new Date(L.getFullYear(),L.getMonth(),1);if(b<=T)for(;b<=T;){const $=b.toLocaleDateString("id-ID",{month:"long",year:"numeric"}),E=A.nominal;let F=0,x="Belum";S>=E?(F=E,x="Lunas",S-=E):S>0&&(F=S,x="Sebagian",S=0),P.push({id:`${A.id_biaya}-${b.getTime()}`,kategori:A.kategori,pos:A.pos,deskripsi:`${A.kategori} ${$}`,nominal_wajib:E,nominal_bayar:F,sisa:E-F,status:x,jatuh_tempo:`10 ${$}`,is_monthly:!0}),b.setMonth(b.getMonth()+1)}}else{const b=A.nominal;let T=0,$="Belum";S>=b?(T=b,$="Lunas"):S>0&&(T=S,$="Sebagian"),P.push({id:`${A.id_biaya}-ONCE`,kategori:A.kategori,pos:A.pos,deskripsi:`${A.kategori} (${A.pos})`,nominal_wajib:b,nominal_bayar:T,sisa:b-T,status:$,jatuh_tempo:"Awal Masuk",is_monthly:!1})}});const z=P.reduce((A,S)=>A+S.nominal_wajib,0),j=P.reduce((A,S)=>A+S.nominal_bayar,0),N=P.sort((A,S)=>A.status!=="Lunas"&&S.status==="Lunas"?-1:A.status==="Lunas"&&S.status!=="Lunas"?1:0);c(N),f({total_wajib:z,total_bayar:j,total_tunggakan:z-j})}catch(p){console.error(p)}finally{t(!1)}})()},[a]),r?e.jsx(fe,{message:"Kalkulasi Tagihan...",fullScreen:!1}):e.jsxs(na,{children:[e.jsx(ve,{tourId:"wali_tagihan",steps:Ks}),e.jsx(ra,{title:"Buku Tagihan",subtitle:"Status kewajiban pembayaran (SPP, Gedung, dll)."}),e.jsxs("div",{id:"wali-tagihan-summary",className:"bg-white rounded-[2rem] p-6 shadow-xl border border-slate-200 mb-8 relative overflow-hidden font-sans",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-rose-50 rounded-bl-[4rem] -mr-4 -mt-4 z-0"}),e.jsxs("div",{className:"relative z-10 grid grid-cols-1 md:grid-cols-3 gap-8 text-center divide-y md:divide-y-0 md:divide-x divide-slate-100",children:[e.jsxs("div",{className:"pt-2 md:pt-0",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-1 font-sans",children:"Total Tagihan"}),e.jsx("p",{className:"text-xl font-black text-slate-800 font-sans tabular-nums",children:ga(k.total_wajib)})]}),e.jsxs("div",{className:"pt-4 md:pt-0",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-1 font-sans",children:"Sudah Dibayar"}),e.jsx("p",{className:"text-xl font-black text-emerald-600 font-sans tabular-nums",children:ga(k.total_bayar)})]}),e.jsxs("div",{className:"pt-4 md:pt-0",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-1 font-sans",children:"Sisa Kewajiban"}),e.jsx("p",{className:`text-2xl font-black font-sans tabular-nums ${k.total_tunggakan>0?"text-rose-600":"text-emerald-500"}`,children:ga(k.total_tunggakan)})]})]}),k.total_tunggakan<=0&&e.jsx("div",{className:"mt-6 text-center",children:e.jsx("span",{className:"bg-emerald-100 text-emerald-700 px-4 py-1.5 rounded-full text-xs font-bold uppercase tracking-wider border border-emerald-200 font-sans",children:"Lunas Semua"})})]}),e.jsxs("div",{id:"wali-tagihan-list",className:"space-y-4",children:[e.jsx("h3",{className:"font-bold text-slate-700 text-sm uppercase tracking-wide ml-2 font-sans",children:"Rincian Item"}),o.length>0?o.map(D=>e.jsxs("div",{className:`bg-white p-5 rounded-2xl border shadow-sm flex flex-col md:flex-row justify-between items-start md:items-center gap-4 group transition-all font-sans ${D.status==="Lunas"?"border-slate-200 opacity-80 hover:opacity-100":"border-rose-100 bg-rose-50/10"}`,children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${D.status==="Lunas"?"bg-emerald-500":D.status==="Sebagian"?"bg-amber-500":"bg-rose-500"}`}),e.jsx("h4",{className:"font-bold text-slate-800 text-sm md:text-base font-sans",children:D.deskripsi}),e.jsx("span",{className:"text-[9px] bg-slate-100 text-slate-500 px-2 py-0.5 rounded border border-slate-200 uppercase",children:D.pos})]}),e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-xs text-slate-500",children:[e.jsxs("span",{children:["Jatuh Tempo: ",e.jsx("span",{className:"font-bold text-slate-600 font-sans",children:D.jatuh_tempo})]}),D.status!=="Lunas"&&e.jsxs("span",{children:["Terbayar: ",e.jsx("span",{className:"text-emerald-600 font-sans tabular-nums font-bold",children:ga(D.nominal_bayar)})]})]})]}),e.jsx("div",{className:"w-full md:w-auto text-right",children:D.status==="Lunas"?e.jsxs("div",{className:"flex items-center justify-end gap-2 text-emerald-600 font-bold bg-emerald-50 px-4 py-2 rounded-xl border border-emerald-100",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-xs uppercase tracking-wider font-sans",children:"Lunas"})]}):e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-wider mb-1 font-sans",children:"Kurang Bayar"}),e.jsx("p",{className:"font-sans tabular-nums font-black text-rose-600 text-lg",children:ga(D.sisa)})]})})]},D.id)):e.jsx(ma,{message:"Tidak ada data tagihan."})]})]})},Ws=[{title:"Riwayat Keuangan",description:"Rekapitulasi seluruh setoran dan transfer dana yang telah Anda lakukan ke pesantren."},{targetId:"wali-keuangan-summary",title:"Total Setoran",description:"Akumulasi dana yang disalurkan sejak awal masuk hingga saat ini.",position:"bottom"},{targetId:"wali-keuangan-list",title:"Daftar Transaksi",description:"Detail riwayat setoran per tanggal. Anda bisa melihat status verifikasi pembayaran di sini.",position:"top"}],Ga=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(a).replace("Rp","Rp "),Es=()=>{const{fetchData:a}=ge(),[r,t]=s.useState(!0),[o,c]=s.useState([]),[k,f]=s.useState({totalSetor:0,totalFrekuensi:0,bulanIni:0});return s.useEffect(()=>{(async()=>{t(!0);try{const B=localStorage.getItem("pesantrenku_user");let p="STR-2024-001";if(B){const w=JSON.parse(B);p=w.id_santri||w.id_referensi||p}const m=await a("keuanganTransaksi",G.getKeuanganTransaksi,"WaliKeuangan",!0,!1),i=(Array.isArray(m)?m:[]).filter(w=>{var d;return((d=w.pihak)==null?void 0:d.id)===p&&w.jenis==="masuk"}),g=i.reduce((w,d)=>{var C;return w+(((C=d.pembayaran)==null?void 0:C.nominal)||0)},0),K=new Date().toISOString().slice(0,7),h=i.filter(w=>w.tanggal.startsWith(K)).reduce((w,d)=>{var C;return w+(((C=d.pembayaran)==null?void 0:C.nominal)||0)},0),M=i.sort((w,d)=>new Date(d.tanggal).getTime()-new Date(w.tanggal).getTime()).map(w=>{var d,C,L,P;return{id:w.id_transaksi,tanggal:new Date(w.tanggal).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),judul:((d=w.peruntukan)==null?void 0:d.kategori)||"Setoran Tunai",pos:((C=w.peruntukan)==null?void 0:C.pos)||"Umum",nominal:((L=w.pembayaran)==null?void 0:L.nominal)||0,jenis:w.jenis,metode:((P=w.pembayaran)==null?void 0:P.metode)||"Tunai",status:w.status||"Selesai"}});c(M),f({totalSetor:g,totalFrekuensi:i.length,bulanIni:h})}catch(B){console.error("Gagal memuat data keuangan wali",B)}finally{t(!1)}})()},[a]),r?e.jsx(fe,{message:"Menyiapkan Data Keuangan...",fullScreen:!1}):e.jsxs(na,{children:[e.jsx(ve,{tourId:"wali_keuangan",steps:Ws}),e.jsx(ra,{title:"Riwayat Transfer",subtitle:"Catatan dana yang Anda salurkan ke pesantren."}),e.jsxs("div",{id:"wali-keuangan-summary",className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-indigo-600 to-blue-500 rounded-2xl p-5 text-white shadow-lg relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-white/10 rounded-full blur-2xl -mr-6 -mt-6"}),e.jsx("p",{className:"text-indigo-100 text-xs font-bold uppercase tracking-widest mb-1",children:"Total Disalurkan"}),e.jsx("h3",{className:"text-3xl font-sans font-bold tabular-nums tracking-tight",children:Ga(k.totalSetor)}),e.jsx("p",{className:"text-xs text-indigo-200 mt-2 font-medium",children:"Sejak awal masuk"})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-5 border border-slate-100 shadow-sm flex flex-col justify-center",children:[e.jsx("p",{className:"text-slate-400 text-xs font-bold uppercase tracking-widest mb-1",children:"Setoran Bulan Ini"}),e.jsx("h3",{className:"text-2xl font-sans font-bold text-slate-800 tabular-nums",children:Ga(k.bulanIni)})]}),e.jsxs("div",{className:"bg-white rounded-2xl p-5 border border-slate-100 shadow-sm flex flex-col justify-center",children:[e.jsx("p",{className:"text-slate-400 text-xs font-bold uppercase tracking-widest mb-1",children:"Frekuensi Transaksi"}),e.jsxs("h3",{className:"text-2xl font-sans font-bold text-slate-800 tabular-nums",children:[k.totalFrekuensi,"x"]})]})]}),e.jsx("div",{id:"wali-keuangan-list",children:e.jsx(Ve,{title:"Riwayat Transaksi",children:e.jsx("div",{className:"space-y-4",children:o.length>0?o.map((D,B)=>e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-100 shadow-sm flex flex-col md:flex-row items-start md:items-center justify-between gap-4 hover:border-emerald-200 transition group",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-xl shrink-0 bg-indigo-50 text-indigo-600 group-hover:bg-emerald-50 group-hover:text-emerald-600 transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-800 text-sm mb-0.5 line-clamp-1",children:D.judul}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-[10px] text-slate-500 font-medium",children:[e.jsx("span",{children:D.tanggal}),e.jsx("span",{className:"w-1 h-1 bg-slate-300 rounded-full"}),e.jsx("span",{className:"uppercase tracking-wide text-indigo-600 bg-indigo-50 px-1.5 py-0.5 rounded border border-indigo-100",children:D.pos}),e.jsx("span",{className:"w-1 h-1 bg-slate-300 rounded-full"}),e.jsx("span",{className:"uppercase",children:D.metode})]})]})]}),e.jsxs("div",{className:"w-full md:w-auto flex justify-between md:block text-right items-center",children:[e.jsxs("p",{className:"font-sans font-bold text-base tabular-nums text-emerald-600",children:["+ ",Ga(D.nominal).replace("Rp","")]}),e.jsx("div",{className:"mt-1 flex justify-end",children:e.jsx(Ja,{status:D.status})})]})]},B)):e.jsx(ma,{message:"Belum ada riwayat setoran."})})})})]})},Hs=[{title:"Selamat Datang, Wali Santri",description:"Ini adalah Portal Orang Tua Santri. Di sini Anda dapat memantau perkembangan akademik, keuangan, dan aktivitas putra-putri Anda di pesantren."},{targetId:"layout-sidebar",title:"Menu Navigasi",description:"Gunakan menu ini untuk mengakses fitur seperti Buku Tabungan, Tagihan SPP, Belanja Koperasi, dan Donasi.",position:"right"}],Ca=[{id:"dashboard",name:"Dashboard",icon:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 01-2-2v-2z"})}),gradient:"from-emerald-500 to-green-600",description:"Ringkasan Utama"},{id:"keuangan",name:"Keuangan Umum",icon:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),gradient:"from-purple-500 to-violet-600",description:"Rekapitulasi Global"},{id:"buku_tabungan",name:"Buku Tabungan",icon:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),gradient:"from-blue-500 to-indigo-600",description:"Saldo & Mutasi"},{id:"buku_tagihan",name:"Buku Tagihan",icon:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),gradient:"from-rose-500 to-pink-600",description:"Kewajiban Pembayaran"},{id:"koperasi",name:"Koperasi",icon:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),gradient:"from-yellow-500 to-amber-600",description:"Belanja Kebutuhan"},{id:"donasi",name:"Donasi",icon:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),gradient:"from-teal-500 to-emerald-600",description:"Infaq & Sedekah"},{id:"profil_siswa",name:"Profil Santri",icon:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 9a3 3 0 11-6 0 3 3 0 016 0zm6 3a9 9 0 11-18 0 9 9 0 0118 0zM7 15s1.5-2 5-2 5 2 5 2"})}),gradient:"from-cyan-500 to-cyan-700",description:"Biodata & Identitas"},{id:"settings",name:"Pengaturan Akun",icon:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37zM15 12a3 3 0 11-6 0 3 3 0 016 0z"})}),gradient:"from-gray-500 to-slate-600",description:"Keamanan & Privasi"},{id:"notifikasi",name:"Notifikasi",icon:e.jsx("svg",{className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),gradient:"from-gray-600 to-gray-800",description:"Pesan Sistem"}],Os=[{title:"",items:["dashboard"]},{title:"KEUANGAN",items:["keuangan","buku_tabungan","buku_tagihan"]},{title:"KOPERASI & DONASI",items:["koperasi","donasi"]},{title:"SEPUTAR AKUN",items:["profil_siswa","settings"]}],Fs=({onLogout:a})=>{var f;const[r,t]=s.useState(()=>localStorage.getItem("miftahulhuda_active_module_wali")||"dashboard");s.useEffect(()=>{localStorage.setItem("miftahulhuda_active_module_wali",r)},[r]);const[o,c]=s.useState({userName:"Wali Santri",userRole:"Orang Tua/Wali",userInitial:"WS",id_santri:"",id_akun:"",email:"",jabatan:"Wali Santri",akses:[]});s.useEffect(()=>{const D=localStorage.getItem("miftahulhuda_user");if(D)try{const B=JSON.parse(D);c(p=>({...p,...B,id_akun:B.userId||B.id_akun,id_santri:B.id_santri||B.id_referensi,akses:B.akses||[]}))}catch(B){console.error("Gagal parsing user data",B)}},[]);const k=()=>{switch(r){case"dashboard":return e.jsx(xt,{onNavigate:t,services:Ca});case"profil_siswa":return e.jsx(Ls,{});case"buku_tabungan":return e.jsx(zs,{});case"buku_tagihan":return e.jsx(Rs,{});case"keuangan":return e.jsx(Es,{});case"koperasi":return e.jsx(Bs,{});case"donasi":return e.jsx(Ps,{});case"notifikasi":return e.jsx(Ms,{});case"settings":return e.jsx(Ts,{id_akun:o.id_akun,userName:o.userName,userRole:o.userRole,userInitial:o.userName.substring(0,2).toUpperCase(),email:o.email,jabatan:o.jabatan,akses:o.akses,accentColor:"emerald"});default:return e.jsx(xt,{onNavigate:t,services:Ca})}};return e.jsxs(e.Fragment,{children:[e.jsx(ve,{tourId:"wali_main",steps:Hs}),e.jsx(At,{title:r==="dashboard"?"Portal Wali Santri":r==="settings"?"Pengaturan Akun":((f=Ca.find(D=>D.id===r))==null?void 0:f.name)||"Menu",subTitle:"Keluarga Besar Miftahul Huda",activeModule:r,navItems:Ca,navGroups:Os,onNavigate:t,onLogout:a,onNotificationClick:()=>t("notifikasi"),...o,accentColor:"emerald",children:k()})]})},Ba=(a,r="data-export.csv")=>{if(!a||a.length===0){alert("Tidak ada data untuk diunduh.");return}const t=(p,m="")=>Object.keys(p).reduce((u,i)=>{const g=m.length?m+".":"";return typeof p[i]=="object"&&p[i]!==null&&!Array.isArray(p[i])?Object.assign(u,t(p[i],g+i)):Array.isArray(p[i])?u[g+i]=JSON.stringify(p[i]):u[g+i]=p[i],u},{}),o=a.map(p=>t(p)),c=Object.keys(o[0]),k=[c.join(","),...o.map(p=>c.map(m=>{let u=p[m]!==void 0?p[m]:"";return typeof u=="string"&&(u=u.replace(/"/g,'""'),u.search(/("|,|\n)/g)>=0&&(u=`"${u}"`)),u}).join(","))].join(`\r
`),f=new Blob(["\uFEFF",k],{type:"text/csv;charset=utf-8;"}),D=document.createElement("a"),B=URL.createObjectURL(f);D.setAttribute("href",B),D.setAttribute("download",r.endsWith(".csv")?r:`${r}.csv`),D.style.visibility="hidden",document.body.appendChild(D),D.click(),document.body.removeChild(D)},Tt=(a,r="data-export.json")=>{if(!a){alert("Tidak ada data untuk diunduh.");return}const t=JSON.stringify(a,null,2),o=new Blob([t],{type:"application/json"}),c=URL.createObjectURL(o),k=document.createElement("a");k.href=c,k.download=r.endsWith(".json")?r:`${r}.json`,document.body.appendChild(k),k.click(),document.body.removeChild(k)},qa=(a,r)=>`
    <!DOCTYPE html>
    <html lang="id">
      <head>
        <meta charset="UTF-8">
        <title>${a}</title>
        <style>
          @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
          
          /* RESET & BASE */
          * { box-sizing: border-box; }
          
          body { 
            font-family: 'Inter', sans-serif; 
            width: 210mm; /* A4 Width */
            min-height: 297mm; /* A4 Height */
            margin: 0 auto; 
            padding: 20px; 
            color: #1e293b; 
            background-color: white;
            line-height: 1.5;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
          }
          
          /* PRINT MEDIA QUERY */
          @media print { 
              @page { 
                margin: 0; 
                size: A4; 
              } 
              body { 
                margin: 15mm 20mm; 
                padding: 0; 
                width: auto; 
                box-shadow: none;
              }
              .no-print { display: none !important; }
          }

          /* UTILITY CLASSES FOR CONTENT */
          .text-center { text-align: center; }
          .text-right { text-align: right; }
          .font-bold { font-weight: 700; }
          .font-extra-bold { font-weight: 800; }
          .uppercase { text-transform: uppercase; }
          .tabular-nums { font-variant-numeric: tabular-nums; }
          
          /* STANDARD TABLE STYLE */
          table { width: 100%; border-collapse: collapse; margin-top: 20px; margin-bottom: 20px; }
          th, td { border: 1px solid #e2e8f0; padding: 10px 12px; text-align: left; font-size: 12px; }
          th { background-color: #f8fafc; font-weight: 800; text-transform: uppercase; color: #475569; letter-spacing: 0.05em; }
          tr:nth-child(even) { background-color: #fcfcfc; }

          /* HEADER STYLE */
          .header { text-align: center; border-bottom: 3px solid #064e3b; padding-bottom: 20px; margin-bottom: 30px; }
          .header h1 { color: #064e3b; font-size: 24px; font-weight: 900; margin: 0; letter-spacing: -0.025em; }
          .header p { font-size: 11px; color: #64748b; margin-top: 5px; font-weight: 500; }
          
          /* TITLE DOCUMENT STYLE */
          .doc-title { text-align: center; font-size: 16px; font-weight: 800; text-transform: uppercase; letter-spacing: 0.2em; margin-bottom: 30px; color: #0f172a; }
          
          /* GRID INFO STYLE */
          .info-grid { display: flex; justify-content: space-between; font-size: 12px; line-height: 1.6; margin-bottom: 20px; }
          .label { font-size: 9px; font-weight: 800; text-transform: uppercase; color: #94a3b8; display: block; margin-bottom: 2px; letter-spacing: 0.05em; }
          
          /* FOOTER STYLE */
          .footer { margin-top: 60px; text-align: right; font-size: 10px; color: #94a3b8; }
          .signature { border-top: 1px solid #cbd5e1; display: inline-block; padding: 10px 40px 0; margin-top: 60px; font-weight: bold; color: #475569; }
        </style>
      </head>
      <body>
        ${r}
        
        <script>
          // Auto print saat window dimuat sempurna
          window.onload = function() { 
              setTimeout(function() { 
                  window.print(); 
                  // Opsional: Tutup window setelah print (biasanya lebih baik dibiarkan terbuka agar user bisa cek dulu)
                  // window.close(); 
              }, 500); 
          }
        <\/script>
      </body>
    </html>
  `,Ya=a=>{const r=window.open("","_blank","width=900,height=800");r?(r.document.open(),r.document.write(a),r.document.close(),r.focus()):alert("Pop-up terblokir oleh browser. Mohon izinkan pop-up untuk situs ini agar fitur cetak berfungsi.")},ie=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(a).replace("Rp","Rp "),sa=({data:a,fileName:r,columns:t,title:o="Laporan Data",subtitle:c=""})=>{const[k,f]=s.useState(!1),D=()=>{const m=a.map(u=>{const i={};return t.forEach(g=>{i[g.header]=g.accessor(u)}),i});Ba(m,r),f(!1)},B=()=>{Tt(a,r),f(!1)},p=()=>{const m=t.map(K=>`<th style="padding:12px 8px; text-align:left; background-color:#f1f5f9; border-bottom:2px solid #e2e8f0; font-size:10px; font-weight:800; text-transform:uppercase; color:#475569;">${K.header}</th>`).join(""),u=a.map((K,h)=>{const M=h%2===0?"#ffffff":"#f8fafc",w=t.map(d=>`<td style="padding:10px 8px; border-bottom:1px solid #e2e8f0; font-size:11px; color:#334155;">${d.accessor(K)}</td>`).join("");return`<tr style="background-color:${M};">${w}</tr>`}).join(""),i=`
            <div style="font-family:'Inter', sans-serif;">
                <div style="margin-bottom:20px; border-bottom:2px solid #064e3b; padding-bottom:15px;">
                    <h1 style="font-size:18px; font-weight:bold; color:#0f172a; margin:0;">${o}</h1>
                    <p style="font-size:12px; color:#64748b; margin:4px 0 0 0;">${c}</p>
                    <p style="font-size:10px; color:#94a3b8; margin:4px 0 0 0;">Dicetak pada: ${new Date().toLocaleString("id-ID")}</p>
                </div>
                <table style="width:100%; border-collapse:collapse; margin-top:10px;">
                    <thead><tr>${m}</tr></thead>
                    <tbody>${u}</tbody>
                </table>
                 <div style="margin-top:30px; text-align:right; font-size:10px; color:#94a3b8;">
                    <p>Total Data: ${a.length} baris</p>
                </div>
            </div>
        `,g=qa(o,i);Ya(g),f(!1)};return e.jsxs("div",{className:"relative z-20",children:[e.jsxs("button",{onClick:()=>f(!k),className:"bg-white border border-gray-200 text-gray-600 px-4 py-2.5 rounded-xl text-xs font-bold hover:bg-gray-50 hover:text-gray-900 transition-all flex items-center gap-2 shadow-sm",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-3 w-3 transition-transform ${k?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),k&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>f(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 bg-white rounded-xl shadow-xl border border-gray-100 p-2 min-w-[160px] z-20 flex flex-col gap-1 animate-fade-in-up",children:[e.jsxs("button",{onClick:D,className:"flex items-center gap-3 px-3 py-2 text-xs font-medium text-gray-700 hover:bg-emerald-50 hover:text-emerald-700 rounded-lg transition-colors text-left w-full",children:[e.jsxs("svg",{className:"w-4 h-4 text-emerald-600",fill:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6zM6 20V4h7v5h5v11H6z"}),e.jsx("path",{d:"M14 10V4l5 5h-5z"})]}),"Excel (.csv)"]}),e.jsxs("button",{onClick:p,className:"flex items-center gap-3 px-3 py-2 text-xs font-medium text-gray-700 hover:bg-rose-50 hover:text-rose-700 rounded-lg transition-colors text-left w-full",children:[e.jsx("svg",{className:"w-4 h-4 text-rose-600",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5v.5zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5v3zm4-3H19v1h1.5v1.5H19v2h-1.5V7h3v1.5zM9 9.5h1v-1H9v1zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm10 5.5h1v-3h-1v3z"})}),"PDF Document"]}),e.jsxs("button",{onClick:B,className:"flex items-center gap-3 px-3 py-2 text-xs font-medium text-gray-700 hover:bg-amber-50 hover:text-amber-700 rounded-lg transition-colors text-left w-full",children:[e.jsx("svg",{className:"w-4 h-4 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"JSON Data"]})]})]})]})},Vs=({title:a,subtitle:r,action:t})=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-8 animate-fade-in-up",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-serif font-bold text-gray-900 tracking-tight",children:a}),e.jsx("p",{className:"text-sm text-gray-500 mt-1 font-medium",children:r})]}),e.jsx("div",{className:"shrink-0 flex gap-3 w-full md:w-auto items-center",children:t})]}),we=({title:a,value:r,prefix:t,icon:o,color:c,trend:k,description:f})=>{const D={emerald:"bg-emerald-100 text-emerald-600",blue:"bg-blue-100 text-blue-600",rose:"bg-rose-100 text-rose-600",amber:"bg-amber-100 text-amber-600",indigo:"bg-indigo-100 text-indigo-600",purple:"bg-purple-100 text-purple-600",gray:"bg-gray-100 text-gray-600"},B={emerald:"text-emerald-700",blue:"text-blue-700",rose:"text-rose-700",amber:"text-amber-700",indigo:"text-indigo-700",purple:"text-purple-700",gray:"text-gray-700"},p={emerald:"bg-emerald-50",blue:"bg-blue-50",rose:"bg-rose-50",amber:"bg-amber-50",indigo:"bg-indigo-50",purple:"bg-purple-50",gray:"bg-gray-50"};return e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-gray-100 shadow-sm hover:shadow-lg transition-all duration-300 group relative overflow-hidden h-full",children:[e.jsx("div",{className:`absolute top-0 right-0 w-24 h-24 rounded-bl-[4rem] opacity-50 transition-transform group-hover:scale-110 ${p[c]}`}),e.jsxs("div",{className:"relative z-10 flex flex-col h-full justify-between",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center text-xl shadow-sm ${D[c]}`,children:o}),k&&e.jsx("span",{className:`text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-wider ${k==="up"?"bg-green-50 text-green-600":"bg-red-50 text-red-600"}`,children:k==="up"?"▲ Naik":"▼ Turun"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-1",children:a}),e.jsxs("h3",{className:`text-2xl lg:text-3xl font-black tracking-tight ${B[c]} font-sans`,children:[t,ie(r).replace("Rp","")]}),f&&e.jsx("p",{className:"text-xs text-gray-400 mt-2 font-medium leading-relaxed",children:f})]})]})]})},ua=({tabs:a,activeTab:r,onChange:t})=>e.jsx("div",{className:"flex bg-gray-100 p-1.5 rounded-[1.5rem] w-full md:w-auto overflow-x-auto scrollbar-hide",children:a.map(o=>e.jsx("button",{onClick:()=>t(o),className:`px-8 py-3 rounded-2xl text-xs font-bold transition-all flex-1 md:flex-none whitespace-nowrap ${r===o?"bg-white text-emerald-800 shadow-md transform scale-105":"text-gray-500 hover:text-gray-700 hover:bg-gray-200/50"}`,children:o},o))}),Ze=({data:a,color:r,height:t=180})=>{if(!a||a.length===0)return e.jsx("div",{className:"h-48 flex items-center justify-center text-gray-400 text-xs italic font-medium bg-gray-50 rounded-3xl border border-dashed border-gray-200",children:"Belum ada data visualisasi."});const o=800,c=20,k=Math.max(...a.map(p=>p.value))*1.2||100,f=a.map((p,m)=>{const u=m/(a.length-1||1)*(o-c*2)+c,i=t-p.value/k*(t-c*2)-c;return{x:u,y:i,value:p.value,date:p.date}});let D=`M ${f[0].x} ${f[0].y}`;for(let p=0;p<f.length-1;p++){const m=f[p],u=f[p+1],i=m.x+(u.x-m.x)/2,g=m.y,K=u.x-(u.x-m.x)/2,h=u.y;D+=` C ${i} ${g}, ${K} ${h}, ${u.x} ${u.y}`}const B=`${D} L ${f[f.length-1].x} ${t} L ${f[0].x} ${t} Z`;return e.jsx("div",{className:"relative w-full overflow-hidden group rounded-2xl bg-white",style:{height:`${t}px`},children:e.jsxs("svg",{viewBox:`0 0 ${o} ${t}`,className:"w-full h-full",preserveAspectRatio:"none",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:`grad-${r}`,x1:"0",x2:"0",y1:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:r,stopOpacity:"0.2"}),e.jsx("stop",{offset:"100%",stopColor:r,stopOpacity:"0"})]})}),e.jsx("path",{d:B,fill:`url(#grad-${r})`,stroke:"none"}),e.jsx("path",{d:D,fill:"none",stroke:r,strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),f.map((p,m)=>e.jsxs("g",{className:"group/dot",children:[e.jsx("circle",{cx:p.x,cy:p.y,r:"4",fill:"white",stroke:r,strokeWidth:"2.5",className:"transition-all duration-300 group-hover/dot:r-6 cursor-pointer opacity-0 group-hover:opacity-100"}),e.jsx("foreignObject",{x:p.x-50,y:Math.max(0,p.y-70),width:"100",height:"60",className:"opacity-0 group-hover/dot:opacity-100 transition-all duration-200 pointer-events-none z-50",children:e.jsxs("div",{className:"bg-slate-800 text-white p-2 rounded-lg shadow-xl text-[10px] text-center",children:[e.jsx("div",{className:"font-bold opacity-70 mb-1",children:p.date}),e.jsx("div",{className:"font-bold text-emerald-400 text-xs",children:ie(p.value)})]})})]},m))]})})},va=({data:a})=>{const r=a.reduce((o,c)=>o+c.value,0)||1;let t=0;return e.jsxs("div",{className:"relative w-40 h-40",children:[e.jsx("svg",{viewBox:"0 0 100 100",className:"transform -rotate-90 w-full h-full drop-shadow-lg",children:a.map((o,c)=>{const k=o.value/r,f=251.2,D=`${k*f} ${f}`,B=-t*f;return t+=k,e.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"transparent",stroke:o.color,strokeWidth:"12",strokeDasharray:D,strokeDashoffset:B,className:"transition-all duration-1000 ease-out hover:stroke-[14px] cursor-pointer hover:opacity-90",children:e.jsxs("title",{children:[o.label,": ",ie(o.value)]})},c)})}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none",children:[e.jsx("span",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest",children:"Total"}),e.jsxs("span",{className:"text-xs font-black text-gray-800 font-sans",children:[(r/1e6).toFixed(1),"Jt"]})]})]})},Gs=({data:a,color:r})=>{if(!a||a.length===0)return null;const t=Math.max(...a.map(o=>o.value))*1.1||100;return e.jsx("div",{className:"h-48 flex items-end justify-between gap-2 pt-6",children:a.map((o,c)=>{const k=o.value/t*100;return e.jsxs("div",{className:"flex-1 flex flex-col items-center gap-2 group h-full justify-end",children:[e.jsx("div",{className:"relative w-full flex justify-center h-full items-end",children:e.jsx("div",{className:"w-full max-w-[30px] rounded-t-lg transition-all duration-500 group-hover:opacity-80 relative",style:{height:`${k}%`,backgroundColor:r},children:e.jsx("div",{className:"absolute bottom-full left-1/2 -translate-x-1/2 mb-2 opacity-0 group-hover:opacity-100 transition-opacity bg-slate-800 text-white text-[10px] px-2 py-1 rounded shadow-lg pointer-events-none whitespace-nowrap z-10",children:ie(o.value)})})}),e.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-wider truncate w-full text-center",children:o.label})]},c)})})},Pe=({status:a})=>{let r="bg-gray-100 text-gray-600 border-gray-200";const t=a.toLowerCase();return["selesai","lunas","success","berhasil","verified"].includes(t)&&(r="bg-emerald-100 text-emerald-700 border-emerald-200"),["proses","pending","menunggu","sebagian"].includes(t)&&(r="bg-amber-100 text-amber-700 border-amber-200"),["batal","gagal","failed","belum lunas","kelebihan"].includes(t)&&(r="bg-rose-100 text-rose-700 border-rose-200"),e.jsx("span",{className:`px-2.5 py-1 rounded-md text-[10px] font-bold uppercase tracking-wider border ${r}`,children:a})},Re=({headers:a,children:r,isEmpty:t})=>e.jsx("div",{className:"bg-white rounded-[2.5rem] shadow-xl shadow-gray-200/40 border border-gray-100 overflow-hidden relative",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm whitespace-nowrap",children:[e.jsx("thead",{className:"bg-gray-50/50 text-gray-400 uppercase text-[10px] font-black tracking-widest border-b border-gray-100",children:e.jsx("tr",{children:a.map((o,c)=>e.jsx("th",{className:`px-6 py-5 ${c===a.length-1?"text-right":""} ${o==="Status"?"text-center":""}`,children:o},c))})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:t?e.jsx("tr",{children:e.jsx("td",{colSpan:a.length,className:"text-center py-16 text-gray-400 italic",children:"Tidak ada data transaksi."})}):r})]})})}),Dt=({children:a,className:r="",title:t,action:o})=>e.jsxs("div",{className:`bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden ${r}`,children:[(t||o)&&e.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50",children:[t&&e.jsx("h3",{className:"font-bold text-slate-800 text-sm uppercase tracking-wide",children:t}),o&&e.jsx("div",{children:o})]}),e.jsx("div",{className:"p-6",children:a})]}),Le=({onClick:a,label:r,icon:t,variant:o="primary",size:c="md",className:k="",disabled:f,type:D="button"})=>{const B="font-bold transition-all duration-200 flex items-center justify-center gap-2 rounded-xl border focus:outline-none focus:ring-2 focus:ring-offset-1 disabled:opacity-50 disabled:cursor-not-allowed transform active:scale-95",p={sm:"px-3 py-1.5 text-xs",md:"px-5 py-2.5 text-xs uppercase tracking-wide",lg:"px-6 py-4 text-sm"},m={primary:"bg-emerald-600 text-white border-emerald-600 hover:bg-emerald-700 shadow-lg shadow-emerald-600/20 hover:-translate-y-0.5",secondary:"bg-white text-gray-600 border-gray-200 hover:bg-gray-50 hover:text-gray-900 focus:ring-gray-300 shadow-sm",danger:"bg-rose-50 text-rose-600 border-rose-200 hover:bg-rose-100 hover:border-rose-300 focus:ring-rose-500",ghost:"bg-transparent text-gray-500 border-transparent hover:bg-gray-100 hover:text-gray-700"};return e.jsxs("button",{type:D,onClick:a,disabled:f,className:`${B} ${p[c]} ${m[o]} ${k}`,children:[t,r]})},pt=({onNavigate:a})=>{const{fetchData:r}=ge(),[t,o]=s.useState(!1),[c,k]=s.useState([]),[f,D]=s.useState([]),[B,p]=s.useState([]),[m,u]=s.useState([]);s.useEffect(()=>{(async()=>{var K;try{const[h,M,w]=await Promise.all([r("keuanganTransaksi",G.getKeuanganTransaksi,"Dashboard",!1,!1),r("databaseSantri",G.getDatabaseSantri,"Dashboard",!1,!1),r("adminPersuratan",G.getPersuratan,"Dashboard",!1,!1)]);k(Array.isArray(h)?h:[]);const d=Array.isArray(M)?M:[];D(d.filter(C=>{var L;return((L=C.verifikasi_santri)==null?void 0:L.status)==="Aktif"})),u(d.filter(C=>{var L;return((L=C.verifikasi_santri)==null?void 0:L.status)==="Menunggu"})),p(w&&w.arsip?w.arsip:Array.isArray(w)&&((K=w[0])!=null&&K.arsip)?w[0].arsip:[])}catch(h){console.error("Dashboard calculation error:",h)}})()},[r]);const i=s.useMemo(()=>{const K=new Date().toISOString().slice(0,7);let h=0,M=0,w=0,d=0;const C={},L={},P={};c.forEach(N=>{var $,E;const A=(($=N.pembayaran)==null?void 0:$.nominal)||0,S=N.tanggal.split("T")[0],b=N.tanggal.slice(0,7),T=((E=N.peruntukan)==null?void 0:E.pos)||"Lainnya";N.jenis==="masuk"?(h+=A,b===K&&(w+=A),C[S]=(C[S]||0)+A,L[T]=(L[T]||0)+A):(M+=A,b===K&&(d+=A),C[S]=(C[S]||0)-A,P[T]=(P[T]||0)+A)});const y=Object.keys(C).sort().slice(-30).map(N=>({date:N,value:C[N]})),z=Object.keys(L).map(N=>({label:N,value:L[N],color:N==="Administrasi"?"#6366f1":N==="Bangunan"?"#10b981":N==="Makan"?"#f59e0b":"#3b82f6"})).sort((N,A)=>A.value-N.value),j=Object.keys(P).map(N=>({label:N,value:P[N]})).sort((N,A)=>A.value-N.value).slice(0,5);return{totalAssets:h-M,incomeThisMonth:w,expenseThisMonth:d,netCashflow:w-d,totalSantri:f.length,totalPendaftar:m.length,recentTrx:c.sort((N,A)=>new Date(A.tanggal).getTime()-new Date(N.tanggal).getTime()).slice(0,5),chartData:y,donutData:z,barData:j}},[c,f,m]);return e.jsxs("div",{className:"space-y-8 animate-fade-in font-sans pb-24 relative min-h-[800px]",children:[e.jsxs("div",{id:"dashboard-hero",className:"bg-gradient-to-r from-slate-900 to-slate-800 rounded-[2.5rem] p-8 md:p-10 text-white shadow-2xl relative overflow-hidden flex flex-col md:flex-row items-center gap-8 border-4 border-slate-800",children:[e.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-emerald-500/10 rounded-full blur-[100px] pointer-events-none -mr-20 -mt-20"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-blue-500/10 rounded-full blur-[80px] pointer-events-none -ml-20 -mb-20"}),e.jsxs("div",{className:"flex-1 relative z-10 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"px-3 py-1 bg-emerald-500/20 text-emerald-300 text-[10px] font-bold uppercase tracking-widest rounded-full border border-emerald-500/30",children:"Live Overview"}),e.jsx("span",{className:"text-slate-400 text-xs",children:new Date().toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"})})]}),e.jsxs("h1",{className:"text-3xl md:text-5xl font-serif font-bold leading-tight",children:["Dashboard ",e.jsx("br",{}),e.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-emerald-400 to-cyan-400",children:"Eksekutif"})]}),e.jsx("p",{className:"text-slate-400 text-sm max-w-lg leading-relaxed",children:"Pantau kesehatan finansial, perkembangan santri, dan aktivitas operasional pesantren dalam satu tampilan terintegrasi."}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsxs("button",{onClick:()=>a("keuangan/transaksiumum"),className:"px-6 py-3 bg-white text-slate-900 rounded-xl font-bold text-sm hover:bg-slate-100 transition shadow-lg flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Input Transaksi"]}),e.jsxs("button",{onClick:()=>a("database/calonsantri"),className:"px-6 py-3 bg-slate-700 text-white rounded-xl font-bold text-sm hover:bg-slate-600 transition border border-slate-600 flex items-center gap-2",children:[e.jsx("span",{className:"bg-emerald-500 text-white text-[10px] px-1.5 py-0.5 rounded font-black",children:i.totalPendaftar}),"Cek Pendaftar"]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 w-full md:w-auto relative z-10",children:[e.jsxs("div",{className:"bg-white/5 backdrop-blur-md p-5 rounded-2xl border border-white/10 min-w-[160px]",children:[e.jsx("p",{className:"text-slate-400 text-[10px] font-bold uppercase tracking-widest mb-1",children:"Total Aset Likuid"}),e.jsx("p",{className:"text-2xl font-mono font-bold text-emerald-400",children:ie(i.totalAssets).replace("Rp","").replace(",00","")})]}),e.jsxs("div",{className:"bg-white/5 backdrop-blur-md p-5 rounded-2xl border border-white/10 min-w-[160px]",children:[e.jsx("p",{className:"text-slate-400 text-[10px] font-bold uppercase tracking-widest mb-1",children:"Santri Aktif"}),e.jsxs("p",{className:"text-2xl font-mono font-bold text-blue-400",children:[i.totalSantri," ",e.jsx("span",{className:"text-xs text-slate-500 font-sans font-medium",children:"Jiwa"})]})]})]})]}),e.jsxs("div",{id:"dashboard-stats-grid",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(we,{title:"Pemasukan Bulan Ini",value:i.incomeThisMonth,icon:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M7 11l5-5m0 0l5 5m-5-5v12"})}),color:"emerald"}),e.jsx(we,{title:"Pengeluaran Bulan Ini",value:i.expenseThisMonth,icon:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M17 13l-5 5m0 0l-5-5m5 5V6"})}),color:"rose"}),e.jsx(we,{title:"Net Cashflow",value:i.netCashflow,icon:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),color:"blue",description:"Selisih masuk & keluar"}),e.jsx(we,{title:"Surat Keluar/Masuk",value:B.length,prefix:"",icon:e.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),color:"purple",description:"Total arsip dokumen"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-serif font-bold text-gray-900 text-xl",children:"Tren Arus Kas"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Pergerakan saldo harian (30 Hari Terakhir)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full bg-emerald-500"}),e.jsx("span",{className:"text-[10px] font-bold uppercase tracking-widest text-gray-400",children:"Net Flow"})]})]}),e.jsx(Ze,{data:i.chartData,color:"#10b981",height:280})]}),e.jsxs("div",{className:"bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm flex flex-col",children:[e.jsx("h3",{className:"font-serif font-bold text-gray-900 text-lg mb-6 text-center",children:"Komposisi Pemasukan"}),e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(va,{data:i.donutData})}),e.jsx("div",{className:"mt-8 space-y-3",children:i.donutData.slice(0,4).map((g,K)=>e.jsxs("div",{className:"flex justify-between items-center text-xs p-2 rounded-lg hover:bg-gray-50 transition border border-transparent hover:border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-3 h-3 rounded-full shadow-sm",style:{backgroundColor:g.color}}),e.jsx("span",{className:"text-gray-600 font-bold uppercase tracking-wider truncate w-24",children:g.label})]}),e.jsx("span",{className:"font-black text-gray-900",children:ie(g.value)})]},K))})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-sm border border-gray-100 overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-8 border-b border-gray-100 flex justify-between items-center bg-gray-50/30",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:"Transaksi Terakhir"}),e.jsx("button",{onClick:()=>a("keuangan/transaksiumum"),className:"text-xs font-bold text-blue-600 hover:bg-blue-50 px-3 py-1.5 rounded-lg transition",children:"Lihat Semua"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm whitespace-nowrap",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-400 uppercase text-[10px] font-black tracking-widest border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Keterangan"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Status"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Nominal"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:i.recentTrx.map((g,K)=>e.jsxs("tr",{className:"hover:bg-slate-50 transition group cursor-default",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-slate-800 text-xs mb-0.5",children:g.peruntukan.kategori}),e.jsx("div",{className:"text-[10px] text-slate-400",children:g.pihak.nama})]}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(Pe,{status:g.status||"Selesai"})}),e.jsxs("td",{className:`px-6 py-4 text-right font-black font-mono text-xs ${g.jenis==="masuk"?"text-emerald-600":"text-rose-600"}`,children:[g.jenis==="masuk"?"+":"-"," ",ie(g.pembayaran.nominal).replace("Rp","")]})]},K))})]})})]}),e.jsxs("div",{className:"bg-white rounded-[2.5rem] border border-gray-100 shadow-sm p-8 flex flex-col",children:[e.jsx("div",{className:"mb-6 flex justify-between items-end",children:e.jsxs("div",{children:[e.jsx("h3",{className:"font-serif font-bold text-gray-900 text-xl",children:"Top Pengeluaran"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Berdasarkan kategori pos anggaran."})]})}),e.jsx("div",{className:"flex-1 flex items-end",children:e.jsx(Gs,{data:i.barData,color:"#f43f5e"})})]})]})]})},Us=({title:a,subtitle:r,action:t})=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8 animate-fade-in-up font-sans",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 tracking-tight",children:a}),e.jsx("p",{className:"text-sm text-gray-500 mt-1 font-medium",children:r})]}),e.jsx("div",{className:"shrink-0",children:t})]}),Ma=({label:a,value:r,icon:t,color:o})=>{const c={emerald:"bg-emerald-50 text-emerald-600 border-emerald-100",blue:"bg-blue-50 text-blue-600 border-blue-100",amber:"bg-amber-50 text-amber-600 border-amber-100",rose:"bg-rose-50 text-rose-600 border-rose-100",purple:"bg-purple-50 text-purple-600 border-purple-100"};return e.jsxs("div",{className:`p-5 rounded-[1.5rem] border transition-all duration-300 hover:shadow-lg hover:-translate-y-1 flex items-center gap-4 bg-white ${c[o].replace("bg-","border-").split(" ")[2]}`,children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center text-xl shadow-sm ${c[o]}`,children:t}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900 leading-none font-sans tabular-nums",children:r}),e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-wider text-gray-400 mt-1 font-sans",children:a})]})]})},Js=({status:a})=>{let r="bg-gray-100 text-gray-600 border-gray-200";const t=a.toLowerCase();return(t==="selesai"||t==="terlaksana"||t==="aktif")&&(r="bg-emerald-100 text-emerald-700 border-emerald-200"),(t==="terjadwal"||t==="menunggu"||t==="masuk")&&(r="bg-blue-100 text-blue-700 border-blue-200"),(t==="batal"||t==="ditolak"||t==="keluar")&&(r="bg-rose-100 text-rose-700 border-rose-200"),(t==="proses"||t==="template")&&(r="bg-amber-100 text-amber-700 border-amber-200"),e.jsx("span",{className:`px-2.5 py-1 rounded-full text-[10px] font-bold uppercase tracking-widest border font-sans ${r}`,children:a})},fa=({onClick:a,label:r,icon:t,className:o=""})=>e.jsxs("button",{onClick:a,className:`bg-emerald-600 text-white px-5 py-2.5 rounded-xl font-bold text-xs hover:bg-emerald-700 shadow-lg shadow-emerald-600/20 transition-all transform hover:-translate-y-0.5 active:scale-95 flex items-center gap-2 font-sans ${o}`,children:[t,r]}),Bt=({onClick:a,label:r,icon:t,className:o=""})=>e.jsxs("button",{onClick:a,className:`bg-white border border-gray-200 text-gray-600 px-4 py-2.5 rounded-xl font-bold text-xs hover:bg-gray-50 hover:text-gray-900 transition-all flex items-center gap-2 font-sans ${o}`,children:[t,r]}),It=({onClick:a,label:r,icon:t,variant:o="primary",size:c="md",className:k="",disabled:f,type:D="button"})=>{const B="font-bold transition-all duration-200 flex items-center justify-center gap-2 rounded-xl border focus:outline-none focus:ring-2 focus:ring-offset-1 disabled:opacity-50 disabled:cursor-not-allowed transform active:scale-95 font-sans",p={sm:"px-3 py-1.5 text-xs",md:"px-5 py-2.5 text-xs uppercase tracking-wide",lg:"px-6 py-4 text-sm"},m={primary:"bg-emerald-600 text-white border-emerald-600 hover:bg-emerald-700 shadow-lg shadow-emerald-600/20 hover:-translate-y-0.5",secondary:"bg-white text-gray-600 border-gray-200 hover:bg-gray-50 hover:text-gray-900 focus:ring-gray-300 shadow-sm",danger:"bg-rose-50 text-rose-600 border-rose-200 hover:bg-rose-100 hover:border-rose-300 focus:ring-rose-500",ghost:"bg-transparent text-gray-500 border-transparent hover:bg-gray-100 hover:text-gray-700"};return e.jsxs("button",{type:D,onClick:a,disabled:f,className:`${B} ${p[c]} ${m[o]} ${k}`,children:[t,r]})},Pt=({value:a,onChange:r,placeholder:t="Cari data..."})=>e.jsxs("div",{className:"relative w-full md:max-w-xs group font-sans",children:[e.jsx("input",{type:"text",value:a,onChange:o=>r(o.target.value),placeholder:t,className:"w-full pl-10 pr-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-xs font-bold text-gray-700 outline-none focus:bg-white focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 transition-all group-hover:bg-white"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 absolute left-3.5 top-1/2 -translate-y-1/2 transition-colors group-focus-within:text-emerald-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),qs=[{title:"Manajemen Agenda",description:"Kelola jadwal rapat, kegiatan pesantren, dan acara penting lainnya dalam satu kalender terpadu."},{targetId:"agenda-add-btn",title:"Buat Agenda Baru",description:"Klik di sini untuk menjadwalkan kegiatan baru. Anda bisa mengatur waktu, lokasi, dan peserta rapat.",position:"left"},{targetId:"agenda-stats",title:"Ringkasan Kegiatan",description:"Pantau jumlah agenda yang terjadwal, selesai, dan total kegiatan bulan ini secara cepat.",position:"bottom"},{targetId:"agenda-list",title:"Daftar & Pencarian",description:"Lihat detail agenda yang ada. Klik pada kartu agenda untuk mengedit, mengisi notulensi, atau mengubah status.",position:"top"}],Ys=()=>{const{fetchData:a,updateCache:r}=ge(),[t,o]=s.useState([]),[c,k]=s.useState(!0),[f,D]=s.useState(""),[B,p]=s.useState(!1),[m,u]=s.useState("create"),[i,g]=s.useState(!1),K={id:"",tanggal:new Date().toISOString().split("T")[0],waktu_mulai:"08:00",waktu_selesai:"10:00",judul:"",lokasi:"",agenda:[],pimpinan:"",notulis:"",peserta_hadir:[],ringkasan:"",keputusan:[],tindak_lanjut:[],status:"terjadwal"},[h,M]=s.useState(K);s.useEffect(()=>{(async()=>{k(!0);try{const S=await a("adminAgenda",G.getAgenda,"Agenda.tsx",!1,!1),b=Array.isArray(S)?S:[];o(b)}catch(S){console.error("Gagal memuat agenda:",S)}finally{k(!1)}})()},[a]);const w=s.useMemo(()=>f?t.filter(A=>A.judul.toLowerCase().includes(f.toLowerCase())||A.lokasi.toLowerCase().includes(f.toLowerCase())||A.pimpinan.toLowerCase().includes(f.toLowerCase())):t,[t,f]),d=s.useMemo(()=>({total:t.length,selesai:t.filter(A=>A.status==="selesai").length,terjadwal:t.filter(A=>A.status==="terjadwal").length,bulanIni:t.filter(A=>A.tanggal.startsWith(new Date().toISOString().slice(0,7))).length}),[t]),C=A=>A?new Date(A).toLocaleDateString("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"}):"-",L=(A,S)=>{u(A),M(A==="edit"&&S?JSON.parse(JSON.stringify(S)):{...K,id:`AGD-${new Date().getFullYear()}-${Date.now().toString().slice(-4)}`}),p(!0),window.scrollTo(0,0)},P=async()=>{if(!h.judul)return alert("Judul agenda wajib diisi.");g(!0);try{let A=[...t];m==="edit"?A=A.map(S=>S.id===h.id?h:S):A.unshift(h),await G.updatePublicContent("admin/agenda",A),r("adminAgenda",A),o(A),p(!1),alert("Agenda berhasil disimpan.")}catch(A){console.error(A),alert("Gagal menyimpan data agenda.")}finally{g(!1)}},y=async()=>{if(confirm("Apakah Anda yakin ingin menghapus agenda ini? Data tidak dapat dikembalikan.")){g(!0);try{const A=t.filter(S=>S.id!==h.id);await G.updatePublicContent("admin/agenda",A),r("adminAgenda",A),o(A),p(!1),alert("Agenda berhasil dihapus.")}catch(A){console.error(A),alert("Gagal menghapus agenda.")}finally{g(!1)}}},z=A=>{A==="agenda"?M({...h,agenda:[...h.agenda,{poin:"",penyaji:""}]}):A==="keputusan"?M({...h,keputusan:[...h.keputusan,""]}):A==="tindak_lanjut"&&M({...h,tindak_lanjut:[...h.tindak_lanjut,{aksi:"",pj:"",deadline:""}]})},j=(A,S)=>{const b=[...h[A]];b.splice(S,1),M({...h,[A]:b})},N=(A,S,b,T)=>{const $=[...h[A]];b?$[S][b]=T:$[S]=T,M({...h,[A]:$})};return c?e.jsx(fe,{message:"Memuat Agenda...",fullScreen:!1}):e.jsxs("div",{className:"font-sans min-h-[600px] pb-24",children:[e.jsx(ve,{tourId:"adm_agenda",steps:qs}),B?e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl border border-gray-200 p-8 animate-fade-in-up",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-100 pb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-2xl text-gray-900 font-sans",children:m==="create"?"Agenda Baru":"Edit Agenda"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1 font-sans",children:"Isi detail lengkap kegiatan."})]}),e.jsx(Bt,{label:"Batal",onClick:()=>p(!1)})]}),e.jsxs("div",{className:"space-y-8 max-w-5xl mx-auto",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2 floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer focus:bg-white font-sans",placeholder:" ",value:h.judul,onChange:A=>M({...h,judul:A.target.value})}),e.jsx("label",{className:"floating-label font-sans",children:"Judul Agenda"})]}),e.jsx(ze,{id:"tgl",label:"Tanggal Pelaksanaan",value:h.tanggal,onChange:A=>M({...h,tanggal:A}),className:"!mb-0"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"floating-group !mb-0 flex-1",children:[e.jsx("input",{type:"time",className:"floating-input peer focus:bg-white font-sans",value:h.waktu_mulai,onChange:A=>M({...h,waktu_mulai:A.target.value})}),e.jsx("label",{className:"floating-label font-sans",children:"Mulai"})]}),e.jsxs("div",{className:"floating-group !mb-0 flex-1",children:[e.jsx("input",{type:"time",className:"floating-input peer focus:bg-white font-sans",value:h.waktu_selesai,onChange:A=>M({...h,waktu_selesai:A.target.value})}),e.jsx("label",{className:"floating-label font-sans",children:"Selesai"})]})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer focus:bg-white font-sans",placeholder:" ",value:h.lokasi,onChange:A=>M({...h,lokasi:A.target.value})}),e.jsx("label",{className:"floating-label font-sans",children:"Lokasi"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"absolute -top-2 left-3 bg-white px-1 text-[10px] font-bold text-gray-500 uppercase z-10 font-sans",children:"Status"}),e.jsxs("select",{value:h.status,onChange:A=>M({...h,status:A.target.value}),className:"w-full p-3.5 border border-gray-200 rounded-xl bg-transparent font-bold text-gray-700 outline-none focus:border-emerald-500 text-sm font-sans",children:[e.jsx("option",{value:"terjadwal",children:"Terjadwal"}),e.jsx("option",{value:"selesai",children:"Selesai"}),e.jsx("option",{value:"batal",children:"Dibatalkan"})]})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer focus:bg-white font-sans",placeholder:" ",value:h.pimpinan,onChange:A=>M({...h,pimpinan:A.target.value})}),e.jsx("label",{className:"floating-label font-sans",children:"Pimpinan Rapat"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer focus:bg-white font-sans",placeholder:" ",value:h.notulis,onChange:A=>M({...h,notulis:A.target.value})}),e.jsx("label",{className:"floating-label font-sans",children:"Notulis"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-2xl border border-gray-200 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h4",{className:"text-xs font-black text-gray-500 uppercase tracking-widest font-sans",children:"Agenda Pembahasan"}),e.jsx("button",{onClick:()=>z("agenda"),className:"text-[10px] font-bold text-emerald-600 bg-white border border-emerald-200 px-3 py-1 rounded hover:bg-emerald-50 font-sans",children:"+ Tambah"})]}),h.agenda.map((A,S)=>e.jsxs("div",{className:"flex gap-2 mb-2",children:[e.jsx("input",{type:"text",className:"flex-1 px-3 py-2 rounded-lg border border-gray-200 text-sm focus:ring-1 focus:ring-emerald-500 outline-none font-sans",placeholder:"Poin bahasan...",value:A.poin,onChange:b=>N("agenda",S,"poin",b.target.value)}),e.jsx("input",{type:"text",className:"w-1/3 px-3 py-2 rounded-lg border border-gray-200 text-sm focus:ring-1 focus:ring-emerald-500 outline-none font-sans",placeholder:"Penyaji",value:A.penyaji,onChange:b=>N("agenda",S,"penyaji",b.target.value)}),e.jsx("button",{onClick:()=>j("agenda",S),className:"text-red-400 hover:text-red-600 px-2",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},S))]}),e.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"floating-group !mb-4 bg-white rounded-xl",children:[e.jsx("textarea",{className:"floating-input peer h-24 py-3 resize-none font-sans",placeholder:" ",value:h.ringkasan,onChange:A=>M({...h,ringkasan:A.target.value})}),e.jsx("label",{className:"floating-label font-sans",children:"Ringkasan Hasil"})]}),e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h4",{className:"text-xs font-black text-blue-500 uppercase tracking-widest font-sans",children:"Tindak Lanjut (Action Plan)"}),e.jsx("button",{onClick:()=>z("tindak_lanjut"),className:"text-[10px] font-bold text-blue-600 bg-white border border-blue-200 px-3 py-1 rounded hover:bg-blue-50 font-sans",children:"+ Tambah"})]}),h.tindak_lanjut.map((A,S)=>e.jsxs("div",{className:"flex gap-2 mb-2 flex-col md:flex-row",children:[e.jsx("input",{type:"text",className:"flex-1 px-3 py-2 rounded-lg border border-gray-200 text-sm focus:ring-1 focus:ring-blue-500 outline-none font-sans",placeholder:"Aksi...",value:A.aksi,onChange:b=>N("tindak_lanjut",S,"aksi",b.target.value)}),e.jsx("input",{type:"text",className:"md:w-32 px-3 py-2 rounded-lg border border-gray-200 text-sm focus:ring-1 focus:ring-blue-500 outline-none font-sans",placeholder:"PIC",value:A.pj,onChange:b=>N("tindak_lanjut",S,"pj",b.target.value)}),e.jsx("input",{type:"date",className:"md:w-36 px-3 py-2 rounded-lg border border-gray-200 text-sm focus:ring-1 focus:ring-blue-500 outline-none font-sans",value:A.deadline,onChange:b=>N("tindak_lanjut",S,"deadline",b.target.value)}),e.jsx("button",{onClick:()=>j("tindak_lanjut",S),className:"text-red-400 hover:text-red-600 px-2 self-end md:self-center",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},S))]})]}),e.jsxs("div",{className:"pt-4 flex gap-4",children:[m==="edit"&&e.jsx(It,{label:i?"Menghapus...":"Hapus Agenda",variant:"danger",onClick:y,disabled:i,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx(fa,{label:i?"Menyimpan...":"Simpan Data",onClick:P,className:"flex-1 justify-center py-3 text-sm font-sans",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 00-2-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})})})]})]})]}):e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{id:"agenda-add-btn",className:"flex justify-end",children:e.jsx(fa,{label:"Buat Agenda",onClick:()=>L("create"),icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})})})}),e.jsxs("div",{id:"agenda-stats",className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(Ma,{label:"Total Agenda",value:d.total,color:"blue",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})})}),e.jsx(Ma,{label:"Akan Datang",value:d.terjadwal,color:"amber",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx(Ma,{label:"Terlaksana",value:d.selesai,color:"emerald",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsx(Ma,{label:"Bulan Ini",value:d.bulanIni,color:"purple",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})})]})]}),e.jsxs("div",{id:"agenda-list",className:"bg-white border border-gray-200 rounded-[2rem] p-6 md:p-8 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 mb-8",children:[e.jsx("h3",{className:"font-bold text-gray-800 text-lg font-sans",children:"Daftar Kegiatan"}),e.jsx(Pt,{value:f,onChange:D})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:w.length===0?e.jsx("div",{className:"col-span-full py-12 text-center text-gray-400 bg-gray-50 rounded-2xl border border-dashed border-gray-200",children:e.jsx("p",{children:"Tidak ada agenda yang ditemukan."})}):w.map((A,S)=>e.jsxs("div",{onClick:()=>L("edit",A),className:"group relative bg-white border border-gray-200 rounded-3xl p-6 hover:shadow-xl hover:border-emerald-200 transition-all cursor-pointer flex flex-col justify-between h-full overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 left-0 w-full h-1.5 ${A.status==="selesai"?"bg-emerald-500":A.status==="batal"?"bg-rose-500":"bg-blue-500"}`}),e.jsxs("div",{className:"space-y-4 mb-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(Js,{status:A.status}),e.jsx("span",{className:"text-[10px] font-bold text-gray-400 bg-gray-50 px-2 py-1 rounded-lg font-sans",children:A.id})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-sans font-bold text-lg text-gray-900 group-hover:text-emerald-700 transition-colors line-clamp-2 leading-tight mb-2",children:A.judul}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500",children:[e.jsx("svg",{className:"w-4 h-4 text-emerald-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsx("span",{className:"font-sans",children:C(A.tanggal)})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[e.jsx("svg",{className:"w-4 h-4 text-emerald-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("span",{className:"font-sans",children:[A.waktu_mulai," - ",A.waktu_selesai||"Selesai"]})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-100 flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsxs("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),e.jsx("span",{className:"truncate max-w-[120px] font-sans",children:A.lokasi})]}),e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center text-gray-500 font-bold text-[10px] border border-white shadow-sm font-sans",title:A.pimpinan,children:A.pimpinan.charAt(0)})]})]},S))})]})]})]})},Qa=({children:a})=>e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 animate-fade-in-up delay-100 font-sans",children:a}),ta=({label:a,value:r,icon:t,color:o,active:c,onClick:k})=>{const f={emerald:"text-emerald-600 bg-emerald-50 border-emerald-200",blue:"text-blue-600 bg-blue-50 border-blue-200",amber:"text-amber-600 bg-amber-50 border-amber-200",rose:"text-rose-600 bg-rose-50 border-rose-200",purple:"text-purple-600 bg-purple-50 border-purple-200",gray:"text-gray-600 bg-gray-50 border-gray-200"},D=c?`ring-2 ring-offset-1 ring-${o}-500 shadow-md`:"hover:shadow-md border-transparent",B=f[o];return e.jsxs("button",{onClick:k,className:`w-full text-left p-4 rounded-2xl bg-white border transition-all duration-300 group flex items-center justify-between gap-3 font-sans ${c?"border-gray-200":"border-gray-100"} ${k?"cursor-pointer":"cursor-default"} ${D}`,children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest text-gray-400 mb-0.5 group-hover:text-gray-600 transition-colors font-sans",children:a}),e.jsx("h3",{className:"text-2xl font-black text-gray-900 leading-none tracking-tight font-sans tabular-nums",children:r})]}),e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center text-lg shadow-sm transition-transform group-hover:scale-110 ${B.split(" ")[1]} ${B.split(" ")[0]}`,children:t})]})},Xa=({children:a})=>e.jsx("div",{className:"bg-white rounded-[2rem] border border-gray-200 shadow-sm overflow-hidden animate-fade-in-up delay-200 relative font-sans",children:a}),Ka=({title:a,searchQuery:r,onSearchChange:t,placeholder:o="Cari data...",actions:c})=>e.jsxs("div",{className:"p-6 border-b border-gray-100 bg-gray-50/30 flex flex-col md:flex-row justify-between items-center gap-4 font-sans",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg hidden md:block",children:a}),e.jsxs("div",{className:"flex gap-3 w-full md:w-auto",children:[e.jsxs("div",{className:"relative flex-1 md:w-64 group",children:[e.jsx("input",{type:"text",placeholder:o,value:r,onChange:k=>t(k.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-gray-200 rounded-xl text-sm font-medium text-gray-700 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none transition-all shadow-sm group-hover:border-gray-300 font-sans"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none group-focus-within:text-emerald-500 transition-colors",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),c]})]}),Ra=({columns:a,children:r,emptyMessage:t="Tidak ada data.",isEmpty:o})=>e.jsx("div",{className:"overflow-x-auto min-h-[400px] font-sans",children:e.jsxs("table",{className:"w-full text-left text-sm whitespace-nowrap",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-500 font-bold uppercase text-[10px] tracking-wider border-b border-gray-100 sticky top-0 z-10",children:e.jsx("tr",{children:a.map((c,k)=>e.jsx("th",{className:`px-6 py-4 ${k===a.length-1?"text-center":""}`,children:c},k))})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:o?e.jsx("tr",{children:e.jsx("td",{colSpan:a.length,className:"text-center py-12 text-gray-400 italic font-sans",children:t})}):r})]})}),Ia=({status:a})=>{let r="bg-gray-100 text-gray-600 border-gray-200";const t=a.toLowerCase();return["aktif","tetap yayasan","lunas","selesai","terverifikasi"].some(o=>t.includes(o))&&(r="bg-emerald-50 text-emerald-700 border-emerald-100"),["menunggu","pendaftar","proses","kontrak"].some(o=>t.includes(o))&&(r="bg-amber-50 text-amber-700 border-amber-100"),["keluar","pindah","batal","gagal","non-aktif"].some(o=>t.includes(o))&&(r="bg-rose-50 text-rose-700 border-rose-100"),["lulus","alumni"].some(o=>t.includes(o))&&(r="bg-blue-50 text-blue-700 border-blue-100"),e.jsx("span",{className:`px-2.5 py-0.5 rounded-md text-[10px] font-bold uppercase tracking-wide border font-sans ${r}`,children:a})},Ye=({onClick:a,label:r,icon:t,className:o=""})=>e.jsxs("button",{onClick:a,className:`bg-emerald-600 text-white px-5 py-2.5 rounded-xl font-bold text-xs hover:bg-emerald-700 shadow-lg shadow-emerald-600/20 transition-all transform hover:-translate-y-0.5 active:scale-95 flex items-center gap-2 whitespace-nowrap font-sans ${o}`,children:[t,r]}),Qe=({onClick:a,icon:r,color:t="emerald",label:o})=>{const c={emerald:"text-emerald-600 bg-emerald-50 hover:bg-emerald-100 hover:text-emerald-700",blue:"text-blue-600 bg-blue-50 hover:bg-blue-100 hover:text-blue-700",red:"text-red-600 bg-red-50 hover:bg-red-100 hover:text-red-700",gray:"text-gray-500 bg-gray-50 hover:bg-gray-100 hover:text-gray-700"};return e.jsxs("button",{onClick:a,className:`p-2 rounded-lg transition-colors flex items-center justify-center gap-2 font-sans ${c[t]} ${o?"px-3 w-full":""}`,title:o,children:[r,o&&e.jsx("span",{className:"text-xs font-bold",children:o})]})},Za=({title:a,subtitle:r,image:t,initial:o,onClose:c,actions:k})=>e.jsxs("div",{className:"bg-white p-6 md:p-8 border-b border-gray-100 flex flex-col md:flex-row justify-between items-start md:items-center gap-6 sticky top-0 z-30 shadow-sm/50 backdrop-blur-md bg-white/95 font-sans",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:c,className:"mr-2 p-2 bg-gray-50 hover:bg-emerald-50 text-gray-400 hover:text-emerald-600 rounded-xl transition-all group border border-transparent hover:border-emerald-100",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 transform group-hover:-translate-x-1 transition-transform",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-emerald-100 text-emerald-600 flex items-center justify-center font-black text-3xl border-4 border-white shadow-lg overflow-hidden relative",children:t?e.jsx("img",{src:t,alt:"",className:"w-full h-full object-cover"}):e.jsx("span",{children:o})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-2xl text-gray-900 leading-none font-sans",children:a}),e.jsx("div",{className:"mt-1.5 flex items-center gap-2",children:e.jsx("span",{className:"text-xs font-bold text-gray-500 font-sans bg-gray-100 px-2 py-0.5 rounded border border-gray-200",children:r})})]})]})]}),e.jsx("div",{className:"flex gap-3 w-full md:w-auto",children:k})]}),Xe=({title:a,icon:r,color:t,children:o})=>{const c={emerald:"text-emerald-700 bg-emerald-50 border-emerald-100",blue:"text-blue-700 bg-blue-50 border-blue-100",amber:"text-amber-700 bg-amber-50 border-amber-100",rose:"text-rose-700 bg-rose-50 border-rose-100",purple:"text-purple-700 bg-purple-50 border-purple-100"},k={emerald:"bg-emerald-100 text-emerald-600",blue:"bg-blue-100 text-blue-600",amber:"bg-amber-100 text-amber-600",rose:"bg-rose-100 text-rose-600",purple:"bg-purple-100 text-purple-600"};return e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 shadow-sm overflow-hidden h-full flex flex-col font-sans",children:[e.jsxs("div",{className:`px-5 py-3 border-b flex items-center gap-3 ${c[t].replace("text-","border-b-")}`,children:[e.jsx("div",{className:`p-1.5 rounded-lg ${k[t]}`,children:r}),e.jsx("h4",{className:`text-xs font-bold uppercase tracking-widest font-sans ${c[t].split(" ")[0]}`,children:a})]}),e.jsx("div",{className:"p-5 flex-1",children:o})]})},Ne=({label:a,value:r})=>e.jsxs("div",{className:"flex justify-between items-start py-2 border-b border-gray-50 last:border-0 last:pb-0 font-sans",children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-wide w-1/3",children:a}),e.jsx("span",{className:"text-sm font-semibold text-gray-800 w-2/3 text-right break-words",children:r||"-"})]}),Qs=[{title:"Database Santri",description:"Pusat data seluruh santri aktif, alumni, dan riwayat mutasi."},{targetId:"santri-stats",title:"Statistik Global",description:"Ringkasan jumlah santri berdasarkan statusnya. Klik kartu untuk memfilter tabel.",position:"bottom"},{targetId:"santri-filters",title:"Filter Jenjang",description:"Gunakan tab ini untuk melihat data spesifik per jenjang pendidikan (MTs, MA, atau Pesantren).",position:"bottom"},{targetId:"santri-table-container",title:"Tabel Data",description:"Daftar lengkap santri. Gunakan kolom pencarian untuk menemukan santri dengan cepat.",position:"top"}],Xs=()=>{var y,z,j,N,A,S,b,T,$,E,F,x,l,I,_,n,v,R,W,q,V,J,U,re,Z,ae,_e,oe,xe;const[a,r]=s.useState("aktif"),[t,o]=s.useState("Semua"),[c,k]=s.useState([]),[f,D]=s.useState([]),[B,p]=s.useState(""),[m,u]=s.useState(!0),[i,g]=s.useState(null),[K,h]=s.useState(""),[M,w]=s.useState(!1),d=async()=>{u(!0);try{const H=localStorage.getItem("pesantrenku_user");let ee="";H&&(ee=JSON.parse(H).filter_santri||"",h(ee));const le=await G.getDatabaseSantri(),Q=(Array.isArray(le)?le:[le]).map(ne=>{var me,be,Me,ke,Se,Y,te,X,se,ue,je,Ae,Te,De,Ke,We,$e,ia,wa,tt,st,nt;const he=((be=(me=ne.data_keluarga)==null?void 0:me.ayah)==null?void 0:be.nama)||((ke=(Me=ne.data_keluarga)==null?void 0:Me.ibu)==null?void 0:ke.nama)||((Y=(Se=ne.data_keluarga)==null?void 0:Se.wali)==null?void 0:Y.nama)||"-",Ce=((X=(te=ne.data_keluarga)==null?void 0:te.ayah)==null?void 0:X.no_wa)||((ue=(se=ne.data_keluarga)==null?void 0:se.ibu)==null?void 0:ue.no_wa)||((Ae=(je=ne.data_keluarga)==null?void 0:je.wali)==null?void 0:Ae.no_wa)||"";return{nis:((Te=ne.data_akademik)==null?void 0:Te.nisn)||((De=ne.verifikasi_santri)==null?void 0:De.id_santri)||"-",nama:((Ke=ne.data_santri)==null?void 0:Ke.nama_lengkap)||"Tanpa Nama",gender:(We=ne.data_santri)==null?void 0:We.jenis_kelamin,kelas:`${(($e=ne.data_akademik)==null?void 0:$e.kelas)||""} ${((ia=ne.data_akademik)==null?void 0:ia.jenjang)||""} - ${((wa=ne.data_akademik)==null?void 0:wa.program_pesantren)||""}`,wali:`${he} ${Ce?`(${Ce})`:""}`,status:((tt=ne.verifikasi_santri)==null?void 0:tt.status)||"Aktif",bergabung:((st=ne.verifikasi_santri)==null?void 0:st.bergabung)||"-",tahun_lulus:((nt=ne.data_akademik)==null?void 0:nt.tahun_lulus)||"-",originalData:ne}});k(Q),D(ee?Q.filter(ne=>ne.gender===ee):Q)}catch(H){console.error("Gagal memuat data kesiswaan:",H)}finally{u(!1)}};s.useEffect(()=>{d()},[]);const C=s.useMemo(()=>f.filter(H=>{var ne,he;const ee=H.nama.toLowerCase().includes(B.toLowerCase())||H.nis.toLowerCase().includes(B.toLowerCase());let le=!1;const O=H.status;a==="aktif"?le=O==="Aktif":a==="mutasi"?le=O==="Keluar"||O==="Pindah":a==="alumni"&&(le=O==="Lulus");let Q=!0;return t!=="Semua"&&(Q=(((he=(ne=H.originalData)==null?void 0:ne.data_akademik)==null?void 0:he.jenjang)||"").toLowerCase()===t.toLowerCase()),ee&&le&&Q}),[f,B,a,t]),L=s.useMemo(()=>{const H=c;return{aktif:H.filter(ee=>ee.status==="Aktif").length,mutasi:H.filter(ee=>ee.status==="Keluar"||ee.status==="Pindah").length,alumni:H.filter(ee=>ee.status==="Lulus").length}},[c]),P=async H=>{if(window.confirm(`Yakin ingin menghapus data santri ID: ${H} secara permanen?`)){w(!0);try{const ee=c.filter(le=>{var O;return((O=le.originalData.verifikasi_santri)==null?void 0:O.id_santri)!==H}).map(le=>le.originalData);await G.updatePendaftarList(ee),alert("Data berhasil dihapus."),g(null),d()}catch(ee){console.error("Gagal menghapus:",ee),alert("Terjadi kesalahan saat menghapus data.")}finally{w(!1)}}};return e.jsxs("div",{className:"space-y-6 animate-fade-in relative min-h-[600px] pb-24 font-sans",children:[e.jsx(ve,{tourId:"db_santri",steps:Qs}),m&&e.jsx(fe,{message:"Menyiapkan database...",fullScreen:!1}),e.jsx("div",{className:m?"opacity-30 pointer-events-none transition-opacity duration-300":"opacity-100 transition-opacity duration-300",children:i?e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-sm border border-gray-200 animate-fade-in-up pb-12 overflow-hidden flex flex-col h-auto",children:[e.jsx(Za,{title:((y=i.data_santri)==null?void 0:y.nama_lengkap)||"Nama Tidak Tersedia",subtitle:`ID: ${((z=i.verifikasi_santri)==null?void 0:z.id_santri)||"-"}`,image:(j=i.data_santri)==null?void 0:j.foto_profil,initial:((A=(N=i.data_santri)==null?void 0:N.nama_lengkap)==null?void 0:A.charAt(0))||"?",onClose:()=>g(null),actions:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Qe,{onClick:()=>window.print(),icon:e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})}),color:"gray",label:"Cetak"}),e.jsx(Qe,{onClick:()=>{var H;return P((H=i.verifikasi_santri)==null?void 0:H.id_santri)},icon:e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),color:"red",label:M?"...":"Hapus Data"}),e.jsx(Ye,{label:"Edit Data",onClick:()=>{},icon:e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]})}),e.jsx("div",{className:"p-8 bg-gray-50/50 min-h-[600px]",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-6xl mx-auto",children:[e.jsxs(Xe,{title:"Biodata Diri",color:"emerald",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),children:[e.jsx(Ne,{label:"NIK",value:(S=i.data_santri)==null?void 0:S.nik}),e.jsx(Ne,{label:"Jenis Kelamin",value:((b=i.data_santri)==null?void 0:b.jenis_kelamin)==="L"?"Laki-laki":"Perempuan"}),e.jsx(Ne,{label:"TTL",value:`${((T=i.data_santri)==null?void 0:T.tempat_lahir)||""}, ${(($=i.data_santri)==null?void 0:$.tanggal_lahir)||""}`}),e.jsx(Ne,{label:"Anak Ke",value:(E=i.data_santri)==null?void 0:E.anak_ke}),e.jsx(Ne,{label:"Hobi",value:(F=i.data_santri)==null?void 0:F.hobi}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-50",children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wide mb-1",children:"Alamat Domisili"}),e.jsxs("p",{className:"text-sm font-medium text-gray-800 leading-relaxed font-sans",children:[((x=i.alamat_domisili)==null?void 0:x.jalan)||"-",", ",((l=i.alamat_domisili)==null?void 0:l.desa)||"",", ",((I=i.alamat_domisili)==null?void 0:I.kecamatan)||"",", ",((_=i.alamat_domisili)==null?void 0:_.kabupaten)||"",", ",((n=i.alamat_domisili)==null?void 0:n.provinsi)||""]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(Xe,{title:"Informasi Akademik",color:"blue",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13M12 6.253V13m0-13c1.667 0 3 1.333 3 3v6.253"})}),children:[e.jsx(Ne,{label:"Jenjang",value:e.jsx("span",{className:"bg-blue-50 text-blue-700 px-2 py-0.5 rounded text-xs font-bold font-sans",children:((v=i.data_akademik)==null?void 0:v.jenjang)||"-"})}),e.jsx(Ne,{label:"Program",value:(R=i.data_akademik)==null?void 0:R.program_pesantren}),e.jsx(Ne,{label:"Asal Sekolah",value:(W=i.data_akademik)==null?void 0:W.asal_sekolah}),e.jsx(Ne,{label:"Tahun Masuk",value:(q=i.data_akademik)==null?void 0:q.tahun_masuk}),e.jsx(Ne,{label:"NISN",value:e.jsx("span",{className:"font-sans text-gray-600",children:(V=i.data_akademik)==null?void 0:V.nisn})})]}),e.jsxs(Xe,{title:"Data Wali",color:"amber",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),children:[e.jsx(Ne,{label:"Nama Ayah",value:(U=(J=i.data_keluarga)==null?void 0:J.ayah)==null?void 0:U.nama}),e.jsx(Ne,{label:"Nama Ibu",value:(Z=(re=i.data_keluarga)==null?void 0:re.ibu)==null?void 0:Z.nama}),e.jsx(Ne,{label:"No. WhatsApp",value:((_e=(ae=i.data_keluarga)==null?void 0:ae.ayah)==null?void 0:_e.no_wa)||((xe=(oe=i.data_keluarga)==null?void 0:oe.ibu)==null?void 0:xe.no_wa)})]})]})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"santri-stats",children:e.jsxs(Qa,{children:[e.jsx(ta,{label:"Santri Aktif",value:L.aktif,icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),color:"emerald",active:a==="aktif",onClick:()=>r("aktif")}),e.jsx(ta,{label:"Data Alumni",value:L.alumni,icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h-5 10v-5a1 1 0 011-1h2a1 1 0 01 1v5m-4 0h4"})}),color:"blue",active:a==="alumni",onClick:()=>r("alumni")}),e.jsx(ta,{label:"Data Mutasi",value:L.mutasi,icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7a4 4 0 11-8 0 4 4 0 018 0zM9 14a6 6 0 00-6 6v1h12v-1a6 6 0 00-6-6zM21 12h-6"})}),color:"rose",active:a==="mutasi",onClick:()=>r("mutasi")})]})}),e.jsx("div",{id:"santri-filters",className:"flex gap-2 mb-4 bg-white p-1.5 rounded-xl w-fit border border-gray-200 shadow-sm overflow-x-auto",children:["Semua","MTs","MA","Pesantren"].map(H=>e.jsx("button",{onClick:()=>o(H),className:`px-5 py-2 rounded-lg text-xs font-bold transition-all whitespace-nowrap font-sans ${t===H?"bg-emerald-600 text-white shadow-md":"text-gray-500 hover:text-gray-900 hover:bg-gray-100"}`,children:H},H))}),e.jsx("div",{id:"santri-table-container",children:e.jsxs("div",{className:"bg-white rounded-[2rem] border border-gray-200 shadow-sm overflow-hidden animate-fade-in-up relative",children:[e.jsx(Ka,{title:a==="aktif"?K?`Data Santri Aktif (${K==="L"?"Putra":"Putri"})`:"Data Santri Aktif":a==="alumni"?"Data Alumni":"Riwayat Mutasi",searchQuery:B,onSearchChange:p,placeholder:"Cari nama, NISN, atau ID...",actions:e.jsx(Ye,{label:"Input Manual",onClick:()=>{},icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})}),e.jsx("div",{className:"overflow-x-auto w-full",children:e.jsx(Ra,{columns:["ID / NISN","Nama Lengkap",a==="alumni"?"Tahun Lulus":"Kelas / Program","Wali Santri","Status","Aksi"],isEmpty:C.length===0,emptyMessage:K?`Tidak ada data santri ${K==="L"?"Putra":"Putri"} ditemukan.`:"Tidak ada data.",children:C.map((H,ee)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition group cursor-default border-b border-gray-50 last:border-none",children:[e.jsx("td",{className:"px-6 py-4 font-sans text-gray-500 font-bold text-xs whitespace-nowrap",children:H.nis}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"font-bold text-gray-800 text-sm block min-w-[150px] font-sans",children:H.nama})}),e.jsx("td",{className:"px-6 py-4 text-gray-600 text-xs font-medium whitespace-nowrap font-sans",children:a==="alumni"?H.tahun_lulus:H.kelas}),e.jsx("td",{className:"px-6 py-4 text-gray-500 text-xs truncate max-w-[180px] font-sans",children:H.wali}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(Ia,{status:H.status})}),e.jsx("td",{className:"px-6 py-4 text-center w-[120px]",children:e.jsx(Qe,{onClick:()=>{g(H.originalData),window.scrollTo(0,0)},icon:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),color:"emerald",label:"Detail"})})]},ee))})})]})})]})})]})},Zs=[{title:"Penerimaan Santri Baru",description:"Halaman ini memuat data pendaftar online yang perlu diverifikasi sebelum menjadi santri aktif."},{targetId:"calon-stats",title:"Antrian Verifikasi",description:"Jumlah total pendaftar yang belum diproses.",position:"bottom"},{targetId:"calon-filters",title:"Filter Jenjang",description:"Saring daftar berdasarkan jenjang yang dituju.",position:"bottom"},{targetId:"calon-table",title:"Tabel Pendaftar",description:"Klik tombol 'Periksa' untuk melihat detail formulir dan melakukan validasi penerimaan.",position:"top"}],en=()=>{var h,M,w,d,C,L,P,y,z,j,N,A,S;const[a,r]=s.useState([]),[t,o]=s.useState(!0),[c,k]=s.useState(""),[f,D]=s.useState(null),[B,p]=s.useState(!1),[m,u]=s.useState("Semua"),i=async()=>{o(!0);try{const b=await G.getDatabaseSantri(),$=(Array.isArray(b)?b:[b]).filter(E=>{var F;return((F=E.verifikasi_santri)==null?void 0:F.status)==="Menunggu"});r($)}catch(b){console.error("Gagal memuat calon santri:",b)}finally{o(!1)}};s.useEffect(()=>{i()},[]);const g=async b=>{if(confirm(`Terima santri atas nama ${b.data_santri.nama_lengkap} menjadi Santri Aktif?`)){p(!0);try{const T=await G.getDatabaseSantri(),$=Array.isArray(T)?T:[],F=`STR-${new Date().getFullYear()}-${Math.floor(Math.random()*1e4).toString().padStart(4,"0")}`,x=$.map(l=>l.verifikasi_santri.id_santri===b.verifikasi_santri.id_santri?{...l,verifikasi_santri:{...l.verifikasi_santri,id_santri:F,status:"Aktif"}}:l);await G.updatePendaftarList(x),alert(`Berhasil! Santri kini Aktif dengan ID: ${F}`),D(null),i()}catch(T){console.error(T),alert("Gagal memproses data.")}finally{p(!1)}}},K=s.useMemo(()=>a.filter(b=>{const T=b.data_santri.nama_lengkap.toLowerCase().includes(c.toLowerCase())||b.verifikasi_santri.id_santri.toLowerCase().includes(c.toLowerCase());let $=!0;if(m!=="Semua"){const E=b.data_akademik.jenjang||"";m==="SMP IT"?$=E==="MTs"||E==="SMP IT"||E==="SMP":m==="MA"?$=E==="MA"||E==="SMA":m==="Khusus Pesantren"&&($=E==="Pesantren"||b.data_akademik.program_pesantren==="Pesantren")}return T&&$}),[a,c,m]);return e.jsxs("div",{className:"space-y-6 animate-fade-in relative min-h-[600px] pb-24 font-sans",children:[e.jsx(ve,{tourId:"db_calon",steps:Zs}),t&&e.jsx(fe,{message:"Memuat Pendaftar...",fullScreen:!1}),f?e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-sm border border-gray-200 animate-fade-in-up overflow-hidden pb-12 font-sans",children:[e.jsx(Za,{title:f.data_santri.nama_lengkap,subtitle:`ID Regis: ${f.verifikasi_santri.id_santri}`,initial:f.data_santri.nama_lengkap.charAt(0),onClose:()=>D(null),actions:e.jsx(Ye,{label:B?"Memproses...":"Terima Sebagai Santri",onClick:()=>g(f),icon:e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})}),e.jsx("div",{className:"p-8 bg-amber-50/30 min-h-[500px]",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-5xl mx-auto",children:[e.jsxs(Xe,{title:"Data Pendaftaran",color:"amber",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),children:[e.jsx(Ne,{label:"NIK",value:f.data_santri.nik}),e.jsx(Ne,{label:"TTL",value:`${f.data_santri.tempat_lahir}, ${f.data_santri.tanggal_lahir}`}),e.jsx(Ne,{label:"Jenis Kelamin",value:f.data_santri.jenis_kelamin==="L"?"Laki-laki":"Perempuan"}),e.jsx(Ne,{label:"Asal Sekolah",value:f.data_akademik.asal_sekolah})]}),e.jsxs(Xe,{title:"Orang Tua & Kontak",color:"blue",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),children:[e.jsx(Ne,{label:"Nama Ayah",value:(M=(h=f.data_keluarga)==null?void 0:h.ayah)==null?void 0:M.nama}),e.jsx(Ne,{label:"Pekerjaan Ayah",value:(d=(w=f.data_keluarga)==null?void 0:w.ayah)==null?void 0:d.pekerjaan}),e.jsx(Ne,{label:"Nama Ibu",value:(L=(C=f.data_keluarga)==null?void 0:C.ibu)==null?void 0:L.nama}),e.jsx(Ne,{label:"No. WhatsApp",value:((y=(P=f.data_keluarga)==null?void 0:P.ayah)==null?void 0:y.no_wa)||((j=(z=f.data_keluarga)==null?void 0:z.ibu)==null?void 0:j.no_wa)})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx(Xe,{title:"Berkas Dokumen",color:"emerald",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"})}),children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("a",{href:(N=f.dokumen_arsip)==null?void 0:N.kk,target:"_blank",className:"block p-3 bg-white border rounded-lg text-sm text-blue-600 hover:underline font-sans",children:"Scan KK"}),e.jsx("a",{href:(A=f.dokumen_arsip)==null?void 0:A.akta,target:"_blank",className:"block p-3 bg-white border rounded-lg text-sm text-blue-600 hover:underline font-sans",children:"Scan Akta"}),e.jsx("a",{href:(S=f.dokumen_arsip)==null?void 0:S.bukti_bayar,target:"_blank",className:"block p-3 bg-white border rounded-lg text-sm text-blue-600 hover:underline font-sans",children:"Bukti Bayar"})]})})})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"calon-stats",children:e.jsx(Qa,{children:e.jsx(ta,{label:"Menunggu Verifikasi",value:a.length,icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"amber"})})}),e.jsx("div",{id:"calon-filters",className:"flex gap-2 mb-4 bg-white p-1.5 rounded-xl w-fit border border-gray-200 shadow-sm overflow-x-auto",children:["Semua","SMP IT","MA","Khusus Pesantren"].map(b=>e.jsx("button",{onClick:()=>u(b),className:`px-5 py-2 rounded-lg text-xs font-bold transition-all whitespace-nowrap font-sans ${m===b?"bg-amber-500 text-white shadow-md":"text-gray-500 hover:text-gray-900 hover:bg-gray-100"}`,children:b},b))}),e.jsx("div",{id:"calon-table",children:e.jsxs(Xa,{children:[e.jsx(Ka,{title:`Daftar Calon Santri (${m})`,searchQuery:c,onSearchChange:k,placeholder:"Cari nama atau ID Regis..."}),e.jsx(Ra,{columns:["ID Pendaftaran","Nama Lengkap","Jenjang","Asal Sekolah","Tanggal Daftar","Aksi"],isEmpty:K.length===0,children:K.map((b,T)=>{const $=b.data_akademik.jenjang==="MTs"?"SMP IT":b.data_akademik.jenjang;return e.jsxs("tr",{className:"hover:bg-amber-50/50 transition border-b border-gray-50 last:border-0 group cursor-default",children:[e.jsx("td",{className:"px-6 py-4 font-sans text-gray-500 font-bold text-xs",children:b.verifikasi_santri.id_santri}),e.jsx("td",{className:"px-6 py-4 font-bold text-gray-800 font-sans",children:b.data_santri.nama_lengkap}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("span",{className:"text-xs text-amber-700 bg-amber-50 px-2 py-1 rounded w-fit font-bold font-sans",children:[$," - ",b.data_akademik.program_pesantren]})}),e.jsx("td",{className:"px-6 py-4 text-xs text-gray-600 font-sans",children:b.data_akademik.asal_sekolah}),e.jsx("td",{className:"px-6 py-4 text-xs text-gray-500 font-sans",children:b.verifikasi_santri.bergabung}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(Qe,{onClick:()=>D(b),icon:e.jsxs("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),label:"Periksa",color:"blue"})})]},T)})})]})})]})]})},an=[{title:"Data Kepegawaian",description:"Manajemen Sumber Daya Manusia (SDM), Guru, dan Staff Pesantren."},{targetId:"pegawai-stats",title:"Statistik SDM",description:"Ringkasan jumlah pegawai berdasarkan status kepegawaian (Tetap/Honorer).",position:"bottom"},{targetId:"pegawai-header",title:"Manajemen Data",description:"Gunakan pencarian untuk menemukan staff, atau tombol 'Tambah Pegawai' untuk mendaftarkan SDM baru.",position:"bottom"},{targetId:"pegawai-table",title:"Daftar Pegawai",description:"Klik ikon detail untuk melihat profil lengkap, mencetak data, atau mengedit informasi.",position:"top"}],tn=()=>{var y,z,j,N,A,S,b,T,$,E,F;const[a,r]=s.useState([]),[t,o]=s.useState([]),[c,k]=s.useState(!0),[f,D]=s.useState(null),[B,p]=s.useState(!1),[m,u]=s.useState({nama:"",nip:"",jabatan:"",status:"Tetap Yayasan"}),[i,g]=s.useState(""),K=s.useMemo(()=>[{value:"Kepala Madrasah",label:"Kepala Madrasah"},{value:"Kepala Tata Usaha",label:"Kepala Tata Usaha"},{value:"Bendahara Yayasan",label:"Bendahara Yayasan"},{value:"Sekretaris",label:"Sekretaris"},{value:"Guru Tetap",label:"Guru Tetap"},{value:"Guru Honorer",label:"Guru Honorer"},{value:"Staff Administrasi",label:"Staff Administrasi"},{value:"Musyrif Asrama",label:"Musyrif Asrama"},{value:"Keamanan",label:"Keamanan"},{value:"Kebersihan",label:"Kebersihan"},{value:"Lainnya",label:"Lainnya"}],[]),h=async()=>{try{k(!0);const x=await G.getKepegawaian(),l=Array.isArray(x)?x:[x];o(l),r(l.map(I=>{var _,n,v,R,W;return{nip:((_=I.data_kepegawaian)==null?void 0:_.nip_niy)||"-",name:((n=I.data_pribadi)==null?void 0:n.nama_lengkap)||"Tanpa Nama",role:((v=I.data_kepegawaian)==null?void 0:v.jabatan_struktural)||((R=I.data_kepegawaian)==null?void 0:R.jenis_ptk)||"-",status:((W=I.data_kepegawaian)==null?void 0:W.status_karyawan)||"Aktif",originalData:I}}))}catch(x){console.error("Gagal memuat data pegawai:",x)}finally{k(!1)}};s.useEffect(()=>{h()},[]);const M=s.useMemo(()=>a.filter(x=>x.name.toLowerCase().includes(i.toLowerCase())||x.nip.toLowerCase().includes(i.toLowerCase())),[a,i]),w=M.filter(x=>x.status.includes("Tetap")).length,d=M.length-w,C=()=>{u({nama:"",nip:"",jabatan:"",status:"Tetap Yayasan"}),p(!0),window.scrollTo(0,0)},L=async()=>{if(!m.nama||!m.nip||!m.jabatan){alert("Nama, NIP, dan Jabatan wajib diisi.");return}try{k(!0);const x={id_pegawai:`EMP-${Date.now()}`,data_pribadi:{nama_lengkap:m.nama},data_kepegawaian:{nip_niy:m.nip,jabatan_struktural:m.jabatan,status_karyawan:m.status}},l=[x,...t];await G.updateKepegawaian(l),o(l),r(I=>[{nip:m.nip,name:m.nama,role:m.jabatan,status:m.status,originalData:x},...I]),p(!1),alert("Data berhasil ditambahkan.")}catch(x){console.error(x),alert("Gagal menyimpan data.")}finally{k(!1)}},P=async x=>{if(window.confirm("Apakah Anda yakin ingin menghapus data ini?"))try{k(!0);const l=t.filter(I=>{var _;return((_=I.data_kepegawaian)==null?void 0:_.nip_niy)!==x});await G.updateKepegawaian(l),o(l),r(I=>I.filter(_=>_.nip!==x)),alert("Data berhasil dihapus.")}catch(l){console.error(l),alert("Gagal menghapus data.")}finally{k(!1)}};return e.jsxs("div",{className:"space-y-6 animate-fade-in relative min-h-[600px] pb-24 font-sans",children:[e.jsx(ve,{tourId:"db_pegawai",steps:an}),!f&&!B&&e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"pegawai-stats",children:e.jsxs(Qa,{children:[e.jsx(ta,{label:"Total Pegawai",value:a.length,icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),color:"blue"}),e.jsx(ta,{label:"Tetap Yayasan",value:w,icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"purple"}),e.jsx(ta,{label:"Honorer/Kontrak",value:d,icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"gray"})]})}),e.jsx("div",{id:"pegawai-table",children:e.jsxs(Xa,{children:[e.jsx("div",{id:"pegawai-header",children:e.jsx(Ka,{title:"Daftar SDM & Guru",searchQuery:i,onSearchChange:g,placeholder:"Cari nama atau NIP...",actions:e.jsx(Ye,{label:"Tambah Pegawai",onClick:C,icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})}),e.jsx(Ra,{columns:["NIP / NIY","Nama Lengkap","Jabatan / Peran","Status","Aksi"],isEmpty:M.length===0,children:M.map((x,l)=>e.jsxs("tr",{className:"hover:bg-gray-50 transition group cursor-default",children:[e.jsx("td",{className:"px-6 py-4 font-sans text-gray-500 font-bold text-xs",children:x.nip}),e.jsx("td",{className:"px-6 py-4 font-bold text-gray-800",children:x.name}),e.jsx("td",{className:"px-6 py-4 text-gray-600 text-xs",children:x.role}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(Ia,{status:x.status})}),e.jsx("td",{className:"px-6 py-4 text-center w-[120px]",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Qe,{onClick:()=>{D(x.originalData),window.scrollTo(0,0)},icon:e.jsxs("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),color:"emerald"}),e.jsx(Qe,{onClick:()=>P(x.nip),icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),color:"red"})]})})]},l))})]})})]}),f&&e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-sm border border-gray-200 animate-fade-in-up overflow-hidden",children:[e.jsx(Za,{title:f.data_pribadi.nama_lengkap,subtitle:`NIP: ${f.data_kepegawaian.nip_niy}`,initial:f.data_pribadi.nama_lengkap.charAt(0),onClose:()=>D(null),actions:e.jsx(Ye,{label:"Cetak Data",onClick:()=>window.print(),icon:e.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})})})}),e.jsx("div",{className:"p-8 bg-gray-50/50 min-h-[600px]",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-5xl mx-auto",children:[e.jsxs(Xe,{title:"Data Pribadi",color:"emerald",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),children:[e.jsx(Ne,{label:"NIK (KTP)",value:(y=f.data_pribadi)==null?void 0:y.nik}),e.jsx(Ne,{label:"TTL",value:`${((z=f==null?void 0:f.data_pribadi)==null?void 0:z.tempat_lahir)||""}, ${((j=f==null?void 0:f.data_pribadi)==null?void 0:j.tanggal_lahir)||""}`}),e.jsx(Ne,{label:"Jenis Kelamin",value:((N=f.data_pribadi)==null?void 0:N.jenis_kelamin)==="L"?"Laki-laki":"Perempuan"}),e.jsx(Ne,{label:"Agama",value:(A=f.data_pribadi)==null?void 0:A.agama}),e.jsx(Ne,{label:"Alamat",value:(S=f.data_pribadi)==null?void 0:S.alamat_ktp})]}),e.jsxs(Xe,{title:"Informasi Kepegawaian",color:"blue",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),children:[e.jsx(Ne,{label:"Status",value:e.jsx(Ia,{status:((b=f.data_kepegawaian)==null?void 0:b.status_karyawan)||""})}),e.jsx(Ne,{label:"Jabatan",value:(T=f.data_kepegawaian)==null?void 0:T.jabatan_struktural}),e.jsx(Ne,{label:"Unit Kerja",value:($=f.data_kepegawaian)==null?void 0:$.unit_kerja}),e.jsx(Ne,{label:"Tgl Masuk",value:(E=f.data_kepegawaian)==null?void 0:E.tanggal_masuk}),e.jsx(Ne,{label:"Golongan",value:(F=f.data_kepegawaian)==null?void 0:F.golongan})]})]})})]}),B&&e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-sm border border-gray-200 p-8 animate-fade-in-up min-h-[600px] max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-100 pb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-sans font-bold text-2xl text-gray-900",children:"Tambah Pegawai Baru"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Masukkan data pokok untuk disimpan ke database."})]}),e.jsx("button",{onClick:()=>p(!1),className:"text-sm font-bold text-gray-500 hover:text-red-500 bg-gray-50 px-5 py-2.5 rounded-xl transition border border-gray-200 hover:bg-white hover:shadow-md",children:"Batal"})]}),e.jsxs("div",{className:"space-y-8 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer focus:bg-white",placeholder:" ",value:m.nama,onChange:x=>u({...m,nama:x.target.value})}),e.jsx("label",{className:"floating-label",children:"Nama Lengkap"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer focus:bg-white",placeholder:" ",value:m.nip,onChange:x=>u({...m,nip:x.target.value})}),e.jsx("label",{className:"floating-label",children:"NIP / NIY"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsx(de,{id:"jabatan-struktural",label:"Jabatan Struktural",value:m.jabatan,onChange:x=>u({...m,jabatan:x}),options:K,className:"!mb-0"}),e.jsx(de,{id:"status-pegawai",label:"Status Kepegawaian",value:m.status,onChange:x=>u({...m,status:x}),options:[{value:"Tetap Yayasan",label:"Tetap Yayasan"},{value:"Kontrak Tahunan",label:"Kontrak Tahunan"},{value:"Harian Lepas / Honorer",label:"Harian Lepas / Honorer"}],className:"!mb-0"})]}),e.jsxs("div",{className:"flex gap-4 pt-6 border-t border-gray-50 mt-6",children:[e.jsx("button",{onClick:()=>p(!1),className:"flex-1 py-4 bg-white border border-gray-200 text-gray-500 font-bold rounded-2xl hover:bg-gray-50 transition",children:"Batalkan"}),e.jsx(Ye,{onClick:L,label:c?"Menyimpan...":"Simpan Data",className:"flex-1 justify-center py-4 text-sm",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 00-2-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})})})]})]})]})]})},sn=[{title:"Dewan Masyayikh",description:"Database khusus untuk para Kiyai, Ustadz Senior, dan Pimpinan Pondok."},{targetId:"kyai-header",title:"Kelola Data",description:"Tambahkan data kiyai baru atau cari nama kiyai yang sudah terdaftar.",position:"bottom"},{targetId:"kyai-table",title:"Daftar Masyayikh",description:"Tabel ini menampilkan seluruh dewan guru senior. Anda bisa mengedit atau menghapus data jika diperlukan.",position:"top"}],nn=()=>{const[a,r]=s.useState([]),[t,o]=s.useState(!0),[c,k]=s.useState(""),[f,D]=s.useState(!1),[B,p]=s.useState(null),[m,u]=s.useState({id:"",nip:"",nama:"",jabatan:"",status:"Tetap Yayasan",santri:[]}),i=async()=>{o(!0);try{const w=await G.getDewanKiyai(),d=Array.isArray(w)?w:w?[w]:[];r(d)}catch(w){console.error(w)}finally{o(!1)}};s.useEffect(()=>{i()},[]);const g=async()=>{if(!m.nama||!m.jabatan){alert("Lengkapi data.");return}o(!0);try{const w={...m,id:m.id||`KYAI-${Date.now()}`};let d=[...a];m.id?d=d.map(C=>C.id===m.id?w:C):d.unshift(w),await G.updateDewanKiyai(d),r(d),D(!1),u({id:"",nip:"",nama:"",jabatan:"",status:"Tetap Yayasan",santri:[]})}catch{alert("Gagal menyimpan")}finally{o(!1)}},K=async w=>{if(confirm("Hapus data kiyai ini?")){o(!0);try{const d=a.filter(C=>C.id!==w);await G.updateDewanKiyai(d),r(d)}catch{alert("Gagal menghapus")}finally{o(!1)}}},h=w=>{u(w),D(!0)},M=a.filter(w=>w.nama.toLowerCase().includes(c.toLowerCase()));return e.jsxs("div",{className:"space-y-6 animate-fade-in relative min-h-[600px] pb-24 font-sans",children:[e.jsx(ve,{tourId:"db_kyai",steps:sn}),t&&e.jsx(fe,{message:"Memuat Data Masyayikh...",fullScreen:!1}),f?e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-sm border border-gray-200 p-8 animate-fade-in-up max-w-3xl mx-auto font-sans",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-100 pb-4",children:[e.jsx("h3",{className:"font-bold text-2xl text-gray-900",children:m.id?"Edit Data Kyai":"Tambah Kyai Baru"}),e.jsx("button",{onClick:()=>D(!1),className:"text-gray-400 hover:text-gray-600",children:"Batal"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:m.nama,onChange:w=>u({...m,nama:w.target.value})}),e.jsx("label",{className:"floating-label",children:"Nama Lengkap & Gelar"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:m.nip,onChange:w=>u({...m,nip:w.target.value})}),e.jsx("label",{className:"floating-label",children:"NIY / NIP"})]}),e.jsx(de,{id:"jabatan",label:"Jabatan",value:m.jabatan,onChange:w=>u({...m,jabatan:w}),options:[{value:"Pimpinan Pondok",label:"Pimpinan Pondok"},{value:"Pengasuh Asrama",label:"Pengasuh Asrama"},{value:"Musytasar",label:"Musytasar"},{value:"A'wan",label:"A'wan"}],className:"!mb-0"})]}),e.jsx("div",{className:"pt-4 flex justify-end",children:e.jsx(Ye,{label:"Simpan Data",onClick:g})})]})]}):e.jsx(e.Fragment,{children:e.jsx("div",{id:"kyai-table",children:e.jsxs(Xa,{children:[e.jsx("div",{id:"kyai-header",children:e.jsx(Ka,{title:"Daftar Kyai & Asatidz Senior",searchQuery:c,onSearchChange:k,actions:e.jsx(Ye,{label:"Tambah Data",onClick:()=>{u({id:"",nip:"",nama:"",jabatan:"",status:"Tetap Yayasan",santri:[]}),D(!0)},icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})}),e.jsx(Ra,{columns:["NIP / ID","Nama Lengkap","Jabatan","Status","Aksi"],isEmpty:M.length===0,children:M.map((w,d)=>e.jsxs("tr",{className:"hover:bg-emerald-50/30 transition border-b border-gray-50 last:border-0",children:[e.jsx("td",{className:"px-6 py-4 font-sans text-gray-500 text-xs",children:w.nip}),e.jsx("td",{className:"px-6 py-4 font-bold text-gray-900 font-sans",children:w.nama}),e.jsx("td",{className:"px-6 py-4 text-emerald-700 font-medium text-sm font-sans",children:w.jabatan}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(Ia,{status:w.status})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex justify-center gap-2",children:[e.jsx(Qe,{icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),onClick:()=>h(w),color:"blue"}),e.jsx(Qe,{icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),onClick:()=>K(w.id),color:"red"})]})})]},d))})]})})})]})},la=({children:a})=>e.jsx("div",{className:"space-y-6 animate-fade-in font-sans pb-24 relative min-h-[600px] text-slate-800",children:a}),et=({title:a,subtitle:r,action:t})=>e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8 font-sans",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-slate-900 tracking-tight",children:a}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 font-medium",children:r})]}),e.jsx("div",{className:"shrink-0 flex gap-3",children:t})]}),He=({children:a,className:r="",title:t,action:o})=>e.jsxs("div",{className:`bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden font-sans ${r}`,children:[(t||o)&&e.jsxs("div",{className:"px-6 py-4 border-b border-slate-100 flex justify-between items-center bg-slate-50/50",children:[t&&e.jsx("h3",{className:"font-bold text-slate-800 text-sm uppercase tracking-wide",children:t}),o&&e.jsx("div",{children:o})]}),e.jsx("div",{className:"p-6",children:a})]}),Aa=({label:a,value:r,icon:t,trend:o="neutral",subValue:c})=>{const k={neutral:"bg-slate-50 text-slate-600 border-slate-200",good:"bg-emerald-50 text-emerald-600 border-emerald-200",warning:"bg-amber-50 text-amber-600 border-amber-200",danger:"bg-rose-50 text-rose-600 border-rose-200"};return e.jsxs("div",{className:`p-5 rounded-xl border transition-all duration-200 ${k[o]} flex items-center justify-between gap-4 font-sans`,children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-widest opacity-70 mb-1",children:a}),e.jsx("h3",{className:"text-2xl font-black tracking-tight leading-none tabular-nums",children:r}),c&&e.jsx("p",{className:"text-xs font-medium mt-1 opacity-80",children:c})]}),e.jsx("div",{className:"text-2xl opacity-80",children:t})]})},Ue=({label:a,variant:r,className:t=""})=>{const o={success:"bg-emerald-100 text-emerald-700 border-emerald-200",warning:"bg-amber-100 text-amber-700 border-amber-200",danger:"bg-rose-100 text-rose-700 border-rose-200",info:"bg-blue-100 text-blue-700 border-blue-200",neutral:"bg-slate-100 text-slate-600 border-slate-200"};return e.jsx("span",{className:`px-2.5 py-0.5 rounded-md text-[10px] font-bold uppercase tracking-wider border font-sans ${o[r]} ${t}`,children:a})},ye=({onClick:a,label:r,icon:t,variant:o="primary",size:c="md",className:k="",disabled:f,type:D="button"})=>{const B="font-bold transition-all duration-200 flex items-center justify-center gap-2 rounded-lg border focus:outline-none focus:ring-2 focus:ring-offset-1 disabled:opacity-50 disabled:cursor-not-allowed font-sans",p={sm:"px-3 py-1.5 text-xs",md:"px-5 py-2.5 text-xs uppercase tracking-wide",lg:"px-6 py-3.5 text-sm"},m={primary:"bg-slate-900 text-white border-slate-900 hover:bg-slate-800 focus:ring-slate-500",secondary:"bg-white text-slate-600 border-slate-200 hover:bg-slate-50 hover:text-slate-900 focus:ring-slate-300",danger:"bg-white text-rose-600 border-rose-200 hover:bg-rose-50 hover:border-rose-300 focus:ring-rose-500",ghost:"bg-transparent text-slate-500 border-transparent hover:bg-slate-100 hover:text-slate-700"};return e.jsxs("button",{type:D,onClick:a,disabled:f,className:`${B} ${p[c]} ${m[o]} ${k}`,children:[t,r]})},at=({children:a})=>e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 font-sans",children:a}),ca=({label:a,value:r,mono:t})=>e.jsxs("div",{className:"flex justify-between items-center py-2 border-b border-slate-50 last:border-0 font-sans",children:[e.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase",children:a}),e.jsx("span",{className:`text-sm font-semibold text-slate-700 ${t?"tabular-nums":""}`,children:r})]}),$t=({headers:a,children:r,isEmpty:t})=>e.jsx("div",{className:"overflow-x-auto min-h-[300px] font-sans",children:e.jsxs("table",{className:"w-full text-left text-sm whitespace-nowrap",children:[e.jsx("thead",{className:"bg-slate-50 text-slate-500 font-bold uppercase text-[10px] tracking-wider border-b border-slate-200",children:e.jsx("tr",{children:a.map((o,c)=>e.jsx("th",{className:`px-6 py-4 ${c===a.length-1?"text-right":""}`,children:o},c))})}),e.jsx("tbody",{className:"divide-y divide-slate-100 bg-white",children:t?e.jsx("tr",{children:e.jsx("td",{colSpan:a.length,className:"text-center py-12 text-slate-400 italic",children:"Tidak ada data."})}):r})]})}),rn=[{title:"Administrasi Persuratan",description:"Kelola arsip surat masuk, surat keluar, dan template dokumen resmi pesantren."},{targetId:"surat-actions",title:"Aksi Cepat",description:"Gunakan tombol ini untuk mencatat surat baru atau mengunggah template dokumen.",position:"left"},{targetId:"surat-templates",title:"Template Dokumen",description:"Kumpulan format surat resmi yang sering digunakan. Klik untuk mengunduh atau melihat detail.",position:"bottom"},{targetId:"surat-arsip",title:"Arsip Surat",description:"Tabel riwayat surat masuk dan keluar. Gunakan filter untuk mencari dokumen spesifik.",position:"top"}],ln=()=>{const{fetchData:a}=ge(),[r,t]=s.useState([]),[o,c]=s.useState([]),[k,f]=s.useState(!0),[D,B]=s.useState("list"),[p,m]=s.useState("masuk"),[u,i]=s.useState(""),[g,K]=s.useState(null),[h,M]=s.useState("masuk"),w={id_surat:"",judul:"",perihal:"",kategori:"",pengirim:"",tertuju:"",tanggal:new Date().toISOString().split("T")[0],link:"",file:"doc"},[d,C]=s.useState(w);s.useEffect(()=>{(async()=>{var A,S;f(!0);try{const b=await a("adminPersuratan",G.getPersuratan,"Persuratan.tsx",!1,!1);Array.isArray(b)?(t(((A=b[0])==null?void 0:A.template)||[]),c(((S=b[0])==null?void 0:S.arsip)||[])):b&&(t(b.template||[]),c(b.arsip||[]))}catch(b){console.error(b)}finally{f(!1)}})()},[a]);const L=s.useMemo(()=>o.filter(N=>{const A=N.jenis===p,S=u.toLowerCase(),b=N.judul.toLowerCase().includes(S)||N.perihal.toLowerCase().includes(S)||N.id_surat.toLowerCase().includes(S);return A&&b}),[o,p,u]),P=N=>{M(N),C({...w,id_surat:N==="template"?`TPL-${Date.now().toString().slice(-4)}`:`SRT-${N==="masuk"?"IN":"OUT"}-${Date.now().toString().slice(-4)}`}),B("form"),window.scrollTo(0,0)},y=N=>{K(N),B("detail"),window.scrollTo(0,0)},z=()=>{if(!d.judul||!d.perihal)return alert("Judul dan Perihal wajib diisi.");if(h==="template"){const N={id_surat:d.id_surat,judul:d.judul,perihal:d.perihal,jenis:d.kategori||"Umum",link:d.link||"#",file:d.file};t([N,...r])}else{const N={id_surat:d.id_surat,jenis:h,judul:d.judul,perihal:d.perihal,pengirim:d.pengirim,tertuju:d.tertuju,timestamp:d.tanggal,link:d.link||"#",file:d.file};c([N,...o])}B("list")},j=N=>{const A=N.toLowerCase();let S="bg-gray-100 text-gray-600";return A.includes("pdf")&&(S="bg-rose-50 text-rose-600 border-rose-100"),A.includes("doc")&&(S="bg-blue-50 text-blue-600 border-blue-100"),A.includes("xls")&&(S="bg-emerald-50 text-emerald-600 border-emerald-100"),A.includes("ppt")&&(S="bg-amber-50 text-amber-600 border-amber-100"),e.jsx("span",{className:`text-[10px] font-black px-2 py-0.5 rounded uppercase border font-sans ${S}`,children:A.slice(0,3)})};return k?e.jsx(fe,{message:"Memuat Dokumen...",fullScreen:!1}):e.jsxs(la,{children:[e.jsx(ve,{tourId:"adm_persuratan",steps:rn}),D==="list"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"surat-actions",className:"flex justify-end gap-2 mb-6 animate-fade-in-up",children:[e.jsx(ye,{label:"Buat Template",size:"sm",variant:"secondary",onClick:()=>P("template"),icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 13h6m-3-3v6m5 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 011.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx(ye,{label:"Catat Surat",size:"sm",onClick:()=>P(p),icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),e.jsxs("div",{id:"surat-templates",className:"mb-8",children:[e.jsx("div",{className:"flex justify-between items-center mb-4 px-1",children:e.jsx("h4",{className:"text-xs font-black text-slate-400 uppercase tracking-widest font-sans",children:"Template Dokumen"})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[r.map((N,A)=>e.jsxs("div",{onClick:()=>y(N),className:"group bg-white border border-slate-200 p-4 rounded-xl hover:border-emerald-300 hover:shadow-md transition-all cursor-pointer relative overflow-hidden flex flex-col justify-between min-h-[120px]",children:[e.jsx("div",{className:"absolute top-0 right-0 p-3 opacity-10 group-hover:opacity-100 transition-opacity text-emerald-500",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),e.jsx("div",{className:"mb-2 w-fit",children:j(N.file)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-800 text-sm leading-snug line-clamp-2 mb-1 group-hover:text-emerald-700 transition-colors font-sans",children:N.judul}),e.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-wider font-sans",children:N.jenis})]})]},A)),e.jsxs("div",{onClick:()=>P("template"),className:"border-2 border-dashed border-slate-200 rounded-xl flex flex-col items-center justify-center text-slate-400 hover:border-emerald-300 hover:text-emerald-600 hover:bg-emerald-50/50 transition-all cursor-pointer min-h-[120px]",children:[e.jsx("svg",{className:"w-8 h-8 mb-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{className:"text-xs font-bold font-sans",children:"Upload Baru"})]})]})]}),e.jsx("div",{id:"surat-arsip",children:e.jsx(He,{title:"Arsip Persuratan",className:"min-h-[400px]",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:[e.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-lg w-fit",children:[e.jsx("button",{onClick:()=>m("masuk"),className:`px-4 py-2 rounded-md text-xs font-bold transition-all font-sans ${p==="masuk"?"bg-white text-emerald-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Surat Masuk"}),e.jsx("button",{onClick:()=>m("keluar"),className:`px-4 py-2 rounded-md text-xs font-bold transition-all font-sans ${p==="keluar"?"bg-white text-emerald-700 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Surat Keluar"})]}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("input",{type:"text",placeholder:"Cari surat...",value:u,onChange:N=>i(N.target.value),className:"w-full pl-9 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-lg text-xs font-bold text-slate-700 outline-none focus:ring-2 focus:ring-emerald-500 transition font-sans"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),e.jsx($t,{headers:["Dokumen","Detail Relasi","Tipe File","Aksi"],isEmpty:L.length===0,children:L.map((N,A)=>e.jsxs("tr",{onClick:()=>y(N),className:"hover:bg-slate-50 transition cursor-pointer group",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${p==="masuk"?"bg-blue-50 text-blue-600":"bg-amber-50 text-amber-600"}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 011.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-slate-800 text-sm mb-0.5 line-clamp-1 font-sans",children:N.judul}),e.jsxs("div",{className:"text-[10px] text-slate-500 flex gap-2 font-sans tabular-nums",children:[e.jsx("span",{className:"bg-slate-100 px-1.5 rounded text-slate-600 border border-slate-200",children:N.id_surat}),e.jsx("span",{children:N.timestamp})]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"text-xs font-sans",children:[e.jsxs("div",{className:"flex gap-2 mb-1",children:[e.jsx("span",{className:"text-[9px] font-bold text-slate-400 uppercase w-8",children:"Dari"}),e.jsx("span",{className:"font-semibold text-slate-700",children:N.pengirim||"-"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:"text-[9px] font-bold text-slate-400 uppercase w-8",children:"Ke"}),e.jsx("span",{className:"font-semibold text-slate-700",children:N.tertuju||"-"})]})]})}),e.jsx("td",{className:"px-6 py-4",children:j(N.file)}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx(ye,{size:"sm",variant:"ghost",onClick:S=>{S.stopPropagation(),y(N)},label:"Detail"})})]},A))})]})})})]}),D==="form"&&e.jsx(He,{title:h==="template"?"Upload Template Baru":`Catat Surat ${h==="masuk"?"Masuk":"Keluar"}`,className:"max-w-4xl mx-auto animate-fade-in-up font-sans",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-slate-50 cursor-not-allowed font-sans",value:d.id_surat,readOnly:!0,placeholder:" "}),e.jsx("label",{className:"floating-label font-sans",children:"ID Surat (Auto)"})]}),h!=="template"&&e.jsx(ze,{id:"tgl",label:"Tanggal Surat",value:d.tanggal,onChange:N=>C({...d,tanggal:N}),className:"!mb-0"}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer font-sans",value:d.judul,onChange:N=>C({...d,judul:N.target.value}),placeholder:" "}),e.jsx("label",{className:"floating-label font-sans",children:"Judul Dokumen"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer font-sans",value:d.perihal,onChange:N=>C({...d,perihal:N.target.value}),placeholder:" "}),e.jsx("label",{className:"floating-label font-sans",children:"Perihal"})]}),h==="template"?e.jsx(de,{id:"kategori",label:"Kategori",value:d.kategori,onChange:N=>C({...d,kategori:N}),options:[{value:"Administrasi",label:"Administrasi"},{value:"Perizinan",label:"Perizinan"},{value:"Keuangan",label:"Keuangan"}],className:"!mb-0"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer font-sans",value:d.pengirim,onChange:N=>C({...d,pengirim:N.target.value}),placeholder:" "}),e.jsx("label",{className:"floating-label font-sans",children:"Pengirim"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer font-sans",value:d.tertuju,onChange:N=>C({...d,tertuju:N.target.value}),placeholder:" "}),e.jsx("label",{className:"floating-label font-sans",children:"Tertuju"})]})]})]}),e.jsx("div",{className:"bg-slate-50 p-6 rounded-xl border border-slate-200",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex-1 floating-group !mb-0 !mt-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-white font-sans",value:d.link,onChange:N=>C({...d,link:N.target.value}),placeholder:" "}),e.jsx("label",{className:"floating-label bg-white font-sans",children:"Link File (G-Drive / PDF URL)"})]}),e.jsx("div",{className:"w-40",children:e.jsx(de,{id:"file-type",label:"Tipe File",value:d.file,onChange:N=>C({...d,file:N}),options:[{value:"pdf",label:"PDF"},{value:"doc",label:"Word"},{value:"xls",label:"Excel"}],className:"!mb-0 !mt-0"})})]})}),e.jsxs("div",{className:"flex justify-end gap-4 pt-6 border-t border-slate-100",children:[e.jsx(ye,{label:"Batal",variant:"secondary",onClick:()=>B("list"),className:"flex-1"}),e.jsx(ye,{label:"Simpan Dokumen",variant:"primary",onClick:z,className:"flex-1"})]})]})}),D==="detail"&&g&&e.jsxs("div",{className:"animate-fade-in-up font-sans",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>B("list"),className:"p-2 bg-white rounded-lg border border-slate-200 text-slate-500 hover:text-emerald-600 hover:border-emerald-200 transition-all shadow-sm",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7 7-7m-7 7h18"})})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900",children:g.judul}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-500 mt-1",children:[e.jsx(Ue,{label:g.jenis||"Template",variant:"info",className:"text-[9px] px-1.5 py-0"}),e.jsx("span",{className:"font-sans bg-slate-100 px-2 py-0.5 rounded text-slate-600 border border-slate-200",children:g.id_surat})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 h-[75vh] bg-slate-800 rounded-2xl shadow-xl overflow-hidden flex flex-col relative border border-slate-700",children:g.link&&g.link!=="#"?e.jsx("iframe",{src:g.link.includes("drive.google.com")?g.link.replace("/view","/preview"):g.link,className:"w-full h-full border-none bg-white",title:"Preview"}):e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center flex-col text-slate-400",children:[e.jsx("svg",{className:"w-16 h-16 mb-4 opacity-50",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("p",{className:"text-sm font-sans",children:"Preview tidak tersedia atau link rusak."}),e.jsx("a",{href:g.link,target:"_blank",rel:"noreferrer",className:"mt-4 px-4 py-2 bg-slate-700 rounded-lg text-xs hover:bg-slate-600 transition font-sans",children:"Buka Link Asli"})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(He,{title:"Informasi Dokumen",children:e.jsxs("div",{className:"space-y-1",children:["timestamp"in g&&e.jsx(ca,{label:"Tanggal",value:g.timestamp}),e.jsx(ca,{label:"Perihal",value:g.perihal}),"pengirim"in g&&e.jsx(ca,{label:"Pengirim",value:g.pengirim||"-"}),"tertuju"in g&&e.jsx(ca,{label:"Tertuju",value:g.tertuju||"-"}),e.jsx(ca,{label:"Tipe File",value:g.file.toUpperCase(),mono:!0})]})}),e.jsxs("div",{className:"bg-emerald-50 rounded-xl p-5 border border-emerald-100 flex flex-col gap-3",children:[e.jsx("h4",{className:"text-sm font-bold text-emerald-800 font-sans",children:"Aksi Cepat"}),e.jsx(ye,{label:"Download File",variant:"primary",onClick:()=>window.open(g.link,"_blank"),className:"w-full justify-center",icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})})}),e.jsx(ye,{label:"Hapus Dokumen",variant:"danger",onClick:()=>{confirm("Hapus?")&&B("list")},className:"w-full justify-center",icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]})]})]})]})},on=[{title:"Manajemen Hak Akses",description:"Kontrol penuh atas siapa yang bisa mengakses sistem admin dan apa yang bisa mereka lakukan."},{targetId:"hak-add-btn",title:"Tambah Admin",description:"Buat akun admin baru dengan peran spesifik (Keuangan, Koperasi, atau Umum).",position:"bottom"},{targetId:"hak-list",title:"Daftar Administrator",description:"Klik pada kartu admin untuk mengedit detail akses. Anda bisa mengatur izin per-modul (View/Input/Super).",position:"top"}],dn=()=>{const[a,r]=s.useState([]),[t,o]=s.useState(!0),[c,k]=s.useState(""),[f,D]=s.useState(!1),[B,p]=s.useState(!1),[m,u]=s.useState({id_akun:"",id_santri:"-",username:"",email:"",peran:"admin_umum",nama:"",status:"terverifikasi",telepon:"",hash_kata_sandi:"",dibuat:"",akses:[],filter_santri:""});s.useEffect(()=>{i()},[]);const i=async()=>{o(!0);try{const y=await G.getRoles(),j=(Array.isArray(y)?y:[]).map(N=>({...N,data_akun:{...N.data_akun,status:N.data_akun.status||"terverifikasi"}}));r(j)}catch(y){console.error("Gagal memuat data role:",y)}finally{o(!1)}},g=()=>{p(!1),u({id_akun:`ADM-${Date.now().toString().slice(-4)}`,id_santri:"-",username:"",email:"",peran:"admin_umum",nama:"",status:"terverifikasi",telepon:"",hash_kata_sandi:"",dibuat:new Date().toISOString(),akses:[],filter_santri:""}),D(!0)},K=y=>{p(!0),u({id_akun:y.verifikasi_akun.id_akun,id_santri:y.verifikasi_akun.id_santri||"-",...y.data_akun,status:y.data_akun.status||"terverifikasi",akses:y.data_akun.akses||[],filter_santri:y.data_akun.filter_santri||""}),D(!0)},h=async()=>{let y=[...a];const z={verifikasi_akun:{id_akun:m.id_akun,id_santri:m.id_santri},data_akun:{username:m.username||m.email,email:m.email,peran:m.peran,nama:m.nama,status:m.status,telepon:m.telepon,hash_kata_sandi:m.hash_kata_sandi,dibuat:m.dibuat||new Date().toISOString(),akses:m.akses||[],filter_santri:m.filter_santri||""}};B?y=y.map(j=>j.verifikasi_akun.id_akun===m.id_akun?z:j):y.push(z);try{await G.updateRoles(y),r(y),D(!1)}catch{alert("Gagal menyimpan.")}},w=["dashboard","administrasi/agenda","administrasi/persuratan","database/kepegawaian","database/santri","keuangan/administrasi","keuangan/aturbiaya","keuangan/bangunan","keuangan/bukutunggakan","keuangan/harian","keuangan/makan","keuangan/operasional","keuangan/phbi","keuangan/transaksiumum","koperasi/produk","koperasi/transaksi","sistem/hakadmin","sistem/manajemenai","sistem/manajemendonasi","sistem/manajemenpostingan","sistem/manajemenpublikasi","sistem/manajementampilan","sistem/pengguna","sistem/pengaturanakun"].reduce((y,z)=>{if(z==="dashboard")return y.Utama||(y.Utama=[]),y.Utama.push(z),y;const[j,N]=z.split("/"),A=j.charAt(0).toUpperCase()+j.slice(1);return y[A]||(y[A]=[]),y[A].push(z),y},{}),d=y=>{const z=y.replace("[","").replace("]",""),[j,N]=z.split(":").map(A=>A.trim());return{module:j,level:N}},C=(y,z)=>{const j=`[${y} : ${z}]`;let N=[...m.akses||[]].filter(S=>!S.startsWith(`[${y}`));const A=(m.akses||[]).find(S=>S.startsWith(`[${y}`));(!A||d(A).level!==z)&&N.push(j),u({...m,akses:N})},L=y=>{switch(y){case"admin_sistem":return"danger";case"admin_umum":return"info";case"admin_koperasi":return"warning";default:return"success"}},P=a.filter(y=>y.data_akun.nama.toLowerCase().includes(c.toLowerCase()));return t?e.jsx("div",{className:"p-12 text-center text-slate-400 font-sans animate-pulse",children:"Memuat hak akses..."}):e.jsxs(la,{children:[e.jsx(ve,{tourId:"sys_hakadmin",steps:on}),f?e.jsx(He,{title:"Konfigurasi Hak Akses",className:"max-w-4xl mx-auto animate-fade-in-up font-sans",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-6 bg-slate-50 p-4 rounded-xl border border-slate-200 mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase mb-1",children:"Nama Pengguna"}),e.jsx("p",{className:"text-lg font-bold text-slate-800",children:m.nama})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase mb-1",children:"Role Utama"}),e.jsx(Ue,{label:m.peran,variant:L(m.peran)})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-purple-100 shadow-sm",children:[e.jsx("p",{className:"text-xs font-bold text-purple-700 uppercase tracking-widest mb-3",children:"Scope Data (Pembatasan Wilayah)"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("button",{onClick:()=>u({...m,filter_santri:""}),className:`p-3 rounded-lg text-xs font-bold transition-all border ${m.filter_santri===""?"bg-purple-600 text-white border-purple-600":"bg-white text-slate-500 border-slate-200 hover:border-purple-300"}`,children:"Semua (Global)"}),e.jsx("button",{onClick:()=>u({...m,filter_santri:"L"}),className:`p-3 rounded-lg text-xs font-bold transition-all border ${m.filter_santri==="L"?"bg-purple-600 text-white border-purple-600":"bg-white text-slate-500 border-slate-200 hover:border-purple-300"}`,children:"Khusus Putra (L)"}),e.jsx("button",{onClick:()=>u({...m,filter_santri:"P"}),className:`p-3 rounded-lg text-xs font-bold transition-all border ${m.filter_santri==="P"?"bg-purple-600 text-white border-purple-600":"bg-white text-slate-500 border-slate-200 hover:border-purple-300"}`,children:"Khusus Putri (P)"})]}),e.jsx("p",{className:"text-[10px] text-slate-400 mt-2 italic",children:"Admin dengan scope khusus hanya dapat melihat data santri sesuai jenis kelamin yang dipilih."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center pb-2 border-b border-slate-100",children:[e.jsx("h4",{className:"font-bold text-sm text-slate-700",children:"Permission Matrix"}),e.jsxs("div",{className:"flex gap-4 text-[10px] uppercase font-bold text-slate-400",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-slate-100 border border-slate-300"})," None"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-100 border border-blue-400"})," View"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-emerald-100 border border-emerald-400"})," Input"]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-rose-100 border border-rose-400"})," Super"]})]})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto custom-scrollbar pr-2 space-y-6",children:Object.entries(w).map(([y,z])=>e.jsxs("div",{children:[e.jsx("h5",{className:"text-xs font-black text-slate-400 uppercase tracking-widest mb-2 border-b border-slate-100 pb-1",children:y}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:z.map(j=>{const N=(m.akses||[]).find(b=>b.startsWith(`[${j}`)),A=N?d(N).level:"none",S=j.includes("/")?j.split("/")[1]:j;return e.jsxs("div",{className:"bg-white p-3 rounded-lg border border-slate-200 flex justify-between items-center hover:border-slate-300 transition-colors",children:[e.jsx("span",{className:"text-xs font-bold uppercase text-slate-600 tracking-tight",children:S.replace(/_/g," ")}),e.jsx("div",{className:"flex bg-slate-100 rounded-lg p-0.5",children:["view","input","super"].map(b=>e.jsx("button",{onClick:()=>C(j,b),className:`px-3 py-1 text-[9px] font-bold uppercase rounded-md transition-all ${A===b?b==="super"?"bg-rose-500 text-white shadow-sm":b==="input"?"bg-emerald-500 text-white shadow-sm":"bg-blue-500 text-white shadow-sm":"text-slate-400 hover:text-slate-600 hover:bg-slate-200"}`,children:b.charAt(0).toUpperCase()},b))})]},j)})})]},y))})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-100 flex gap-4",children:[e.jsx(ye,{label:"Batal",variant:"secondary",onClick:()=>D(!1),className:"flex-1"}),e.jsx(ye,{label:"Simpan Akses",variant:"primary",onClick:h,className:"flex-1"})]})]})}):e.jsxs("div",{className:"font-sans",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-end items-center gap-4 mb-6",children:[e.jsxs("div",{id:"hak-search",className:"relative flex-1 md:max-w-xs w-full",children:[e.jsx("input",{type:"text",placeholder:"Cari admin...",value:c,onChange:y=>k(y.target.value),className:"w-full pl-9 pr-4 py-2.5 bg-white border border-gray-200 rounded-xl text-xs font-bold text-gray-700 outline-none focus:ring-2 focus:ring-emerald-500 transition shadow-sm"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{id:"hak-add-btn",children:e.jsx(ye,{label:"Tambah Admin",onClick:g,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})]}),e.jsx("div",{id:"hak-list",children:e.jsx(at,{children:P.map(y=>e.jsxs("div",{onClick:()=>K(y),className:"bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition p-6 cursor-pointer group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-slate-100 flex items-center justify-center font-bold text-xl text-slate-600 border border-slate-200",children:y.data_akun.nama.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-slate-900 text-sm leading-tight",children:y.data_akun.nama}),e.jsx("p",{className:"text-xs text-slate-500 font-medium",children:y.data_akun.email}),e.jsxs("div",{className:"mt-1 flex gap-2",children:[e.jsx(Ue,{label:y.data_akun.peran,variant:L(y.data_akun.peran),className:"text-[9px] px-1.5 py-0"}),y.data_akun.filter_santri&&e.jsx("span",{className:"text-[9px] px-1.5 py-0 rounded border bg-purple-50 text-purple-700 border-purple-100 uppercase font-bold tracking-wider",children:y.data_akun.filter_santri==="L"?"Putra Only":"Putri Only"})]})]})]}),e.jsx("span",{className:"text-[9px] bg-slate-50 px-2 py-1 rounded text-slate-400 font-mono border border-slate-100",children:y.verifikasi_akun.id_akun})]}),e.jsxs("div",{className:"bg-slate-50 rounded-lg p-3 border border-slate-100",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-2",children:"Modul Terdaftar"}),e.jsxs("div",{className:"flex flex-wrap gap-1.5",children:[y.data_akun.akses&&y.data_akun.akses.length>0?y.data_akun.akses.slice(0,5).map((z,j)=>{const{module:N}=d(z),A=N.includes("/")?N.split("/")[1]:N;return e.jsx("span",{className:"text-[9px] px-1.5 py-0.5 rounded border bg-white text-slate-600 border-slate-200",children:A},j)}):e.jsx("span",{className:"text-xs text-slate-400 italic",children:"Akses Default Role"}),y.data_akun.akses&&y.data_akun.akses.length>5&&e.jsxs("span",{className:"text-[9px] px-1.5 py-0.5 rounded bg-slate-200 text-slate-600",children:["+",y.data_akun.akses.length-5]})]})]})]},y.verifikasi_akun.id_akun))})})]})]})},Ta=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(a).replace("Rp","Rp "),cn=a=>{const r=document.createElement("canvas"),t=r.getContext("2d");if(!t){alert("Browser tidak mendukung pembuatan gambar.");return}const o=800,c=280,k=50,f=a.produk.length||1,B=c+f*k+250;r.width=o,r.height=B,t.fillStyle="#ffffff",t.fillRect(0,0,o,B),t.fillStyle="#064e3b",t.fillRect(0,0,o,120),t.fillStyle="#ffffff",t.font="bold 32px Arial, sans-serif",t.textAlign="center",t.fillText("KOPERASI MIFTAHUL HUDA",o/2,50),t.font="16px Arial, sans-serif",t.fillStyle="#a7f3d0",t.fillText("Jl. Pesantren No. 10, Jawa Barat, Indonesia",o/2,80),t.fillStyle="#000000",t.font="bold 28px Arial, sans-serif",t.textAlign="center",t.fillText("NOTA TRANSAKSI",o/2,170),t.textAlign="left",t.fillStyle="#555555",t.font="18px Arial, sans-serif",t.fillText("No. Ref",50,220),t.fillText("Tanggal",50,250),t.fillStyle="#000000",t.font="bold 18px Arial, sans-serif",t.fillText(`: ${a.id_transaksi}`,150,220),t.fillText(`: ${a.jenis_transaksi.tanggal}`,150,250),t.textAlign="right",t.fillStyle="#555555",t.font="18px Arial, sans-serif",t.fillText("Pembeli",o-50,220),t.fillStyle="#000000",t.font="bold 20px Arial, sans-serif",t.fillText(a.pihak.nama,o-50,250),t.font="16px Arial, sans-serif",t.fillStyle="#666666",t.fillText(a.pihak.kategori,o-50,275),t.beginPath(),t.moveTo(50,290),t.lineTo(o-50,290),t.lineWidth=2,t.strokeStyle="#e5e7eb",t.stroke();let p=330;t.textAlign="left",t.font="bold 16px Arial, sans-serif",t.fillStyle="#064e3b",t.fillText("ITEM / PRODUK",50,p),t.textAlign="center",t.fillText("QTY",450,p),t.textAlign="right",t.fillText("HARGA",600,p),t.fillText("SUBTOTAL",o-50,p),p+=20,t.font="16px Arial, sans-serif",t.fillStyle="#333333",a.produk&&a.produk.length>0?a.produk.forEach(g=>{p+=40,t.textAlign="left",t.fillText(g.nama,50,p),t.textAlign="center",t.fillText(g.qty.toString(),450,p),t.textAlign="right",t.fillText(Ta(g.harga_jual),600,p),t.font="bold 16px Arial, sans-serif",t.fillText(Ta(g.qty*g.harga_jual),o-50,p),t.font="16px Arial, sans-serif"}):(p+=40,t.textAlign="left",t.fillText(a.jenis_transaksi.keterangan||"Transaksi Umum",50,p),t.textAlign="center",t.fillText("1",450,p),t.textAlign="right",t.font="bold 16px Arial, sans-serif",t.fillText(Ta(Math.abs(a.jenis_transaksi.total_nominal)),o-50,p)),p+=40,t.beginPath(),t.moveTo(50,p),t.lineTo(o-50,p),t.strokeStyle="#000000",t.stroke(),p+=50,t.textAlign="left",t.font="bold 24px Arial, sans-serif",t.fillStyle="#000000",t.fillText("TOTAL BAYAR",50,p),t.textAlign="right",t.font="bold 36px Arial, sans-serif",t.fillStyle="#064e3b",t.fillText(Ta(Math.abs(a.jenis_transaksi.total_nominal)),o-50,p),p+=80;const m=a.jenis_transaksi.status||"SELESAI";t.save(),t.translate(100,p),t.rotate(-.1),t.beginPath(),t.lineWidth=4,t.strokeStyle=m==="Lunas"||m==="Selesai"?"#059669":"#d97706",t.roundRect(0,0,200,60,10),t.stroke(),t.font="bold 28px Courier New, monospace",t.fillStyle=m==="Lunas"||m==="Selesai"?"#059669":"#d97706",t.textAlign="center",t.fillText(m.toUpperCase(),100,40),t.restore(),t.textAlign="center",t.fillStyle="#666666",t.font="14px Arial, sans-serif",t.fillText("Petugas Admin",o-100,p),t.fillText("( ________________ )",o-100,p+70),t.textAlign="center",t.fillStyle="#9ca3af",t.font="italic 12px Arial, sans-serif",t.fillText(`Dicetak otomatis oleh Sistem Miftahul Huda pada ${new Date().toLocaleString("id-ID")}`,o/2,B-30);const u=r.toDataURL("image/png"),i=document.createElement("a");i.href=u,i.download=`Nota_${a.id_transaksi}.png`,document.body.appendChild(i),i.click(),document.body.removeChild(i)},Ie=a=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(a).replace("Rp","Rp "),zt=({data:a,fileName:r,columns:t,title:o="Laporan Koperasi",subtitle:c=""})=>{const[k,f]=s.useState(!1),D=()=>{const m=a.map(u=>{const i={};return t.forEach(g=>{i[g.header]=g.accessor(u)}),i});Ba(m,r),f(!1)},B=()=>{Tt(a,r),f(!1)},p=()=>{const m=t.map(K=>`<th style="padding:12px 8px; text-align:left; background-color:#f1f5f9; border-bottom:2px solid #e2e8f0; font-size:10px; font-weight:800; text-transform:uppercase; color:#475569;">${K.header}</th>`).join(""),u=a.map((K,h)=>{const M=h%2===0?"#ffffff":"#f8fafc",w=t.map(d=>`<td style="padding:10px 8px; border-bottom:1px solid #e2e8f0; font-size:11px; color:#334155;">${d.accessor(K)}</td>`).join("");return`<tr style="background-color:${M};">${w}</tr>`}).join(""),i=`
            <div style="font-family:'Inter', sans-serif;">
                <div style="margin-bottom:20px; border-bottom:2px solid #064e3b; padding-bottom:15px;">
                    <h1 style="font-size:18px; font-weight:bold; color:#0f172a; margin:0;">${o}</h1>
                    <p style="font-size:12px; color:#64748b; margin:4px 0 0 0;">${c}</p>
                    <p style="font-size:10px; color:#94a3b8; margin:4px 0 0 0;">Dicetak pada: ${new Date().toLocaleString("id-ID")}</p>
                </div>
                <table style="width:100%; border-collapse:collapse; margin-top:10px;">
                    <thead><tr>${m}</tr></thead>
                    <tbody>${u}</tbody>
                </table>
                 <div style="margin-top:30px; text-align:right; font-size:10px; color:#94a3b8;">
                    <p>Total Data: ${a.length} baris</p>
                </div>
            </div>
        `,g=qa(o,i);Ya(g),f(!1)};return e.jsxs("div",{className:"relative z-20",children:[e.jsxs("button",{onClick:()=>f(!k),className:"bg-white border border-gray-200 text-gray-600 px-4 py-2.5 rounded-xl text-xs font-bold hover:bg-gray-50 hover:text-gray-900 transition-all flex items-center gap-2 shadow-sm h-[42px]",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),"Export",e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:`h-3 w-3 transition-transform ${k?"rotate-180":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),k&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>f(!1)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 bg-white rounded-xl shadow-xl border border-gray-100 p-2 min-w-[160px] z-20 flex flex-col gap-1 animate-fade-in-up",children:[e.jsxs("button",{onClick:D,className:"flex items-center gap-3 px-3 py-2 text-xs font-medium text-gray-700 hover:bg-emerald-50 hover:text-emerald-700 rounded-lg transition-colors text-left w-full",children:[e.jsxs("svg",{className:"w-4 h-4 text-emerald-600",fill:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{d:"M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8l-6-6zM6 20V4h7v5h5v11H6z"}),e.jsx("path",{d:"M14 10V4l5 5h-5z"})]}),"Excel (.csv)"]}),e.jsxs("button",{onClick:p,className:"flex items-center gap-3 px-3 py-2 text-xs font-medium text-gray-700 hover:bg-rose-50 hover:text-rose-700 rounded-lg transition-colors text-left w-full",children:[e.jsx("svg",{className:"w-4 h-4 text-rose-600",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5v.5zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5v3zm4-3H19v1h1.5v1.5H19v2h-1.5V7h3v1.5zM9 9.5h1v-1H9v1zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm10 5.5h1v-3h-1v3z"})}),"PDF Document"]}),e.jsxs("button",{onClick:B,className:"flex items-center gap-3 px-3 py-2 text-xs font-medium text-gray-700 hover:bg-amber-50 hover:text-amber-700 rounded-lg transition-colors text-left w-full",children:[e.jsx("svg",{className:"w-4 h-4 text-amber-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"JSON Data"]})]})]})]})},Da=({title:a,value:r,subtitle:t,icon:o,colorClass:c,trend:k})=>e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] border border-gray-100 shadow-sm hover:shadow-lg transition-all duration-300 group relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 right-0 w-24 h-24 rounded-bl-[4rem] opacity-20 transition-transform group-hover:scale-110 ${c.split(" ")[0]}`}),e.jsxs("div",{className:"relative z-10 flex flex-col h-full justify-between",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-2xl flex items-center justify-center text-xl shadow-sm ${c}`,children:o}),k&&e.jsx("span",{className:`text-[10px] font-bold px-2 py-1 rounded-full uppercase tracking-wider ${k==="up"?"bg-green-50 text-green-600":"bg-red-50 text-red-600"}`,children:k==="up"?"▲ Naik":"▼ Turun"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-1",children:a}),e.jsx("h3",{className:"text-2xl md:text-3xl font-black text-gray-900 tracking-tight",children:r}),e.jsx("p",{className:"text-xs text-gray-500 mt-1 font-medium",children:t})]})]})]}),mn=({status:a})=>{let r="bg-gray-100 text-gray-600";return["Selesai","Lunas","Sukses","Success"].includes(a)&&(r="bg-emerald-100 text-emerald-700 border-emerald-200"),["Proses","Pending"].includes(a)&&(r="bg-amber-100 text-amber-700 border-amber-200"),["Batal","Gagal","Failed"].includes(a)&&(r="bg-rose-100 text-rose-700 border-rose-200"),e.jsx("span",{className:`px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-widest border ${r}`,children:a})},Ge=({onClick:a,label:r,icon:t,variant:o="primary",className:c=""})=>{const k="px-5 py-2.5 rounded-xl text-xs font-bold transition-all duration-300 flex items-center justify-center gap-2 transform active:scale-95",f={primary:"bg-emerald-600 text-white hover:bg-emerald-700 shadow-lg shadow-emerald-600/20 hover:-translate-y-0.5",secondary:"bg-white border border-gray-200 text-gray-600 hover:bg-gray-50 hover:text-gray-900 hover:border-gray-300 shadow-sm",danger:"bg-rose-50 text-rose-600 border border-rose-100 hover:bg-rose-100 hover:border-rose-200",ghost:"bg-transparent text-gray-500 hover:text-emerald-600 hover:bg-emerald-50"};return e.jsxs("button",{onClick:a,className:`${k} ${f[o]} ${c}`,children:[t,r]})},un=({data:a,color:r})=>{if(!a||a.length===0)return e.jsx("div",{className:"h-48 flex items-center justify-center text-gray-400 text-xs italic font-medium bg-gray-50 rounded-3xl border border-dashed border-gray-200",children:"Belum ada data visualisasi."});const t=180,o=800,c=20,k=Math.max(...a.map(p=>p.value))*1.2||100,f=a.map((p,m)=>{const u=m/(a.length-1||1)*(o-c*2)+c,i=t-p.value/k*(t-c*2)-c;return{x:u,y:i,value:p.value,date:p.date,modal:p.modal,sales:p.sales}});let D=`M ${f[0].x} ${f[0].y}`;f.forEach((p,m)=>{if(m===0)return;const u=f[m-1],i=u.x+(p.x-u.x)/2,g=u.y,K=u.x+(p.x-u.x)/2,h=p.y;D+=` C ${i} ${g} ${K} ${h} ${p.x} ${p.y}`});const B=`${D} L ${f[f.length-1].x} ${t} L ${f[0].x} ${t} Z`;return e.jsx("div",{className:"relative w-full h-48 overflow-hidden group rounded-2xl bg-white",children:e.jsxs("svg",{viewBox:`0 0 ${o} ${t}`,className:"w-full h-full",preserveAspectRatio:"none",children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"gradientArea",x1:"0",x2:"0",y1:"0",y2:"1",children:[e.jsx("stop",{offset:"0%",stopColor:r,stopOpacity:"0.15"}),e.jsx("stop",{offset:"100%",stopColor:r,stopOpacity:"0"})]})}),e.jsx("path",{d:B,fill:"url(#gradientArea)",stroke:"none"}),e.jsx("path",{d:D,fill:"none",stroke:r,strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),f.map((p,m)=>e.jsxs("g",{className:"group/dot",children:[e.jsx("circle",{cx:p.x,cy:p.y,r:"4",fill:"white",stroke:r,strokeWidth:"2.5",className:"transition-all duration-300 group-hover/dot:r-6 cursor-pointer opacity-0 group-hover:opacity-100"}),e.jsx("foreignObject",{x:p.x-60,y:p.y-90,width:"120",height:"80",className:"opacity-0 group-hover/dot:opacity-100 transition-all duration-200 pointer-events-none z-50",children:e.jsxs("div",{className:"bg-slate-800 text-white p-2 rounded-lg shadow-xl text-[10px] text-center",children:[e.jsx("div",{className:"font-bold opacity-70 mb-1",children:p.date}),e.jsx("div",{className:"font-bold text-emerald-400 text-sm",children:Ie(p.sales)})]})})]},m))]})})},xn=({data:a})=>{const r=a.reduce((o,c)=>o+c.value,0)||1;let t=0;return e.jsxs("div",{className:"relative w-40 h-40",children:[e.jsx("svg",{viewBox:"0 0 100 100",className:"transform -rotate-90 w-full h-full drop-shadow-xl",children:a.map((o,c)=>{const k=o.value/r,f=251.2,D=`${k*f} ${f}`,B=-t*f;return t+=k,e.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"transparent",stroke:o.color,strokeWidth:"12",strokeDasharray:D,strokeDashoffset:B,className:"transition-all duration-1000 ease-out hover:opacity-90 hover:stroke-[14px]"},c)})}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none",children:[e.jsx("span",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-widest",children:"Total"}),e.jsxs("span",{className:"text-sm font-black text-gray-800",children:[(r/1e6).toFixed(1),"Jt"]})]})]})},hn=[{title:"Jurnal Transaksi Koperasi",description:"Halaman ini adalah pusat aktivitas kasir dan pencatatan keuangan unit usaha koperasi."},{targetId:"kop-tabs",title:"Mode Tampilan",description:"Gunakan 'Ringkasan' untuk melihat grafik profit & omset, atau 'Data Transaksi' untuk melihat tabel detail.",position:"bottom"},{targetId:"kop-filters",title:"Filter & Laporan",description:"Saring data berdasarkan jenis (Pemasukan/Pengeluaran/Kredit) dan rentang tanggal untuk kebutuhan laporan.",position:"bottom"},{targetId:"kop-action-btn",title:"Kasir / Input Transaksi",description:"Klik tombol ini untuk membuka formulir kasir. Anda bisa mencatat penjualan ke santri, umum, atau belanja stok.",position:"left"},{targetId:"kop-stats-cards",title:"Indikator Utama",description:"Pantau Kas Koperasi, Total Omset, dan Piutang (Kredit) secara real-time di sini.",position:"bottom"}],pn=({transaksiList:a,produkList:r,santriList:t,onUpdateTransaksi:o,isFormOpen:c,setFormOpen:k,filterMode:f,setFilterMode:D,searchQuery:B,setSearchQuery:p,startDate:m,setStartDate:u,endDate:i,setEndDate:g,onExport:K})=>{const[h,M]=s.useState("Ringkasan"),[w,d]=s.useState(null),[C,L]=s.useState("newest"),[P,y]=s.useState(null),z=s.useRef(null),[j,N]=s.useState(!1),A=s.useRef(null),[S,b]=s.useState(!1),[T,$]=s.useState(null);s.useEffect(()=>{function H(ee){z.current&&!z.current.contains(ee.target)&&y(null),A.current&&!A.current.contains(ee.target)&&N(!1)}return document.addEventListener("mousedown",H),()=>document.removeEventListener("mousedown",H)},[]);const E=(H,ee)=>{H.stopPropagation(),y(P===ee?null:ee)},F=(H,ee)=>{if(H.stopPropagation(),y(null),window.confirm("HAPUS PERMANEN? Data transaksi ini akan dihapus dari server.")){const le=a.filter(O=>O.id_transaksi!==ee);o(le)}},x=H=>{cn(H),y(null)},l=H=>{const ee=H.produk.map(Q=>`
        <tr>
            <td style="padding: 8px; border-bottom: 1px solid #eee;">${Q.nama}</td>
            <td style="padding: 8px; border-bottom: 1px solid #eee; text-align: center;">${Q.qty}</td>
            <td style="padding: 8px; border-bottom: 1px solid #eee; text-align: right;">${Ie(Q.harga_jual)}</td>
            <td style="padding: 8px; border-bottom: 1px solid #eee; text-align: right;">${Ie(Q.qty*Q.harga_jual)}</td>
        </tr>
      `).join(""),le=`
        <div style="max-width: 600px; margin: 0 auto;">
            <div style="text-align: center; margin-bottom: 20px;">
                <h2 style="margin: 0; color: #064e3b;">KOPERASI MIFTAHUL HUDA</h2>
                <p style="margin: 5px 0; font-size: 12px; color: #64748b;">Jl. Pesantren No. 10, Jawa Barat, Indonesia</p>
            </div>
            
            <div style="display: flex; justify-content: space-between; margin-bottom: 20px; font-size: 12px; border-top: 1px solid #e2e8f0; border-bottom: 1px solid #e2e8f0; padding: 10px 0;">
                <div>
                    <p><strong>No. Ref:</strong> ${H.id_transaksi}</p>
                    <p><strong>Tanggal:</strong> ${new Date(H.jenis_transaksi.tanggal).toLocaleString("id-ID")}</p>
                </div>
                <div style="text-align: right;">
                    <p><strong>Pembeli:</strong> ${H.pihak.nama}</p>
                    <p><strong>Status:</strong> ${H.jenis_transaksi.status||"Selesai"}</p>
                </div>
            </div>

            <table style="width: 100%; border-collapse: collapse; font-size: 12px;">
                <thead>
                    <tr style="background-color: #f8fafc;">
                        <th style="padding: 10px; text-align: left;">Produk</th>
                        <th style="padding: 10px; text-align: center;">Qty</th>
                        <th style="padding: 10px; text-align: right;">Harga</th>
                        <th style="padding: 10px; text-align: right;">Subtotal</th>
                    </tr>
                </thead>
                <tbody>
                    ${ee}
                </tbody>
                <tfoot>
                    <tr>
                        <td colspan="3" style="padding: 15px 10px; text-align: right; font-weight: bold;">TOTAL BAYAR</td>
                        <td style="padding: 15px 10px; text-align: right; font-weight: bold; font-size: 14px;">${Ie(Math.abs(H.jenis_transaksi.total_nominal))}</td>
                    </tr>
                </tfoot>
            </table>

            <div style="margin-top: 40px; text-align: center; font-size: 10px; color: #94a3b8;">
                <p>Terima kasih telah berbelanja di Koperasi Kami.</p>
                <p>Barang yang sudah dibeli tidak dapat ditukar/dikembalikan.</p>
            </div>
        </div>
      `,O=qa(`Nota_${H.id_transaksi}`,le);Ya(O),y(null)},I=H=>{v({jenis_transaksi:{...H.jenis_transaksi,total_nominal:Math.abs(H.jenis_transaksi.total_nominal),status:H.jenis_transaksi.status||"Selesai"},produk:[...H.produk],pihak:{...H.pihak,id_akun:H.pihak.id_akun||""}}),$(H.id_transaksi),b(!0),y(null),k(!0)},_={jenis_transaksi:{tanggal:new Date().toISOString().split("T")[0],jenis:"Pemasukan",metode:"Tunai",keterangan:"",total_nominal:0,status:"Selesai"},produk:[],pihak:{kategori:"Santri",nama:"",id_akun:""}},[n,v]=s.useState(_),[R,W]=s.useState({id_produk:"",kategori:"",nama:"",qty:1,harga_beli:0,harga_jual:0,gambar:""}),[q,V]=s.useState("");ja.useEffect(()=>{c&&!S&&(v({..._,produk:[]}),V(""))},[c]);const J=s.useMemo(()=>Array.isArray(t)?t.map(H=>{var ee,le,O;return{value:((ee=H.verifikasi_santri)==null?void 0:ee.id_santri)||"",label:`${(le=H.verifikasi_santri)==null?void 0:le.id_santri} - ${(O=H.data_santri)==null?void 0:O.nama_lengkap}`}}):[],[t]),U=s.useMemo(()=>r.map(H=>({value:H.id_produk,label:`${H.nama} (${H.id_produk})`})),[r]),re=s.useMemo(()=>{if(!Array.isArray(a))return[];let H=[...a];if(B.trim()){const ee=B.toLowerCase();H=H.filter(le=>le.id_transaksi.toLowerCase().includes(ee)||le.jenis_transaksi.keterangan.toLowerCase().includes(ee)||le.pihak.nama.toLowerCase().includes(ee))}return f==="Pemasukan"&&(H=H.filter(ee=>ee.jenis_transaksi.jenis==="Pemasukan")),f==="Pengeluaran"&&(H=H.filter(ee=>ee.jenis_transaksi.jenis==="Pengeluaran")),f==="Buku Kredit"&&(H=H.filter(ee=>ee.jenis_transaksi.metode==="Kredit")),m&&(H=H.filter(ee=>new Date(ee.jenis_transaksi.tanggal)>=new Date(m))),i&&(H=H.filter(ee=>new Date(ee.jenis_transaksi.tanggal)<=new Date(i))),H.sort((ee,le)=>{const O=new Date(ee.jenis_transaksi.tanggal).getTime(),Q=new Date(le.jenis_transaksi.tanggal).getTime();return C==="newest"?Q-O:O-Q})},[a,B,m,i,C,f]),Z=s.useMemo(()=>{const ee=!m&&!i?a:a.filter(te=>{const X=te.jenis_transaksi.tanggal;return X>=m&&X<=i});let le=0,O=0,Q=0,ne=0,he=0;const Ce={},me={};ee.forEach(te=>{const X=Math.abs(te.jenis_transaksi.total_nominal);if(te.jenis_transaksi.jenis==="Pemasukan"){if(Q+=X,te.jenis_transaksi.metode==="Kredit"&&te.jenis_transaksi.status!=="Lunas"&&(he+=X),te.produk&&te.produk.length>0){const ue=te.jenis_transaksi.tanggal;me[ue]||(me[ue]={sales:0,modal:0}),te.produk.forEach(je=>{const Ae=je.qty*je.harga_jual,Te=je.qty*je.harga_beli;le+=Ae,O+=Te,me[ue].sales+=Ae,me[ue].modal+=Te,Ce[je.nama]=(Ce[je.nama]||0)+je.qty})}}else ne+=X});const be=Q-ne,Me=le-O,ke=Object.entries(me).map(([te,X])=>({date:te,value:X.sales,sales:X.sales,modal:X.modal})).sort((te,X)=>new Date(te.date).getTime()-new Date(X.date).getTime()),Se={Tunai:0,Transfer:0,Kredit:0};ee.forEach(te=>{if(te.jenis_transaksi.jenis==="Pemasukan"){const X=te.jenis_transaksi.metode,se=Math.abs(te.jenis_transaksi.total_nominal);X==="Tunai"?Se.Tunai+=se:X==="Transfer"?Se.Transfer+=se:Se.Kredit+=se}});const Y=[{label:"Tunai",value:Se.Tunai,color:"#10b981"},{label:"Transfer",value:Se.Transfer,color:"#3b82f6"},{label:"Kredit",value:Se.Kredit,color:"#f59e0b"}];return{totalKas:be,totalPemasukanUmum:Q,totalPengeluaranUmum:ne,totalPiutang:he,omsetProduk:le,profitProduk:Me,dailySalesData:ke,revenueMethodsData:Y}},[a,m,i]),ae=H=>{var le;V(H);const ee=r.find(O=>O.id_produk===H);ee&&W({id_produk:ee.id_produk,nama:ee.nama,kategori:ee.kategori,harga_beli:ee.harga_beli,harga_jual:ee.harga_jual,qty:1,gambar:((le=ee.gambar)==null?void 0:le[0])||""})},_e=()=>{if(!R.nama||R.qty<=0)return;const H=[...n.produk,R],ee=H.reduce((le,O)=>le+O.qty*O.harga_jual,0);v(le=>({...le,produk:H,jenis_transaksi:{...le.jenis_transaksi,total_nominal:ee}})),W({id_produk:"",kategori:"",nama:"",qty:1,harga_beli:0,harga_jual:0,gambar:""}),V("")},oe=H=>{const ee=n.produk.filter((le,O)=>O!==H);v(le=>({...le,produk:ee,jenis_transaksi:{...le.jenis_transaksi,total_nominal:ee.reduce((O,Q)=>O+Q.qty*Q.harga_jual,0)}}))},xe=()=>{let H=n.jenis_transaksi.total_nominal;n.jenis_transaksi.jenis==="Pengeluaran"?H=-Math.abs(H):H=Math.abs(H);const ee={id_transaksi:S&&T?T:`TRX-${Date.now().toString().slice(-6)}`,jenis_transaksi:{...n.jenis_transaksi,total_nominal:H},produk:n.produk,pihak:n.pihak},le=S&&T?a.map(O=>O.id_transaksi===T?ee:O):[ee,...a];o(le),k(!1),b(!1),$(null)};return c?e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl border border-gray-100 p-8 animate-fade-in-up font-sans relative z-30",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 pb-6 border-b border-gray-100",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-serif font-bold text-3xl text-gray-900 tracking-tight",children:S?"Edit Transaksi":"Transaksi Baru"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Catat pemasukan atau pengeluaran koperasi secara detail."})]}),e.jsx(Ge,{label:"Batal",variant:"secondary",onClick:()=>{k(!1),b(!1),$(null)}})]}),e.jsxs("div",{className:"space-y-8 max-w-5xl mx-auto",children:[e.jsxs("div",{className:"bg-gray-50/50 p-6 rounded-3xl border border-gray-200",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4",children:"Informasi Dasar"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(ze,{id:"trx-date",label:"Tanggal Transaksi",value:n.jenis_transaksi.tanggal,onChange:H=>v({...n,jenis_transaksi:{...n.jenis_transaksi,tanggal:H}}),className:"md:col-span-1"}),e.jsx("div",{className:"md:col-span-1",children:e.jsx(de,{id:"trx-type",label:"Jenis",value:n.jenis_transaksi.jenis,onChange:H=>v({...n,jenis_transaksi:{...n.jenis_transaksi,jenis:H}}),options:[{value:"Pemasukan",label:"Pemasukan"},{value:"Pengeluaran",label:"Pengeluaran"}]})}),e.jsx("div",{className:"md:col-span-1",children:e.jsx(de,{id:"trx-method",label:"Metode",value:n.jenis_transaksi.metode,onChange:H=>v({...n,jenis_transaksi:{...n.jenis_transaksi,metode:H}}),options:[{value:"Tunai",label:"Tunai"},{value:"Transfer",label:"Transfer"},{value:"Kredit",label:"Kredit"}]})}),e.jsx("div",{className:"md:col-span-1",children:e.jsx(de,{id:"trx-status",label:"Status",value:n.jenis_transaksi.status||"Selesai",onChange:H=>v({...n,jenis_transaksi:{...n.jenis_transaksi,status:H}}),options:[{value:"Selesai",label:"Selesai"},{value:"Proses",label:"Proses"},{value:"Batal",label:"Batal"}]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-white",placeholder:" ",value:n.jenis_transaksi.keterangan,onChange:H=>v({...n,jenis_transaksi:{...n.jenis_transaksi,keterangan:H.target.value}})}),e.jsx("label",{className:"floating-label",children:"Keterangan / Catatan"})]}),e.jsxs("div",{className:"floating-group",children:[e.jsx("input",{type:"number",className:"floating-input peer font-bold text-emerald-700 bg-white tabular-nums text-lg",placeholder:" ",value:n.jenis_transaksi.total_nominal,onChange:H=>v({...n,jenis_transaksi:{...n.jenis_transaksi,total_nominal:Number(H.target.value)}})}),e.jsx("label",{className:"floating-label",children:"Total Nominal (Rp)"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-3xl border border-gray-200 shadow-sm relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-emerald-50 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none"}),e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest mb-4 relative z-10",children:"Item Produk (Opsional)"}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-end mb-6 relative z-10",children:[e.jsx("div",{className:"flex-1 w-full",children:e.jsx(de,{id:"prod-search",label:"Cari Produk",value:q,onChange:ae,options:U,className:"w-full !mb-0"})}),e.jsxs("div",{className:"w-full md:w-24 floating-group !mb-0 !mt-0",children:[e.jsx("input",{type:"number",className:"floating-input peer",value:R.qty,onChange:H=>W({...R,qty:Number(H.target.value)})}),e.jsx("label",{className:"floating-label",children:"Qty"})]}),e.jsxs("div",{className:"w-full md:w-40 floating-group !mb-0 !mt-0",children:[e.jsx("input",{type:"number",className:"floating-input peer",value:R.harga_jual,onChange:H=>W({...R,harga_jual:Number(H.target.value)})}),e.jsx("label",{className:"floating-label",children:"Harga"})]}),e.jsxs("button",{onClick:_e,className:"w-full md:w-auto h-[52px] px-6 bg-emerald-600 text-white rounded-xl font-bold shadow-md hover:bg-emerald-700 transition flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})," Tambah"]})]}),n.produk.length>0&&e.jsx("div",{className:"overflow-hidden rounded-2xl border border-gray-100",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-500 uppercase text-[10px] font-bold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3",children:"Produk"}),e.jsx("th",{className:"px-6 py-3 text-center",children:"Qty"}),e.jsx("th",{className:"px-6 py-3 text-right",children:"Subtotal"}),e.jsx("th",{className:"px-6 py-3 text-center"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50 bg-white",children:n.produk.map((H,ee)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-3 font-medium text-gray-800",children:H.nama}),e.jsx("td",{className:"px-6 py-3 text-center",children:H.qty}),e.jsx("td",{className:"px-6 py-3 text-right tabular-nums font-bold text-gray-600",children:Ie(H.qty*H.harga_jual)}),e.jsx("td",{className:"px-6 py-3 text-center",children:e.jsx("button",{onClick:()=>oe(ee),className:"text-red-400 hover:text-red-600 transition",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]},ee))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(de,{id:"cat-pihak",label:"Kategori Pihak",value:n.pihak.kategori,onChange:H=>v({...n,pihak:{...n.pihak,kategori:H,nama:"",id_akun:""}}),options:[{value:"Santri",label:"Santri"},{value:"Umum",label:"Umum"},{value:"Supplier",label:"Supplier"}]}),n.pihak.kategori==="Santri"?e.jsx(de,{id:"nm-pihak",label:"Cari Santri",value:n.pihak.id_akun||"",onChange:H=>{var le;const ee=t.find(O=>O.verifikasi_santri.id_santri===H);v({...n,pihak:{...n.pihak,id_akun:H,nama:((le=ee==null?void 0:ee.data_santri)==null?void 0:le.nama_lengkap)||""}})},options:J}):e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",value:n.pihak.nama,onChange:H=>v({...n,pihak:{...n.pihak,nama:H.target.value}}),placeholder:" "}),e.jsx("label",{className:"floating-label",children:"Nama Pihak"})]})]}),e.jsx("div",{className:"flex gap-4 pt-6 mt-4 border-t border-gray-100",children:e.jsx(Ge,{label:S?"Simpan Perubahan":"Simpan Transaksi",onClick:xe,className:"w-full py-4 text-base"})})]})]}):e.jsxs("div",{className:"font-sans",children:[e.jsx(ve,{tourId:"kop_transaksi",steps:hn}),e.jsxs("div",{className:"bg-white p-2 rounded-[2rem] shadow-sm border border-gray-200 mb-8 sticky top-0 z-20 backdrop-blur-md bg-white/90",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{id:"kop-tabs",className:"flex bg-gray-100 p-1.5 rounded-[1.5rem] w-full md:w-auto shrink-0",children:[e.jsx("button",{onClick:()=>M("Ringkasan"),className:`px-8 py-3 rounded-2xl text-xs font-bold transition-all flex-1 md:flex-none whitespace-nowrap ${h==="Ringkasan"?"bg-white text-emerald-800 shadow-md transform scale-105":"text-gray-500 hover:text-gray-700"}`,children:"Ringkasan"}),e.jsx("button",{onClick:()=>M("Data"),className:`px-8 py-3 rounded-2xl text-xs font-bold transition-all flex-1 md:flex-none ${h==="Data"?"bg-white text-emerald-800 shadow-md transform scale-105":"text-gray-500 hover:text-gray-700"}`,children:"Data Transaksi"})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto overflow-x-auto justify-end pb-2 md:pb-0 px-2 md:px-0 scrollbar-hide",children:[e.jsx("div",{id:"kop-filters",children:e.jsxs("select",{value:f,onChange:H=>D(H.target.value),className:"bg-gray-50 border border-gray-200 px-4 py-2.5 rounded-xl text-xs font-bold text-gray-700 outline-none cursor-pointer h-[42px]",children:[e.jsx("option",{value:"Ringkasan",children:"Ringkasan"}),e.jsx("option",{value:"Semua",children:"Semua Data"}),e.jsx("option",{value:"Pemasukan",children:"Pemasukan"}),e.jsx("option",{value:"Pengeluaran",children:"Pengeluaran"}),e.jsx("option",{value:"Buku Kredit",children:"Buku Kredit"})]})}),e.jsx("div",{id:"kop-action-btn",children:e.jsx(Ge,{label:"Catat Transaksi",onClick:()=>k(!0),icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),className:"h-[42px] whitespace-nowrap"})}),h==="Data"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-2 shrink-0",children:[e.jsx("input",{type:"date",value:m,onChange:H=>u(H.target.value),className:"bg-gray-50 border border-gray-200 px-3 py-2.5 rounded-xl text-xs font-bold text-gray-600 outline-none w-28 h-[42px]"}),e.jsx("span",{className:"self-center text-gray-400",children:"-"}),e.jsx("input",{type:"date",value:i,onChange:H=>g(H.target.value),className:"bg-gray-50 border border-gray-200 px-3 py-2.5 rounded-xl text-xs font-bold text-gray-600 outline-none w-28 h-[42px]"})]}),e.jsxs("div",{className:"relative w-40 shrink-0 hidden lg:block",children:[e.jsx("input",{type:"text",placeholder:"Cari...",value:B,onChange:H=>p(H.target.value),className:"pl-9 pr-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-xs w-full transition-all focus:ring-2 focus:ring-emerald-500 outline-none h-[42px]"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx(zt,{data:re,fileName:`Laporan_Transaksi_Koperasi_${new Date().toISOString().split("T")[0]}`,title:"Laporan Transaksi Koperasi",columns:[{header:"Tanggal",accessor:H=>H.jenis_transaksi.tanggal},{header:"ID Transaksi",accessor:H=>H.id_transaksi},{header:"Keterangan",accessor:H=>H.jenis_transaksi.keterangan||"-"},{header:"Pihak",accessor:H=>H.pihak.nama},{header:"Jenis",accessor:H=>H.jenis_transaksi.jenis},{header:"Nominal",accessor:H=>Ie(Math.abs(H.jenis_transaksi.total_nominal))},{header:"Status",accessor:H=>H.jenis_transaksi.status||"Selesai"}]})]})]})]}),h==="Data"&&e.jsx("div",{className:"mt-2 lg:hidden",children:e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",placeholder:"Cari transaksi...",value:B,onChange:H=>p(H.target.value),className:"pl-9 pr-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-xs w-full transition-all focus:ring-2 focus:ring-emerald-500 outline-none"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})})]}),h==="Ringkasan"?e.jsxs("div",{className:"animate-fade-in-up space-y-8",children:[e.jsxs("div",{id:"kop-stats-cards",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(Da,{title:"Total Kas",value:Ie(Z.totalKas),subtitle:"Saldo Bersih",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),colorClass:"bg-emerald-100 text-emerald-600",trend:"up"}),e.jsx(Da,{title:"Pemasukan",value:Ie(Z.totalPemasukanUmum),subtitle:"Total Kredit",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 11l5-5m0 0l5 5m-5-5v12"})}),colorClass:"bg-blue-100 text-blue-600"}),e.jsx(Da,{title:"Pengeluaran",value:Ie(Z.totalPengeluaranUmum),subtitle:"Total Debit",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 13l-5 5m0 0l-5-5m5 5V6"})}),colorClass:"bg-rose-100 text-rose-600"}),e.jsx(Da,{title:"Profit Produk",value:Ie(Z.profitProduk),subtitle:"Margin Keuntungan",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),colorClass:"bg-amber-100 text-amber-600"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm",children:[e.jsx("h3",{className:"font-serif font-bold text-gray-900 text-xl mb-6",children:"Analisa Profitabilitas"}),e.jsx(un,{data:Z.dailySalesData,color:"#10b981"})]}),e.jsxs("div",{className:"bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm flex flex-col items-center justify-center relative overflow-hidden",children:[e.jsx("h3",{className:"font-serif font-bold text-gray-900 text-lg mb-8 w-full text-center",children:"Metode Pembayaran"}),e.jsx(xn,{data:Z.revenueMethodsData})]})]})]}):e.jsx("div",{className:"animate-fade-in-up",children:e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl shadow-gray-200/40 border border-gray-100 overflow-hidden relative",children:[j&&e.jsxs("div",{ref:A,className:"absolute top-16 left-6 z-20 bg-white rounded-xl shadow-xl border border-gray-100 p-2 min-w-[150px] animate-fade-in",children:[e.jsxs("button",{onClick:()=>{L("newest"),N(!1)},className:"w-full text-left px-4 py-2 rounded-lg hover:bg-gray-50 text-xs font-bold text-gray-600 flex items-center justify-between",children:["Terbaru ",C==="newest"&&"✓"]}),e.jsxs("button",{onClick:()=>{L("oldest"),N(!1)},className:"w-full text-left px-4 py-2 rounded-lg hover:bg-gray-50 text-xs font-bold text-gray-600 flex items-center justify-between",children:["Terlama ",C==="oldest"&&"✓"]})]}),e.jsxs("div",{className:"overflow-x-auto pb-32",children:[e.jsxs("table",{id:"kop-transaksi-table",className:"w-full text-left text-sm table-fixed min-w-[1000px]",children:[e.jsx("thead",{className:"bg-gray-50/50 text-gray-400 uppercase text-[10px] font-black tracking-widest border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-8 py-5 w-16"}),e.jsxs("th",{className:"px-6 py-5 w-[18%] cursor-pointer hover:text-emerald-600 transition",onClick:H=>{H.stopPropagation(),N(!j)},children:["Tanggal & ID ",e.jsx("span",{className:"ml-1",children:"▼"})]}),e.jsx("th",{className:"px-6 py-5 w-[25%]",children:"Keterangan"}),e.jsx("th",{className:"px-6 py-5 text-center w-[10%]",children:"QTY"}),e.jsx("th",{className:"px-6 py-5 w-[18%]",children:"Pihak"}),e.jsx("th",{className:"px-6 py-5 text-right w-[15%]",children:"Total"}),e.jsx("th",{className:"px-6 py-5 text-center w-[12%]",children:"Status"}),e.jsx("th",{className:"px-6 py-5 text-center w-16"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:re.map(H=>{const ee=H.jenis_transaksi.jenis==="Pemasukan",le=H.produk.reduce((Q,ne)=>Q+ne.qty,0),O=w===H.id_transaksi;return e.jsxs(ja.Fragment,{children:[e.jsxs("tr",{className:`hover:bg-gray-50/80 transition duration-200 cursor-pointer group ${O?"bg-gray-50/80":""}`,onClick:()=>d(O?null:H.id_transaksi),children:[e.jsx("td",{className:"px-8 py-5 align-top",children:e.jsx("div",{className:`w-10 h-10 rounded-2xl flex items-center justify-center shadow-sm ${ee?"bg-emerald-100 text-emerald-600":"bg-rose-100 text-rose-600"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:ee?"M19 14l-7 7m0 0l-7-7m7 7V3":"M5 10l7-7m0 0l7 7m-7-7v18"})})})}),e.jsx("td",{className:"px-6 py-5 align-top",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-gray-900 text-sm mb-0.5",children:new Date(H.jenis_transaksi.tanggal).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})}),e.jsx("span",{className:"text-[10px] text-gray-400 font-mono tracking-wide",children:H.id_transaksi})]})}),e.jsx("td",{className:"px-6 py-5 align-top text-gray-600 text-sm leading-relaxed font-medium",children:H.jenis_transaksi.keterangan||(H.produk.length>0?H.produk[0].nama+(H.produk.length>1?"...":""):"-")}),e.jsx("td",{className:"px-6 py-5 align-top text-center font-bold text-gray-800",children:le>0?e.jsx("span",{className:"bg-gray-100 px-2 py-1 rounded text-xs",children:le}):"-"}),e.jsx("td",{className:"px-6 py-5 align-top",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-gray-900 text-sm mb-0.5",children:H.pihak.nama}),e.jsx("span",{className:"text-[10px] text-gray-500 uppercase font-bold tracking-wider",children:H.pihak.kategori})]})}),e.jsx("td",{className:"px-6 py-5 align-top text-right font-black text-gray-900 text-sm whitespace-nowrap tracking-tight",children:Ie(Math.abs(H.jenis_transaksi.total_nominal))}),e.jsxs("td",{className:"px-6 py-5 align-top text-center",children:[e.jsx(mn,{status:H.jenis_transaksi.status||"Selesai"}),e.jsx("div",{className:"text-[9px] text-gray-400 font-bold uppercase mt-1 tracking-wider",children:H.jenis_transaksi.metode})]}),e.jsxs("td",{className:"px-6 py-5 align-top text-center relative",children:[e.jsx("button",{className:"text-gray-300 hover:text-gray-600 p-2 rounded-lg hover:bg-gray-100 transition",onClick:Q=>E(Q,H.id_transaksi),children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{d:"M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"})})}),P===H.id_transaksi&&e.jsx("div",{ref:z,className:"absolute right-8 top-8 w-48 bg-white rounded-xl shadow-2xl border border-gray-100 z-50 overflow-hidden animate-fade-in-up origin-top-right ring-1 ring-black/5",onClick:Q=>Q.stopPropagation(),children:e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>x(H),className:"w-full text-left px-4 py-2.5 text-xs font-bold text-gray-600 hover:bg-gray-50 hover:text-emerald-700 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})," Gambar Nota"]}),e.jsxs("button",{onClick:()=>l(H),className:"w-full text-left px-4 py-2.5 text-xs font-bold text-gray-600 hover:bg-gray-50 hover:text-emerald-700 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"})})," Cetak PDF"]}),e.jsx("div",{className:"h-px bg-gray-100 my-1 mx-2"}),e.jsxs("button",{onClick:()=>I(H),className:"w-full text-left px-4 py-2.5 text-xs font-bold text-blue-600 hover:bg-blue-50 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})," Edit Data"]}),e.jsxs("button",{onClick:Q=>F(Q,H.id_transaksi),className:"w-full text-left px-4 py-2.5 text-xs font-bold text-red-600 hover:bg-red-50 flex items-center gap-3",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})," Hapus"]})]})})]})]}),O&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"p-0 border-none",children:e.jsx("div",{className:"bg-gray-50 border-t border-gray-100 shadow-inner px-8 py-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto space-y-2",children:[H.produk.map((Q,ne)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center text-xs font-bold text-gray-500 border border-gray-200",children:[Q.qty,"x"]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-gray-800",children:Q.nama}),e.jsx("p",{className:"text-[9px] text-gray-400 font-mono",children:Q.id_produk})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-xs font-bold text-gray-900",children:Ie(Q.harga_jual*Q.qty)}),e.jsxs("p",{className:"text-[9px] text-gray-400",children:["@ ",Ie(Q.harga_jual)]})]})]},ne)),H.produk.length===0&&e.jsx("p",{className:"text-center text-xs text-gray-400 italic py-2",children:"Tidak ada detail produk."})]})})})})]},H.id_transaksi)})})]}),e.jsx("div",{className:"sticky bottom-0 z-30 p-4 bg-white/90 backdrop-blur-md border-t border-gray-100 shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]",children:e.jsxs("button",{onClick:()=>k(!0),className:"w-full py-4 bg-emerald-600 text-white font-bold rounded-2xl shadow-lg shadow-emerald-600/20 hover:bg-emerald-700 hover:shadow-emerald-600/30 transition-all transform hover:-translate-y-0.5 active:scale-95 flex items-center justify-center gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 4v16m8-8H4"})}),"Catat Transaksi Baru"]})})]})]})})]})},gn=[{title:"Manajemen Produk",description:"Kelola inventaris barang koperasi di sini. Tambahkan produk baru, perbarui harga, dan pantau stok."},{targetId:"kop-produk-filter",title:"Filter Kategori",description:"Navigasi cepat antar kategori produk (Seragam, Kitab, Jajan, dll).",position:"bottom"},{targetId:"kop-produk-search",title:"Pencarian & Ekspor",description:"Cari produk berdasarkan nama/ID. Anda juga bisa mengunduh data stok ke Excel/PDF.",position:"bottom"},{targetId:"kop-produk-add",title:"Tambah Produk",description:"Klik untuk menambahkan item baru ke katalog koperasi.",position:"left"},{targetId:"kop-produk-list",title:"Daftar Barang",description:"Klik pada baris produk untuk mengedit detail atau menghapusnya.",position:"top"}],bn=({produkList:a,onUpdateProduk:r,isFormOpen:t,setFormOpen:o,onExport:c})=>{var C;const[k,f]=s.useState(""),[D,B]=s.useState("Semua"),[p,m]=s.useState(null),[u,i]=s.useState({id_produk:"",nama:"",kategori:"Makanan",harga_beli:0,harga_jual:0,stok:0,gambar:[],terjual:0}),g=s.useMemo(()=>{const L=new Set(a.map(P=>P.kategori));return["Semua",...Array.from(L)]},[a]),K=s.useMemo(()=>{let L=a;if(k){const P=k.toLowerCase();L=L.filter(y=>{var z,j,N;return((z=y.nama)==null?void 0:z.toLowerCase().includes(P))||((j=y.id_produk)==null?void 0:j.toLowerCase().includes(P))||((N=y.kategori)==null?void 0:N.toLowerCase().includes(P))})}return D!=="Semua"&&(L=L.filter(P=>P.kategori===D)),L},[a,k,D]),h=L=>{i(L),m(L.id_produk),o(!0),window.scrollTo(0,0)},M=()=>{p&&confirm("Hapus produk ini? Tindakan tidak dapat dibatalkan.")&&(r(a.filter(L=>L.id_produk!==p)),o(!1),m(null))},w=()=>{if(!u.nama||!u.id_produk){alert("Lengkapi data produk.");return}let L=[...a];if(p)L=L.map(P=>P.id_produk===p?u:P);else{if(a.some(P=>P.id_produk===u.id_produk)){alert("ID Produk sudah ada.");return}L.push(u)}r(L),o(!1),m(null),i({id_produk:"",nama:"",kategori:"Makanan",harga_beli:0,harga_jual:0,stok:0,gambar:[],terjual:0})},d=()=>{o(!0),m(null),i({id_produk:"",nama:"",kategori:"Makanan",harga_beli:0,harga_jual:0,stok:0,gambar:[],terjual:0})};return e.jsxs("div",{className:"space-y-6 animate-fade-in font-sans",children:[e.jsx(ve,{tourId:"kop_produk",steps:gn}),!t&&e.jsx("div",{className:"animate-fade-in-up",children:e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl shadow-gray-200/40 border border-gray-100 overflow-hidden relative",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 bg-white sticky top-0 z-10 flex flex-col lg:flex-row gap-4 justify-between items-center",children:[e.jsx("div",{id:"kop-produk-filter",className:"flex gap-2 overflow-x-auto w-full lg:w-auto scrollbar-hide pb-2 lg:pb-0",children:g.map(L=>e.jsx("button",{onClick:()=>B(L),className:`px-4 py-2 rounded-xl text-xs font-bold transition-all whitespace-nowrap border ${D===L?"bg-emerald-50 text-emerald-700 border-emerald-100":"bg-white text-gray-500 border-gray-100 hover:border-gray-300"}`,children:L},L))}),e.jsxs("div",{className:"flex items-center gap-2 w-full lg:w-auto",children:[e.jsxs("div",{id:"kop-produk-search",className:"flex items-center gap-2 flex-1",children:[e.jsxs("div",{className:"relative flex-1 lg:w-64",children:[e.jsx("input",{type:"text",placeholder:"Cari produk...",value:k,onChange:L=>f(L.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-emerald-500 outline-none transition"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx(zt,{data:K,fileName:`Data_Produk_${new Date().toISOString().split("T")[0]}`,title:"Data Stok Produk Koperasi",columns:[{header:"ID Produk",accessor:L=>L.id_produk},{header:"Nama Produk",accessor:L=>L.nama},{header:"Kategori",accessor:L=>L.kategori},{header:"Harga Modal",accessor:L=>Ie(L.harga_beli)},{header:"Harga Jual",accessor:L=>Ie(L.harga_jual)},{header:"Stok",accessor:L=>L.stok}]})]}),e.jsxs("button",{id:"kop-produk-add",onClick:d,className:"bg-emerald-600 text-white px-4 py-2.5 rounded-xl text-xs font-bold hover:bg-emerald-700 transition flex items-center gap-2 shadow-lg shadow-emerald-600/20 h-[42px]",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Baru"]})]})]}),e.jsx("div",{className:"overflow-x-auto pb-32",children:e.jsxs("table",{id:"kop-produk-list",className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-50/50 text-gray-400 uppercase text-[10px] font-black tracking-widest border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-8 py-5",children:"Info Produk"}),e.jsx("th",{className:"px-6 py-5",children:"Kategori"}),e.jsx("th",{className:"px-6 py-5 text-right",children:"Modal"}),e.jsx("th",{className:"px-6 py-5 text-right",children:"Jual"}),e.jsx("th",{className:"px-6 py-5 text-center",children:"Stok"}),e.jsx("th",{className:"px-6 py-5 text-center w-16"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-50",children:[K.map(L=>e.jsxs("tr",{className:"hover:bg-gray-50/80 transition duration-200 group cursor-pointer",onClick:()=>h(L),children:[e.jsx("td",{className:"px-8 py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-gray-100 border border-gray-200 overflow-hidden flex items-center justify-center shrink-0 shadow-sm relative",children:L.gambar&&L.gambar[0]?e.jsx("img",{src:L.gambar[0],alt:"",className:"w-full h-full object-cover"}):e.jsx("svg",{className:"w-5 h-5 text-gray-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-gray-900",children:L.nama}),e.jsx("div",{className:"text-[10px] text-gray-400 font-mono tracking-wide mt-0.5",children:L.id_produk})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"bg-gray-100 text-gray-600 px-2.5 py-1 rounded-lg text-[10px] font-bold uppercase tracking-wider border border-gray-200",children:L.kategori})}),e.jsx("td",{className:"px-6 py-4 text-right text-gray-500 font-mono text-xs",children:Ie(L.harga_beli)}),e.jsx("td",{className:"px-6 py-4 text-right font-bold text-emerald-600 font-mono",children:Ie(L.harga_jual)}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-[10px] font-bold ${L.stok>10?"bg-emerald-100 text-emerald-700":L.stok>0?"bg-amber-100 text-amber-700":"bg-rose-100 text-rose-700"}`,children:L.stok})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("div",{className:"p-2 rounded-lg hover:bg-gray-100 text-gray-300 hover:text-emerald-600 transition",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})})]},L.id_produk)),K.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"text-center py-12 text-gray-400 italic",children:"Tidak ada produk ditemukan."})})]})]})})]})}),t&&e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl border border-gray-100 p-8 animate-fade-in-up font-sans relative z-30 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-100 pb-4",children:[e.jsx("h3",{className:"font-serif font-bold text-3xl text-gray-900 tracking-tight",children:p?"Edit Produk":"Tambah Produk Baru"}),e.jsx(Ge,{label:"Batal",variant:"secondary",onClick:()=>o(!1)})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-gray-50",placeholder:" ",value:u.id_produk,onChange:L=>i({...u,id_produk:L.target.value}),disabled:!!p}),e.jsx("label",{className:"floating-label",children:"ID Produk / Barcode"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:u.nama,onChange:L=>i({...u,nama:L.target.value})}),e.jsx("label",{className:"floating-label",children:"Nama Produk"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:u.kategori,onChange:L=>i({...u,kategori:L.target.value})}),e.jsx("label",{className:"floating-label",children:"Kategori"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"number",className:"floating-input peer",placeholder:" ",value:u.stok,onChange:L=>i({...u,stok:Number(L.target.value)})}),e.jsx("label",{className:"floating-label",children:"Stok Awal"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:((C=u.gambar)==null?void 0:C[0])||"",onChange:L=>i({...u,gambar:[L.target.value]})}),e.jsx("label",{className:"floating-label",children:"URL Gambar"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-6 rounded-3xl border border-gray-200 grid grid-cols-1 md:grid-cols-2 gap-6 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-emerald-100 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none"}),e.jsxs("div",{className:"floating-group !mb-0 relative z-10",children:[e.jsx("input",{type:"number",className:"floating-input peer font-bold text-gray-700 bg-white",placeholder:" ",value:u.harga_beli,onChange:L=>i({...u,harga_beli:Number(L.target.value)})}),e.jsx("label",{className:"floating-label bg-white",children:"Harga Beli (HPP)"})]}),e.jsxs("div",{className:"floating-group !mb-0 relative z-10",children:[e.jsx("input",{type:"number",className:"floating-input peer font-bold text-emerald-700 text-lg bg-white",placeholder:" ",value:u.harga_jual,onChange:L=>i({...u,harga_jual:Number(L.target.value)})}),e.jsx("label",{className:"floating-label bg-white",children:"Harga Jual"})]})]}),e.jsxs("div",{className:"pt-6 flex gap-4 border-t border-gray-100 mt-4",children:[p&&e.jsx(Ge,{label:"Hapus Produk",variant:"danger",onClick:M,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx(Ge,{label:"Simpan Data",onClick:w,className:"flex-1 py-4 text-base",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 00-2-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})})})]})]})]})]})},fn=[{title:"Selamat Datang di Modul Koperasi",description:"Kelola penjualan retail dan unit usaha pesantren dengan sistem kasir terintegrasi."},{targetId:"koperasi-tab-nav",title:"Navigasi Cepat",description:"Pindah antara mode 'Jurnal Transaksi' untuk kasir dan 'Stok Produk' untuk manajemen inventaris.",position:"bottom"},{targetId:"koperasi-action-btn",title:"Catat Transaksi",description:"Klik di sini untuk membuka formulir kasir dan mencatat pembelian santri.",position:"left"},{targetId:"koperasi-filter-bar",title:"Filter & Laporan",description:"Gunakan filter ini untuk melihat laporan spesifik (Pemasukan/Pengeluaran) dan mengekspor data ke Excel.",position:"bottom"}],gt=({initialTab:a="Jurnal"})=>{const{fetchData:r,cache:t,updateCache:o}=ge(),[c,k]=s.useState(a);s.useEffect(()=>{k(a)},[a]);const f=t.koperasiProduk&&t.koperasiTransaksi&&t.databaseSantri,[D,B]=s.useState(!f),[p,m]=s.useState(t.koperasiProduk||[]),[u,i]=s.useState(t.koperasiTransaksi||[]),[g,K]=s.useState(t.databaseSantri||[]),[h,M]=s.useState("Ringkasan"),[w,d]=s.useState(""),[C,L]=s.useState(""),[P,y]=s.useState(""),[z,j]=s.useState(!1);s.useEffect(()=>{(async()=>{const T=Date.now();f||B(!0);try{const[$,E,F]=await Promise.all([r("koperasiProduk",G.getKoperasiProduk,"Koperasi",!1,!1),r("koperasiTransaksi",G.getKoperasiTransaksi,"Koperasi",!1,!1),r("databaseSantri",G.getDatabaseSantri,"Koperasi",!1,!1)]);m(Array.isArray($)?$:[]),i(Array.isArray(E)?E:[]),K(Array.isArray(F)?F:F?[F]:[])}catch($){console.error($)}finally{if(f)B(!1);else{const $=Date.now()-T;setTimeout(()=>B(!1),Math.max(0,2e3-$))}}})()},[r,f]);const N=async b=>{await G.updateKoperasiProduk(b),m(b),o("koperasiProduk",b)},A=async b=>{await G.updateKoperasiTransaksi(b),i(b),o("koperasiTransaksi",b)},S=()=>{let b=[];c==="Jurnal"?(b=u.filter(T=>{const $=T.jenis_transaksi.tanggal,E=C?$>=C:!0,F=P?$<=P:!0,x=E&&F,l=w?T.id_transaksi.toLowerCase().includes(w.toLowerCase())||T.jenis_transaksi.keterangan.toLowerCase().includes(w.toLowerCase())||T.pihak.nama.toLowerCase().includes(w.toLowerCase()):!0;return x&&l}),Ba(b,`Laporan_Transaksi_Koperasi_${new Date().toISOString().split("T")[0]}`)):Ba(p,`Stok_Produk_Koperasi_${new Date().toISOString().split("T")[0]}`)};return e.jsxs(e.Fragment,{children:[e.jsx(ve,{tourId:"koperasi",steps:fn}),e.jsxs("div",{className:"space-y-6 animate-fade-in font-sans pb-24 relative min-h-[500px]",children:[D&&e.jsx(fe,{message:"Menyiapkan Koperasi...",fullScreen:!1}),e.jsx("div",{className:D?"opacity-30 pointer-events-none filter blur-sm transition-all duration-500":"opacity-100 filter-none transition-all duration-500",children:c==="Jurnal"?e.jsx(pn,{transaksiList:u,produkList:p,santriList:g,onUpdateTransaksi:A,isFormOpen:z,setFormOpen:j,onZoomImage:b=>console.log(b),filterMode:h,setFilterMode:M,searchQuery:w,setSearchQuery:d,startDate:C,setStartDate:L,endDate:P,setEndDate:y,onExport:S}):e.jsx(bn,{produkList:p,onUpdateProduk:N,isFormOpen:z,setFormOpen:j,onExport:S})})]})]})},jn=[{title:"Unit Usaha Lainnya",description:"Kelola portofolio bisnis pesantren di luar koperasi retail, seperti pertanian, peternakan, atau jasa."},{targetId:"kop-bisnis-header",title:"Manajemen Unit",description:"Lihat daftar unit usaha yang aktif. Klik tombol 'Tambah Unit' untuk mendaftarkan bisnis baru.",position:"bottom"},{targetId:"kop-bisnis-list",title:"Kartu Unit Usaha",description:"Setiap kartu menampilkan ringkasan kinerja dan target pasar. Klik ikon edit di pojok kanan atas gambar untuk mengubah data.",position:"top"}],kn=()=>{const{fetchData:a,updateCache:r}=ge(),[t,o]=s.useState([]),[c,k]=s.useState(!0),[f,D]=s.useState(!1),[B,p]=s.useState(null),m={id:"",nama:"",kategori:"Pertanian",deskripsi:"",pasar:"Internal & Eksternal",statistik:[{label:"",value:""},{label:"",value:""}],gambar:[""],tautan:{label:"Hubungi Kami",url:""}},[u,i]=s.useState(m);s.useEffect(()=>{(async()=>{k(!0);try{const L=await a("koperasiTambahan",G.getKoperasiTambahan,"BisnisLain",!1,!1),P=Array.isArray(L)?L:[];o(P)}catch(L){console.error("Gagal memuat data bisnis:",L),o([])}finally{k(!1)}})()},[a]);const g=async()=>{if(!u.nama||!u.deskripsi){alert("Nama unit dan deskripsi wajib diisi.");return}k(!0);try{const C=B||`UNIT-${Date.now().toString().slice(-6)}`,L={...u,id:C};let P=[];B?P=t.map(y=>y.id===B?L:y):P=[...t,L],await G.updateKoperasiTambahan(P),r("koperasiTambahan",P),o(P),D(!1),p(null),i(m)}catch(C){console.error(C),alert("Gagal menyimpan data.")}finally{k(!1)}},K=async C=>{if(confirm("Hapus unit bisnis ini?")){k(!0);try{const L=t.filter(P=>P.id!==C);await G.updateKoperasiTambahan(L),r("koperasiTambahan",L),o(L)}catch(L){console.error(L),alert("Gagal menghapus data.")}finally{k(!1)}}},h=C=>{i(JSON.parse(JSON.stringify(C))),p(C.id),D(!0),window.scrollTo(0,0)},M=(C,L,P)=>{const y=[...u.statistik];y[C]={...y[C],[L]:P},i({...u,statistik:y})},w=()=>{i({...u,statistik:[...u.statistik,{label:"",value:""}]})},d=C=>{i({...u,statistik:u.statistik.filter((L,P)=>P!==C)})};return c&&t.length===0?e.jsx(fe,{message:"Memuat Data Bisnis...",fullScreen:!1}):e.jsxs("div",{className:"space-y-6 animate-fade-in font-sans pb-24",children:[e.jsx(ve,{tourId:"kop_bisnis",steps:jn}),f?e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl border border-gray-200 p-8 animate-fade-in-up font-sans max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-100 pb-4",children:[e.jsx("h3",{className:"font-bold text-2xl text-gray-900 font-sans",children:B?"Edit Unit Bisnis":"Tambah Unit Baru"}),e.jsx(Ge,{label:"Batal",variant:"secondary",onClick:()=>D(!1)})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-slate-50",placeholder:" ",value:u.id,disabled:!0,readOnly:!0}),e.jsx("label",{className:"floating-label",children:"ID Unit (Auto)"})]}),e.jsx(de,{id:"kategori-bisnis",label:"Kategori",value:u.kategori,onChange:C=>i({...u,kategori:C}),options:[{value:"Pertanian",label:"Pertanian"},{value:"Peternakan",label:"Peternakan"},{value:"Perikanan",label:"Perikanan"},{value:"Manufaktur Kreatif",label:"Manufaktur / Interior"},{value:"Jasa",label:"Jasa Layanan"}],className:"!mb-0"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:u.nama,onChange:C=>i({...u,nama:C.target.value})}),e.jsx("label",{className:"floating-label",children:"Nama Unit Usaha"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("textarea",{className:"floating-input peer h-32 py-3",placeholder:" ",value:u.deskripsi,onChange:C=>i({...u,deskripsi:C.target.value})}),e.jsx("label",{className:"floating-label",children:"Deskripsi Lengkap"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:u.pasar,onChange:C=>i({...u,pasar:C.target.value})}),e.jsx("label",{className:"floating-label",children:"Target Pasar (Internal/Eksternal)"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:u.gambar[0],onChange:C=>i({...u,gambar:[C.target.value]})}),e.jsx("label",{className:"floating-label",children:"URL Gambar Utama"})]})]}),e.jsxs("div",{className:"bg-slate-50 p-6 rounded-2xl border border-slate-200",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Statistik Kinerja"}),e.jsx("button",{onClick:w,className:"text-[10px] font-bold text-emerald-600 hover:text-emerald-700 bg-white border border-emerald-200 px-3 py-1 rounded-lg",children:"+ Tambah"})]}),e.jsx("div",{className:"space-y-3",children:u.statistik.map((C,L)=>e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"flex-1 floating-group !mb-0 !mt-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-white",placeholder:" ",value:C.label,onChange:P=>M(L,"label",P.target.value)}),e.jsx("label",{className:"floating-label bg-white",children:"Label (ex: Panen)"})]}),e.jsxs("div",{className:"flex-1 floating-group !mb-0 !mt-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-white",placeholder:" ",value:C.value,onChange:P=>M(L,"value",P.target.value)}),e.jsx("label",{className:"floating-label bg-white",children:"Nilai (ex: 5 Ton)"})]}),e.jsx("button",{onClick:()=>d(L),className:"p-3 text-rose-500 hover:bg-rose-50 rounded-lg transition",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},L))})]}),e.jsxs("div",{className:"p-4 rounded-xl border border-slate-200 bg-white",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest mb-4",children:"Tombol Aksi (CTA)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:u.tautan.label,onChange:C=>i({...u,tautan:{...u.tautan,label:C.target.value}})}),e.jsx("label",{className:"floating-label",children:"Label Tombol"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:u.tautan.url,onChange:C=>i({...u,tautan:{...u.tautan,url:C.target.value}})}),e.jsx("label",{className:"floating-label",children:"Link URL (WA/IG)"})]})]})]})]}),e.jsx("div",{className:"pt-8 border-t border-gray-100 flex gap-4 mt-8",children:e.jsx(Ge,{label:"Simpan Data",onClick:g,className:"flex-1 py-4 text-base"})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{id:"kop-bisnis-header",className:"flex justify-between items-center bg-white p-4 rounded-2xl border border-gray-200 shadow-sm",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 font-sans",children:"Unit Usaha Pesantren"}),e.jsx("p",{className:"text-xs text-gray-500 font-sans",children:"Kelola portfolio bisnis selain toko retail."})]}),e.jsx(Ge,{label:"Tambah Unit",onClick:()=>{i(m),p(null),D(!0)},icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),e.jsx("div",{id:"kop-bisnis-list",className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:t.map(C=>e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 shadow-sm overflow-hidden flex flex-col group hover:shadow-lg transition-all",children:[e.jsxs("div",{className:"relative h-48 bg-slate-100 overflow-hidden",children:[e.jsx("img",{src:C.gambar[0],alt:C.nama,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500",onError:L=>L.currentTarget.src="https://placehold.co/600x400?text=No+Image"}),e.jsx("div",{className:"absolute top-3 left-3 bg-white/90 backdrop-blur px-3 py-1 rounded-lg text-[10px] font-bold uppercase tracking-wider text-slate-800 shadow-sm",children:C.kategori}),e.jsxs("div",{className:"absolute top-3 right-3 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>h(C),className:"p-1.5 bg-white text-blue-600 rounded-lg shadow hover:bg-blue-50",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>K(C.id),className:"p-1.5 bg-white text-rose-600 rounded-lg shadow hover:bg-rose-50",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),e.jsxs("div",{className:"p-5 flex-1 flex flex-col",children:[e.jsx("h4",{className:"text-lg font-bold text-slate-900 mb-2 font-sans",children:C.nama}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-3 mb-4 font-sans leading-relaxed",children:C.deskripsi}),e.jsxs("div",{className:"mt-auto pt-4 border-t border-slate-100 space-y-3",children:[e.jsxs("div",{className:"flex justify-between text-[10px] uppercase font-bold text-slate-400 tracking-wider",children:[e.jsx("span",{children:"Statistik Utama"}),e.jsx("span",{children:"Target Pasar"})]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:C.statistik.slice(0,2).map((L,P)=>e.jsxs("div",{className:"bg-slate-50 p-2 rounded-lg text-center",children:[e.jsx("div",{className:"font-bold text-slate-800",children:L.value}),e.jsx("div",{className:"text-[9px] text-slate-400 uppercase",children:L.label})]},P))}),e.jsx("div",{className:"bg-emerald-50 text-emerald-700 px-3 py-2 rounded-lg text-xs font-bold text-center font-sans",children:C.pasar})]})]})]},C.id))})]})]})},vn=[{title:"Dana Pembangunan & Wakaf",description:"Manajemen khusus untuk dana pengembangan infrastruktur, wakaf, dan infaq bangunan."},{targetId:"keu-bg-tabs",title:"Navigasi",description:"Gunakan 'Monitoring' untuk melihat status pelunasan Uang Gedung setiap santri.",position:"bottom"},{targetId:"keu-bg-stats",title:"Saldo Proyek",description:"Total kas khusus pembangunan yang tersedia untuk dibelanjakan.",position:"bottom"},{targetId:"keu-bg-transaksi",title:"Riwayat Transaksi",description:"Daftar penerimaan wakaf dan belanja material bangunan.",position:"top"}],wn=()=>{const{fetchData:a,cache:r,updateCache:t}=ge(),[o,c]=s.useState("Ringkasan"),k=r.keuanganBiaya&&r.keuanganTransaksi&&r.databaseSantri,[f,D]=s.useState(!k),[B,p]=s.useState(r.keuanganBiaya||[]),[m,u]=s.useState(r.keuanganTransaksi||[]),[i,g]=s.useState(r.databaseSantri||[]),[K,h]=s.useState(!1),[M,w]=s.useState(null),[d,C]=s.useState({jenis:"masuk",kategori:"",id_santri:"",nama_santri:"",nama_pihak_luar:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",id_biaya:"",status:"Selesai"}),[L,P]=s.useState(""),[y,z]=s.useState("");s.useEffect(()=>{(async()=>{const I=Date.now();k||D(!0);try{const[_,n,v]=await Promise.all([a("keuanganBiaya",G.getKeuanganBiaya,"Bangunan",!1,!1),a("keuanganTransaksi",G.getKeuanganTransaksi,"Bangunan",!1,!1),a("databaseSantri",G.getDatabaseSantri,"Bangunan",!1,!1)]);p(Array.isArray(_)?_:[]),u(Array.isArray(n)?n:[]),g(Array.isArray(v)?v:v?[v]:[])}catch(_){console.error(_)}finally{if(k)D(!1);else{const _=Date.now()-I;setTimeout(()=>D(!1),Math.max(0,2e3-_))}}})()},[a,k]);const j=s.useMemo(()=>Array.isArray(B)?B.filter(l=>l.pos==="Bangunan"):[],[B]),N=s.useMemo(()=>Array.isArray(m)?m.filter(l=>l.peruntukan.pos==="BANGUNAN"||l.peruntukan.pos==="Bangunan"):[],[m]),A=s.useMemo(()=>{let l=N;return y&&(l=l.filter(I=>I.tanggal.startsWith(y))),l.sort((I,_)=>new Date(_.tanggal).getTime()-new Date(I.tanggal).getTime())},[N,y]),S=s.useMemo(()=>{if(!Array.isArray(i)||!i.length)return[];const l=j.reduce((I,_)=>I+_.nominal,0);return i.map(I=>{var W,q,V,J;const _=((W=I.verifikasi_santri)==null?void 0:W.id_santri)||"-",n=N.filter(U=>U.pihak.id===_&&U.jenis==="masuk"&&(U.status==="Selesai"||U.status==="Lunas")).reduce((U,re)=>U+re.pembayaran.nominal,0),v=l-n;let R="Belum Lunas";return v<=0?R="Lunas":v<0&&(R="Kelebihan"),{id_santri:_,nama:((q=I.data_santri)==null?void 0:q.nama_lengkap)||"Tanpa Nama",kelas:`${(V=I.data_akademik)==null?void 0:V.kelas} ${(J=I.data_akademik)==null?void 0:J.jenjang}`,wajib_bayar:l,total_bayar:n,sisa_bayar:v>0?v:0,status:R}}).sort((I,_)=>I.nama.localeCompare(_.nama))},[i,j,N]),b=s.useMemo(()=>S.filter(l=>l.nama.toLowerCase().includes(L.toLowerCase())),[S,L]),T=s.useMemo(()=>{const l=N.reduce((V,J)=>J.status==="Batal"||J.status==="Gagal"?V:J.jenis==="keluar"?V-J.pembayaran.nominal:V+J.pembayaran.nominal,0),I=A,_=I.filter(V=>V.jenis==="masuk").reduce((V,J)=>V+J.pembayaran.nominal,0),n=I.filter(V=>V.jenis==="keluar").reduce((V,J)=>V+J.pembayaran.nominal,0),v=I.filter(V=>V.jenis==="masuk"&&V.pihak.id).reduce((V,J)=>V+J.pembayaran.nominal,0),R=I.filter(V=>V.jenis==="masuk"&&!V.pihak.id).reduce((V,J)=>V+J.pembayaran.nominal,0),W={};I.forEach(V=>{const J=V.tanggal.split("T")[0],U=V.jenis==="keluar"?-V.pembayaran.nominal:V.pembayaran.nominal;W[J]||(W[J]={value:0}),W[J].value+=U});const q=Object.keys(W).sort().map(V=>({date:V,...W[V]}));return{kasPembangunan:l,totalPemasukan:_,pemasukanSantri:v,pemasukanDonasi:R,totalPengeluaran:n,chartData:q}},[N,A]),$=l=>{C({jenis:l.jenis,kategori:l.peruntukan.kategori,id_santri:l.pihak.id||"",nama_santri:l.pihak.nama,nama_pihak_luar:l.pihak.id?"":l.pihak.nama,tanggal:new Date(l.tanggal).toISOString().split("T")[0],nominal:l.pembayaran.nominal,keterangan:l.pembayaran.catatan,metode:l.pembayaran.metode,id_biaya:l.peruntukan.id_ref||"",status:l.status||"Selesai"}),w(l.id_transaksi),h(!0),window.scrollTo(0,0)},E=async()=>{if(!d.nominal){alert("Mohon lengkapi nominal.");return}const I={id_transaksi:M||`TRX-BG-${Date.now()}`,tanggal:new Date(d.tanggal).toISOString(),jenis:d.jenis,status:d.status,pihak:{id:d.id_santri||null,nama:d.id_santri?d.nama_santri:d.nama_pihak_luar},peruntukan:{pos:"BANGUNAN",kategori:d.kategori,id_ref:d.id_biaya},pembayaran:{metode:d.metode,sistem:d.metode==="Tunai"?"":"Bank",penyedia:"",no_rek:"",penerima:"Bendahara",nominal:Number(d.nominal),catatan:d.keterangan}};let _=M?m.map(n=>n.id_transaksi===M?I:n):[I,...m];await G.updateKeuanganTransaksi(_),u(_),t("keuanganTransaksi",_),h(!1),w(null),C({jenis:"masuk",kategori:"",id_santri:"",nama_santri:"",nama_pihak_luar:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",id_biaya:"",status:"Selesai"})},F=async()=>{if(M&&window.confirm("Apakah Anda yakin ingin menghapus transaksi ini?")){D(!0);try{const l=m.filter(I=>I.id_transaksi!==M);await G.updateKeuanganTransaksi(l),u(l),t("keuanganTransaksi",l),h(!1),w(null)}catch(l){console.error("Gagal menghapus:",l)}finally{D(!1)}}},x=s.useMemo(()=>Array.isArray(i)?i.map(l=>{var I,_;return{value:(I=l.verifikasi_santri)==null?void 0:I.id_santri,label:`${(_=l.data_santri)==null?void 0:_.nama_lengkap}`}}):[],[i]);return e.jsxs("div",{className:"space-y-8 animate-fade-in font-sans pb-24 relative min-h-[600px]",children:[f&&e.jsx(fe,{message:"Menyiapkan data Pembangunan...",fullScreen:!1}),e.jsxs("div",{className:f?"opacity-30 pointer-events-none filter blur-sm transition-all duration-500":"opacity-100 filter-none transition-all duration-500",children:[e.jsx(ve,{tourId:"keu_bangunan",steps:vn}),e.jsx("div",{id:"keu-bg-tabs",className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-white p-2 rounded-2xl shadow-sm border border-gray-200 mb-6 sticky top-0 z-20 backdrop-blur-md bg-white/90",children:e.jsx(ua,{tabs:["Ringkasan","Transaksi","Monitoring"],activeTab:o,onChange:l=>c(l)})}),o==="Ringkasan"&&e.jsxs("div",{className:"space-y-8 animate-fade-in-up",children:[e.jsxs("div",{id:"keu-bg-stats",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(we,{title:"Total Kas",value:T.kasPembangunan,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h-5 10v-5a1 1 0 011-1h2a1 1 0 01 1v5m-4 0h4"})}),color:"emerald",description:"Saldo bersih kas pembangunan."}),e.jsx(we,{title:"Pemasukan Santri",value:T.pemasukanSantri,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),color:"blue"}),e.jsx(we,{title:"Wakaf Luar",value:T.pemasukanDonasi,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})}),color:"amber"}),e.jsx(we,{title:"Pengeluaran",value:T.totalPengeluaran,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 17h8m0 0V9m0 8l-8-8-4 4-6-6"})}),color:"rose"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm",children:[e.jsx("h3",{className:"font-serif font-bold text-gray-900 text-xl mb-6",children:"Tren Arus Kas (Net)"}),e.jsx(Ze,{data:T.chartData,color:"#10b981"})]}),e.jsxs("div",{className:"bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm flex flex-col items-center justify-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-emerald-400 to-amber-500"}),e.jsx("h3",{className:"font-serif font-bold text-gray-900 text-lg mb-8 w-full text-center",children:"Komposisi Dana"}),e.jsx(va,{data:[{label:"Santri",value:T.pemasukanSantri,color:"#10b981"},{label:"Wakaf Luar",value:T.pemasukanDonasi,color:"#f59e0b"}]}),e.jsxs("div",{className:"w-full mt-8 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center text-xs p-2 rounded-lg hover:bg-gray-50 transition",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-3 h-3 rounded-full shadow-sm bg-emerald-500"}),e.jsx("span",{className:"text-gray-600 font-bold uppercase tracking-wider",children:"Santri"})]}),e.jsx("span",{className:"font-black text-gray-900 font-sans",children:ie(T.pemasukanSantri)})]}),e.jsxs("div",{className:"flex justify-between items-center text-xs p-2 rounded-lg hover:bg-gray-50 transition",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-3 h-3 rounded-full shadow-sm bg-amber-500"}),e.jsx("span",{className:"text-gray-600 font-bold uppercase tracking-wider",children:"Wakaf"})]}),e.jsx("span",{className:"font-black text-gray-900 font-sans",children:ie(T.pemasukanDonasi)})]})]})]})]})]}),o==="Transaksi"&&e.jsx("div",{id:"keu-bg-transaksi",className:"space-y-6 animate-fade-in-up",children:K?e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl border border-gray-100 p-8 animate-fade-in-up font-sans relative z-30 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-100 pb-4",children:[e.jsx("h3",{className:"font-serif font-bold text-3xl text-gray-900 tracking-tight",children:M?"Edit Transaksi":"Input Pembangunan"}),e.jsx(Le,{label:"Batal",variant:"secondary",onClick:()=>{h(!1),w(null)}})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 ml-1",children:"Jenis"}),e.jsxs("div",{className:"flex bg-gray-50 p-1 rounded-xl",children:[e.jsx("button",{onClick:()=>C({...d,jenis:"masuk"}),className:`flex-1 py-3 rounded-lg text-sm font-bold transition ${d.jenis==="masuk"?"bg-emerald-600 text-white shadow":"text-gray-500"}`,children:"Pemasukan"}),e.jsx("button",{onClick:()=>C({...d,jenis:"keluar"}),className:`flex-1 py-3 rounded-lg text-sm font-bold transition ${d.jenis==="keluar"?"bg-rose-600 text-white shadow":"text-gray-500"}`,children:"Pengeluaran"})]})]}),e.jsx(ze,{id:"tgl-trx",label:"Tanggal Transaksi",value:d.tanggal,onChange:l=>C({...d,tanggal:l}),className:"!mb-0"})]}),d.jenis==="masuk"?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(de,{id:"cari-santri",label:"Cari Nama Santri (Opsional)",value:d.id_santri,onChange:l=>{var _;const I=i.find(n=>n.verifikasi_santri.id_santri===l);C({...d,id_santri:l,nama_santri:((_=I==null?void 0:I.data_santri)==null?void 0:_.nama_lengkap)||""})},options:x,className:"!mb-0"}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:d.nama_pihak_luar,onChange:l=>C({...d,nama_pihak_luar:l.target.value}),disabled:!!d.id_santri}),e.jsx("label",{className:"floating-label",children:"Nama Donatur (Jika Non-Santri)"})]})]}):e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:d.nama_pihak_luar,onChange:l=>C({...d,nama_pihak_luar:l.target.value})}),e.jsx("label",{className:"floating-label",children:"Dibayarkan Kepada / Toko"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"number",className:"floating-input peer font-bold text-emerald-700 text-lg",placeholder:" ",value:d.nominal||"",onChange:l=>C({...d,nominal:Number(l.target.value)})}),e.jsx("label",{className:"floating-label",children:"Nominal (Rp)"})]}),e.jsx(de,{id:"kategori-bayar",label:"Peruntukan",value:d.kategori,onChange:l=>C({...d,kategori:l}),options:d.jenis==="masuk"?[{value:"Uang Gedung",label:"Uang Gedung"},{value:"Wakaf",label:"Wakaf Sukarela"},{value:"Donasi Pembangunan",label:"Donasi Pembangunan"}]:[{value:"Belanja Material",label:"Belanja Material"},{value:"Upah Tukang",label:"Upah Tukang"},{value:"Operasional Proyek",label:"Operasional Proyek"}],className:"!mb-0"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(de,{id:"metode-bayar",label:"Metode",value:d.metode,onChange:l=>C({...d,metode:l}),options:[{value:"Tunai",label:"Tunai"},{value:"Transfer",label:"Transfer"}],className:"!mb-0"}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:d.keterangan,onChange:l=>C({...d,keterangan:l.target.value})}),e.jsx("label",{className:"floating-label",children:"Catatan"})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsx(de,{id:"status-transaksi",label:"Status Pembayaran",value:d.status,onChange:l=>C({...d,status:l}),options:[{value:"Selesai",label:"Selesai"},{value:"Menunggu",label:"Menunggu"},{value:"Gagal",label:"Gagal"}],className:"!mb-0"})}),e.jsxs("div",{className:"pt-6 flex gap-4 border-t border-gray-100 mt-4",children:[M&&e.jsx(Le,{label:"Hapus",variant:"danger",onClick:F,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx(Le,{label:M?"Simpan Perubahan":"Simpan Transaksi",onClick:E,className:"flex-1 py-4 text-base"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-end mb-4 gap-2",children:[e.jsx(sa,{data:A,fileName:`Transaksi_Bangunan_${new Date().toISOString().split("T")[0]}`,title:"Laporan Transaksi Pembangunan",columns:[{header:"Tanggal",accessor:l=>new Date(l.tanggal).toLocaleDateString("id-ID")},{header:"ID",accessor:l=>l.id_transaksi},{header:"Kategori",accessor:l=>l.peruntukan.kategori},{header:"Pihak",accessor:l=>l.pihak.nama},{header:"Jenis",accessor:l=>l.jenis},{header:"Nominal",accessor:l=>ie(l.pembayaran.nominal)},{header:"Status",accessor:l=>l.status||"Selesai"}]}),e.jsx(Le,{onClick:()=>{h(!0),w(null),C({jenis:"masuk",kategori:"",id_santri:"",nama_santri:"",nama_pihak_luar:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",id_biaya:"",status:"Selesai"})},label:"Input Transaksi",icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),e.jsx(Re,{headers:["Tanggal","Jenis","Pihak","Keterangan","Status","Nominal"],isEmpty:A.length===0,children:A.map(l=>e.jsxs("tr",{onClick:()=>$(l),className:"hover:bg-gray-50 transition cursor-pointer group",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-gray-900 text-sm mb-0.5",children:new Date(l.tanggal).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})}),e.jsx("span",{className:"text-[10px] text-gray-400 font-sans tracking-wide",children:l.id_transaksi})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`text-[9px] font-bold uppercase tracking-wider px-2 py-1 rounded border ${l.jenis==="masuk"?"bg-emerald-50 text-emerald-600 border-emerald-100":"bg-rose-50 text-rose-600 border-rose-100"}`,children:l.jenis})}),e.jsx("td",{className:"px-6 py-4 font-bold text-gray-800",children:l.pihak.nama}),e.jsxs("td",{className:"px-6 py-4 text-gray-600 text-[11px] font-medium",children:[l.peruntukan.kategori," - ",l.pembayaran.catatan]}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(Pe,{status:l.status||"Selesai"})}),e.jsxs("td",{className:`px-6 py-4 text-right font-black text-sm tracking-tight font-sans tabular-nums ${l.jenis==="masuk"?"text-emerald-600":"text-rose-600"}`,children:[l.jenis==="masuk"?"+":"-"," ",ie(l.pembayaran.nominal).replace("Rp","")]})]},l.id_transaksi))})]})}),o==="Monitoring"&&e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl border border-gray-100 overflow-hidden animate-fade-in-up mt-6",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center flex-wrap gap-4 bg-gray-50/30 sticky top-0 z-10",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:"Monitoring Santri"}),e.jsx("p",{className:"text-xs text-gray-400",children:"Status pembayaran uang gedung santri."})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("input",{type:"text",placeholder:"Cari Nama Santri...",value:L,onChange:l=>P(l.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-gray-200 rounded-xl text-xs font-bold text-gray-700 outline-none focus:ring-2 focus:ring-emerald-500 transition shadow-sm"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx(sa,{data:b,fileName:`Monitoring_Bangunan_${new Date().toISOString().split("T")[0]}`,title:"Monitoring Pembayaran Bangunan",columns:[{header:"ID Santri",accessor:l=>l.id_santri},{header:"Nama Lengkap",accessor:l=>l.nama},{header:"Kelas",accessor:l=>l.kelas},{header:"Wajib Bayar",accessor:l=>ie(l.wajib_bayar)},{header:"Total Bayar",accessor:l=>ie(l.total_bayar)},{header:"Sisa",accessor:l=>ie(l.sisa_bayar)},{header:"Status",accessor:l=>l.status}]})]})]}),e.jsx(Re,{headers:["Nama Santri","Kelas","Wajib Bayar","Terbayar","Sisa","Status"],children:b.map(l=>e.jsxs("tr",{className:"hover:bg-emerald-50/30 transition group cursor-default border-b border-gray-50 last:border-0",children:[e.jsx("td",{className:"px-6 py-4 font-bold text-gray-800",children:l.nama}),e.jsx("td",{className:"px-6 py-4 text-gray-500 text-xs",children:l.kelas}),e.jsx("td",{className:"px-6 py-4 text-right font-medium text-gray-700 font-sans tabular-nums text-sm",children:ie(l.wajib_bayar).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-right font-bold text-emerald-600 font-sans tabular-nums text-sm",children:ie(l.total_bayar).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-right font-bold text-rose-600 font-sans tabular-nums text-sm",children:ie(l.sisa_bayar).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(Pe,{status:l.status})})]},l.id_santri))})]})]})]})},yn=[{title:"Kas Operasional",description:"Manajemen SPP (Infaq Syahriah) dan belanja rutin operasional pesantren."},{targetId:"keu-ops-stats",title:"Kesehatan Kas",description:"Pastikan saldo operasional cukup untuk menutupi kebutuhan listrik, air, dan gaji.",position:"bottom"},{targetId:"keu-ops-monitor",title:"Monitoring SPP",description:"Pantau kepatuhan pembayaran SPP santri per bulan.",position:"top"}],Nn=()=>{const{fetchData:a,cache:r,updateCache:t}=ge(),[o,c]=s.useState("Ringkasan"),k=r.keuanganBiaya&&r.keuanganTransaksi&&r.databaseSantri,[f,D]=s.useState(!k),[B,p]=s.useState(r.keuanganBiaya||[]),[m,u]=s.useState(r.keuanganTransaksi||[]),[i,g]=s.useState(r.databaseSantri||[]),[K,h]=s.useState(!1),[M,w]=s.useState(null),[d,C]=s.useState({jenis:"masuk",kategori:"",id_santri:"",nama_santri:"",nama_pihak_luar:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",id_biaya:"",status:"Selesai"}),[L,P]=s.useState(""),[y,z]=s.useState("");s.useEffect(()=>{(async()=>{const l=Date.now();k||D(!0);try{const[I,_,n]=await Promise.all([a("keuanganBiaya",G.getKeuanganBiaya,"Operasional",!1,!1),a("keuanganTransaksi",G.getKeuanganTransaksi,"Operasional",!1,!1),a("databaseSantri",G.getDatabaseSantri,"Operasional",!1,!1)]);p(Array.isArray(I)?I:[]),u(Array.isArray(_)?_:[]),g(Array.isArray(n)?n:n?[n]:[])}catch(I){console.error(I)}finally{if(k)D(!1);else{const I=Date.now()-l;setTimeout(()=>D(!1),Math.max(0,2e3-I))}}})()},[a,k]);const j=s.useMemo(()=>Array.isArray(m)?m.filter(x=>x.peruntukan.pos==="OPERASIONAL"||x.peruntukan.pos==="Operasional"):[],[m]),N=s.useMemo(()=>Array.isArray(B)?B.filter(x=>x.pos==="Operasional"):[],[B]),A=s.useMemo(()=>[...N.map(l=>({value:l.id_biaya,label:l.kategori})),{value:"LAINNYA",label:"Lainnya"}],[N]),S=s.useMemo(()=>{if(!Array.isArray(i)||!i.length)return[];const x=y||new Date().toISOString().slice(0,7),l=N.find(_=>(_.kategori.toLowerCase().includes("spp")||_.kategori.toLowerCase().includes("syariah"))&&_.periode==="bulanan"),I=l?l.nominal:0;return i.map(_=>{var W,q,V,J;const n=((W=_.verifikasi_santri)==null?void 0:W.id_santri)||"-",v=j.filter(U=>U.pihak.id===n&&U.tanggal.startsWith(x)).reduce((U,re)=>U+re.pembayaran.nominal,0);let R="Belum Lunas";return I>0?v>=I?R="Lunas":v>0&&(R="Sebagian"):v>0&&(R="Lunas"),{id_santri:n,nama:((q=_.data_santri)==null?void 0:q.nama_lengkap)||"Tanpa Nama",kelas:`${((V=_.data_akademik)==null?void 0:V.kelas)||""} ${((J=_.data_akademik)==null?void 0:J.jenjang)||""}`,wajib_bayar:I,terbayar:v,sisa_bayar:Math.max(0,I-v),status:R}}).sort((_,n)=>_.nama.localeCompare(n.nama))},[i,N,j,y]),b=s.useMemo(()=>{const x=j.reduce((Z,ae)=>ae.peruntukan.kategori.toLowerCase().includes("belanja")||ae.peruntukan.kategori.toLowerCase().includes("listrik")||ae.peruntukan.kategori.toLowerCase().includes("air")||ae.jenis==="keluar"?Z-ae.pembayaran.nominal:Z+ae.pembayaran.nominal,0),l=y?j.filter(Z=>Z.tanggal.startsWith(y)):j,I=l.filter(Z=>Z.jenis==="masuk").reduce((Z,ae)=>Z+ae.pembayaran.nominal,0),_=l.filter(Z=>Z.jenis==="keluar").reduce((Z,ae)=>Z+ae.pembayaran.nominal,0),n={};l.forEach(Z=>{const ae=Z.tanggal.split("T")[0],_e=Z.jenis==="keluar"?-Z.pembayaran.nominal:Z.pembayaran.nominal;n[ae]||(n[ae]={value:0}),n[ae].value+=_e});const v=Object.keys(n).sort().map(Z=>({date:Z,...n[Z]})),R=[...l].sort((Z,ae)=>new Date(ae.tanggal).getTime()-new Date(Z.tanggal).getTime()),W=l.filter(Z=>Z.jenis==="keluar"),q=W.filter(Z=>Z.peruntukan.kategori.toLowerCase().includes("listrik")).reduce((Z,ae)=>Z+ae.pembayaran.nominal,0),V=W.filter(Z=>Z.peruntukan.kategori.toLowerCase().includes("air")).reduce((Z,ae)=>Z+ae.pembayaran.nominal,0),J=W.filter(Z=>Z.peruntukan.kategori.toLowerCase().includes("atk")).reduce((Z,ae)=>Z+ae.pembayaran.nominal,0),U=W.reduce((Z,ae)=>Z+ae.pembayaran.nominal,0)-(q+V+J),re=[{label:"Listrik",value:q,color:"#f59e0b"},{label:"Air",value:V,color:"#3b82f6"},{label:"ATK",value:J,color:"#10b981"},{label:"Lainnya",value:Math.max(0,U),color:"#64748b"}].filter(Z=>Z.value>0);return{saldoGlobal:x,pemasukanPeriode:I,pengeluaranPeriode:_,dailyChartData:v,filteredTransactions:R,donutData:re}},[j,y]),T=x=>{C({jenis:x.jenis,kategori:x.peruntukan.kategori,id_santri:x.pihak.id||"",nama_santri:x.pihak.nama,nama_pihak_luar:x.pihak.id?"":x.pihak.nama,tanggal:new Date(x.tanggal).toISOString().split("T")[0],nominal:x.pembayaran.nominal,keterangan:x.pembayaran.catatan,metode:x.pembayaran.metode,id_biaya:x.peruntukan.id_ref||"",status:x.status||"Selesai"}),w(x.id_transaksi),h(!0),window.scrollTo(0,0)},$=async()=>{if(!d.nominal){alert("Nominal wajib diisi.");return}const l={id_transaksi:M||`TRX-OPS-${Date.now().toString().slice(-6)}`,tanggal:new Date(d.tanggal).toISOString(),status:d.status,jenis:d.jenis,pihak:{id:d.id_santri||null,nama:d.id_santri?d.nama_santri:d.nama_pihak_luar},peruntukan:{pos:"OPERASIONAL",kategori:d.kategori,id_ref:d.id_biaya||"BY-MANUAL"},pembayaran:{metode:d.metode,sistem:d.metode==="Tunai"?"":"Bank",penyedia:"",no_rek:"",penerima:"Bendahara",nominal:Number(d.nominal),catatan:d.keterangan||"-"}};let I=[];M?I=m.map(_=>_.id_transaksi===M?l:_):I=[l,...m],await G.updateKeuanganTransaksi(I),u(I),t("keuanganTransaksi",I),h(!1),w(null),C({jenis:"masuk",kategori:"",id_santri:"",nama_santri:"",nama_pihak_luar:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",id_biaya:"",status:"Selesai"})},E=async()=>{if(M&&window.confirm("Apakah Anda yakin ingin menghapus transaksi ini?")){D(!0);try{const x=m.filter(l=>l.id_transaksi!==M);await G.updateKeuanganTransaksi(x),u(x),t("keuanganTransaksi",x),h(!1),w(null)}catch(x){console.error("Gagal menghapus:",x)}finally{D(!1)}}},F=s.useMemo(()=>Array.isArray(i)?i.map(x=>{var l,I;return{value:(l=x.verifikasi_santri)==null?void 0:l.id_santri,label:`${(I=x.data_santri)==null?void 0:I.nama_lengkap}`}}):[],[i]);return e.jsxs("div",{className:"space-y-6 animate-fade-in font-sans pb-24 relative min-h-[600px]",children:[e.jsx(ve,{tourId:"keu_operasional",steps:yn}),e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-white p-2 rounded-2xl shadow-sm border border-gray-200 mb-6 sticky top-0 z-20 backdrop-blur-md bg-white/90",children:e.jsx(ua,{tabs:["Ringkasan","Transaksi","Monitoring"],activeTab:o,onChange:x=>c(x)})}),o==="Ringkasan"&&e.jsxs("div",{id:"keu-ops-stats",className:"space-y-8 animate-fade-in-up",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(we,{title:"Saldo Operasional",value:b.saldoGlobal,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"blue",description:"Saldo bersih kas operasional."}),e.jsx(we,{title:"Pemasukan SPP",value:b.pemasukanPeriode,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 11l5-5m0 0l5 5m-5-5v12"})}),color:"emerald"}),e.jsx(we,{title:"Pengeluaran",value:b.pengeluaranPeriode,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 13l-5 5m0 0l-5-5m5 5V6"})}),color:"rose"}),e.jsx(we,{title:"Sisa Tagihan",value:0,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"gray",description:"Estimasi tunggakan bulan ini."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm",children:[e.jsx("h3",{className:"font-serif font-bold text-gray-900 text-xl mb-6",children:"Tren Arus Kas (Net)"}),e.jsx(Ze,{data:b.dailyChartData,color:"#3b82f6"})]}),e.jsxs("div",{className:"bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm flex flex-col items-center justify-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-400 to-indigo-500"}),e.jsx("h3",{className:"font-serif font-bold text-gray-900 text-lg mb-8 w-full text-center",children:"Pos Pengeluaran"}),e.jsx(va,{data:b.donutData}),e.jsx("div",{className:"w-full mt-8 space-y-3",children:b.donutData.map((x,l)=>e.jsxs("div",{className:"flex justify-between items-center text-xs p-2 rounded-lg hover:bg-gray-50 transition",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-3 h-3 rounded-full shadow-sm",style:{backgroundColor:x.color}}),e.jsx("span",{className:"text-gray-600 font-bold uppercase tracking-wider",children:x.label})]}),e.jsx("span",{className:"font-black text-gray-900 font-sans tabular-nums",children:ie(x.value)})]},l))})]})]})]}),o==="Transaksi"&&e.jsx("div",{className:"space-y-6 animate-fade-in-up",children:K?e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl border border-gray-100 p-8 animate-fade-in-up font-sans relative z-30 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-100 pb-4",children:[e.jsx("h3",{className:"font-serif font-bold text-3xl text-gray-900 tracking-tight",children:M?"Edit Transaksi":"Input Transaksi Operasional"}),e.jsx(Le,{label:"Batal",variant:"secondary",onClick:()=>{h(!1),w(null)}})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 ml-1",children:"Jenis"}),e.jsxs("div",{className:"flex bg-gray-50 p-1 rounded-xl",children:[e.jsx("button",{onClick:()=>C({...d,jenis:"masuk"}),className:`flex-1 py-3 rounded-lg text-sm font-bold transition ${d.jenis==="masuk"?"bg-blue-600 text-white shadow":"text-gray-500"}`,children:"Pemasukan"}),e.jsx("button",{onClick:()=>C({...d,jenis:"keluar"}),className:`flex-1 py-3 rounded-lg text-sm font-bold transition ${d.jenis==="keluar"?"bg-rose-600 text-white shadow":"text-gray-500"}`,children:"Pengeluaran"})]})]}),e.jsx(ze,{id:"tgl-trx",label:"Tanggal",value:d.tanggal||"",onChange:x=>C({...d,tanggal:x}),className:"!mb-0"})]}),d.jenis==="masuk"?e.jsx(de,{id:"cari-santri",label:"Cari Santri",value:d.id_santri,onChange:x=>{var I;const l=i.find(_=>_.verifikasi_santri.id_santri===x);C({...d,id_santri:x,nama_santri:((I=l==null?void 0:l.data_santri)==null?void 0:I.nama_lengkap)||""})},options:F,className:"!mb-0"}):e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:d.nama_pihak_luar,onChange:x=>C({...d,nama_pihak_luar:x.target.value})}),e.jsx("label",{className:"floating-label",children:"Pihak Luar / Vendor"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(de,{id:"kategori-biaya",label:"Kategori / Pos",value:d.id_biaya,options:A,onChange:x=>{const l=N.find(I=>I.id_biaya===x);C({...d,id_biaya:x,kategori:(l==null?void 0:l.kategori)||(x==="LAINNYA"?"Lainnya":""),nominal:(l==null?void 0:l.nominal)||0})},className:"!mb-0"}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:d.keterangan,onChange:x=>C({...d,keterangan:x.target.value})}),e.jsx("label",{className:"floating-label",children:"Keterangan"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"number",className:"floating-input peer font-bold text-blue-800 text-lg",placeholder:" ",value:d.nominal||"",onChange:x=>C({...d,nominal:Number(x.target.value)})}),e.jsx("label",{className:"floating-label",children:"Nominal (Rp)"})]}),e.jsx(de,{id:"metode-bayar",label:"Metode",value:d.metode,onChange:x=>C({...d,metode:x}),options:[{value:"Tunai",label:"Tunai"},{value:"Transfer",label:"Transfer"}],className:"!mb-0"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-6",children:e.jsx(de,{id:"status-transaksi",label:"Status Pembayaran",value:d.status,onChange:x=>C({...d,status:x}),options:[{value:"Selesai",label:"Selesai"},{value:"Menunggu",label:"Menunggu"},{value:"Gagal",label:"Gagal"}],className:"!mb-0"})}),e.jsxs("div",{className:"pt-6 flex gap-4 border-t border-gray-100 mt-4",children:[M&&e.jsx(Le,{label:"Hapus",variant:"danger",onClick:E,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx(Le,{label:M?"Simpan Perubahan":"Simpan Transaksi",onClick:$,className:"flex-1 py-4 text-base"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"bg-white rounded-xl px-3 py-2 flex items-center gap-2 border border-gray-200 shadow-sm",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Periode:"}),e.jsx("input",{type:"month",value:y,onChange:x=>z(x.target.value),className:"bg-transparent text-xs font-bold text-gray-700 outline-none cursor-pointer hover:text-blue-600"}),y&&e.jsx("button",{onClick:()=>z(""),className:"text-[10px] text-red-400 font-bold px-1",children:"✕"})]}),e.jsx(Le,{label:"Input Transaksi",onClick:()=>{h(!0),w(null),C({jenis:"masuk",kategori:"",id_santri:"",nama_santri:"",nama_pihak_luar:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",id_biaya:"",status:"Selesai"})},icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),e.jsx(Re,{headers:["Tanggal","Jenis","Pihak","Keterangan","Status","Nominal"],isEmpty:b.filteredTransactions.length===0,children:b.filteredTransactions.map((x,l)=>{const I=x.jenis==="keluar";return e.jsxs("tr",{className:"hover:bg-blue-50/30 transition cursor-pointer group",onClick:()=>T(x),children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-gray-900 text-sm mb-0.5",children:new Date(x.tanggal).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})}),e.jsx("span",{className:"text-[10px] text-gray-400 font-sans tracking-wide",children:x.id_transaksi})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`text-[9px] font-bold px-2 py-1 rounded border ${I?"bg-rose-50 text-rose-600 border-rose-100":"bg-blue-50 text-blue-600 border-blue-100"}`,children:I?"Keluar":"Masuk"})}),e.jsx("td",{className:"px-6 py-4 font-bold text-gray-800",children:x.pihak.nama}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-gray-800 group-hover:text-blue-700 transition",children:x.peruntukan.kategori}),e.jsx("div",{className:"text-[10px] text-gray-500 mt-0.5 italic",children:x.pembayaran.catatan})]}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(Pe,{status:x.status||"Selesai"})}),e.jsxs("td",{className:`px-6 py-4 text-right font-black font-sans text-sm tracking-tight tabular-nums ${I?"text-rose-600":"text-blue-600"}`,children:[I?"-":"+"," ",ie(x.pembayaran.nominal).replace("Rp","")]})]},l)})})]})}),o==="Monitoring"&&e.jsx("div",{id:"keu-ops-monitor",className:"animate-fade-in-up mt-6",children:e.jsxs("div",{className:"bg-white rounded-[2rem] shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex flex-col md:flex-row justify-between items-center gap-4 bg-gray-50/30 sticky top-0 z-10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:"Monitoring SPP"}),e.jsxs("div",{className:"bg-white rounded-xl px-3 py-2 flex items-center gap-2 border border-gray-200 shadow-sm",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Periode:"}),e.jsx("input",{type:"month",value:y,onChange:x=>z(x.target.value),className:"bg-transparent text-xs font-bold text-gray-700 outline-none cursor-pointer hover:text-blue-600"}),y&&e.jsx("button",{onClick:()=>z(""),className:"text-[10px] text-red-400 font-bold px-1",children:"✕"})]})]}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("input",{type:"text",placeholder:"Cari Nama Santri...",value:L,onChange:x=>P(x.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-gray-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-blue-500 outline-none transition shadow-sm"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),e.jsx(Re,{headers:["Nama Santri","Kelas","Wajib Bayar","Terbayar","Sisa","Status"],children:S.filter(x=>x.nama.toLowerCase().includes(L.toLowerCase())).map(x=>e.jsxs("tr",{className:"hover:bg-blue-50/30 transition border-b border-gray-50 last:border-0 cursor-default",children:[e.jsx("td",{className:"px-6 py-4 font-bold text-gray-800",children:x.nama}),e.jsx("td",{className:"px-6 py-4 text-gray-500 text-xs",children:x.kelas}),e.jsx("td",{className:"px-6 py-4 text-right font-medium text-gray-700 font-sans tabular-nums text-sm",children:ie(x.wajib_bayar).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-right font-bold text-emerald-600 font-sans tabular-nums text-sm",children:ie(x.terbayar).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-right font-bold text-rose-600 font-sans tabular-nums text-sm",children:ie(x.sisa_bayar).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(Pe,{status:x.status})})]},x.id_santri))})]})})]})},_n=[{title:"Dapur & Uang Makan",description:"Kelola dana konsumsi santri. Pantau pemasukan uang makan dan pengeluaran belanja dapur."},{targetId:"keu-makan-stats",title:"Analisa Biaya",description:"Lihat rata-rata biaya makan per santri per hari untuk efisiensi anggaran.",position:"left"},{targetId:"keu-makan-graph",title:"Tren Belanja",description:"Grafik pengeluaran belanja dapur harian.",position:"top"}],Sn=()=>{const{fetchData:a,cache:r,updateCache:t}=ge(),[o,c]=s.useState("Ringkasan"),k=r.keuanganBiaya&&r.keuanganTransaksi&&r.databaseSantri,[f,D]=s.useState(!k),[B,p]=s.useState(r.keuanganBiaya||[]),[m,u]=s.useState(r.keuanganTransaksi||[]),[i,g]=s.useState(r.databaseSantri||[]),[K,h]=s.useState(!1),[M,w]=s.useState(null),[d,C]=s.useState({jenis:"masuk",kategori:"",id_santri:"",nama_santri:"",nama_pihak_luar:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",id_biaya:"",status:"Selesai"}),[L,P]=s.useState(""),[y,z]=s.useState("");s.useEffect(()=>{(async()=>{k||D(!0);try{const[l,I,_]=await Promise.all([a("keuanganBiaya",G.getKeuanganBiaya,"Makan",!1,!1),a("keuanganTransaksi",G.getKeuanganTransaksi,"Makan",!1,!1),a("databaseSantri",G.getDatabaseSantri,"Makan",!1,!1)]);p(Array.isArray(l)?l:[]),u(Array.isArray(I)?I:[]),g(Array.isArray(_)?_:_?[_]:[])}catch(l){console.error(l)}finally{D(!1)}})()},[a,k]);const j=s.useMemo(()=>Array.isArray(m)?m.filter(x=>{var l,I;return((l=x.peruntukan)==null?void 0:l.pos)==="Makan"||((I=x.peruntukan)==null?void 0:I.pos)==="MAKAN"}):[],[m]),N=s.useMemo(()=>Array.isArray(B)?B.filter(x=>x.pos==="Makan"):[],[B]),A=s.useMemo(()=>[...N.map(l=>({value:l.id_biaya,label:l.kategori})),{value:"LAINNYA",label:"Lainnya"}],[N]),S=s.useMemo(()=>{const x=U=>U.peruntukan.kategori.toLowerCase().includes("belanja")||U.peruntukan.kategori.toLowerCase().includes("dapur")||U.jenis==="keluar",l=U=>!x(U),I=j.reduce((U,re)=>l(re)?U+re.pembayaran.nominal:U-re.pembayaran.nominal,0),_=y?j.filter(U=>U.tanggal.startsWith(y)):j,n=_.filter(U=>l(U)).reduce((U,re)=>U+re.pembayaran.nominal,0),v=_.filter(U=>x(U)).reduce((U,re)=>U+re.pembayaran.nominal,0),R={};_.forEach(U=>{const re=U.tanggal.split("T")[0],Z=x(U)?-U.pembayaran.nominal:U.pembayaran.nominal;R[re]||(R[re]={value:0}),R[re].value+=Z});const W=Object.keys(R).sort().map(U=>({date:U,...R[U]})),q=v/Math.max(1,W.length),V=q/(i.length||1),J=[..._].sort((U,re)=>new Date(re.tanggal).getTime()-new Date(U.tanggal).getTime());return{saldoGlobal:I,pemasukanPeriode:n,pengeluaranPeriode:v,dailyChartData:W,rataRataBelanjaHarian:q,costPerSantriPerHari:V,filteredTransactions:J}},[j,y,i]),b=s.useMemo(()=>{if(!Array.isArray(i)||!i.length)return[];const x=y||new Date().toISOString().slice(0,7),l=N.find(_=>(_.kategori.toLowerCase().includes("katering")||_.kategori.toLowerCase().includes("makan"))&&_.periode==="bulanan"),I=l?l.nominal:0;return i.map(_=>{var W,q,V,J;const n=((W=_.verifikasi_santri)==null?void 0:W.id_santri)||"-",v=j.filter(U=>{var re;return((re=U.pihak)==null?void 0:re.id)===n&&U.tanggal.startsWith(x)&&!U.peruntukan.kategori.toLowerCase().includes("belanja")}).reduce((U,re)=>{var Z;return U+(((Z=re.pembayaran)==null?void 0:Z.nominal)||0)},0);let R="Belum Lunas";return I>0?v>=I?R="Lunas":v>0&&(R="Sebagian"):v>0&&(R="Lunas"),{id_santri:n,nama:((q=_.data_santri)==null?void 0:q.nama_lengkap)||"Tanpa Nama",kelas:`${((V=_.data_akademik)==null?void 0:V.kelas)||""} ${((J=_.data_akademik)==null?void 0:J.jenjang)||""}`,wajib_bayar:I,terbayar:v,sisa_bayar:Math.max(0,I-v),status:R}}).sort((_,n)=>_.nama.localeCompare(n.nama))},[i,N,j,y]);s.useMemo(()=>{const x=b.length,l=b.filter(v=>v.status==="Lunas").length,I=b.reduce((v,R)=>v+R.wajib_bayar,0),_=b.reduce((v,R)=>v+R.terbayar,0),n=x>0?l/x*100:0;return{totalSantri:x,lunas:l,totalTarget:I,totalTerkumpul:_,persentaseLunas:n}},[b]);const T=x=>{const l=x.peruntukan.kategori.toLowerCase().includes("belanja")||x.peruntukan.kategori.toLowerCase().includes("dapur");C({jenis:l?"keluar":"masuk",kategori:x.peruntukan.kategori,id_santri:x.pihak.id||"",nama_santri:x.pihak.nama,nama_pihak_luar:x.pihak.id?"":x.pihak.nama,tanggal:new Date(x.tanggal).toISOString().split("T")[0],nominal:x.pembayaran.nominal,keterangan:x.pembayaran.catatan,metode:x.pembayaran.metode,id_biaya:x.peruntukan.id_ref||"",status:x.status||"Selesai"}),w(x.id_transaksi),h(!0),window.scrollTo(0,0)},$=async()=>{if(!d.nominal){alert("Mohon lengkapi nominal.");return}const x=d.jenis==="keluar",I={id_transaksi:M||`TRX-MAKAN-${Date.now().toString().slice(-6)}`,tanggal:new Date(d.tanggal).toISOString(),status:d.status,jenis:d.jenis,pihak:{id:d.id_santri||null,nama:d.id_santri?d.nama_santri:d.nama_pihak_luar},peruntukan:{pos:"Makan",kategori:d.kategori||(x?"Belanja Dapur":"Katering"),id_ref:d.id_biaya||"BY-MANUAL"},pembayaran:{metode:d.metode,sistem:d.metode==="Tunai"?"":"Bank",penyedia:"",no_rek:"",penerima:"Bendahara",nominal:Number(d.nominal),catatan:d.keterangan||"-"}};let _=M?m.map(n=>n.id_transaksi===M?I:n):[I,...m];await G.updateKeuanganTransaksi(_),u(_),t("keuanganTransaksi",_),h(!1),w(null),C({jenis:"masuk",kategori:"",id_santri:"",nama_santri:"",nama_pihak_luar:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",id_biaya:"",status:"Selesai"})},E=s.useMemo(()=>Array.isArray(i)?i.map(x=>{var l,I,_;return{value:(l=x.verifikasi_santri)==null?void 0:l.id_santri,label:`${(I=x.data_santri)==null?void 0:I.nama_lengkap} (${(_=x.verifikasi_santri)==null?void 0:_.id_santri})`}}):[],[i]),F=async()=>{if(M&&window.confirm("Apakah Anda yakin ingin menghapus transaksi ini?")){D(!0);try{const x=m.filter(l=>l.id_transaksi!==M);await G.updateKeuanganTransaksi(x),u(x),t("keuanganTransaksi",x),h(!1),w(null)}catch(x){console.error("Gagal menghapus:",x)}finally{D(!1)}}};return f?e.jsx(fe,{message:"Menyiapkan data Dapur...",fullScreen:!1}):e.jsxs("div",{className:"space-y-6 animate-fade-in font-sans pb-24 relative min-h-[600px]",children:[e.jsx(ve,{tourId:"keu_makan",steps:_n}),e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-white p-2 rounded-2xl shadow-sm border border-gray-200 mb-6 sticky top-0 z-20 backdrop-blur-md bg-white/90",children:e.jsx(ua,{tabs:["Ringkasan","Transaksi","Monitoring"],activeTab:o,onChange:x=>c(x)})}),o==="Ringkasan"&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 animate-fade-in-up",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(we,{title:"Saldo Uang Makan",value:S.saldoGlobal,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M21 15.546c-.523 0-1.046.151-1.5.454a2.704 2.704 0 01-3 0 2.704 2.704 0 00-3 0 2.704 2.704 0 01-3 0 2.704 2.704 0 00-3 0 2.701 2.701 0 00-1.5-.454M9 6v2m3-2v2m3-2v2M9 3h.01M12 3h.01M15 3h.01M21 21v-7a2 2 0 00-2-2H5a2 2 0 00-2 2v7h18zm-3-9v-2a2 2 0 00-2-2H8a2 2 0 00-2 2v2h12z"})}),color:"amber",description:"Saldo operasional dapur."}),e.jsx(we,{title:"Rata-rata Belanja",value:S.rataRataBelanjaHarian,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})}),color:"blue",description:"Per hari."})]}),e.jsxs("div",{id:"keu-makan-graph",className:"bg-white p-6 rounded-[2rem] border border-gray-200 shadow-sm",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-600 mb-4 uppercase tracking-widest",children:"Tren Belanja Dapur"}),e.jsx(Ze,{data:S.dailyChartData,color:"#f59e0b"})]})]}),e.jsxs("div",{id:"keu-makan-stats",className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-[2rem] shadow-sm border border-gray-200 flex flex-col justify-center",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-sm mb-6 uppercase tracking-widest text-center",children:"Arus Kas Periode Ini"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(we,{title:"Pemasukan",value:S.pemasukanPeriode,icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 11l5-5m0 0l5 5m-5-5v12"})}),color:"emerald"}),e.jsx(we,{title:"Pengeluaran",value:S.pengeluaranPeriode,icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 13l-5 5m0 0l-5-5m5 5V6"})}),color:"rose"})]})]}),e.jsxs("div",{className:"bg-amber-900 rounded-[2rem] p-6 text-white shadow-xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-amber-800 rounded-full blur-3xl -mr-10 -mt-10"}),e.jsx("h3",{className:"font-bold text-lg mb-4 relative z-10",children:"Analisa Biaya"}),e.jsxs("div",{className:"space-y-4 relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"text-amber-200 font-medium",children:"Avg. Belanja / Hari"}),e.jsx("span",{className:"font-bold text-white font-sans text-sm",children:ie(S.rataRataBelanjaHarian)})]}),e.jsx("div",{className:"w-full bg-amber-800 h-px"}),e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"text-amber-200 font-medium",children:"Cost / Santri / Hari"}),e.jsx("span",{className:"font-bold text-white font-sans text-sm",children:ie(S.costPerSantriPerHari)})]})]})]})]})]}),o==="Transaksi"&&e.jsx("div",{className:"space-y-6 animate-fade-in-up",children:K?e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl border border-gray-100 p-8 animate-fade-in-up font-sans relative z-30 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-100 pb-4",children:[e.jsx("h3",{className:"font-serif font-bold text-2xl text-gray-900 tracking-tight",children:M?"Edit Transaksi":"Input Keuangan Dapur"}),e.jsx(Le,{label:"Batal",variant:"secondary",onClick:()=>{h(!1),w(null)}})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 ml-1",children:"Jenis"}),e.jsxs("div",{className:"flex bg-gray-50 p-1 rounded-xl",children:[e.jsx("button",{onClick:()=>C({...d,jenis:"masuk",kategori:"Katering"}),className:`flex-1 py-3 rounded-lg text-sm font-bold transition ${d.jenis==="masuk"?"bg-emerald-600 text-white shadow":"text-gray-500"}`,children:"Pemasukan"}),e.jsx("button",{onClick:()=>C({...d,jenis:"keluar",kategori:"Belanja Dapur",id_santri:""}),className:`flex-1 py-3 rounded-lg text-sm font-bold transition ${d.jenis==="keluar"?"bg-rose-600 text-white shadow":"text-gray-500"}`,children:"Pengeluaran"})]})]}),e.jsx(ze,{id:"tgl-trx",label:"Tanggal",value:d.tanggal||"",onChange:x=>C({...d,tanggal:x}),className:"!mb-0"})]}),d.jenis==="masuk"?e.jsx(de,{id:"cari-santri",label:"Cari Santri",value:d.id_santri,onChange:x=>{var I;const l=i.find(_=>_.verifikasi_santri.id_santri===x);C({...d,id_santri:x,nama_santri:((I=l==null?void 0:l.data_santri)==null?void 0:I.nama_lengkap)||""})},options:E,className:"!mb-0"}):e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:d.nama_pihak_luar,onChange:x=>C({...d,nama_pihak_luar:x.target.value})}),e.jsx("label",{className:"floating-label",children:"Supplier / Vendor"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(de,{id:"kategori-biaya",label:"Kategori / Pos",value:d.id_biaya,options:A,onChange:x=>{const l=N.find(I=>I.id_biaya===x);C({...d,id_biaya:x,kategori:(l==null?void 0:l.kategori)||(x==="LAINNYA"?"Lainnya":""),nominal:(l==null?void 0:l.nominal)||0})},className:"!mb-0"}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:d.keterangan,onChange:x=>C({...d,keterangan:x.target.value})}),e.jsx("label",{className:"floating-label",children:"Keterangan"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"number",className:"floating-input peer font-bold text-emerald-800 text-lg",placeholder:" ",value:d.nominal||"",onChange:x=>C({...d,nominal:Number(x.target.value)})}),e.jsx("label",{className:"floating-label",children:"Nominal (Rp)"})]}),e.jsx(de,{id:"metode-bayar",label:"Metode",value:d.metode,onChange:x=>C({...d,metode:x}),options:[{value:"Tunai",label:"Tunai"},{value:"Transfer",label:"Transfer"}],className:"!mb-0"})]}),e.jsxs("div",{className:"pt-6 flex gap-4 border-t border-gray-100 mt-4",children:[M&&e.jsx(Le,{label:"Hapus",variant:"danger",onClick:F,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx(Le,{label:M?"Simpan Perubahan":"Simpan Transaksi",onClick:$,className:"flex-1 py-4 text-base"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(Le,{onClick:()=>{h(!0),w(null),C({jenis:"masuk",kategori:"",id_santri:"",nama_santri:"",nama_pihak_luar:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",id_biaya:"",status:"Selesai"})},label:"Transaksi Baru",icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})}),e.jsx(Re,{headers:["Keterangan","Tanggal","Status","Jenis","Nominal"],isEmpty:S.filteredTransactions.length===0,children:S.filteredTransactions.map((x,l)=>{const I=x.jenis==="keluar";return e.jsxs("tr",{className:"hover:bg-amber-50/50 transition cursor-pointer group",onClick:()=>T(x),children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center mr-2 ${I?"bg-rose-100 text-rose-600":"bg-emerald-100 text-emerald-600"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:I?"M20 12H4":"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-gray-800 group-hover:text-amber-700 transition",children:x.peruntukan.kategori}),e.jsxs("div",{className:"text-[10px] text-gray-500 mt-0.5",children:[x.pembayaran.catatan," (",x.pihak.nama,")"]})]})]})}),e.jsx("td",{className:"px-6 py-4 font-bold text-gray-500 text-xs",children:new Date(x.tanggal).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(Pe,{status:x.status||"Selesai"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:`text-[9px] font-bold px-2 py-1 rounded border ${I?"bg-rose-50 text-rose-600 border-rose-100":"bg-emerald-50 text-emerald-600 border-emerald-100"}`,children:I?"Keluar":"Masuk"})}),e.jsxs("td",{className:`px-6 py-4 text-right font-black font-sans text-sm tracking-tight ${I?"text-rose-600":"text-emerald-600"}`,children:[I?"-":"+"," ",ie(x.pembayaran.nominal).replace("Rp","")]})]},l)})})]})}),o==="Monitoring"&&e.jsx("div",{className:"animate-fade-in-up mt-6",children:e.jsxs("div",{className:"bg-white rounded-[2rem] shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex flex-col md:flex-row justify-between items-center gap-4 bg-gray-50/30 sticky top-0 z-10",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:"Monitoring Iuran Makan"}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("input",{type:"text",placeholder:"Cari Nama Santri...",value:L,onChange:x=>P(x.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-gray-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-emerald-500 outline-none transition shadow-sm"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),e.jsx(Re,{headers:["Nama Santri","Kelas","Wajib Bayar","Terbayar","Sisa","Status"],children:b.filter(x=>x.nama.toLowerCase().includes(L.toLowerCase())).map(x=>e.jsxs("tr",{className:"hover:bg-amber-50/30 transition group cursor-default border-b border-gray-50 last:border-0",children:[e.jsx("td",{className:"px-6 py-4 font-bold text-gray-800",children:x.nama}),e.jsx("td",{className:"px-6 py-4 text-gray-500 text-xs",children:x.kelas}),e.jsx("td",{className:"px-6 py-4 text-right font-medium text-gray-700 font-mono text-sm",children:ie(x.wajib_bayar).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-right font-bold text-emerald-600 font-mono text-sm",children:ie(x.terbayar).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-right font-bold text-rose-600 font-mono text-sm",children:ie(x.sisa_bayar).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(Pe,{status:x.status})})]},x.id_santri))})]})})]})},Ln=[{title:"Dana PHBI & Kegiatan",description:"Kelola keuangan untuk Peringatan Hari Besar Islam (Maulid, Rajaban) dan kegiatan ekstrakurikuler santri."},{targetId:"keu-phbi-monitor",title:"Iuran Kegiatan",description:"Pantau pengumpulan iuran santri untuk event tertentu.",position:"bottom"},{targetId:"keu-phbi-trx",title:"Belanja Panitia",description:"Catat pengeluaran panitia untuk konsumsi, dekorasi, dan logistik acara.",position:"top"}],Cn=()=>{const{fetchData:a,cache:r,updateCache:t}=ge(),[o,c]=s.useState("Ringkasan"),k=r.keuanganBiaya&&r.keuanganTransaksi&&r.databaseSantri,[f,D]=s.useState(!k),[B,p]=s.useState(r.keuanganBiaya||[]),[m,u]=s.useState(r.keuanganTransaksi||[]),[i,g]=s.useState(r.databaseSantri||[]),[K,h]=s.useState(!1),[M,w]=s.useState(null),[d,C]=s.useState({jenis:"masuk",kategori:"",id_santri:"",nama_santri:"",nama_pihak_luar:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",id_biaya:"",status:"Selesai"}),[L,P]=s.useState(""),[y,z]=s.useState("");s.useEffect(()=>{(async()=>{k||D(!0);try{const[I,_,n]=await Promise.all([a("keuanganBiaya",G.getKeuanganBiaya,"PHBI",!1,!1),a("keuanganTransaksi",G.getKeuanganTransaksi,"PHBI",!1,!1),a("databaseSantri",G.getDatabaseSantri,"PHBI",!1,!1)]);p(Array.isArray(I)?I:[]),u(Array.isArray(_)?_:[]),g(Array.isArray(n)?n:n?[n]:[])}catch(I){console.error("Gagal memuat data PHBI:",I)}finally{D(!1)}})()},[a,k]);const j=s.useMemo(()=>Array.isArray(B)?B.filter(l=>l.pos==="PHBI"):[],[B]),N=s.useMemo(()=>Array.isArray(m)?m.filter(l=>{var I;return((I=l.peruntukan)==null?void 0:I.pos)==="PHBI"}):[],[m]),A=s.useMemo(()=>[...j.map(I=>({value:I.id_biaya,label:I.kategori})),{value:"LAINNYA",label:"Lainnya"}],[j]),S=s.useMemo(()=>{const l=V=>V.peruntukan.kategori.toLowerCase().includes("belanja")||V.peruntukan.kategori.toLowerCase().includes("konsumsi"),I=N.reduce((V,J)=>l(J)?V-J.pembayaran.nominal:V+J.pembayaran.nominal,0),_=y?N.filter(V=>V.tanggal.startsWith(y)):N,n=_.filter(V=>!l(V)).reduce((V,J)=>V+J.pembayaran.nominal,0),v=_.filter(V=>l(V)).reduce((V,J)=>V+J.pembayaran.nominal,0),R={};_.filter(V=>l(V)).forEach(V=>{R[V.tanggal.split("T")[0]]=(R[V.tanggal.split("T")[0]]||0)+V.pembayaran.nominal});const W=Object.entries(R).map(([V,J])=>({date:V,value:J})).sort((V,J)=>new Date(V.date).getTime()-new Date(J.date).getTime()),q=[..._].sort((V,J)=>new Date(J.tanggal).getTime()-new Date(V.tanggal).getTime());return{saldoGlobal:I,pemasukanPeriode:n,pengeluaranPeriode:v,dailyChartData:W,filteredTransactions:q}},[N,y]),b=s.useMemo(()=>{if(!Array.isArray(i)||!i.length)return[];const l=y||new Date().toISOString().slice(0,7),I=j.find(n=>n.kategori.toLowerCase().includes("iuran")||n.kategori.toLowerCase().includes("phbi")),_=I?I.nominal:0;return i.map(n=>{var q,V,J,U;const v=((q=n.verifikasi_santri)==null?void 0:q.id_santri)||"-",R=N.filter(re=>{var Z;return((Z=re.pihak)==null?void 0:Z.id)===v&&!re.peruntukan.kategori.toLowerCase().includes("belanja")&&re.tanggal.startsWith(l)}).reduce((re,Z)=>{var ae;return re+(((ae=Z.pembayaran)==null?void 0:ae.nominal)||0)},0);let W="Belum Lunas";return _>0?R>=_?W="Lunas":R>0&&(W="Sebagian"):R>0&&(W="Lunas"),{id_santri:v,nama:((V=n.data_santri)==null?void 0:V.nama_lengkap)||"Tanpa Nama",kelas:`${((J=n.data_akademik)==null?void 0:J.kelas)||""} ${((U=n.data_akademik)==null?void 0:U.jenjang)||""}`,wajib_bayar:_,terbayar:R,sisa_bayar:Math.max(0,_-R),status:W}}).sort((n,v)=>n.nama.localeCompare(v.nama))},[i,j,N,y]),T=s.useMemo(()=>{const l=b.length,I=b.filter(R=>R.status==="Lunas").length,_=b.reduce((R,W)=>R+W.wajib_bayar,0),n=b.reduce((R,W)=>R+W.terbayar,0),v=l>0?I/l*100:0;return{totalSantri:l,lunas:I,totalTarget:_,totalTerkumpul:n,persentaseLunas:v}},[b]),$=l=>{const I=l.peruntukan.kategori.toLowerCase().includes("belanja")||l.peruntukan.kategori.toLowerCase().includes("konsumsi");C({jenis:I?"keluar":"masuk",kategori:l.peruntukan.kategori,id_santri:l.pihak.id||"",nama_santri:l.pihak.nama,nama_pihak_luar:l.pihak.id?"":l.pihak.nama,tanggal:new Date(l.tanggal).toISOString().split("T")[0],nominal:l.pembayaran.nominal,keterangan:l.pembayaran.catatan,metode:l.pembayaran.metode,id_biaya:l.peruntukan.id_ref||"",status:l.status||"Selesai"}),w(l.id_transaksi),h(!0),window.scrollTo(0,0)},E=async()=>{if(!d.nominal){alert("Nominal wajib diisi.");return}const l=d.jenis==="keluar",_={id_transaksi:M||`TRX-PHBI-${Date.now().toString().slice(-6)}`,tanggal:new Date(d.tanggal).toISOString(),status:d.status,jenis:d.jenis,pihak:{id:d.id_santri||null,nama:d.id_santri?d.nama_santri:d.nama_pihak_luar},peruntukan:{pos:"PHBI",kategori:d.kategori||(l?"Belanja Kegiatan":"Iuran Kegiatan"),id_ref:d.id_biaya||"BY-MANUAL"},pembayaran:{metode:d.metode,sistem:d.metode==="Tunai"?"":"Bank",penyedia:"",no_rek:"",penerima:"Panitia",nominal:Number(d.nominal),catatan:d.keterangan||"-"}};let n=M?m.map(v=>v.id_transaksi===M?_:v):[_,...m];await G.updateKeuanganTransaksi(n),u(n),t("keuanganTransaksi",n),h(!1),w(null),C({jenis:"masuk",kategori:"",id_santri:"",nama_santri:"",nama_pihak_luar:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",id_biaya:"",status:"Selesai"})},F=s.useMemo(()=>Array.isArray(i)?i.map(l=>{var I,_,n;return{value:(I=l.verifikasi_santri)==null?void 0:I.id_santri,label:`${(_=l.data_santri)==null?void 0:_.nama_lengkap} (${(n=l.verifikasi_santri)==null?void 0:n.id_santri})`}}):[],[i]),x=async()=>{if(M&&window.confirm("Apakah Anda yakin ingin menghapus transaksi ini?")){D(!0);try{const l=m.filter(I=>I.id_transaksi!==M);await G.updateKeuanganTransaksi(l),u(l),t("keuanganTransaksi",l),h(!1),w(null)}catch(l){console.error("Gagal menghapus:",l)}finally{D(!1)}}};return f?e.jsx(fe,{message:"Menyiapkan data PHBI...",fullScreen:!1}):e.jsxs("div",{className:"space-y-6 animate-fade-in font-sans pb-24 relative min-h-[600px]",children:[e.jsx(ve,{tourId:"keu_phbi",steps:Ln}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-white p-2 rounded-2xl shadow-sm border border-gray-200 mb-6 sticky top-0 z-20 backdrop-blur-md bg-white/90",children:[e.jsx(ua,{tabs:["Ringkasan","Transaksi","Monitoring"],activeTab:o,onChange:l=>c(l)}),!K&&o==="Transaksi"&&e.jsx(Le,{label:"Input Transaksi",onClick:()=>{h(!0),w(null),C({jenis:"masuk",kategori:"",id_santri:"",nama_santri:"",nama_pihak_luar:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",id_biaya:"",status:"Selesai"})},icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),className:"md:w-auto w-full"})]}),o==="Ringkasan"&&e.jsxs("div",{className:"space-y-8 animate-fade-in-up",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(we,{title:"Saldo Kegiatan",value:S.saldoGlobal,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})}),color:"purple",description:"Sisa anggaran kegiatan."}),e.jsx(we,{title:"Pemasukan Iuran",value:S.pemasukanPeriode,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 11l5-5m0 0l5 5m-5-5v12"})}),color:"emerald"}),e.jsx(we,{title:"Pengeluaran",value:S.pengeluaranPeriode,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 13l-5 5m0 0l-5-5m5 5V6"})}),color:"rose"}),e.jsx(we,{title:"Target Dana",value:T.totalTarget,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),color:"amber",description:"Estimasi total iuran."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm",children:[e.jsx("h3",{className:"font-serif font-bold text-gray-900 text-xl mb-6",children:"Realisasi Anggaran (Harian)"}),e.jsx(Ze,{data:S.dailyChartData,color:"#8b5cf6"})]}),e.jsxs("div",{className:"bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm flex flex-col items-center justify-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-purple-400 to-pink-500"}),e.jsx("h3",{className:"font-serif font-bold text-gray-900 text-lg mb-8 w-full text-center",children:"Capaian Target"}),e.jsx(va,{data:[{label:"Tercapai",value:S.pemasukanPeriode,color:"#10b981"},{label:"Sisa Target",value:Math.max(0,T.totalTarget-S.pemasukanPeriode),color:"#e5e7eb"}]}),e.jsxs("div",{className:"w-full mt-8 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center text-xs p-2 rounded-lg bg-gray-50",children:[e.jsx("span",{className:"font-bold text-gray-500",children:"Progress"}),e.jsxs("span",{className:"font-black text-emerald-600",children:[T.totalTarget>0?(S.pemasukanPeriode/T.totalTarget*100).toFixed(1):0,"%"]})]}),e.jsxs("div",{className:"text-center text-[10px] text-gray-400 mt-2",children:["Dari total target ",ie(T.totalTarget)]})]})]})]})]}),o==="Transaksi"&&e.jsx("div",{id:"keu-phbi-trx",className:"space-y-6 animate-fade-in-up",children:K?e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl border border-gray-100 p-8 animate-fade-in-up font-sans relative z-30 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-100 pb-4",children:[e.jsx("h3",{className:"font-serif font-bold text-2xl text-gray-900 tracking-tight",children:M?"Edit Transaksi":"Input Keuangan PHBI"}),e.jsx(Le,{label:"Batal",variant:"secondary",onClick:()=>{h(!1),w(null)}})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 ml-1",children:"Jenis"}),e.jsxs("div",{className:"flex bg-gray-50 p-1 rounded-xl",children:[e.jsx("button",{onClick:()=>C({...d,jenis:"masuk"}),className:`flex-1 py-3 rounded-lg text-sm font-bold transition ${d.jenis==="masuk"?"bg-emerald-600 text-white shadow":"text-gray-500"}`,children:"Pemasukan"}),e.jsx("button",{onClick:()=>C({...d,jenis:"keluar"}),className:`flex-1 py-3 rounded-lg text-sm font-bold transition ${d.jenis==="keluar"?"bg-rose-600 text-white shadow":"text-gray-500"}`,children:"Pengeluaran"})]})]}),e.jsx(ze,{id:"tgl-trx",label:"Tanggal",value:d.tanggal||"",onChange:l=>C({...d,tanggal:l}),className:"!mb-0"})]}),d.jenis==="masuk"?e.jsx(de,{id:"cari-santri",label:"Cari Santri",value:d.id_santri,onChange:l=>{var _;const I=i.find(n=>n.verifikasi_santri.id_santri===l);C({...d,id_santri:l,nama_santri:((_=I==null?void 0:I.data_santri)==null?void 0:_.nama_lengkap)||""})},options:F,className:"!mb-0"}):e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:d.nama_pihak_luar,onChange:l=>C({...d,nama_pihak_luar:l.target.value})}),e.jsx("label",{className:"floating-label",children:"Supplier / Vendor"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(de,{id:"kategori-biaya",label:"Kategori / Pos",value:d.id_biaya,options:A,onChange:l=>{const I=j.find(_=>_.id_biaya===l);C({...d,id_biaya:l,kategori:(I==null?void 0:I.kategori)||(l==="LAINNYA"?"Lainnya":""),nominal:(I==null?void 0:I.nominal)||0})},className:"!mb-0"}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:d.keterangan,onChange:l=>C({...d,keterangan:l.target.value})}),e.jsx("label",{className:"floating-label",children:"Keterangan"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"number",className:"floating-input peer font-bold text-emerald-800 text-lg",placeholder:" ",value:d.nominal||"",onChange:l=>C({...d,nominal:Number(l.target.value)})}),e.jsx("label",{className:"floating-label",children:"Nominal (Rp)"})]}),e.jsx(de,{id:"metode-bayar",label:"Metode",value:d.metode,onChange:l=>C({...d,metode:l}),options:[{value:"Tunai",label:"Tunai"},{value:"Transfer",label:"Transfer"}],className:"!mb-0"})]}),e.jsxs("div",{className:"pt-6 flex gap-4 border-t border-gray-100 mt-4",children:[M&&e.jsx(Le,{label:"Hapus",variant:"danger",onClick:x,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx(Le,{label:M?"Simpan Perubahan":"Simpan Transaksi",onClick:E,className:"flex-1 py-4 text-base"})]})]})]}):e.jsx(Re,{headers:["Keterangan","Tanggal","Status","Jenis","Nominal"],isEmpty:S.filteredTransactions.length===0,children:S.filteredTransactions.map((l,I)=>{const _=l.jenis==="keluar";return e.jsxs("tr",{className:"hover:bg-purple-50/50 transition cursor-pointer group",onClick:()=>$(l),children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center mr-2 ${_?"bg-rose-100 text-rose-600":"bg-purple-100 text-purple-600"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:_?"M20 12H4":"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-gray-800 group-hover:text-purple-700 transition",children:l.peruntukan.kategori}),e.jsxs("div",{className:"text-[10px] text-gray-500 mt-0.5",children:[l.pembayaran.catatan," (",l.pihak.nama,")"]})]})]})}),e.jsx("td",{className:"px-6 py-4 font-bold text-gray-500 text-xs",children:new Date(l.tanggal).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(Pe,{status:l.status||"Selesai"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:`text-[9px] font-bold px-2 py-1 rounded border ${_?"bg-rose-50 text-rose-600 border-rose-100":"bg-emerald-50 text-emerald-600 border-emerald-100"}`,children:_?"Keluar":"Masuk"})}),e.jsxs("td",{className:`px-6 py-4 text-right font-black font-sans tabular-nums text-sm tracking-tight ${_?"text-rose-600":"text-emerald-600"}`,children:[_?"-":"+"," ",ie(l.pembayaran.nominal).replace("Rp","")]})]},I)})})}),o==="Monitoring"&&e.jsx("div",{id:"keu-phbi-monitor",className:"animate-fade-in-up mt-6",children:e.jsxs("div",{className:"bg-white rounded-[2rem] shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex flex-col md:flex-row justify-between items-center gap-4 bg-gray-50/30 sticky top-0 z-10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:"Monitoring Iuran PHBI"}),e.jsxs("div",{className:"bg-white rounded-xl px-3 py-2 flex items-center gap-2 border border-gray-200 shadow-sm",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:"Periode:"}),e.jsx("input",{type:"month",value:y,onChange:l=>z(l.target.value),className:"bg-transparent text-xs font-bold text-gray-700 outline-none cursor-pointer hover:text-blue-600"}),y&&e.jsx("button",{onClick:()=>z(""),className:"text-[10px] text-red-400 font-bold px-1",children:"✕"})]})]}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("input",{type:"text",placeholder:"Cari Nama Santri...",value:L,onChange:l=>P(l.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-gray-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-emerald-500 outline-none transition shadow-sm"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),e.jsx(Re,{headers:["Nama Santri","Kelas","Wajib Iuran","Terbayar","Sisa","Status"],children:b.filter(l=>l.nama.toLowerCase().includes(L.toLowerCase())).map(l=>e.jsxs("tr",{className:"hover:bg-amber-50/30 transition group cursor-default border-b border-gray-50 last:border-0",children:[e.jsx("td",{className:"px-6 py-4 font-bold text-gray-800",children:l.nama}),e.jsx("td",{className:"px-6 py-4 text-gray-500 text-xs",children:l.kelas}),e.jsx("td",{className:"px-6 py-4 text-right font-medium text-gray-700 font-mono text-sm",children:ie(l.wajib_bayar).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-right font-bold text-emerald-600 font-mono text-sm",children:ie(l.terbayar).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-right font-bold text-rose-600 font-mono text-sm",children:ie(l.sisa_bayar).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(Pe,{status:l.status})})]},l.id_santri))})]})})]})},Mn=()=>{const{fetchData:a,cache:r,updateCache:t}=ge(),[o,c]=s.useState("Ringkasan"),k=r.keuanganTransaksi&&r.databaseSantri,[f,D]=s.useState(!k),[B,p]=s.useState(r.keuanganTransaksi||[]),[m,u]=s.useState(r.databaseSantri||[]),[i,g]=s.useState(!1),[K,h]=s.useState(null),[M,w]=s.useState({jenis:"masuk",id_santri:"",nama_santri:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",kategori:"Jajan",status:"Selesai"}),[d,C]=s.useState(""),[L,P]=s.useState("");s.useEffect(()=>{(async()=>{k||D(!0);try{const[$,E]=await Promise.all([a("keuanganTransaksi",G.getKeuanganTransaksi,"Jajan",!1,!1),a("databaseSantri",G.getDatabaseSantri,"Jajan",!1,!1)]);p(Array.isArray($)?$:[]),u(Array.isArray(E)?E:E?[E]:[])}catch($){console.error("Gagal memuat data jajan:",$)}finally{D(!1)}})()},[a,k]);const y=s.useMemo(()=>B.filter(T=>{var $;return(($=T.peruntukan)==null?void 0:$.pos)==="Jajan"}).map(T=>{var F,x,l,I,_,n;const E=T.peruntukan.kategori==="Tabungan"||T.peruntukan.kategori==="Deposit"?"masuk":"keluar";return{id:T.id_transaksi,tanggal:T.tanggal,jenis:E,id_santri:((F=T.pihak)==null?void 0:F.id)||"-",nama_santri:((x=T.pihak)==null?void 0:x.nama)||"Unknown",nominal:((l=T.pembayaran)==null?void 0:l.nominal)||0,keterangan:((I=T.pembayaran)==null?void 0:I.catatan)||"",metode:(_=T.pembayaran)==null?void 0:_.metode,kategori:(n=T.peruntukan)==null?void 0:n.kategori,status:T.status||"Selesai"}}).sort((T,$)=>new Date($.tanggal).getTime()-new Date(T.tanggal).getTime()),[B]),z=s.useMemo(()=>{const T=new Map;return m.forEach($=>{var F,x,l,I;const E=(F=$.verifikasi_santri)==null?void 0:F.id_santri;E&&T.set(E,{id_santri:E,nama:((x=$.data_santri)==null?void 0:x.nama_lengkap)||"Tanpa Nama",kelas:`${((l=$.data_akademik)==null?void 0:l.kelas)||""} ${((I=$.data_akademik)==null?void 0:I.jenjang)||""}`,total_masuk:0,total_keluar:0,saldo:0,last_activity:"-"})}),y.forEach($=>{if($.status==="Selesai"||$.status==="Lunas"){const E=T.get($.id_santri);E&&($.jenis==="masuk"?(E.total_masuk+=$.nominal,E.saldo+=$.nominal):(E.total_keluar+=$.nominal,E.saldo-=$.nominal),(E.last_activity==="-"||new Date($.tanggal)>new Date(E.last_activity))&&(E.last_activity=$.tanggal))}}),Array.from(T.values()).sort(($,E)=>E.saldo!==$.saldo?E.saldo-$.saldo:$.nama.localeCompare(E.nama))},[m,y]),j=s.useMemo(()=>{const T=z.reduce((_,n)=>_+n.saldo,0),$=L?y.filter(_=>_.tanggal.startsWith(L)):y,E=$.filter(_=>_.jenis==="masuk").reduce((_,n)=>_+n.nominal,0),F=$.filter(_=>_.jenis==="keluar").reduce((_,n)=>_+n.nominal,0),x={};$.filter(_=>_.jenis==="keluar").forEach(_=>{x[_.tanggal.split("T")[0]]=(x[_.tanggal.split("T")[0]]||0)+_.nominal});const l=Object.entries(x).map(([_,n])=>({date:_,value:n})).sort((_,n)=>new Date(_.date).getTime()-new Date(n.date).getTime()),I=z.filter(_=>_.saldo>0).length;return{totalSaldo:T,totalSetoran:E,totalJajan:F,dailyChartData:l,filteredTrx:$,santriAktifMenabung:I}},[z,y,L]),N=T=>{w({jenis:T.jenis,id_santri:T.id_santri,nama_santri:T.nama_santri,tanggal:new Date(T.tanggal).toISOString().split("T")[0],nominal:T.nominal,keterangan:T.keterangan,metode:T.metode||"Tunai",kategori:T.kategori||"Jajan",status:T.status||"Selesai"}),h(T.id),g(!0),window.scrollTo(0,0)},A=async()=>{var F;if(!M.nominal){alert("Nominal dan Santri wajib diisi.");return}if(M.jenis==="keluar"&&!K&&(((F=z.find(l=>l.id_santri===M.id_santri))==null?void 0:F.saldo)||0)<Number(M.nominal)&&!window.confirm("Saldo santri tidak mencukupi. Lanjutkan transaksi (saldo akan minus)?"))return;const $={id_transaksi:K||`TRX-JJN-${Date.now().toString().slice(-6)}`,tanggal:new Date(M.tanggal).toISOString(),status:M.status,pihak:{id:M.id_santri,nama:M.nama_santri},peruntukan:{pos:"Jajan",kategori:M.jenis==="masuk"?"Tabungan":M.kategori||"Jajan",id_ref:M.jenis==="masuk"?"BY-JJN-DEP":"BY-JJN-EXP"},pembayaran:{metode:M.metode,sistem:"Internal",penyedia:"",no_rek:"",penerima:"Koperasi",nominal:Number(M.nominal),catatan:M.keterangan||(M.jenis==="masuk"?"Deposit":"Jajan")}};let E=K?B.map(x=>x.id_transaksi===K?$:x):[$,...B];await G.updateKeuanganTransaksi(E),p(E),t("keuanganTransaksi",E),g(!1),h(null),w({jenis:"masuk",id_santri:"",nama_santri:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",kategori:"Jajan",status:"Selesai"})},S=async()=>{if(K&&window.confirm("Apakah Anda yakin ingin menghapus transaksi ini?")){D(!0);try{const T=B.filter($=>$.id_transaksi!==K);await G.updateKeuanganTransaksi(T),p(T),t("keuanganTransaksi",T),g(!1),h(null)}catch(T){console.error("Gagal menghapus:",T)}finally{D(!1)}}},b=s.useMemo(()=>Array.isArray(m)?m.map(T=>{var $,E,F;return{value:($=T.verifikasi_santri)==null?void 0:$.id_santri,label:`${(E=T.data_santri)==null?void 0:E.nama_lengkap} (${(F=T.verifikasi_santri)==null?void 0:F.id_santri})`}}):[],[m]);return f?e.jsx(fe,{message:"Menyiapkan Tabungan Santri...",fullScreen:!1}):e.jsxs("div",{className:"space-y-8 animate-fade-in font-sans pb-24 relative min-h-[600px]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-white p-2 rounded-2xl shadow-sm border border-gray-200 mb-6 sticky top-0 z-20 backdrop-blur-md bg-white/90",children:[e.jsx(ua,{tabs:["Ringkasan","Transaksi","Monitoring"],activeTab:o,onChange:T=>c(T)}),!i&&o==="Transaksi"&&e.jsx(Le,{label:"Transaksi Baru",onClick:()=>{g(!0),h(null),w({jenis:"masuk",id_santri:"",nama_santri:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",kategori:"Jajan",status:"Selesai"})},icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),className:"md:w-auto w-full"})]}),o==="Ringkasan"&&e.jsxs("div",{className:"space-y-8 animate-fade-in-up",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(we,{title:"Total Dana Tabungan",value:j.totalSaldo,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"emerald",description:"Akumulasi saldo seluruh santri yang tersimpan."}),e.jsx(we,{title:"Total Deposit",value:j.totalSetoran,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),color:"blue"}),e.jsx(we,{title:"Total Penarikan",value:j.totalJajan,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})}),color:"rose"}),e.jsx(we,{title:"Santri Menabung",value:j.santriAktifMenabung,prefix:"",icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),color:"amber",description:"Memiliki saldo > 0"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-8 rounded-[2.5rem] border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"font-serif font-bold text-gray-900 text-xl mb-6",children:"Tren Penarikan / Jajan (Harian)"}),e.jsx(Ze,{data:j.dailyChartData,color:"#10b981"})]}),e.jsxs("div",{className:"bg-emerald-900 rounded-[2.5rem] p-8 text-white shadow-xl relative overflow-hidden flex flex-col",children:[e.jsx("div",{className:"absolute top-0 right-0 w-48 h-48 bg-emerald-800 rounded-full blur-3xl -mr-16 -mt-16 pointer-events-none"}),e.jsx("h3",{className:"font-serif font-bold text-xl mb-6 relative z-10",children:"Top Saldo Santri"}),e.jsx("div",{className:"space-y-4 relative z-10 overflow-y-auto custom-scrollbar flex-1 pr-2",children:z.slice(0,5).map((T,$)=>e.jsxs("div",{className:"flex justify-between items-center text-sm border-b border-emerald-800 pb-3 last:border-0 hover:bg-emerald-800/30 p-2 rounded-lg transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold ${$===0?"bg-yellow-400 text-emerald-900":$===1?"bg-gray-300 text-emerald-900":$===2?"bg-orange-400 text-emerald-900":"bg-emerald-800 text-emerald-200"}`,children:$+1}),e.jsx("span",{className:"font-medium truncate max-w-[120px]",children:T.nama})]}),e.jsx("span",{className:"font-mono text-emerald-300 font-bold",children:ie(T.saldo)})]},$))})]})]})]}),o==="Transaksi"&&e.jsx("div",{className:"space-y-6 animate-fade-in-up",children:i?e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl border border-gray-100 p-8 animate-fade-in-up font-sans relative z-30 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-100 pb-4",children:[e.jsx("h3",{className:"font-serif font-bold text-2xl text-gray-900 tracking-tight",children:K?"Edit Transaksi":"Input Tabungan"}),e.jsx(Le,{label:"Batal",variant:"secondary",onClick:()=>{g(!1),h(null)}})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 ml-1",children:"Jenis"}),e.jsxs("div",{className:"flex bg-gray-50 p-1 rounded-xl",children:[e.jsx("button",{onClick:()=>w({...M,jenis:"masuk"}),className:`flex-1 py-3 rounded-lg text-sm font-bold transition ${M.jenis==="masuk"?"bg-emerald-600 text-white shadow":"text-gray-500"}`,children:"Setor (Deposit)"}),e.jsx("button",{onClick:()=>w({...M,jenis:"keluar"}),className:`flex-1 py-3 rounded-lg text-sm font-bold transition ${M.jenis==="keluar"?"bg-rose-600 text-white shadow":"text-gray-500"}`,children:"Tarik (Jajan)"})]})]}),e.jsx(ze,{id:"tgl-trx",label:"Tanggal",value:M.tanggal||"",onChange:T=>w({...M,tanggal:T}),className:"!mb-0"})]}),e.jsx(de,{id:"cari-santri",label:"Cari Santri",value:M.id_santri,onChange:T=>{var E;const $=m.find(F=>F.verifikasi_santri.id_santri===T);w({...M,id_santri:T,nama_santri:((E=$==null?void 0:$.data_santri)==null?void 0:E.nama_lengkap)||""})},options:b,className:"!mb-0"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"number",className:"floating-input peer font-bold text-emerald-800 text-lg",placeholder:" ",value:M.nominal||"",onChange:T=>w({...M,nominal:Number(T.target.value)})}),e.jsx("label",{className:"floating-label",children:"Nominal (Rp)"})]}),M.jenis==="masuk"?e.jsx(de,{id:"metode-bayar",label:"Metode",value:M.metode,onChange:T=>w({...M,metode:T}),options:[{value:"Tunai",label:"Tunai"},{value:"Transfer",label:"Transfer"}],className:"!mb-0"}):e.jsx(de,{id:"kategori-keluar",label:"Keperluan",value:M.kategori,onChange:T=>w({...M,kategori:T}),options:[{value:"Jajan",label:"Jajan Kantin"},{value:"Barang",label:"Beli Barang"},{value:"Tunai",label:"Tarik Tunai"}],className:"!mb-0"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:M.keterangan,onChange:T=>w({...M,keterangan:T.target.value})}),e.jsx("label",{className:"floating-label",children:"Catatan Tambahan"})]}),e.jsxs("div",{className:"pt-6 flex gap-4 border-t border-gray-100 mt-4",children:[K&&e.jsx(Le,{label:"Hapus",variant:"danger",onClick:S,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx(Le,{label:K?"Simpan Perubahan":"Proses Transaksi",onClick:A,className:"flex-1 py-4 text-base"})]})]})]}):e.jsx(Re,{headers:["Keterangan","Tanggal","Status","Jenis","Nominal"],isEmpty:j.filteredTrx.length===0,children:j.filteredTrx.map((T,$)=>{const E=T.jenis==="masuk";return e.jsxs("tr",{className:"hover:bg-emerald-50/50 transition cursor-pointer group",onClick:()=>N(T),children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center mr-2 ${E?"bg-emerald-100 text-emerald-600":"bg-rose-100 text-rose-600"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:E?"M12 4v16m8-8H4":"M20 12H4"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-gray-800 group-hover:text-emerald-700 transition",children:T.kategori}),e.jsx("div",{className:"text-[10px] text-gray-500 mt-0.5",children:T.nama_santri})]})]})}),e.jsx("td",{className:"px-6 py-4 font-bold text-gray-500 text-xs",children:new Date(T.tanggal).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(Pe,{status:T.status||"Selesai"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:`text-[9px] font-bold px-2 py-1 rounded border ${E?"bg-emerald-50 text-emerald-600 border-emerald-100":"bg-rose-50 text-rose-600 border-rose-100"}`,children:E?"Setor":"Tarik"})}),e.jsxs("td",{className:`px-6 py-4 text-right font-black font-sans tabular-nums text-sm tracking-tight ${E?"text-emerald-600":"text-rose-600"}`,children:[E?"+":"-"," ",ie(T.nominal).replace("Rp","")]})]},$)})})}),o==="Monitoring"&&e.jsx("div",{className:"animate-fade-in-up mt-6",children:e.jsxs("div",{className:"bg-white rounded-[2rem] shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex flex-col md:flex-row justify-between items-center gap-4 bg-gray-50/30 sticky top-0 z-10",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:"Monitoring Saldo Santri"}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("input",{type:"text",placeholder:"Cari Nama Santri...",value:d,onChange:T=>C(T.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-gray-200 rounded-xl text-xs font-bold focus:ring-2 focus:ring-emerald-500 outline-none transition shadow-sm"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-xs whitespace-nowrap",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-500 font-bold uppercase tracking-wider border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"ID Santri"}),e.jsx("th",{className:"px-6 py-4",children:"Nama Santri"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Total Setor"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Total Jajan"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Sisa Saldo"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:z.filter(T=>T.nama.toLowerCase().includes(d.toLowerCase())).map(T=>e.jsxs("tr",{className:"hover:bg-gray-50 transition cursor-default",children:[e.jsx("td",{className:"px-6 py-4 font-sans text-gray-500 font-bold text-[10px]",children:T.id_santri}),e.jsx("td",{className:"px-6 py-4 font-bold text-gray-800",children:T.nama}),e.jsx("td",{className:"px-6 py-4 text-right font-medium text-blue-600 font-sans tabular-nums text-sm",children:ie(T.total_masuk).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-right font-medium text-rose-600 font-sans tabular-nums text-sm",children:ie(T.total_keluar).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-right font-bold text-emerald-700 font-sans tabular-nums text-sm",children:ie(T.saldo)}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-[10px] font-bold uppercase border ${T.saldo<1e4?"bg-rose-50 text-rose-700 border-rose-100":"bg-emerald-50 text-emerald-700 border-emerald-100"}`,children:T.saldo<1e4?"Low":"Aman"})})]},T.id_santri))})]})})]})})]})},An=()=>{const{fetchData:a,updateCache:r}=ge(),[t,o]=s.useState(!0),[c,k]=s.useState("biaya"),[f,D]=s.useState([]),[B,p]=s.useState(""),[m,u]=s.useState("Semua"),[i,g]=s.useState(!1),[K,h]=s.useState(null),[M,w]=s.useState({id_biaya:"",pos:"Operasional",kategori:"",periode:"Bulanan",nominal:0}),[d,C]=s.useState(null),[L,P]=s.useState(!1),[y,z]=s.useState("bank"),[j,N]=s.useState(null),[A,S]=s.useState({bank:"",rekening:"",pemilik:""}),[b,T]=s.useState({jenis:"",nomor:"",pemilik:""});s.useEffect(()=>{(async()=>{o(!0);try{const[R,W]=await Promise.all([a("keuanganBiaya",G.getKeuanganBiaya,"AturBiaya",!1,!1),a("rekening",G.getRekening,"AturBiaya",!1,!1)]);D(Array.isArray(R)?R:[]),C(Array.isArray(W)?W[0]:W)}catch(R){console.error(R)}finally{o(!1)}})()},[a]);const $=s.useMemo(()=>f.filter(v=>{var R;return(m==="Semua"||v.pos===m)&&((R=v.kategori)==null?void 0:R.toLowerCase().includes(B.toLowerCase()))}),[f,m,B]),E=s.useMemo(()=>({totalItems:f.length,totalPotentialMonthly:f.filter(v=>v.periode==="bulanan").reduce((v,R)=>v+R.nominal,0)}),[f]),F=async()=>{if(!M.kategori||!M.nominal)return alert("Lengkapi data kategori dan nominal.");let v=[...f];const R={...M,id_biaya:K||`BY-${Date.now()}`};K?v=v.map(W=>W.id_biaya===K?R:W):v.push(R),await G.updateKeuanganBiaya(v),r("keuanganBiaya",v),D(v),g(!1),h(null),w({id_biaya:"",pos:"Operasional",kategori:"",periode:"Bulanan",nominal:0})},x=async()=>{if(!K||!confirm("Hapus item biaya ini?"))return;const v=f.filter(R=>R.id_biaya!==K);await G.updateKeuanganBiaya(v),r("keuanganBiaya",v),D(v),g(!1),h(null)},l=async()=>{d&&(await G.updateRekening([d]),r("rekening",[d]),alert("Konfigurasi Rekening Disimpan."))},I=async()=>{if(!d)return;const v={...d};if(y==="bank"){if(!A.bank||!A.rekening)return alert("Lengkapi data bank.");const R=[...v.bank];j!==null?R[j]=A:R.push(A),v.bank=R}else{if(!b.jenis||!b.nomor)return alert("Lengkapi data e-wallet.");const R=[...v.ewallet];j!==null?R[j]=b:R.push(b),v.ewallet=R}C(v),await G.updateRekening([v]),r("rekening",[v]),P(!1),N(null)},_=async(v,R)=>{if(!d||!confirm("Hapus item ini?"))return;const W={...d};v==="bank"?W.bank=W.bank.filter((q,V)=>V!==R):W.ewallet=W.ewallet.filter((q,V)=>V!==R),C(W),await G.updateRekening([W]),r("rekening",[W])},n=(v,R)=>{z(v),N(R),v==="bank"?S(R!==null&&d?d.bank[R]:{bank:"",rekening:"",pemilik:""}):T(R!==null&&d?d.ewallet[R]:{jenis:"",nomor:"",pemilik:""}),P(!0)};return e.jsxs("div",{className:"space-y-6 animate-fade-in font-sans pb-24 relative min-h-[600px]",children:[t&&e.jsx(fe,{message:"Memuat Konfigurasi...",fullScreen:!1}),e.jsxs("div",{className:t?"opacity-30 pointer-events-none filter blur-sm transition-all duration-500":"opacity-100 filter-none transition-all duration-500",children:[e.jsx(Us,{title:"Atur Biaya & Rekening",subtitle:"Konfigurasi pos biaya dan rekening pembayaran.",action:!i&&!L&&e.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-xl",children:[e.jsx("button",{onClick:()=>k("biaya"),className:`px-4 py-2 rounded-lg text-xs font-bold transition-all font-sans ${c==="biaya"?"bg-white text-emerald-800 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Pos Biaya"}),e.jsx("button",{onClick:()=>k("rekening"),className:`px-4 py-2 rounded-lg text-xs font-bold transition-all font-sans ${c==="rekening"?"bg-white text-emerald-800 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Atur Rekening"})]})}),c==="biaya"&&(i?e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl border border-gray-200 p-8 animate-fade-in-up max-w-2xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-100 pb-4",children:[e.jsx("h3",{className:"font-bold text-2xl text-gray-900 font-sans",children:K?"Edit Biaya":"Tambah Biaya"}),e.jsx(Bt,{label:"Batal",onClick:()=>g(!1)})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(de,{id:"pos",label:"Pos Anggaran",value:M.pos,onChange:v=>w({...M,pos:v}),options:[{value:"Operasional",label:"Operasional"},{value:"Bangunan",label:"Bangunan"},{value:"Makan",label:"Makan"},{value:"PHBI",label:"PHBI"},{value:"Administrasi",label:"Administrasi"}],className:"!mb-0"}),e.jsx(de,{id:"periode",label:"Periode",value:M.periode,onChange:v=>w({...M,periode:v}),options:[{value:"bulanan",label:"Bulanan"},{value:"semesteran",label:"Semesteran"},{value:"tahunan",label:"Tahunan"},{value:"sekali",label:"Sekali / Insidentil"}],className:"!mb-0"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:M.kategori,onChange:v=>w({...M,kategori:v.target.value})}),e.jsx("label",{className:"floating-label",children:"Nama Biaya"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"number",className:"floating-input peer font-bold text-slate-800 text-lg bg-slate-50 font-sans",placeholder:" ",value:M.nominal||"",onChange:v=>w({...M,nominal:Number(v.target.value)})}),e.jsx("label",{className:"floating-label",children:"Nominal (Rp)"})]}),e.jsxs("div",{className:"pt-6 flex gap-4 border-t border-gray-100 mt-4",children:[K&&e.jsx("button",{onClick:x,className:"px-6 py-4 bg-red-50 text-red-600 font-bold rounded-2xl hover:bg-red-100 transition border border-red-100 font-sans",children:"Hapus"}),e.jsx(fa,{label:"Simpan Data",onClick:F,className:"flex-1 justify-center py-4 text-base font-sans"})]})]})]}):e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"bg-slate-800 rounded-2xl p-6 text-white shadow-lg flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-slate-300 text-xs font-bold uppercase tracking-wider mb-1 font-sans",children:"Total Item Biaya"}),e.jsx("span",{className:"text-2xl font-bold font-sans",children:E.totalItems})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("h4",{className:"text-slate-300 text-xs font-bold uppercase tracking-wider mb-1 font-sans",children:"Potensi Bulanan"}),e.jsx("span",{className:"text-2xl font-sans font-bold text-emerald-400 tabular-nums",children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(E.totalPotentialMonthly)})]})]}),e.jsxs("div",{className:"bg-white rounded-[2rem] shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 bg-white flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"w-full md:w-64",children:e.jsx(de,{id:"filter-pos",label:"Filter Pos Anggaran",value:m==="Semua"?"":m,onChange:v=>u(v||"Semua"),options:[{value:"Semua",label:"Semua Pos"},{value:"Operasional",label:"Operasional"},{value:"Bangunan",label:"Bangunan"},{value:"Makan",label:"Makan"},{value:"PHBI",label:"PHBI"},{value:"Administrasi",label:"Administrasi"}],className:"!mb-0"})}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto",children:[e.jsx(Pt,{value:B,onChange:p,placeholder:"Cari biaya..."}),e.jsx(It,{label:"Tambah",onClick:()=>{g(!0),h(null),w({id_biaya:"",pos:"Operasional",kategori:"",periode:"Bulanan",nominal:0})},icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z",clipRule:"evenodd"})})})]})]}),e.jsx("div",{className:"overflow-x-auto max-h-[500px] custom-scrollbar",children:e.jsxs("table",{className:"w-full text-left text-xs font-sans",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-500 font-bold uppercase tracking-wider sticky top-0 z-10 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Kategori Biaya"}),e.jsx("th",{className:"px-6 py-4",children:"Pos Anggaran"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Periode"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Nominal"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Aksi"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-50",children:$.length>0?$.map(v=>e.jsxs("tr",{className:"hover:bg-slate-50 transition group",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-gray-900 text-sm",children:v.kategori}),e.jsx("div",{className:"text-[10px] text-gray-400 font-mono mt-0.5",children:v.id_biaya})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"bg-white border border-gray-200 text-gray-600 px-2.5 py-1 rounded-lg text-[10px] font-bold uppercase tracking-wider shadow-sm",children:v.pos})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-[10px] font-bold uppercase border ${v.periode==="bulanan"?"bg-blue-50 text-blue-600 border-blue-100":"bg-purple-50 text-purple-600 border-purple-100"}`,children:v.periode})}),e.jsx("td",{className:"px-6 py-4 text-right font-sans font-bold text-emerald-700 text-sm tabular-nums",children:new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(v.nominal)}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("button",{onClick:()=>{w(v),h(v.id_biaya),g(!0)},className:"text-slate-400 hover:text-emerald-600 p-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})})]},v.id_biaya)):e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-12 text-gray-400 italic",children:"Tidak ada data biaya ditemukan."})})})]})})]})]})),c==="rekening"&&d&&(L?e.jsxs("div",{className:"bg-white rounded-[2rem] shadow-xl border border-gray-200 p-8 animate-fade-in-up max-w-md mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6 border-b border-gray-100 pb-4",children:[e.jsxs("h3",{className:"font-bold text-xl text-gray-900 font-sans",children:[j!==null?"Edit":"Tambah"," ",y==="bank"?"Bank":"E-Wallet"]}),e.jsx("button",{onClick:()=>P(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:y==="bank"?A.bank:b.jenis,onChange:v=>y==="bank"?S({...A,bank:v.target.value}):T({...b,jenis:v.target.value})}),e.jsx("label",{className:"floating-label font-sans",children:y==="bank"?"Nama Bank":"Jenis E-Wallet"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:y==="bank"?A.rekening:b.nomor,onChange:v=>y==="bank"?S({...A,rekening:v.target.value}):T({...b,nomor:v.target.value})}),e.jsx("label",{className:"floating-label font-sans",children:y==="bank"?"No. Rekening":"No. HP / ID"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:y==="bank"?A.pemilik:b.pemilik,onChange:v=>y==="bank"?S({...A,pemilik:v.target.value}):T({...b,pemilik:v.target.value})}),e.jsx("label",{className:"floating-label font-sans",children:"Atas Nama"})]}),e.jsx(fa,{label:"Simpan",onClick:I,className:"w-full justify-center py-3.5 font-sans"})]})]}):e.jsxs("div",{className:"space-y-8 animate-fade-in-up",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold text-gray-800 text-lg flex items-center gap-2 font-sans",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-blue-100 flex items-center justify-center text-blue-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h-5 10v-5a1 1 0 011-1h2a1 1 0 01 1v5m-4 0h4"})})}),"Rekening Bank"]}),e.jsx("button",{onClick:()=>n("bank",null),className:"text-xs font-bold text-blue-600 bg-blue-50 px-3 py-1.5 rounded-lg hover:bg-blue-100 font-sans",children:"+ Tambah"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:d.bank.map((v,R)=>e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex justify-between items-center group hover:border-blue-300 transition-all",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-800 font-sans",children:v.bank}),e.jsx("p",{className:"font-mono text-sm text-slate-600 tracking-wide my-0.5",children:v.rekening}),e.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold font-sans",children:v.pemilik})]}),e.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>n("bank",R),className:"p-1.5 bg-gray-50 rounded hover:bg-gray-200 text-slate-500",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>_("bank",R),className:"p-1.5 bg-red-50 rounded hover:bg-red-100 text-red-500",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},R))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold text-gray-800 text-lg flex items-center gap-2 font-sans",children:[e.jsx("span",{className:"w-8 h-8 rounded-lg bg-purple-100 flex items-center justify-center text-purple-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),"E-Wallet"]}),e.jsx("button",{onClick:()=>n("ewallet",null),className:"text-xs font-bold text-purple-600 bg-purple-50 px-3 py-1.5 rounded-lg hover:bg-purple-100 font-sans",children:"+ Tambah"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:d.ewallet.map((v,R)=>e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm flex justify-between items-center group hover:border-purple-300 transition-all",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-slate-800 font-sans",children:v.jenis}),e.jsx("p",{className:"font-mono text-sm text-slate-600 tracking-wide my-0.5",children:v.nomor}),e.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold font-sans",children:v.pemilik})]}),e.jsxs("div",{className:"flex gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>n("ewallet",R),className:"p-1.5 bg-gray-50 rounded hover:bg-gray-200 text-slate-500",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:()=>_("ewallet",R),className:"p-1.5 bg-red-50 rounded hover:bg-red-100 text-red-500",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},R))})]})]}),e.jsxs("div",{className:"bg-white rounded-[2rem] border border-gray-200 p-8 shadow-sm",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg mb-6 border-b border-gray-100 pb-2 font-sans",children:"Pengaturan QRIS & Kontak"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:d.QRIS.gambar,onChange:v=>C({...d,QRIS:{...d.QRIS,gambar:v.target.value}})}),e.jsx("label",{className:"floating-label font-sans",children:"URL Gambar QRIS"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:d.QRIS.pemilik,onChange:v=>C({...d,QRIS:{...d.QRIS,pemilik:v.target.value}})}),e.jsx("label",{className:"floating-label font-sans",children:"Nama Merchant QRIS"})]}),d.QRIS.gambar&&e.jsx("div",{className:"p-2 border border-dashed border-gray-300 rounded-xl w-32 h-32 flex items-center justify-center bg-gray-50 mx-auto md:mx-0",children:e.jsx("img",{src:d.QRIS.gambar,alt:"QRIS Preview",className:"max-w-full max-h-full object-contain"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase font-sans",children:"Kontak Konfirmasi (WhatsApp)"}),d.kontak.map((v,R)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:v,onChange:W=>{const q=[...d.kontak];q[R]=W.target.value,C({...d,kontak:q})},className:"flex-1 bg-gray-50 border border-gray-200 rounded-lg px-3 py-2 text-sm font-medium focus:ring-2 focus:ring-emerald-500 outline-none font-sans"}),R>0&&e.jsx("button",{onClick:()=>C({...d,kontak:d.kontak.filter((W,q)=>q!==R)}),className:"text-red-400 hover:text-red-600 px-2 font-sans",children:"X"})]},R)),e.jsx("button",{onClick:()=>C({...d,kontak:[...d.kontak,""]}),className:"text-xs font-bold text-emerald-600 hover:text-emerald-700 font-sans",children:"+ Tambah Nomor"})]})]}),e.jsx("div",{className:"mt-8 pt-4 border-t border-gray-100 flex justify-end",children:e.jsx(fa,{label:"Simpan QRIS & Kontak",onClick:l,icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})})]})]}))]})]})},Tn=()=>{const{fetchData:a,cache:r,updateCache:t}=ge(),[o,c]=s.useState("Ringkasan"),k=r.keuanganBiaya&&r.keuanganTransaksi&&r.databaseSantri,[f,D]=s.useState(!k),[B,p]=s.useState(r.keuanganBiaya||[]),[m,u]=s.useState(r.keuanganTransaksi||[]),[i,g]=s.useState(r.databaseSantri||[]),[K,h]=s.useState(!1),[M,w]=s.useState(null),d={jenis:"masuk",kategori:"",id_santri:"",nama_santri:"",nama_pihak_luar:"",tanggal:new Date().toISOString().split("T")[0],nominal:0,keterangan:"",metode:"Tunai",id_biaya:"",status:"Selesai"},[C,L]=s.useState(d),[P,y]=s.useState(""),[z,j]=s.useState("");s.useEffect(()=>{(async()=>{k||D(!0);try{const[v,R,W]=await Promise.all([a("keuanganBiaya",G.getKeuanganBiaya,"Administrasi",!1,!1),a("keuanganTransaksi",G.getKeuanganTransaksi,"Administrasi",!1,!1),a("databaseSantri",G.getDatabaseSantri,"Administrasi",!1,!1)]);p(Array.isArray(v)?v:[]),u(Array.isArray(R)?R:[]),g(Array.isArray(W)?W:W?[W]:[])}catch(v){console.error(v)}finally{D(!1)}})()},[a,k]);const N=s.useMemo(()=>Array.isArray(m)?m.filter(n=>{var v,R;return((v=n.peruntukan)==null?void 0:v.pos)==="Administrasi"||((R=n.peruntukan)==null?void 0:R.pos)==="ADMINISTRASI"}):[],[m]),A=s.useMemo(()=>Array.isArray(B)?B.filter(n=>n.pos==="Administrasi"):[],[B]),S=s.useMemo(()=>{var q,V,J;if(!Array.isArray(i)||!i.length)return[];const n=((q=A.find(U=>U.id_biaya==="BY-ADM-DAFTAR"||U.kategori.toLowerCase().includes("pendaftaran")))==null?void 0:q.nominal)||0,v=((V=A.find(U=>U.id_biaya==="BY-ADM-KTS"||U.kategori.toLowerCase().includes("kartu tanda")))==null?void 0:V.nominal)||0,R=((J=A.find(U=>U.id_biaya==="BY-ADM-KOP"||U.kategori.toLowerCase().includes("kopontren")))==null?void 0:J.nominal)||0,W=n+v+R;return i.map(U=>{var le,O,Q,ne;const re=((le=U.verifikasi_santri)==null?void 0:le.id_santri)||"-",Z=N.filter(he=>{var Ce;return((Ce=he.pihak)==null?void 0:Ce.id)===re&&he.jenis==="masuk"}),ae=(he,Ce,me)=>{const be=Z.filter(ke=>{var Se,Y;return((Se=ke.peruntukan)==null?void 0:Se.id_ref)===he||((Y=ke.peruntukan)==null?void 0:Y.kategori.toLowerCase().includes(Ce))}).reduce((ke,Se)=>ke+Se.pembayaran.nominal,0),Me=me>0&&be>=me;return{paid:be,target:me,isLunas:Me}},_e=ae("BY-ADM-DAFTAR","pendaftaran",n),oe=ae("BY-ADM-KTS","kartu tanda",v),xe=ae("BY-ADM-KOP","kopontren",R),H=_e.paid+oe.paid+xe.paid,ee=_e.isLunas&&oe.isLunas&&xe.isLunas;return{id_santri:re,nama:((O=U.data_santri)==null?void 0:O.nama_lengkap)||"Tanpa Nama",kelas:`${((Q=U.data_akademik)==null?void 0:Q.kelas)||""} ${((ne=U.data_akademik)==null?void 0:ne.jenjang)||""}`,pendaftaran:_e,kts:oe,kopontren:xe,wajib_bayar:W,terbayar:H,status:ee?"Lunas":"Belum"}}).sort((U,re)=>U.nama.localeCompare(re.nama))},[i,A,N]),b=s.useMemo(()=>{const n=S.length,v=S.filter(V=>V.status==="Lunas").length,R=S.reduce((V,J)=>V+J.wajib_bayar,0),W=S.reduce((V,J)=>V+J.terbayar,0),q=n>0?v/n*100:0;return{totalSantri:n,lunas:v,totalTarget:R,totalTerkumpul:W,persentaseLunas:q}},[S]),T=s.useMemo(()=>S.filter(n=>n.nama.toLowerCase().includes(P.toLowerCase())),[S,P]),$=s.useMemo(()=>{const n=N.reduce((oe,xe)=>xe.jenis==="keluar"?oe-xe.pembayaran.nominal:oe+xe.pembayaran.nominal,0),v=z?N.filter(oe=>oe.tanggal.startsWith(z)):N,R=v.filter(oe=>oe.jenis==="masuk").reduce((oe,xe)=>oe+xe.pembayaran.nominal,0),W=v.filter(oe=>oe.jenis==="keluar").reduce((oe,xe)=>oe+xe.pembayaran.nominal,0),q={};v.forEach(oe=>{const xe=oe.jenis==="keluar"?-oe.pembayaran.nominal:oe.pembayaran.nominal;q[oe.tanggal.split("T")[0]]=(q[oe.tanggal.split("T")[0]]||0)+xe});const V=Object.entries(q).map(([oe,xe])=>({date:oe,value:xe})).sort((oe,xe)=>new Date(oe.date).getTime()-new Date(xe.date).getTime()),J=[...v].sort((oe,xe)=>new Date(xe.tanggal).getTime()-new Date(oe.tanggal).getTime()),U=v.filter(oe=>oe.peruntukan.kategori.toLowerCase().includes("pendaftaran")&&oe.jenis==="masuk").reduce((oe,xe)=>oe+xe.pembayaran.nominal,0),re=v.filter(oe=>oe.peruntukan.kategori.toLowerCase().includes("kartu")&&oe.jenis==="masuk").reduce((oe,xe)=>oe+xe.pembayaran.nominal,0),Z=v.filter(oe=>oe.peruntukan.kategori.toLowerCase().includes("kopontren")&&oe.jenis==="masuk").reduce((oe,xe)=>oe+xe.pembayaran.nominal,0),ae=R-(U+re+Z),_e=[{label:"Pendaftaran",value:U,color:"#6366f1"},{label:"KTS",value:re,color:"#ec4899"},{label:"Kopontren",value:Z,color:"#f59e0b"},{label:"Lainnya",value:Math.max(0,ae),color:"#64748b"}].filter(oe=>oe.value>0);return{saldoGlobal:n,pemasukanPeriode:R,pengeluaranPeriode:W,dailyChartData:V,filteredTransactions:J,donutData:_e}},[N,z]),E=n=>{L({jenis:n.jenis,kategori:n.peruntukan.kategori,id_santri:n.pihak.id||"",nama_santri:n.pihak.nama,nama_pihak_luar:n.pihak.id?"":n.pihak.nama,tanggal:new Date(n.tanggal).toISOString().split("T")[0],nominal:n.pembayaran.nominal,keterangan:n.pembayaran.catatan,metode:n.pembayaran.metode,id_biaya:n.peruntukan.id_ref||"",status:n.status||"Selesai"}),w(n.id_transaksi),h(!0),window.scrollTo(0,0)},F=async()=>{if(!C.nominal){alert("Mohon lengkapi nominal.");return}const v={id_transaksi:M||`TRX-ADM-${Date.now().toString().slice(-6)}`,tanggal:new Date(C.tanggal).toISOString(),jenis:C.jenis,status:C.status,pihak:{id:C.id_santri||null,nama:C.id_santri?C.nama_santri:C.nama_pihak_luar},peruntukan:{pos:"Administrasi",kategori:C.kategori,id_ref:C.id_biaya||"BY-MANUAL"},pembayaran:{metode:C.metode,sistem:C.metode==="Tunai"?"":"Bank",penyedia:"",no_rek:"",penerima:"Tata Usaha",nominal:Number(C.nominal),catatan:C.keterangan||"-"}};let R=M?m.map(W=>W.id_transaksi===M?v:W):[v,...m];await G.updateKeuanganTransaksi(R),u(R),t("keuanganTransaksi",R),h(!1),w(null),L(d)},x=s.useMemo(()=>Array.isArray(i)?i.map(n=>{var v,R,W;return{value:(v=n.verifikasi_santri)==null?void 0:v.id_santri,label:`${(R=n.data_santri)==null?void 0:R.nama_lengkap} (${(W=n.verifikasi_santri)==null?void 0:W.id_santri})`}}):[],[i]),l=s.useMemo(()=>[...A.map(v=>({value:v.id_biaya,label:v.kategori})),{value:"MANUAL_OUT",label:"Belanja / Pengeluaran"},{value:"LAINNYA",label:"Lainnya"}],[A]),I=({data:n})=>n.isLunas?e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("span",{className:"w-5 h-5 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center border border-emerald-200",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})}):n.paid>0?e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-[9px] font-bold text-amber-600 bg-amber-50 px-2 py-0.5 rounded-full border border-amber-100",children:"Cicil"}),e.jsx("span",{className:"text-[9px] font-sans font-medium text-gray-500 mt-0.5",children:ie(n.paid).replace("Rp","")})]}):e.jsx("div",{className:"flex flex-col items-center",children:e.jsx("span",{className:"w-1.5 h-1.5 bg-gray-200 rounded-full"})}),_=async()=>{if(M&&window.confirm("Apakah Anda yakin ingin menghapus transaksi ini?")){D(!0);try{const n=m.filter(v=>v.id_transaksi!==M);await G.updateKeuanganTransaksi(n),u(n),t("keuanganTransaksi",n),h(!1),w(null)}catch(n){console.error("Gagal menghapus:",n)}finally{D(!1)}}};return f?e.jsx(fe,{message:"Menyiapkan data Administrasi...",fullScreen:!1}):e.jsxs("div",{className:"space-y-8 animate-fade-in font-sans pb-24 relative min-h-[600px]",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-white p-2 rounded-2xl shadow-sm border border-gray-200 mb-6 sticky top-0 z-20 backdrop-blur-md bg-white/90",children:e.jsx(ua,{tabs:["Ringkasan","Transaksi","Monitoring"],activeTab:o,onChange:n=>c(n)})}),o==="Ringkasan"&&e.jsxs("div",{className:"space-y-8 animate-fade-in-up",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(we,{title:"Saldo Administrasi",value:$.saldoGlobal,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 011.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),color:"indigo",description:"Saldo bersih kas."}),e.jsx(we,{title:"Pemasukan",value:$.pemasukanPeriode,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 11l5-5m0 0l5 5m-5-5v12"})}),color:"emerald"}),e.jsx(we,{title:"Pengeluaran",value:$.pengeluaranPeriode,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 13l-5 5m0 0l-5-5m5 5V6"})}),color:"rose"}),e.jsx(we,{title:"Target Penerimaan",value:b.totalTarget,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),color:"amber",description:"Potensi total pendapatan."})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm",children:[e.jsx("h3",{className:"font-serif font-bold text-gray-900 text-xl mb-6",children:"Tren Arus Kas (Net)"}),e.jsx(Ze,{data:$.dailyChartData,color:"#6366f1"})]}),e.jsxs("div",{className:"bg-white p-8 rounded-[2.5rem] border border-gray-100 shadow-sm flex flex-col items-center justify-center relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-indigo-400 to-purple-500"}),e.jsx("h3",{className:"font-serif font-bold text-gray-900 text-lg mb-8 w-full text-center",children:"Sumber Pemasukan"}),e.jsx(va,{data:$.donutData}),e.jsx("div",{className:"w-full mt-8 space-y-3",children:$.donutData.map((n,v)=>e.jsxs("div",{className:"flex justify-between items-center text-xs p-2 rounded-lg hover:bg-gray-50 transition",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"w-3 h-3 rounded-full shadow-sm",style:{backgroundColor:n.color}}),e.jsx("span",{className:"text-gray-600 font-bold uppercase tracking-wider",children:n.label})]}),e.jsx("span",{className:"font-black text-gray-900 font-sans",children:ie(n.value)})]},v))})]})]})]}),o==="Transaksi"&&e.jsx("div",{className:"space-y-6 animate-fade-in-up",children:K?e.jsxs("div",{className:"bg-white rounded-[2.5rem] shadow-xl border border-gray-200 p-8 animate-fade-in-up font-sans relative z-30 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8 border-b border-gray-100 pb-4",children:[e.jsx("h3",{className:"font-serif font-bold text-2xl text-gray-900 tracking-tight",children:M?"Edit Transaksi":"Input Administrasi"}),e.jsx(Le,{label:"Batal",variant:"secondary",onClick:()=>{h(!1),w(null)}})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 ml-1",children:"Jenis"}),e.jsxs("div",{className:"flex bg-gray-50 p-1 rounded-xl",children:[e.jsx("button",{onClick:()=>L({...C,jenis:"masuk"}),className:`flex-1 py-3 rounded-lg text-sm font-bold transition ${C.jenis==="masuk"?"bg-indigo-600 text-white shadow":"text-gray-500"}`,children:"Pemasukan"}),e.jsx("button",{onClick:()=>L({...C,jenis:"keluar"}),className:`flex-1 py-3 rounded-lg text-sm font-bold transition ${C.jenis==="keluar"?"bg-rose-600 text-white shadow":"text-gray-500"}`,children:"Pengeluaran"})]})]}),e.jsx(ze,{id:"tgl-trx",label:"Tanggal",value:C.tanggal||"",onChange:n=>L({...C,tanggal:n}),className:"!mb-0"})]}),C.jenis==="masuk"?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(de,{id:"cari-santri",label:"Cari Santri (Opsional)",value:C.id_santri,onChange:n=>{var R;const v=i.find(W=>W.verifikasi_santri.id_santri===n);L({...C,id_santri:n,nama_santri:((R=v==null?void 0:v.data_santri)==null?void 0:R.nama_lengkap)||""})},options:x,className:"!mb-0"}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:C.nama_pihak_luar,onChange:n=>L({...C,nama_pihak_luar:n.target.value}),disabled:!!C.id_santri}),e.jsx("label",{className:"floating-label",children:"Nama Penyetor (Jika Non-Santri)"})]})]}):e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:C.nama_pihak_luar,onChange:n=>L({...C,nama_pihak_luar:n.target.value})}),e.jsx("label",{className:"floating-label",children:"Dibayarkan Kepada"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(de,{id:"kategori-biaya",label:"Kategori",value:C.id_biaya,options:l,onChange:n=>{const v=A.find(R=>R.id_biaya===n);L(n==="MANUAL_OUT"?{...C,id_biaya:n,kategori:"Belanja / Pengeluaran",nominal:0}:n==="LAINNYA"?{...C,id_biaya:n,kategori:"Lainnya",nominal:0}:{...C,id_biaya:n,kategori:(v==null?void 0:v.kategori)||"",nominal:(v==null?void 0:v.nominal)||0})},className:"!mb-0"}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:C.keterangan,onChange:n=>L({...C,keterangan:n.target.value})}),e.jsx("label",{className:"floating-label",children:"Keterangan"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"number",className:"floating-input peer font-bold text-indigo-800 text-lg",placeholder:" ",value:C.nominal||"",onChange:n=>L({...C,nominal:Number(n.target.value)})}),e.jsx("label",{className:"floating-label",children:"Nominal (Rp)"})]}),e.jsx(de,{id:"metode-bayar",label:"Metode",value:C.metode,options:[{value:"Tunai",label:"Tunai"},{value:"Transfer",label:"Transfer"}],onChange:n=>L({...C,metode:n}),className:"!mb-0"})]}),e.jsxs("div",{className:"pt-6 flex gap-4 border-t border-gray-100 mt-4",children:[M&&e.jsx(Le,{label:"Hapus",variant:"danger",onClick:_,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx(Le,{label:M?"Simpan Perubahan":"Simpan Transaksi",onClick:F,className:"flex-1 py-4 text-base"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(sa,{data:$.filteredTransactions,fileName:`Transaksi_Administrasi_${new Date().toISOString().split("T")[0]}`,title:"Laporan Transaksi Administrasi",columns:[{header:"Tanggal",accessor:n=>new Date(n.tanggal).toLocaleDateString("id-ID")},{header:"ID",accessor:n=>n.id_transaksi},{header:"Kategori",accessor:n=>n.peruntukan.kategori},{header:"Pihak",accessor:n=>n.pihak.nama},{header:"Jenis",accessor:n=>n.jenis},{header:"Nominal",accessor:n=>ie(n.pembayaran.nominal)},{header:"Status",accessor:n=>n.status||"Selesai"}]}),e.jsx(Le,{onClick:()=>{h(!0),w(null),L(d)},label:"Input Transaksi",icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]}),e.jsx(Re,{headers:["Keterangan","Tanggal","Status","Jenis","Nominal"],isEmpty:$.filteredTransactions.length===0,children:$.filteredTransactions.map((n,v)=>{const R=n.jenis==="keluar";return e.jsxs("tr",{className:"hover:bg-indigo-50/50 transition cursor-pointer group",onClick:()=>E(n),children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center mr-2 ${R?"bg-rose-100 text-rose-600":"bg-indigo-100 text-indigo-600"}`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:R?"M20 12H4":"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-gray-800 group-hover:text-indigo-700 transition",children:n.peruntukan.kategori}),e.jsxs("div",{className:"text-[10px] text-gray-500 mt-0.5",children:[n.pembayaran.catatan," (",n.pihak.nama,")"]})]})]})}),e.jsx("td",{className:"px-6 py-4 font-bold text-gray-500 text-xs",children:new Date(n.tanggal).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(Pe,{status:n.status||"Selesai"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:`text-[9px] font-bold px-2 py-1 rounded border ${R?"bg-rose-50 text-rose-600 border-rose-100":"bg-indigo-50 text-indigo-600 border-indigo-100"}`,children:R?"Keluar":"Masuk"})}),e.jsxs("td",{className:`px-6 py-4 text-right font-black font-sans text-sm tracking-tight ${R?"text-rose-600":"text-indigo-600"}`,children:[R?"-":"+"," ",ie(n.pembayaran.nominal).replace("Rp","")]})]},v)})})]})}),o==="Monitoring"&&e.jsx("div",{className:"animate-fade-in-up space-y-6",children:e.jsxs("div",{className:"bg-white rounded-[2rem] shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex flex-wrap justify-between items-center gap-4 bg-gray-50/30 sticky top-0 z-10",children:[e.jsxs("div",{className:"flex gap-4 items-center flex-1",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:"Checklist Kewajiban Administrasi"}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("input",{type:"text",placeholder:"Cari Nama Santri...",value:P,onChange:n=>y(n.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-white border border-gray-200 rounded-xl text-xs font-bold text-gray-700 outline-none focus:ring-2 focus:ring-indigo-500 transition shadow-sm"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-gray-400 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),e.jsx(sa,{data:T,fileName:`Monitoring_Administrasi_${new Date().toISOString().split("T")[0]}`,title:"Laporan Monitoring Administrasi Santri",columns:[{header:"ID Santri",accessor:n=>n.id_santri},{header:"Nama Lengkap",accessor:n=>n.nama},{header:"Kelas",accessor:n=>n.kelas},{header:"Wajib Bayar",accessor:n=>ie(n.wajib_bayar)},{header:"Total Bayar",accessor:n=>ie(n.terbayar)},{header:"Status",accessor:n=>n.status}]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-xs",children:[e.jsx("thead",{className:"bg-gray-50 text-gray-500 font-bold uppercase tracking-wider",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"Santri"}),e.jsx("th",{className:"px-6 py-4",children:"Kelas"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Pendaftaran"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"KTS"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"Kopontren"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Total Bayar"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:T.map(n=>e.jsxs("tr",{className:"hover:bg-indigo-50/30 transition border-b border-gray-50 last:border-0 cursor-default",children:[e.jsx("td",{className:"px-6 py-4 font-bold text-gray-800",children:n.nama}),e.jsx("td",{className:"px-6 py-4 text-gray-500 text-xs",children:n.kelas}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(I,{data:n.pendaftaran})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(I,{data:n.kts})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(I,{data:n.kopontren})}),e.jsx("td",{className:"px-6 py-4 text-right font-bold font-sans text-indigo-600 text-sm tabular-nums",children:ie(n.terbayar).replace("Rp","")})]},n.id_santri))})]})})]})})]})},Dn=[{title:"Jurnal Umum Keuangan",description:"Pusat pencatatan seluruh arus kas masuk dan keluar pesantren, mencakup semua pos anggaran."},{targetId:"keu-umum-stats",title:"Ringkasan Arus Kas",description:"Lihat total Pemasukan, Pengeluaran, dan Saldo Bersih (Net Cashflow) secara global.",position:"bottom"},{targetId:"keu-umum-filter",title:"Filter Data",description:"Saring transaksi berdasarkan Pos Anggaran (Administrasi, Bangunan, dll) atau rentang tanggal.",position:"bottom"},{targetId:"keu-umum-add",title:"Catat Transaksi",description:"Klik tombol ini untuk mencatat pemasukan atau pengeluaran baru secara manual.",position:"left"},{targetId:"keu-umum-chart",title:"Grafik Tren",description:"Visualisasi pergerakan keuangan harian untuk memantau kesehatan finansial.",position:"top"}],Bn=()=>{const{fetchData:a,cache:r,updateCache:t}=ge(),[o,c]=s.useState([]),[k,f]=s.useState([]),[D,B]=s.useState([]),[p,m]=s.useState(!0),[u,i]=s.useState(""),[g,K]=s.useState("Semua"),[h,M]=s.useState(""),[w,d]=s.useState(""),[C,L]=s.useState(!1),[P,y]=s.useState(null),z={jenis:"masuk",tanggal:new Date().toISOString().split("T")[0],pos:"Operasional",kategori:"",id_ref_biaya:"",id_santri:"",nama_pihak:"",nominal:0,metode:"Tunai",keterangan:"",status:"Selesai"},[j,N]=s.useState(z);s.useEffect(()=>{(async()=>{m(!0);try{const[n,v,R]=await Promise.all([a("keuanganTransaksi",G.getKeuanganTransaksi,"TransaksiUmum",!1,!1),a("keuanganBiaya",G.getKeuanganBiaya,"TransaksiUmum",!1,!1),a("databaseSantri",G.getDatabaseSantri,"TransaksiUmum",!1,!1)]);c(Array.isArray(n)?n:[]),f(Array.isArray(v)?v:[]),B(Array.isArray(R)?R:[])}catch(n){console.error("Gagal memuat data transaksi umum:",n)}finally{m(!1)}})()},[a]);const A=s.useMemo(()=>{let _=o;if(u){const n=u.toLowerCase();_=_.filter(v=>v.pihak.nama.toLowerCase().includes(n)||v.peruntukan.kategori.toLowerCase().includes(n)||v.id_transaksi.toLowerCase().includes(n))}return g!=="Semua"&&(_=_.filter(n=>n.peruntukan.pos===g)),h&&(_=_.filter(n=>n.tanggal>=h)),w&&(_=_.filter(n=>n.tanggal<=w)),_.sort((n,v)=>new Date(v.tanggal).getTime()-new Date(n.tanggal).getTime())},[o,u,g,h,w]),S=s.useMemo(()=>{const _=A.filter(W=>W.jenis==="masuk").reduce((W,q)=>W+q.pembayaran.nominal,0),n=A.filter(W=>W.jenis==="keluar").reduce((W,q)=>W+q.pembayaran.nominal,0),v={};A.forEach(W=>{const q=W.tanggal.split("T")[0],V=W.jenis==="masuk"?W.pembayaran.nominal:-W.pembayaran.nominal;v[q]=(v[q]||0)+V});const R=Object.keys(v).sort().map(W=>({date:W,value:v[W]}));return{pemasukan:_,pengeluaran:n,net:_-n,chartData:R}},[A]),b=s.useMemo(()=>{const _=new Set(o.map(n=>n.peruntukan.pos));return["Semua",...Array.from(_)].map(n=>({value:n,label:n}))},[o]),T=s.useMemo(()=>{const _=k.map(n=>({value:n.id_biaya,label:`${n.kategori} (${n.pos}) - ${ie(n.nominal)}`}));return[{value:"",label:"-- Input Manual --"},..._]},[k]),$=s.useMemo(()=>D.map(_=>({value:_.verifikasi_santri.id_santri,label:`${_.data_santri.nama_lengkap} (${_.verifikasi_santri.id_santri})`})),[D]),E=_=>{const n=k.find(v=>v.id_biaya===_);N(n?v=>({...v,id_ref_biaya:_,pos:n.pos,kategori:n.kategori,nominal:n.nominal,jenis:"masuk"}):v=>({...v,id_ref_biaya:""}))},F=_=>{const n=D.find(v=>v.verifikasi_santri.id_santri===_);N(v=>({...v,id_santri:_,nama_pihak:n?n.data_santri.nama_lengkap:""}))},x=_=>{y(_.id_transaksi),N({jenis:_.jenis,tanggal:new Date(_.tanggal).toISOString().split("T")[0],pos:_.peruntukan.pos,kategori:_.peruntukan.kategori,id_ref_biaya:_.peruntukan.id_ref||"",id_santri:_.pihak.id||"",nama_pihak:_.pihak.nama,nominal:_.pembayaran.nominal,metode:_.pembayaran.metode,keterangan:_.pembayaran.catatan,status:_.status}),L(!0),window.scrollTo(0,0)},l=async _=>{if(confirm("Hapus transaksi ini?")){m(!0);try{const n=o.filter(v=>v.id_transaksi!==_);await G.updateKeuanganTransaksi(n),c(n),t("keuanganTransaksi",n)}catch(n){console.error(n),alert("Gagal menghapus transaksi.")}finally{m(!1)}}},I=async()=>{if(!j.nominal||!j.nama_pihak||!j.kategori){alert("Mohon lengkapi Nominal, Pihak, dan Kategori.");return}m(!0);try{const n={id_transaksi:P||`TRX-GEN-${Date.now().toString().slice(-8)}`,tanggal:new Date(j.tanggal).toISOString(),jenis:j.jenis,status:j.status,pihak:{id:j.id_santri||null,nama:j.nama_pihak},peruntukan:{pos:j.pos,kategori:j.kategori,id_ref:j.id_ref_biaya||"MANUAL"},pembayaran:{metode:j.metode,sistem:j.metode==="Tunai"?"Kasir":"Bank",penyedia:"-",no_rek:"-",penerima:"Admin",nominal:Number(j.nominal),catatan:j.keterangan||"-"}};let v=[...o];P?v=v.map(R=>R.id_transaksi===P?n:R):v.unshift(n),await G.updateKeuanganTransaksi(v),c(v),t("keuanganTransaksi",v),L(!1),y(null),N(z)}catch(_){console.error(_),alert("Gagal menyimpan transaksi.")}finally{m(!1)}};return p&&o.length===0?e.jsx(fe,{message:"Memuat Jurnal Keuangan...",fullScreen:!1}):e.jsxs("div",{className:"space-y-6 animate-fade-in font-sans pb-24 relative min-h-[600px]",children:[e.jsx(ve,{tourId:"keu_umum",steps:Dn}),C?e.jsxs(Dt,{title:P?"Edit Jurnal Transaksi":"Catat Transaksi Baru",className:"max-w-5xl mx-auto animate-fade-in-up",children:[e.jsx("div",{className:"flex justify-end mb-8 -mt-12",children:e.jsx(Le,{label:"Batal",variant:"secondary",onClick:()=>L(!1),size:"sm"})}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-100 p-6 rounded-3xl flex flex-col md:flex-row gap-6 items-center shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 text-blue-800 shrink-0",children:[e.jsx("div",{className:"p-3 bg-white rounded-2xl shadow-sm text-blue-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-sm",children:"Smart Input"}),e.jsx("p",{className:"text-[10px] opacity-70",children:"Otomatis isi nominal dari Master Biaya"})]})]}),e.jsx("div",{className:"flex-1 w-full",children:e.jsx(de,{id:"master-biaya",label:"Pilih Jenis Biaya (Opsional)",value:j.id_ref_biaya,onChange:E,options:T,className:"!mb-0 bg-white/80 backdrop-blur-sm"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-1 rounded-2xl flex relative border border-gray-200",children:[e.jsx("div",{className:`absolute top-1 bottom-1 w-[calc(50%-4px)] bg-white rounded-xl shadow-sm transition-all duration-300 ${j.jenis==="keluar"?"translate-x-[100%] ml-2":"translate-x-0 ml-1"}`}),e.jsx("button",{onClick:()=>N({...j,jenis:"masuk"}),className:`flex-1 py-3 rounded-xl text-sm font-bold relative z-10 transition-colors ${j.jenis==="masuk"?"text-emerald-700":"text-gray-400"}`,children:"Pemasukan (+)"}),e.jsx("button",{onClick:()=>N({...j,jenis:"keluar"}),className:`flex-1 py-3 rounded-xl text-sm font-bold relative z-10 transition-colors ${j.jenis==="keluar"?"text-rose-700":"text-gray-400"}`,children:"Pengeluaran (-)"})]}),e.jsx(ze,{id:"tgl-trx",label:"Tanggal Transaksi",value:j.tanggal,onChange:_=>N({...j,tanggal:_}),className:"!mb-0"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-white",placeholder:" ",value:j.pos,onChange:_=>N({...j,pos:_.target.value})}),e.jsx("label",{className:"floating-label",children:"Pos Anggaran"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-white",placeholder:" ",value:j.kategori,onChange:_=>N({...j,kategori:_.target.value})}),e.jsx("label",{className:"floating-label",children:"Kategori"})]})]}),e.jsxs("div",{className:"floating-group !mb-0 relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 font-bold text-gray-400 z-10",children:"Rp"}),e.jsx("input",{type:"number",className:"floating-input peer pl-10 font-mono font-bold text-2xl text-gray-800 bg-white border-2 border-gray-100 focus:border-emerald-500 h-16",placeholder:" ",value:j.nominal||"",onChange:_=>N({...j,nominal:Number(_.target.value)})}),e.jsx("label",{className:"floating-label !left-10",children:"Nominal Transaksi"})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(de,{id:"cari-santri",label:"Cari Santri (Jika Pemasukan Siswa)",value:j.id_santri,onChange:F,options:$,className:"!mb-0"}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-white",placeholder:" ",value:j.nama_pihak,onChange:_=>N({...j,nama_pihak:_.target.value})}),e.jsx("label",{className:"floating-label",children:"Nama Pihak / Penyetor / Penerima"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(de,{id:"metode",label:"Metode",value:j.metode,onChange:_=>N({...j,metode:_}),options:[{value:"Tunai",label:"Tunai"},{value:"Transfer",label:"Transfer"}],className:"!mb-0"}),e.jsx(de,{id:"status",label:"Status",value:j.status,onChange:_=>N({...j,status:_}),options:[{value:"Selesai",label:"Selesai"},{value:"Menunggu",label:"Menunggu"}],className:"!mb-0"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("textarea",{className:"floating-input peer h-32 py-3 bg-white",placeholder:" ",value:j.keterangan,onChange:_=>N({...j,keterangan:_.target.value})}),e.jsx("label",{className:"floating-label",children:"Catatan Tambahan"})]})]})]}),e.jsxs("div",{className:"pt-8 mt-4 border-t border-gray-100 flex gap-4",children:[P&&e.jsx(Le,{label:"Hapus Data",variant:"danger",onClick:()=>l(P),icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx(Le,{label:P?"Simpan Perubahan":"Simpan Transaksi",onClick:I,className:"flex-1 py-4 text-lg",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"keu-umum-stats",className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8 mt-2",children:[e.jsx(we,{title:"Pemasukan",value:S.pemasukan,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 11l5-5m0 0l5 5m-5-5v12"})}),color:"emerald",description:"Total Arus Masuk"}),e.jsx(we,{title:"Pengeluaran",value:S.pengeluaran,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 13l-5 5m0 0l-5-5m5 5V6"})}),color:"rose",description:"Total Arus Keluar"}),e.jsx(we,{title:"Net Cashflow",value:S.net,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"blue",description:"Saldo Bersih"})]}),e.jsxs("div",{id:"keu-umum-filter",className:"bg-white p-2 rounded-[2rem] border border-gray-200 shadow-sm flex flex-col md:flex-row gap-4 items-center justify-between mb-6 sticky top-0 z-10 backdrop-blur-md bg-white/90",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 px-2 w-full md:w-auto items-center",children:[e.jsx("div",{className:"w-48 shrink-0 z-20",children:e.jsx(de,{id:"filter-pos",label:"Pos Anggaran",value:g,onChange:K,options:b,className:"!mb-0 !mt-0"})}),e.jsxs("div",{className:"flex bg-gray-100 rounded-xl p-1 shrink-0 border border-gray-200",children:[e.jsx("input",{type:"date",value:h,onChange:_=>M(_.target.value),className:"bg-transparent border-none px-3 py-1.5 text-xs font-bold text-gray-700 outline-none w-32"}),e.jsx("span",{className:"text-gray-400 self-center",children:"-"}),e.jsx("input",{type:"date",value:w,onChange:_=>d(_.target.value),className:"bg-transparent border-none px-3 py-1.5 text-xs font-bold text-gray-700 outline-none w-32"})]})]}),e.jsxs("div",{className:"flex gap-2 w-full md:w-auto pr-2",children:[e.jsxs("div",{className:"relative flex-1 md:w-64",children:[e.jsx("input",{type:"text",placeholder:"Cari transaksi...",value:u,onChange:_=>i(_.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-xs font-bold text-gray-700 outline-none focus:ring-2 focus:ring-emerald-500 transition-all shadow-sm"}),e.jsx("svg",{className:"w-4 h-4 text-gray-400 absolute left-3.5 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx(sa,{data:A,fileName:`Jurnal_Umum_${new Date().toISOString().split("T")[0]}`,title:"Laporan Jurnal Umum Keuangan",columns:[{header:"Tanggal",accessor:_=>new Date(_.tanggal).toLocaleDateString("id-ID")},{header:"Pos / Kategori",accessor:_=>`${_.peruntukan.pos} - ${_.peruntukan.kategori}`},{header:"Pihak",accessor:_=>_.pihak.nama},{header:"Keterangan",accessor:_=>_.pembayaran.catatan},{header:"Jenis",accessor:_=>_.jenis},{header:"Nominal",accessor:_=>ie(_.pembayaran.nominal)},{header:"Status",accessor:_=>_.status}]}),e.jsx("div",{id:"keu-umum-add",children:e.jsx(Le,{label:"Catat",onClick:()=>{L(!0),y(null),N(z)},icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),className:"shrink-0"})})]})]}),e.jsx(Re,{headers:["Tanggal","Ref ID","Pos / Kategori","Pihak / Keterangan","Metode","Status","Nominal"],isEmpty:A.length===0,children:A.map((_,n)=>e.jsxs("tr",{onClick:()=>x(_),className:"hover:bg-blue-50/30 transition cursor-pointer group border-b border-gray-50 last:border-0",children:[e.jsx("td",{className:"px-6 py-4 font-bold text-gray-600 border-l-4 border-transparent group-hover:border-emerald-500 pl-5 transition-all text-xs",children:new Date(_.tanggal).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})}),e.jsx("td",{className:"px-6 py-4 font-mono text-[10px] text-gray-400 font-bold",children:_.id_transaksi}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-gray-800 text-sm mb-0.5",children:_.peruntukan.kategori}),e.jsx("span",{className:`text-[9px] font-black uppercase tracking-wider px-2 py-0.5 rounded ${_.peruntukan.pos==="Operasional"?"bg-blue-50 text-blue-600":"bg-orange-50 text-orange-600"}`,children:_.peruntukan.pos})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-gray-800",children:_.pihak.nama}),e.jsx("div",{className:"text-[10px] text-gray-400 italic font-medium",children:_.pembayaran.catatan})]}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:"bg-gray-100 text-gray-500 px-2 py-1 rounded text-[10px] font-bold uppercase",children:_.pembayaran.metode})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(Pe,{status:_.status})}),e.jsxs("td",{className:`px-6 py-4 text-right font-sans font-bold text-sm ${_.jenis==="masuk"?"text-emerald-600":"text-rose-600"}`,children:[_.jenis==="masuk"?"+":"-"," ",ie(_.pembayaran.nominal).replace("Rp","")]})]},n))}),e.jsxs("div",{id:"keu-umum-chart",className:"mt-8 bg-white p-6 rounded-[2.5rem] border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg mb-6 ml-2",children:"Tren Arus Kas Harian"}),e.jsx(Ze,{data:S.chartData,color:"#10b981",height:240})]})]})]})},In=()=>{var _;const{fetchData:a,updateCache:r}=ge(),[t,o]=s.useState(!0),[c,k]=s.useState(!1),[f,D]=s.useState([]),[B,p]=s.useState([]),[m,u]=s.useState([]),[i,g]=s.useState([]),[K,h]=s.useState(""),[M,w]=s.useState("list"),[d,C]=s.useState(null),[L,P]=s.useState({isOpen:!1,status:"idle",title:"",message:""}),[y,z]=s.useState({isOpen:!1,student:null,primaryEmail:""}),j="service_vel46d1",N="tagihan-miftahulhuda1",A="-_XBRYy7elJVxzhyM";s.useEffect(()=>{(async()=>{o(!0);try{const[v,R,W,q]=await Promise.all([a("databaseSantri",G.getDatabaseSantri,"BukuTunggakan",!1,!1),a("keuanganBiaya",G.getKeuanganBiaya,"BukuTunggakan",!1,!1),a("keuanganTransaksi",G.getKeuanganTransaksi,"BukuTunggakan",!1,!1),a("databaseAkun",G.getDatabaseAkun,"BukuTunggakan",!1,!1)]);D(Array.isArray(v)?v:[]),p(Array.isArray(R)?R:[]),u(Array.isArray(W)?W:[]),g(Array.isArray(q)?q:[])}catch(v){console.error("Gagal memuat data buku tunggakan:",v)}finally{o(!1)}})()},[a]);const S=s.useMemo(()=>{if(!f.length||!B.length)return[];const n=new Date,v=n.getFullYear(),R=n.getMonth();return f.map(W=>{var oe,xe,H,ee,le,O,Q,ne,he,Ce;const q=((oe=W.verifikasi_santri)==null?void 0:oe.id_santri)||"-",V=((xe=W.data_santri)==null?void 0:xe.nama_lengkap)||"Tanpa Nama",J=(H=W.verifikasi_santri)==null?void 0:H.bergabung;let U=[];const re=m.filter(me=>{var be;return((be=me.pihak)==null?void 0:be.id)===q&&me.jenis==="masuk"&&(me.status==="Selesai"||me.status==="Lunas"||me.status==="Verified")});B.forEach(me=>{let be=re.filter(Me=>Me.peruntukan.id_ref===me.id_biaya||Me.peruntukan.kategori.toLowerCase().includes(me.kategori.toLowerCase())).reduce((Me,ke)=>Me+(ke.pembayaran.nominal||0),0);if(me.periode==="bulanan"){let Me=new Date(J);isNaN(Me.getTime())&&(Me=new Date(new Date().getFullYear(),0,1));let ke=new Date(Me.getFullYear(),Me.getMonth(),1);const Se=new Date(v,R,1);if(ke<=Se)for(;ke<=Se;){const Y=ke.toLocaleDateString("id-ID",{month:"long",year:"numeric"}),te=me.nominal;let X=0,se="Belum";be>=te?(X=te,se="Lunas",be-=te):be>0&&(X=be,se="Sebagian",be=0),U.push({id_item:`${me.id_biaya}-${ke.getTime()}`,kategori:me.kategori,periode:"Bulanan",deskripsi:`${me.kategori} ${Y}`,nominal_tagihan:te,nominal_bayar:X,sisa_tagihan:te-X,status:se,jatuh_tempo:`10 ${Y}`}),ke.setMonth(ke.getMonth()+1)}}else{const Me=me.nominal;let ke=0,Se="Belum";be>=Me?(ke=Me,Se="Lunas"):be>0&&(ke=be,Se="Sebagian"),U.push({id_item:`${me.id_biaya}-ONCE`,kategori:me.kategori,periode:me.periode,deskripsi:`${me.kategori} (${me.pos})`,nominal_tagihan:Me,nominal_bayar:ke,sisa_tagihan:Me-ke,status:Se,jatuh_tempo:"-",pos:me.pos})}});const Z=U.reduce((me,be)=>me+be.nominal_tagihan,0),ae=U.reduce((me,be)=>me+be.nominal_bayar,0),_e=Z-ae;return{id_santri:q,nama:V,kelas:`${((ee=W.data_akademik)==null?void 0:ee.kelas)||""} ${((le=W.data_akademik)==null?void 0:le.jenjang)||""}`,status_aktif:((O=W.verifikasi_santri)==null?void 0:O.status)||"Aktif",bergabung:J,wali:((ne=(Q=W.data_keluarga)==null?void 0:Q.ayah)==null?void 0:ne.nama)||"-",no_hp:((Ce=(he=W.data_keluarga)==null?void 0:he.ayah)==null?void 0:Ce.no_wa)||"",total_wajib:Z,total_bayar:ae,total_tunggakan:_e,status_keuangan:_e<=0?"Lunas":"Ada Tunggakan",details:U,raw_data_akademik:W.data_akademik,raw_data_keluarga:W.data_keluarga}})},[f,B,m]),b=s.useMemo(()=>S.filter(n=>n.nama.toLowerCase().includes(K.toLowerCase())||n.id_santri.toLowerCase().includes(K.toLowerCase())),[S,K]),T=s.useMemo(()=>({totalPotensi:S.reduce((n,v)=>n+v.total_wajib,0),totalTunggakan:S.reduce((n,v)=>n+v.total_tunggakan,0),jumlahLunas:S.filter(n=>n.status_keuangan==="Lunas").length,jumlahMenunggak:S.filter(n=>n.status_keuangan==="Ada Tunggakan").length}),[S]),$=n=>{var v,R,W,q;if(Array.isArray(i)&&i.length>0){const V=i.find(J=>{var ae,_e;const U=(((ae=J==null?void 0:J.verifikasi_akun)==null?void 0:ae.id_santri)||"").trim().toLowerCase(),re=(n.id_santri||"").trim().toLowerCase(),Z=(((_e=n.raw_data_akademik)==null?void 0:_e.nisn)||"").trim().toLowerCase();return U&&(U===re||Z&&U===Z)});if((v=V==null?void 0:V.data_akun)!=null&&v.email)return V.data_akun.email}if(n.raw_data_keluarga){const V=(R=n.raw_data_keluarga.ayah)==null?void 0:R.email,J=(W=n.raw_data_keluarga.ibu)==null?void 0:W.email,U=(q=n.raw_data_keluarga.wali)==null?void 0:q.email,re=Z=>typeof Z=="string"&&Z.includes("@")&&Z.length>5&&Z!=="-";if(re(V))return V;if(re(J))return J;if(re(U))return U}return null},E=(n,v)=>{if(n.stopPropagation(),v.status_keuangan==="Lunas"){alert("Santri ini sudah lunas, tidak ada tagihan untuk dikirim.");return}const R=v.details.filter(J=>J.sisa_tagihan>0);let W=`Assalamu'alaikum, Yth. Wali Santri *${v.nama}*.

`;W+=`Berikut adalah rincian kewajiban administrasi yang belum terselesaikan:

`,R.slice(0,15).forEach((J,U)=>{W+=`${U+1}. ${J.deskripsi}: ${ie(J.sisa_tagihan)}
`}),R.length>15&&(W+=`... dan ${R.length-15} item lainnya.
`),W+=`
*Total Tunggakan: ${ie(v.total_tunggakan)}*

`,W+=`Mohon untuk segera melakukan pembayaran. Terima kasih.
- Bagian Keuangan Pesantren`;let q=v.no_hp.replace(/\D/g,"");q.startsWith("0")&&(q="62"+q.substring(1)),q.startsWith("62")||(q="62"+q);const V=`https://wa.me/${q}?text=${encodeURIComponent(W)}`;window.open(V,"_blank")},F=(n,v)=>{if(n.stopPropagation(),v.status_keuangan==="Lunas"){alert("Status Lunas. Tidak perlu kirim email.");return}const R=$(v);if(!R){alert(`Tidak ditemukan email valid untuk santri ${v.nama}.`);return}z({isOpen:!0,student:v,primaryEmail:R})},x=async()=>{const n=b.filter(W=>W.status_keuangan==="Ada Tunggakan");if(n.length===0){alert("Tidak ada santri dengan tunggakan dalam daftar saat ini.");return}if(!window.confirm(`Kirim email tagihan ke ${n.length} santri yang menunggak? Proses ini akan memakan waktu.`))return;k(!0),P({isOpen:!0,status:"batch_processing",title:"Mengirim Tagihan Menyeluruh",message:"Persiapan data...",batchTotal:n.length,batchCurrent:0,batchSuccess:0,batchFailed:0,currentName:""});let v=0,R=0;for(let W=0;W<n.length;W++){const q=n[W];P(J=>({...J,batchCurrent:W+1,currentName:q.nama}));const V=$(q);if(V)try{const U=q.details.filter(Z=>Z.sisa_tagihan>0).map((Z,ae)=>`
                    <tr style="background-color: ${ae%2===0?"#ffffff":"#f8fafc"};">
                        <td style="padding: 12px 15px; border-bottom: 1px solid #e2e8f0; color: #334155;">${ae+1}</td>
                        <td style="padding: 12px 15px; border-bottom: 1px solid #e2e8f0; color: #334155;">${Z.deskripsi}</td>
                        <td style="padding: 12px 15px; border-bottom: 1px solid #e2e8f0; color: #334155; text-align: right; font-family: monospace; font-weight: bold;">${ie(Z.sisa_tagihan)}</td>
                    </tr>
                `).join(""),re={to_name:q.wali||"Wali Santri",to_email:V.trim(),nama_santri:q.nama,id_santri:q.id_santri,kelas_santri:q.kelas,table_rows:U,total_tagihan:ie(q.total_tunggakan)};await ba.send(j,N,re,A),v++,P(Z=>({...Z,batchSuccess:v}))}catch(J){console.error(`Gagal kirim ke ${q.nama}:`,J),R++,P(U=>({...U,batchFailed:R}))}else console.warn(`Skip ${q.nama}: No Email`),R++,P(J=>({...J,batchFailed:R}));await new Promise(J=>setTimeout(J,1500))}P(W=>({...W,status:"batch_report",title:"Pengiriman Selesai",message:`Berhasil: ${v}, Gagal: ${R}`})),k(!1)},l=async()=>{if(!y.student)return;const{student:n,primaryEmail:v}=y;z(R=>({...R,isOpen:!1})),k(!0),P({isOpen:!0,status:"loading",title:"Mengirim Email",message:`Sedang mengirim ke ${v}...`});try{const W=n.details.filter(J=>J.sisa_tagihan>0).map((J,U)=>`
              <tr style="background-color: ${U%2===0?"#ffffff":"#f8fafc"};">
                  <td style="padding: 12px 15px; border-bottom: 1px solid #e2e8f0; color: #334155;">${U+1}</td>
                  <td style="padding: 12px 15px; border-bottom: 1px solid #e2e8f0; color: #334155;">${J.deskripsi}</td>
                  <td style="padding: 12px 15px; border-bottom: 1px solid #e2e8f0; color: #334155; text-align: right; font-family: monospace; font-weight: bold;">${ie(J.sisa_tagihan)}</td>
              </tr>
          `).join(""),q={to_name:n.wali||"Wali Santri",to_email:v.trim(),nama_santri:n.nama,id_santri:n.id_santri,kelas_santri:n.kelas,table_rows:W,total_tagihan:ie(n.total_tunggakan)};if(!ba||!ba.send)throw new Error("EmailJS library belum siap.");const V=await ba.send(j,N,q,A);if(V.status===200)P({isOpen:!0,status:"success",title:"Email Terkirim!",message:`Tagihan berhasil dikirim ke akun: ${v}`}),setTimeout(()=>{P(J=>({...J,isOpen:!1})),k(!1)},2500);else throw new Error(`EmailJS Error: ${V.text}`)}catch(R){console.error("Gagal kirim email:",R),P({isOpen:!0,status:"error",title:"Gagal Mengirim",message:R.text||R.message||"Terjadi kesalahan koneksi."}),k(!1)}},I=async(n,v)=>{if(n.stopPropagation(),v.status_keuangan==="Lunas"){alert("Tidak dapat mengirim notifikasi tagihan karena status sudah Lunas.");return}if(confirm(`Kirim notifikasi in-app ke ${v.nama}?`)){k(!0);try{const R=await G.getWaliNotifikasi(),W=Array.isArray(R)?R:[],V=[{verifikasi_akun:{id_notifikasi:`NTF-BILL-${Date.now()}`,id_santri:v.id_santri},notifikasi:{kategori:"payment",judul:"Pemberitahuan Tunggakan",pesan:`Assalamu’alaikum. Akumulasi tunggakan administrasi saat ini sebesar ${ie(v.total_tunggakan)}. Mohon segera melakukan pembayaran.`,waktu:new Date().toLocaleString("id-ID",{dateStyle:"medium",timeStyle:"short"}),dibaca:!1}},...W];await G.updatePublicContent("realtime/notifikasi",V),r("waliNotifikasi",V),alert("Notifikasi berhasil dikirim ke aplikasi wali.")}catch(R){console.error("Gagal kirim notifikasi",R)}finally{k(!1)}}};return t?e.jsx(fe,{message:"Menghitung Tunggakan...",fullScreen:!1}):e.jsxs("div",{className:"space-y-6 animate-fade-in font-sans pb-24 relative min-h-[600px]",children:[y.isOpen&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm animate-fade-in px-4",children:e.jsxs("div",{className:"bg-white rounded-3xl p-6 md:p-8 max-w-md w-full shadow-2xl transform scale-100 transition-all border border-gray-100",children:[e.jsx("h3",{className:"font-serif font-bold text-2xl mb-4 text-slate-800",children:"Konfirmasi Kirim Email"}),e.jsxs("div",{className:"space-y-4 mb-6 text-sm text-slate-600",children:[e.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-100",children:[e.jsx("p",{className:"text-[10px] uppercase font-bold text-blue-500 mb-1",children:"Akun Penerima"}),e.jsx("p",{className:"font-bold text-slate-800 break-all",children:y.primaryEmail})]}),e.jsxs("p",{children:["Anda akan mengirim rincian tagihan untuk santri ",e.jsx("strong",{children:(_=y.student)==null?void 0:_.nama})," ke email akun aplikasi yang terdaftar."]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>z(n=>({...n,isOpen:!1})),className:"flex-1 py-3 bg-slate-100 text-slate-600 font-bold rounded-xl hover:bg-slate-200 transition",children:"Batal"}),e.jsx("button",{onClick:l,className:"flex-1 py-3 bg-emerald-600 text-white font-bold rounded-xl hover:bg-emerald-700 transition shadow-lg shadow-emerald-600/20",children:"Kirim Sekarang"})]})]})}),L.isOpen&&e.jsx("div",{className:"fixed inset-0 z-[9999] bg-white animate-fade-in flex flex-col items-center justify-center",children:e.jsxs("div",{className:"w-full max-w-lg px-6 text-center space-y-8 relative",children:[e.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[500px] h-[500px] bg-emerald-50 rounded-full blur-3xl -z-10 opacity-50"}),e.jsxs("div",{className:"flex justify-center mb-4",children:[(L.status==="loading"||L.status==="batch_processing")&&e.jsxs("div",{className:"relative w-24 h-24",children:[e.jsx("div",{className:"absolute inset-0 border-4 border-emerald-100 rounded-full"}),e.jsx("div",{className:"absolute inset-0 border-4 border-emerald-600 rounded-full border-t-transparent animate-spin"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-emerald-600 text-xs font-black",children:L.status==="batch_processing"&&L.batchTotal?Math.round((L.batchCurrent||0)/L.batchTotal*100)+"%":"..."})]}),L.status==="success"&&e.jsx("div",{className:"w-24 h-24 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center animate-fade-in-scale shadow-lg shadow-emerald-200",children:e.jsx("svg",{className:"w-12 h-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})}),L.status==="error"&&e.jsx("div",{className:"w-24 h-24 bg-rose-100 text-rose-600 rounded-full flex items-center justify-center animate-shake shadow-lg shadow-rose-200",children:e.jsx("svg",{className:"w-12 h-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M6 18L18 6M6 6l12 12"})})}),L.status==="batch_report"&&e.jsx("div",{className:"w-24 h-24 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center animate-fade-in-scale shadow-lg shadow-blue-200",children:e.jsx("svg",{className:"w-12 h-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-serif font-bold text-3xl mb-2 text-slate-800",children:L.title}),e.jsx("p",{className:"text-slate-500 text-lg",children:L.message}),L.status==="batch_processing"&&L.currentName&&e.jsxs("p",{className:"text-emerald-600 font-bold mt-2 animate-pulse",children:["Mengirim ke: ",L.currentName]})]}),L.status==="batch_processing"&&L.batchTotal&&e.jsx("div",{className:"w-full bg-gray-100 rounded-full h-4 overflow-hidden border border-gray-200",children:e.jsx("div",{className:"bg-emerald-500 h-full transition-all duration-300 ease-out",style:{width:`${(L.batchCurrent||0)/L.batchTotal*100}%`}})}),L.status==="batch_report"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-6 rounded-2xl border border-gray-200",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:"Berhasil"}),e.jsx("p",{className:"text-2xl font-black text-emerald-600",children:L.batchSuccess})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:"Gagal / Skip"}),e.jsx("p",{className:"text-2xl font-black text-rose-600",children:L.batchFailed})]})]}),(L.status==="error"||L.status==="batch_report")&&e.jsx("button",{onClick:()=>P(n=>({...n,isOpen:!1})),className:"mt-8 px-10 py-4 bg-slate-900 text-white font-bold rounded-2xl hover:bg-black transition shadow-xl",children:"Tutup"})]})}),M==="list"?e.jsxs(e.Fragment,{children:[e.jsx(Vs,{title:"Buku Tunggakan",subtitle:"Monitoring kewajiban dan tagihan santri secara real-time."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[e.jsx(we,{title:"Total Tunggakan",value:T.totalTunggakan,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),color:"rose",description:`${T.jumlahMenunggak} Santri Menunggak`}),e.jsx(we,{title:"Total Tagihan",value:T.totalPotensi,icon:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),color:"blue",description:"Akumulasi Kewajiban"}),e.jsxs("div",{className:"md:col-span-2 bg-white p-6 rounded-[2rem] border border-gray-100 shadow-sm flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-gray-500 font-bold text-xs uppercase tracking-widest mb-1",children:"Rasio Kepatuhan"}),e.jsxs("p",{className:"text-3xl font-black text-emerald-600 font-sans",children:[(T.jumlahLunas/(S.length||1)*100).toFixed(1),"%"]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:[T.jumlahLunas," dari ",S.length," santri lunas."]})]}),e.jsx("div",{className:"h-16 w-16 rounded-full border-4 border-emerald-100 flex items-center justify-center text-emerald-600",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})]}),e.jsxs("div",{className:"bg-white rounded-[2rem] shadow-sm border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex flex-col md:flex-row justify-between items-center gap-4 bg-gray-50/30",children:[e.jsxs("div",{className:"relative flex-1 md:max-w-md w-full",children:[e.jsx("input",{type:"text",placeholder:"Cari Nama / ID Santri...",value:K,onChange:n=>h(n.target.value),className:"w-full pl-10 pr-4 py-3 bg-white border border-gray-200 rounded-xl text-sm font-medium focus:ring-2 focus:ring-emerald-500 outline-none transition shadow-sm"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Le,{label:"Kirim Tagihan Menyeluruh",variant:"primary",onClick:x,icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),className:"h-[42px] whitespace-nowrap bg-emerald-600 hover:bg-emerald-700 text-xs",disabled:c}),e.jsx(sa,{data:b,fileName:`Laporan_Tunggakan_${new Date().toISOString().split("T")[0]}`,title:"Laporan Tunggakan Santri",columns:[{header:"ID Santri",accessor:n=>n.id_santri},{header:"Nama Lengkap",accessor:n=>n.nama},{header:"Kelas",accessor:n=>n.kelas},{header:"Total Wajib",accessor:n=>ie(n.total_wajib)},{header:"Tunggakan",accessor:n=>ie(n.total_tunggakan)},{header:"Status",accessor:n=>n.status_keuangan}]})]})]}),e.jsx(Re,{headers:["ID Santri","Nama Lengkap","Kelas","Total Wajib","Tunggakan","Status","Aksi"],isEmpty:b.length===0,children:b.map(n=>e.jsxs("tr",{className:"hover:bg-gray-50 transition group cursor-pointer",onClick:()=>{C(n),w("detail"),window.scrollTo(0,0)},children:[e.jsx("td",{className:"px-6 py-4 font-mono text-xs font-bold text-gray-500",children:n.id_santri}),e.jsx("td",{className:"px-6 py-4 font-bold text-gray-800",children:n.nama}),e.jsx("td",{className:"px-6 py-4 text-xs text-gray-600",children:n.kelas}),e.jsx("td",{className:"px-6 py-4 text-right text-gray-600 font-sans text-xs font-bold",children:ie(n.total_wajib).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-right font-bold text-rose-600 font-sans text-xs",children:ie(n.total_tunggakan).replace("Rp","")}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx(Pe,{status:n.status_keuangan==="Lunas"?"Lunas":"Menunggak"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:v=>E(v,n),className:"p-2 bg-emerald-50 text-emerald-600 hover:bg-emerald-100 rounded-lg transition border border-emerald-200",title:"Kirim Tagihan via WhatsApp",children:e.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"})})}),e.jsx("button",{onClick:v=>F(v,n),disabled:c,className:"p-2 bg-slate-50 text-slate-600 hover:bg-slate-100 rounded-lg transition border border-slate-200 disabled:opacity-50",title:"Kirim Rincian via Email",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),e.jsx("button",{onClick:v=>I(v,n),disabled:c,className:"p-2 bg-blue-50 text-blue-600 hover:bg-blue-100 rounded-lg transition border border-blue-200 disabled:opacity-50",title:"Kirim Notifikasi Aplikasi",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})})]})})]},n.id_santri))})]})]}):d&&e.jsxs(Dt,{title:`Rincian Tunggakan - ${d.nama}`,className:"animate-fade-in-up",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6 border-b border-gray-100 pb-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-x-8 gap-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-xs uppercase font-bold",children:"ID Santri"}),e.jsx("p",{className:"font-bold",children:d.id_santri})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-xs uppercase font-bold",children:"Kelas"}),e.jsx("p",{className:"font-bold",children:d.kelas})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-xs uppercase font-bold",children:"Wali"}),e.jsxs("p",{className:"font-bold",children:[d.wali," (",d.no_hp,")"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-xs uppercase font-bold",children:"Status"}),e.jsx(Pe,{status:d.status_keuangan})]})]}),e.jsx(Le,{label:"Kembali",variant:"secondary",onClick:()=>w("list"),size:"sm"})]}),e.jsx("div",{className:"flex justify-end mb-4",children:e.jsx(sa,{data:d.details,fileName:`Rincian_Tunggakan_${d.nama}`,title:`Rincian Tunggakan - ${d.nama}`,columns:[{header:"Kategori",accessor:n=>n.kategori},{header:"Deskripsi",accessor:n=>n.deskripsi},{header:"Jatuh Tempo",accessor:n=>n.jatuh_tempo},{header:"Wajib",accessor:n=>ie(n.nominal_tagihan)},{header:"Bayar",accessor:n=>ie(n.nominal_bayar)},{header:"Sisa",accessor:n=>ie(n.sisa_tagihan)},{header:"Status",accessor:n=>n.status}]})}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6 grid grid-cols-3 gap-4 text-center border border-gray-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-bold mb-1",children:"Total Tagihan"}),e.jsx("p",{className:"text-xl font-black text-gray-800 font-sans",children:ie(d.total_wajib)})]}),e.jsxs("div",{className:"border-x border-gray-200",children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-bold mb-1",children:"Sudah Bayar"}),e.jsx("p",{className:"text-xl font-black text-emerald-600 font-sans",children:ie(d.total_bayar)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 uppercase font-bold mb-1",children:"Sisa Kewajiban"}),e.jsx("p",{className:"text-xl font-black text-rose-600 font-sans",children:ie(d.total_tunggakan)})]})]}),e.jsx("div",{className:"overflow-x-auto rounded-xl border border-gray-200",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-gray-100 text-gray-500 font-bold uppercase text-xs border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3",children:"Deskripsi Tagihan"}),e.jsx("th",{className:"px-4 py-3",children:"Jatuh Tempo"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Nominal"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Terbayar"}),e.jsx("th",{className:"px-4 py-3 text-right",children:"Sisa"}),e.jsx("th",{className:"px-4 py-3 text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 bg-white",children:d.details.map(n=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-3 font-medium text-gray-800",children:[n.deskripsi,e.jsx("span",{className:"block text-[10px] text-gray-400 font-normal",children:n.kategori})]}),e.jsx("td",{className:"px-4 py-3 text-xs text-gray-500",children:n.jatuh_tempo}),e.jsx("td",{className:"px-4 py-3 text-right font-sans font-bold text-gray-600",children:ie(n.nominal_tagihan).replace("Rp","")}),e.jsx("td",{className:"px-4 py-3 text-right font-sans text-emerald-600 font-bold",children:ie(n.nominal_bayar).replace("Rp","")}),e.jsx("td",{className:"px-4 py-3 text-right font-sans text-rose-600 font-bold",children:ie(n.sisa_tagihan).replace("Rp","")}),e.jsx("td",{className:"px-4 py-3 text-center",children:e.jsx(Pe,{status:n.status})})]},n.id_item))})]})})]})]})},Pn=[{title:"Manajemen Akun Pengguna",description:"Kelola akun Wali Santri dan Staf. Anda bisa mereset password atau membuat akun baru."},{targetId:"user-search",title:"Cari Akun",description:"Gunakan nama pengguna, email, atau nama santri (untuk Wali) untuk menemukan akun.",position:"bottom"},{targetId:"user-add-btn",title:"Buat Akun",description:"Klik di sini untuk menambahkan akun pengguna baru secara manual.",position:"left"},{targetId:"user-list",title:"Daftar Pengguna",description:"Klik kartu pengguna untuk melihat detail, mengubah password, atau menghapus akun.",position:"top"}],$n=()=>{const[a,r]=s.useState([]),[t,o]=s.useState(!0),[c,k]=s.useState({}),[f,D]=s.useState(!1),[B,p]=s.useState(!1),[m,u]=s.useState(""),[i,g]=s.useState({id_akun:"",id_santri:"-",email:"",peran:"admin_umum",nama:"",status:"terverifikasi",telepon:"",hash_kata_sandi:"",dibuat:"",akses:[],filter_santri:""});s.useEffect(()=>{K()},[]);const K=async()=>{o(!0);try{const[y,z]=await Promise.all([G.getDatabaseAkun(),G.getDatabaseSantri()]),j=Array.isArray(y)?y:[],N=Array.isArray(z)?z:[],A=j.map(S=>{var $,E;let b="";const T=($=S.verifikasi_akun)==null?void 0:$.id_santri;if(T&&T!=="-"&&T.length>3){const F=N.find(x=>{var l;return((l=x.verifikasi_santri)==null?void 0:l.id_santri)===T});F?b=((E=F.data_santri)==null?void 0:E.nama_lengkap)||"Nama Tidak Ditemukan":b="Data Santri Tidak Ditemukan"}return{...S,data_akun:{...S.data_akun,status:S.data_akun.status||"terverifikasi"},nama_santri_terkait:b}});r(A)}catch(y){console.error("Gagal memuat data user:",y)}finally{o(!1)}},h=(y,z)=>{z.stopPropagation(),k(j=>({...j,[y]:!j[y]}))},M=()=>{p(!1);const y=`ADM-${Date.now().toString().slice(-6)}`;g({id_akun:y,id_santri:"-",email:"",peran:"admin_umum",nama:"",status:"terverifikasi",telepon:"",hash_kata_sandi:"",dibuat:new Date().toISOString(),akses:[],filter_santri:""}),D(!0),window.scrollTo(0,0)},w=y=>{p(!0),g({id_akun:y.verifikasi_akun.id_akun,id_santri:y.verifikasi_akun.id_santri||"-",email:y.data_akun.email||"",peran:y.data_akun.peran,nama:y.data_akun.nama,status:y.data_akun.status||"terverifikasi",telepon:y.data_akun.telepon,hash_kata_sandi:y.data_akun.hash_kata_sandi,dibuat:y.data_akun.dibuat,akses:y.data_akun.akses||[],filter_santri:y.data_akun.filter_santri||""}),D(!0),window.scrollTo(0,0)},d=async(y,z)=>{if(z&&z.stopPropagation(),!window.confirm("Hapus akun ini secara permanen?"))return;const j=a.filter(A=>A.verifikasi_akun.id_akun!==y),N=j.map(({nama_santri_terkait:A,...S})=>S);try{await G.updateRoles(N),r(j),f&&D(!1)}catch{alert("Gagal menghapus.")}},C=async()=>{if(!i.email||!i.nama||!i.hash_kata_sandi){alert("Email, Nama, dan Password wajib diisi.");return}const y={verifikasi_akun:{id_akun:i.id_akun,id_santri:i.id_santri},data_akun:{peran:i.peran,nama:i.nama,status:i.status,email:i.email,telepon:i.telepon,hash_kata_sandi:i.hash_kata_sandi,dibuat:i.dibuat||new Date().toISOString(),akses:i.akses,filter_santri:i.filter_santri||""}};let z=[...a];B?z=z.map(N=>N.verifikasi_akun.id_akun===i.id_akun?{...y,nama_santri_terkait:N.nama_santri_terkait}:N):z.push(y);const j=z.map(({nama_santri_terkait:N,...A})=>A);try{await G.updateRoles(j),K(),D(!1)}catch{alert("Gagal menyimpan data.")}},L=a.filter(y=>y.data_akun.nama.toLowerCase().includes(m.toLowerCase())||y.data_akun.email.toLowerCase().includes(m.toLowerCase())||y.verifikasi_akun.id_akun.toLowerCase().includes(m.toLowerCase())||y.nama_santri_terkait&&y.nama_santri_terkait.toLowerCase().includes(m.toLowerCase())),P=y=>{switch(y){case"admin_sistem":return"danger";case"admin_umum":return"info";case"admin_koperasi":return"warning";default:return"success"}};return t?e.jsx("div",{className:"p-12 text-center text-slate-400 font-sans animate-pulse",children:"Memuat database pengguna..."}):e.jsxs(la,{children:[e.jsx(ve,{tourId:"sys_pengguna",steps:Pn}),!f&&e.jsxs("div",{className:"font-sans",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-end items-center gap-4 mb-6",children:[e.jsxs("div",{id:"user-search",className:"relative flex-1 md:max-w-xs w-full",children:[e.jsx("input",{type:"text",placeholder:"Cari user / santri...",value:m,onChange:y=>u(y.target.value),className:"w-full pl-9 pr-4 py-2.5 bg-white border border-slate-200 rounded-xl text-xs font-bold text-slate-700 outline-none focus:ring-2 focus:ring-slate-500 transition shadow-sm"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("div",{id:"user-add-btn",children:e.jsx(ye,{label:"Tambah",onClick:M,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})]}),e.jsx("div",{id:"user-list",children:e.jsx(at,{children:L.length>0?L.map(y=>e.jsx("div",{onClick:()=>w(y),className:"bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-all group cursor-pointer relative overflow-hidden flex flex-col font-sans",children:e.jsxs("div",{className:"p-5 flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center text-white font-bold text-lg shadow-sm ${y.data_akun.peran==="admin_sistem"?"bg-rose-600":y.data_akun.peran==="admin_umum"?"bg-blue-600":y.data_akun.peran==="admin_koperasi"?"bg-amber-500":"bg-emerald-600"}`,children:y.data_akun.nama.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900 leading-tight line-clamp-1",children:y.data_akun.nama}),e.jsxs("div",{className:"flex gap-2 mt-1",children:[e.jsx(Ue,{label:y.data_akun.peran,variant:P(y.data_akun.peran),className:"text-[9px] px-1.5 py-0"}),y.data_akun.filter_santri&&e.jsxs("span",{className:"text-[9px] px-1.5 py-0 rounded border bg-purple-50 text-purple-700 border-purple-100 uppercase font-bold tracking-wider",children:["Scope: ",y.data_akun.filter_santri]})]})]})]}),e.jsx("div",{className:"flex flex-col items-end gap-1",children:e.jsx("span",{className:"text-[9px] font-mono text-slate-400 bg-slate-50 px-1.5 py-0.5 rounded border border-slate-100",children:y.verifikasi_akun.id_akun})})]}),y.nama_santri_terkait&&e.jsxs("div",{className:"mb-4 bg-emerald-50/50 border border-emerald-100 rounded-lg p-2.5 flex items-start gap-2",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-emerald-600 mt-0.5 shrink-0",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[9px] font-bold text-emerald-700 uppercase",children:"Wali Santri"}),e.jsx("p",{className:"text-xs font-semibold text-slate-700 leading-tight",children:y.nama_santri_terkait})]})]}),e.jsxs("div",{className:"space-y-2 mt-auto",children:[e.jsx(ca,{label:"Email",value:y.data_akun.email}),e.jsxs("div",{className:"flex justify-between items-center py-2",children:[e.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase",children:"Password"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-mono font-bold text-slate-700",children:c[y.verifikasi_akun.id_akun]?y.data_akun.hash_kata_sandi:"••••••••"}),e.jsx("button",{onClick:z=>h(y.verifikasi_akun.id_akun,z),className:"text-slate-400 hover:text-slate-600",children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-3.5 w-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]})]})]})},y.verifikasi_akun.id_akun)):e.jsx("div",{className:"col-span-full text-center py-20 bg-white rounded-xl border border-slate-200 border-dashed text-slate-400 text-sm font-sans",children:"Tidak ada data pengguna."})})})]}),f&&e.jsx(He,{title:B?"Edit Data User":"Tambah User Baru",className:"max-w-3xl mx-auto animate-fade-in-up font-sans",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-slate-50 cursor-not-allowed",placeholder:" ",value:i.id_akun,readOnly:!0}),e.jsx("label",{className:"floating-label",children:"ID Akun (Auto)"})]}),e.jsx(de,{id:"role-peran",label:"Peran Sistem",value:i.peran,onChange:y=>g({...i,peran:y}),options:[{value:"admin_umum",label:"Admin Umum"},{value:"admin_koperasi",label:"Admin Koperasi"},{value:"admin_sistem",label:"Admin Sistem (Super)"},{value:"wali",label:"Wali Santri"},{value:"guru",label:"Guru / Pengajar"}],className:"!mb-0"}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:i.nama,onChange:y=>g({...i,nama:y.target.value})}),e.jsx("label",{className:"floating-label",children:"Nama Lengkap"})]}),e.jsx(de,{id:"user-status",label:"Status Akun",value:i.status,onChange:y=>g({...i,status:y}),options:[{value:"terverifikasi",label:"Terverifikasi"},{value:"belum_terverifikasi",label:"Belum Terverifikasi"}],className:"!mb-0"}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"email",className:"floating-input peer",placeholder:" ",value:i.email,onChange:y=>g({...i,email:y.target.value})}),e.jsx("label",{className:"floating-label",children:"Email (Username)"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:i.hash_kata_sandi,onChange:y=>g({...i,hash_kata_sandi:y.target.value})}),e.jsx("label",{className:"floating-label",children:"Password"})]}),e.jsx($a,{id:"telp-user",label:"Nomor Telepon / WA",value:i.telepon,onChange:y=>g({...i,telepon:y})}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:`floating-input peer ${i.peran==="wali"?"border-emerald-500 text-emerald-800 font-bold":""}`,placeholder:" ",value:i.id_santri,onChange:y=>g({...i,id_santri:y.target.value})}),e.jsxs("label",{className:`floating-label ${i.peran==="wali"?"text-emerald-600 font-bold":""}`,children:["ID Santri ",i.peran==="wali"?"(Wajib)":"(Opsional)"]})]}),e.jsxs("div",{className:"md:col-span-2 bg-purple-50 p-4 rounded-xl border border-purple-100",children:[e.jsx("p",{className:"text-xs font-bold text-purple-700 uppercase tracking-widest mb-3",children:"Scope Data (Pembatasan Wilayah)"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsx("button",{onClick:()=>g({...i,filter_santri:""}),className:`p-3 rounded-lg text-xs font-bold transition-all border ${i.filter_santri===""?"bg-purple-600 text-white border-purple-600":"bg-white text-slate-500 border-slate-200 hover:border-purple-300"}`,children:"Semua (Global)"}),e.jsx("button",{onClick:()=>g({...i,filter_santri:"L"}),className:`p-3 rounded-lg text-xs font-bold transition-all border ${i.filter_santri==="L"?"bg-purple-600 text-white border-purple-600":"bg-white text-slate-500 border-slate-200 hover:border-purple-300"}`,children:"Khusus Putra (L)"}),e.jsx("button",{onClick:()=>g({...i,filter_santri:"P"}),className:`p-3 rounded-lg text-xs font-bold transition-all border ${i.filter_santri==="P"?"bg-purple-600 text-white border-purple-600":"bg-white text-slate-500 border-slate-200 hover:border-purple-300"}`,children:"Khusus Putri (P)"})]})]})]}),e.jsxs("div",{className:"flex gap-4 pt-6 border-t border-slate-100",children:[e.jsx(ye,{label:"Batal",variant:"secondary",onClick:()=>D(!1),className:"flex-1"}),B&&e.jsx(ye,{label:"Hapus",variant:"danger",onClick:y=>d(i.id_akun,y),className:"flex-none",icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),e.jsx(ye,{label:"Simpan",variant:"primary",onClick:C,className:"flex-1"})]})]})})]})},zn=[{title:"Pengaturan Akun Anda",description:"Kelola profil pribadi dan keamanan akun Anda di halaman ini."},{targetId:"settings-profile-card",title:"Profil Saya",description:"Informasi dasar akun Anda seperti ID, Nama, dan Peran.",position:"bottom"},{targetId:"settings-form",title:"Edit Informasi",description:"Ubah nama, email, atau password Anda secara mandiri demi keamanan.",position:"top"}],Kn=({id_akun:a,userName:r,userRole:t,userInitial:o,email:c="",accentColor:k="emerald"})=>{const[f,D]=s.useState({nama:r,email:c,password:""}),[B,p]=s.useState(!1);s.useEffect(()=>{D(g=>({...g,nama:r,email:c}))},[r,c]);const m=()=>{switch(k){case"cyan":return"bg-cyan-600 hover:bg-cyan-700 shadow-cyan-600/20";case"yellow":return"bg-amber-600 hover:bg-amber-700 shadow-amber-600/20";case"indigo":return"bg-indigo-600 hover:bg-indigo-700 shadow-indigo-600/20";default:return"bg-emerald-800 hover:bg-emerald-900 shadow-emerald-800/20"}},u=()=>{switch(k){case"cyan":return"bg-cyan-100 text-cyan-600";case"yellow":return"bg-amber-100 text-amber-600";case"indigo":return"bg-indigo-100 text-indigo-600";default:return"bg-emerald-100 text-emerald-800"}},i=()=>{alert("Simulasi: Perubahan disimpan.")};return e.jsxs("div",{className:"space-y-8 animate-fade-in max-w-5xl mx-auto pb-20 font-sans",children:[e.jsx(ve,{tourId:"sys_pengaturan",steps:zn}),e.jsxs("div",{id:"settings-profile-card",className:"bg-white p-8 rounded-[2.5rem] shadow-sm border border-gray-200 flex flex-col md:flex-row items-center gap-8 relative overflow-hidden",children:[e.jsx("div",{className:`absolute top-0 right-0 w-48 h-48 opacity-10 rounded-bl-[4rem] ${u().split(" ")[0]}`}),e.jsxs("div",{className:"relative shrink-0",children:[e.jsx("div",{className:`w-32 h-32 rounded-[2rem] flex items-center justify-center font-bold text-4xl border-[6px] border-white shadow-2xl ${u()}`,children:o}),e.jsx("div",{className:`absolute -bottom-2 -right-2 text-white px-3 py-1 rounded-xl shadow-lg text-[10px] font-black uppercase tracking-widest ${m().split(" ")[0]}`,children:t})]}),e.jsxs("div",{className:"text-center md:text-left flex-1 relative z-10 space-y-2",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-sans font-bold text-gray-900 leading-tight",children:r}),e.jsx("p",{className:"text-emerald-600 font-medium text-sm mb-4 font-sans",children:"Status: Terverifikasi"})]}),e.jsx("div",{className:"flex flex-wrap justify-center md:justify-start gap-2 mt-2",children:e.jsxs("span",{className:"px-3 py-1.5 bg-gray-100 text-gray-600 rounded-lg text-[10px] font-bold uppercase tracking-wider border border-gray-200 flex items-center gap-2 font-sans",children:["ID: ",a||"-"]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx("div",{id:"settings-form",className:"lg:col-span-2 space-y-8",children:e.jsxs("div",{className:"bg-white p-8 rounded-[2.5rem] shadow-sm border border-gray-200",children:[e.jsx("div",{className:"flex justify-between items-center mb-8 border-b border-gray-100 pb-4",children:e.jsx("h3",{className:"font-sans font-bold text-xl text-gray-900",children:"Informasi Akun"})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",value:a,readOnly:!0,className:"floating-input peer bg-gray-50 text-gray-500 cursor-not-allowed border-gray-200 font-sans",placeholder:" "}),e.jsx("label",{className:"floating-label font-sans",children:"ID Akun"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",value:t,readOnly:!0,className:"floating-input peer bg-gray-50 text-gray-500 cursor-not-allowed border-gray-200 font-sans",placeholder:" "}),e.jsx("label",{className:"floating-label font-sans",children:"Peran"})]})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",value:f.nama,onChange:g=>D({...f,nama:g.target.value}),className:"floating-input peer focus:bg-white font-bold text-gray-800 font-sans",placeholder:" "}),e.jsx("label",{className:"floating-label font-sans",children:"Nama Lengkap"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"email",value:f.email,onChange:g=>D({...f,email:g.target.value}),className:"floating-input peer font-bold text-gray-800 font-sans",placeholder:" "}),e.jsx("label",{className:"floating-label font-sans",children:"Email"})]}),e.jsxs("div",{className:"floating-group !mb-0 relative",children:[e.jsx("input",{type:B?"text":"password",value:f.password,onChange:g=>D({...f,password:g.target.value}),className:"floating-input peer font-bold text-gray-800 pr-10 font-sans",placeholder:" "}),e.jsx("label",{className:"floating-label font-sans",children:"Password"}),e.jsx("button",{type:"button",onClick:()=>p(!B),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-emerald-600 font-sans font-bold text-xs",children:B?"Hide":"Show"})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{onClick:i,className:`text-white font-bold py-3.5 px-8 rounded-2xl transition shadow-lg transform hover:-translate-y-1 active:scale-95 text-sm font-sans ${m()}`,children:"Simpan Perubahan"})})]})]})}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white p-6 rounded-[2.5rem] shadow-sm border border-gray-200 h-full",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6 border-b border-gray-100 pb-4",children:[e.jsx("div",{className:"p-2 bg-slate-100 rounded-xl text-slate-600",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-sans font-bold text-lg text-gray-900",children:"Catatan"}),e.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-wider font-sans",children:"Info Penting"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-xs text-gray-600 leading-relaxed font-sans",children:"Pastikan data email dan nomor telepon selalu aktif untuk menerima notifikasi penting terkait aktivitas santri."}),e.jsxs("div",{className:"bg-amber-50 p-4 rounded-xl border border-amber-100",children:[e.jsx("p",{className:"text-[10px] font-bold text-amber-700 uppercase mb-1 font-sans",children:"Perubahan Password"}),e.jsx("p",{className:"text-[10px] text-amber-600 leading-relaxed font-sans",children:"Jika Anda mengubah password, Anda harus login ulang di semua perangkat yang terhubung."})]})]})]})})]})]})},Rn=[{id:"dasar",label:"Dasar"},{id:"beranda",label:"Beranda"},{id:"profil",label:"Profil"},{id:"akademik",label:"Akademik"},{id:"pendaftaran",label:"Pendaftaran"}],bt=[{id:"mobile",label:"Mobile",width:375,height:812,icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M8 21h8a2 2 0 002-2V5a2 2 0 00-2-2H8a2 2 0 00-2 2v14a2 2 0 002 2z"})})},{id:"tablet",label:"Tablet",width:768,height:1024,icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 18h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})},{id:"desktop",label:"Desktop",width:1366,height:768,icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}],Wn=[{title:"CMS & Editor Tampilan",description:"Ubah konten website publik (Landing Page) secara langsung tanpa perlu coding."},{targetId:"cms-page-selector",title:"Pilih Halaman",description:"Navigasi antar halaman website (Beranda, Profil, Akademik, dll) yang ingin diedit.",position:"bottom"},{targetId:"cms-device-tools",title:"Simulasi Perangkat",description:"Lihat pratinjau tampilan website dalam mode Mobile (HP), Tablet, atau Desktop secara real-time.",position:"bottom"},{targetId:"cms-editor-sidebar",title:"Panel Editor",description:"Ubah teks, gambar, dan konfigurasi di sini. Perubahan akan langsung terlihat di layar pratinjau sebelah kanan.",position:"right"},{targetId:"cms-preview-area",title:"Layar Pratinjau",description:"Visualisasi hasil editan Anda. Anda bisa menggeser (drag) area ini jika konten terlalu panjang.",position:"left"}],En=({value:a,onChange:r,className:t,placeholder:o})=>{const c=s.useRef(null);return s.useEffect(()=>{c.current&&(c.current.style.height="auto",c.current.style.height=`${c.current.scrollHeight}px`)},[a]),e.jsx("textarea",{ref:c,className:`${t} overflow-hidden resize-none min-h-[100px]`,rows:1,value:a,onChange:k=>r(k.target.value),placeholder:o})},Hn=()=>{const{fetchData:a,updateCache:r}=ge(),[t,o]=s.useState("dasar"),[c,k]=s.useState(!1),[f,D]=s.useState(bt[0]),[B,p]=s.useState("portrait"),[m,u]=s.useState(.85),[i,g]=s.useState(null),[K,h]=s.useState(!1),M=s.useRef(null);s.useEffect(()=>{(async()=>{k(!0),g(null);try{let N=null;t==="dasar"?N=await a("dasar",G.getDasar,"CMS"):t==="beranda"?N=await a("beranda",G.getBeranda,"CMS"):t==="profil"?N=await a("profil",G.getProfil,"CMS"):t==="akademik"?N=await a("akademik",G.getAkademik,"CMS"):t==="pendaftaran"&&(N=await a("pendaftaranPage",G.getPendaftaranPage,"CMS",!1,!1)),g(Array.isArray(N)?N[0]:N),h(!1)}catch(N){console.error(N)}finally{k(!1)}})()},[t,a]),s.useEffect(()=>{M.current&&(M.current.scrollTop=0),f.id==="mobile"?u(.85):f.id==="tablet"?u(.6):u(.45),p("portrait")},[f]);const w=()=>u(j=>Math.min(j+.05,1.5)),d=()=>u(j=>Math.max(j-.05,.2)),C=async()=>{try{k(!0);let j=i;["dasar","beranda","profil","akademik","pendaftaran"].includes(t)&&(Array.isArray(i)||(j=[i])),await G.updatePublicContent(t,j),r(t,j),h(!1),alert("Perubahan disimpan!")}catch{alert("Gagal menyimpan.")}finally{k(!1)}},L=(j,N)=>{g(A=>{const S=JSON.parse(JSON.stringify(A));let b=S;for(let T=0;T<j.length-1;T++)b=b[j[T]];return b[j[j.length-1]]=N,S}),h(!0)},P=(j,N=[])=>{if(typeof j=="string"||typeof j=="number"){const A=N[N.length-1];if(A==="id")return null;const S=A.replace(/_/g," ").replace(/\b\w/g,T=>T.toUpperCase()),b=typeof j=="string"&&j.length>60||["deskripsi","pesan","alamat","biografi","sambutan","keterangan"].some(T=>A.toLowerCase().includes(T));return e.jsxs("div",{className:"mb-5 bg-white p-3 rounded-xl border border-slate-100 shadow-sm transition-all hover:shadow-md",children:[e.jsx("label",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2 block",children:S}),b?e.jsx(En,{className:"w-full bg-slate-50 border border-slate-200 rounded-lg p-3 text-sm focus:ring-2 focus:ring-emerald-500 outline-none transition focus:bg-white",value:j,onChange:T=>L(N,T),placeholder:`Isi ${S.toLowerCase()}...`}):e.jsx("input",{type:typeof j=="number"?"number":"text",className:"w-full bg-slate-50 border border-slate-200 rounded-lg p-2.5 text-sm font-medium focus:ring-2 focus:ring-emerald-500 outline-none transition focus:bg-white",value:j,onChange:T=>L(N,typeof j=="number"?Number(T.target.value):T.target.value)})]},N.join("."))}return Array.isArray(j)?e.jsxs("div",{className:"mb-8 p-4 bg-slate-50 border border-slate-200 rounded-2xl space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("h4",{className:"text-xs font-bold text-slate-500 uppercase",children:[N[N.length-1]," List"]}),e.jsxs("span",{className:"text-[10px] bg-slate-200 px-2 py-0.5 rounded text-slate-600",children:[j.length," Items"]})]}),j.map((A,S)=>e.jsxs("div",{className:"bg-white p-4 rounded-xl border border-slate-200 shadow-sm relative group",children:[e.jsxs("span",{className:"absolute top-2 right-2 text-[10px] font-mono text-slate-300",children:["#",S+1]}),typeof A=="object"?P(A,[...N,S.toString()]):e.jsx("div",{className:"mt-2",children:e.jsx("input",{type:"text",className:"w-full bg-slate-50 border-none rounded p-2 text-sm",value:A,onChange:b=>L([...N,S.toString()],b.target.value)})})]},S))]},N.join(".")):typeof j=="object"&&j!==null?Object.keys(j).map(A=>e.jsxs("div",{className:N.length===0?"mb-10":"",children:[N.length===0&&e.jsxs("div",{className:"flex items-center gap-2 mb-4 pb-2 border-b border-slate-100",children:[e.jsx("div",{className:"w-1 h-4 bg-emerald-500 rounded-full"}),e.jsx("h3",{className:"text-sm font-bold text-slate-800 uppercase tracking-widest",children:A.replace(/_/g," ")})]}),P(j[A],[...N,A])]},A)):null},y=B==="portrait"?f.width:f.height,z=B==="portrait"?f.height:f.width;return e.jsxs("div",{className:"h-[calc(100vh-120px)] flex flex-col font-sans bg-slate-50 rounded-3xl border border-slate-200 shadow-sm overflow-hidden",children:[e.jsx(ve,{tourId:"sys_tampilan",steps:Wn}),e.jsxs("div",{className:"h-16 bg-white border-b border-slate-200 flex justify-between items-center px-6 shrink-0 z-30",children:[e.jsx("div",{id:"cms-page-selector",className:"flex bg-slate-100 p-1 rounded-xl",children:Rn.map(j=>e.jsx("button",{onClick:()=>o(j.id),className:`px-4 py-1.5 rounded-lg text-xs font-bold transition-all ${t===j.id?"bg-white text-emerald-800 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:j.label},j.id))}),e.jsxs("div",{className:"flex items-center gap-3",children:[t!=="dasar"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"cms-device-tools",className:"flex bg-slate-100 p-1 rounded-xl border border-slate-200 items-center",children:[bt.map(j=>e.jsx("button",{onClick:()=>D(j),className:`p-2 rounded-lg transition-all ${f.id===j.id?"bg-white text-slate-900 shadow-sm":"text-slate-400 hover:text-slate-600"}`,title:j.label,children:j.icon},j.id)),e.jsx("div",{className:"w-px h-5 bg-slate-300 mx-1"}),e.jsx("button",{onClick:()=>p(j=>j==="portrait"?"landscape":"portrait"),className:"p-2 text-slate-500 hover:text-slate-800 rounded-lg hover:bg-white transition",title:"Putar Orientasi",children:e.jsx("svg",{className:`w-4 h-4 transition-transform ${B==="landscape"?"rotate-90":""}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),e.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-xl border border-slate-200 items-center",children:[e.jsx("button",{onClick:d,className:"p-2 text-slate-500 hover:text-slate-800 rounded-lg hover:bg-white transition",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 12H4"})})}),e.jsxs("span",{className:"text-[10px] font-bold text-slate-600 w-10 text-center font-mono select-none",children:[Math.round(m*100),"%"]}),e.jsx("button",{onClick:w,className:"p-2 text-slate-500 hover:text-slate-800 rounded-lg hover:bg-white transition",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]}),e.jsx(ye,{label:c?"...":"Simpan",onClick:C,disabled:!K||c,className:"ml-2"})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{id:"cms-editor-sidebar",className:"w-[380px] bg-white border-r border-slate-200 overflow-y-auto custom-scrollbar p-6 z-20 shadow-[4px_0_24px_rgba(0,0,0,0.02)] shrink-0",children:[e.jsxs("h2",{className:"text-lg font-bold text-slate-900 mb-6 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-emerald-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Editor Konten"]}),c&&!i?e.jsx(fe,{message:"Memuat...",fullScreen:!1}):e.jsx("div",{className:"space-y-2",children:i?P(i):e.jsx("div",{className:"text-center text-slate-400 py-20 text-sm",children:"Data tidak tersedia."})})]}),e.jsx("div",{id:"cms-preview-area",ref:M,className:"flex-1 bg-slate-100 overflow-auto relative cursor-grab active:cursor-grabbing custom-scrollbar",style:{backgroundImage:"radial-gradient(#cbd5e1 1px, transparent 1px)",backgroundSize:"20px 20px"},children:t==="dasar"?e.jsx("div",{className:"min-h-full min-w-full flex items-center justify-center p-8",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-xl p-8 max-w-lg w-full border border-slate-200",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6 border-b border-slate-100 pb-4",children:[(i==null?void 0:i.logo)&&e.jsx("img",{src:i.logo,alt:"Logo",className:"w-16 h-16 object-contain bg-slate-50 rounded-xl p-2"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:(i==null?void 0:i.nama)||"Nama Sekolah"}),e.jsx("p",{className:"text-sm text-emerald-600 font-bold uppercase tracking-widest",children:(i==null?void 0:i.sub_nama)||"Sub Nama"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase",children:"Deskripsi"}),e.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:(i==null?void 0:i.deskripsi_singkat)||"-"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase",children:"Telepon"}),e.jsx("p",{className:"text-sm font-medium text-slate-800",children:(i==null?void 0:i.telepon)||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase",children:"Email"}),e.jsx("p",{className:"text-sm font-medium text-slate-800",children:(i==null?void 0:i.email)||"-"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase",children:"Alamat"}),e.jsx("p",{className:"text-sm text-slate-600",children:(i==null?void 0:i.alamat)||"-"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase",children:"Copyright"}),e.jsx("p",{className:"text-xs text-slate-500 font-mono",children:(i==null?void 0:i.copyright)||"-"})]})]})]})}):e.jsx("div",{className:"min-h-full min-w-full flex items-start justify-center py-12 px-8",children:e.jsxs("div",{className:"bg-white shadow-[0_35px_60px_-15px_rgba(0,0,0,0.3)] transition-all duration-300 relative rounded-[3rem] border-8 border-slate-800 ring-2 ring-slate-900/10 shrink-0",style:{width:`${y}px`,height:`${z}px`,transform:`scale(${m})`,transformOrigin:"top center",marginBottom:`${z*(m-1)}px`},children:[e.jsx("div",{className:"absolute top-20 -left-[10px] w-[3px] h-12 bg-slate-700 rounded-l-md"})," ",e.jsx("div",{className:"absolute top-36 -left-[10px] w-[3px] h-12 bg-slate-700 rounded-l-md"})," ",e.jsx("div",{className:"absolute top-28 -right-[10px] w-[3px] h-16 bg-slate-700 rounded-r-md"})," ",e.jsxs("div",{className:"w-full h-full overflow-hidden bg-white relative rounded-[2.3rem] mask-image: rounded-[2.3rem]",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-8 z-[100] flex justify-center pointer-events-none",children:e.jsxs("div",{className:"w-32 h-7 bg-black rounded-b-3xl flex items-center justify-center gap-3",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-slate-800"}),e.jsx("div",{className:"w-10 h-1.5 rounded-full bg-slate-800/50"})]})}),e.jsxs("div",{className:"absolute top-1 left-6 right-6 z-[99] flex justify-between text-[10px] font-bold text-black mix-blend-difference pointer-events-none",children:[e.jsx("span",{children:"9:41"}),e.jsxs("div",{className:"flex gap-1 items-center",children:[e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-1.07 3.97-2.64 5.39z"})}),e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M15.67 4H14V2h-4v2H8.33C7.6 4 7 4.6 7 5.33v15.33C7 21.4 7.6 22 8.33 22h7.33c.74 0 1.34-.6 1.34-1.33V5.33C17 4.6 16.4 4 15.67 4z"})})]})]}),e.jsx("div",{className:"w-full h-full overflow-y-auto custom-scrollbar pt-8 bg-white",children:e.jsxs("div",{className:(f.id==="mobile",""),children:[t==="beranda"&&e.jsx(yt,{onNavigate:()=>{},onLogin:()=>{},previewData:i}),t==="profil"&&e.jsx(_t,{previewData:i}),t==="akademik"&&e.jsx(St,{previewData:i}),t==="pendaftaran"&&e.jsx(Ct,{previewData:i})]})})]})]})})})]})]})},On=[{title:"Manajemen Publikasi",description:"Pusat kontrol untuk Berita Website dan Notifikasi ke Wali Santri."},{targetId:"pub-tabs",title:"Pilih Mode",description:"Gunakan tab ini untuk berpindah antara pengelolaan Berita Artikel atau Notifikasi Aplikasi.",position:"bottom"},{targetId:"pub-add-btn",title:"Buat Baru",description:"Klik di sini untuk menulis artikel berita baru atau mengirim notifikasi push ke wali santri.",position:"left"},{targetId:"pub-list",title:"Riwayat",description:"Daftar publikasi yang telah diterbitkan. Anda bisa mengedit artikel berita dari sini.",position:"top"}],Fn=()=>{const{fetchData:a}=ge(),[r,t]=s.useState("berita"),[o,c]=s.useState([]),[k,f]=s.useState([]),[D,B]=s.useState([]),[p,m]=s.useState(!0),[u,i]=s.useState(!1),[g,K]=s.useState(!1),[h,M]=s.useState(null),[w,d]=s.useState({timestamp:new Date().toISOString().split("T")[0],judul:"",kategori:"Prestasi",penulis:"Humas",konten:[]}),[C,L]=s.useState({judul:"",kategori:"info",pesan:"",target_santri:"ALL"}),P=s.useRef([]);s.useEffect(()=>{(async()=>{m(!0);try{const[l,I,_]=await Promise.all([a("berita",G.getBerita,"ManajemenPublikasi",!1,!1),a("waliNotifikasi",G.getWaliNotifikasi,"ManajemenPublikasi",!1,!1),a("databaseSantri",G.getDatabaseSantri,"ManajemenPublikasi",!1,!1)]);c(Array.isArray(l)?l:(l==null?void 0:l.item)||[]),f(Array.isArray(I)?I.map(n=>{var v,R,W,q,V,J,U;return{id:(v=n.verifikasi_akun)==null?void 0:v.id_notifikasi,kategori:(R=n.notifikasi)==null?void 0:R.kategori,judul:(W=n.notifikasi)==null?void 0:W.judul,pesan:(q=n.notifikasi)==null?void 0:q.pesan,waktu:(V=n.notifikasi)==null?void 0:V.waktu,dibaca:(J=n.notifikasi)==null?void 0:J.dibaca,target_santri:(U=n.verifikasi_akun)==null?void 0:U.id_santri}}):[]),B(Array.isArray(_)?_:[])}catch(l){console.error(l)}finally{m(!1)}})()},[a]);const y=x=>{const l=P.current[x];l&&(l.style.height="auto",l.style.height=l.scrollHeight+"px")},z=s.useMemo(()=>{const x={value:"ALL",label:"Semua Wali Santri (Broadcast)"},l=D.map(I=>{var _,n,v;return{value:(_=I.verifikasi_santri)==null?void 0:_.id_santri,label:`${(n=I.data_santri)==null?void 0:n.nama_lengkap} (${(v=I.verifikasi_santri)==null?void 0:v.id_santri})`}});return[x,...l]},[D]),j=x=>{d(l=>({...l,konten:[...l.konten,{jenis:x,isi:"",hyperlink:""}]}))},N=(x,l,I)=>{const _=[...w.konten];_[x]={..._[x],[l]:I},d(n=>({...n,konten:_}))},A=x=>{d(l=>({...l,konten:l.konten.filter((I,_)=>_!==x)}))},S=(x,l)=>{if(l==="up"&&x===0||l==="down"&&x===w.konten.length-1)return;const I=[...w.konten],_=l==="up"?x-1:x+1;[I[x],I[_]]=[I[_],I[x]],d(n=>({...n,konten:I}))},b=()=>{if(!w.judul||w.konten.length===0){alert("Judul dan minimal satu konten wajib diisi.");return}let x=[...o];const l={id:g&&h?h:Date.now(),timestamp:new Date(w.timestamp).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"}),judul:w.judul,kategori:w.kategori,penulis:w.penulis,konten:w.konten};g&&h?x=x.map(I=>I.id===h?l:I):x.unshift(l),c(x),i(!1)},T=x=>{d({timestamp:new Date().toISOString().split("T")[0],judul:x.judul,kategori:x.kategori,penulis:x.penulis,konten:x.konten}),M(x.id),K(!0),i(!0),window.scrollTo(0,0)},$=()=>{if(!C.judul||!C.target_santri){alert("Judul dan Target wajib diisi.");return}alert(`Notifikasi dikirim ke: ${C.target_santri}`),i(!1)},E=()=>{i(!0),K(!1),M(null),r==="berita"&&d({timestamp:new Date().toISOString().split("T")[0],judul:"",kategori:"Prestasi",penulis:"Humas",konten:[{jenis:"teks",isi:"",hyperlink:""}]})},F=x=>{const l=x.find(I=>I.jenis==="gambar");return l?l.isi:null};return p?e.jsx(fe,{message:"Memuat Publikasi...",fullScreen:!1}):e.jsxs(la,{children:[e.jsx(ve,{tourId:"sys_publikasi",steps:On}),!u&&e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-white p-2 rounded-xl shadow-sm border border-slate-200 mb-6",children:[e.jsxs("div",{id:"pub-tabs",className:"flex bg-slate-100 p-1 rounded-lg w-full md:w-auto",children:[e.jsx("button",{onClick:()=>t("berita"),className:`px-6 py-2 rounded-md text-xs font-bold transition-all flex-1 md:flex-none ${r==="berita"?"bg-white text-slate-800 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Berita Website"}),e.jsx("button",{onClick:()=>t("notifikasi"),className:`px-6 py-2 rounded-md text-xs font-bold transition-all flex-1 md:flex-none ${r==="notifikasi"?"bg-white text-slate-800 shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:"Notifikasi Wali"})]}),e.jsx("div",{id:"pub-add-btn",children:e.jsx(ye,{label:r==="berita"?"Tulis Berita":"Kirim Notifikasi",onClick:E,icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})]}),u?e.jsxs(He,{title:r==="berita"?g?"Edit Artikel":"Tulis Artikel Baru":"Kirim Notifikasi",className:"max-w-4xl mx-auto animate-fade-in-up",children:[r==="berita"?e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx("input",{type:"text",placeholder:"Judul Berita",value:w.judul,onChange:x=>d({...w,judul:x.target.value}),className:"w-full text-3xl font-bold text-slate-900 placeholder-slate-300 border-none focus:ring-0 p-0 bg-transparent leading-tight font-serif"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 border-b border-slate-100 pb-6",children:[e.jsx(de,{id:"kategori-berita",label:"Kategori",value:w.kategori,onChange:x=>d({...w,kategori:x}),options:[{value:"Prestasi",label:"Prestasi"},{value:"Kegiatan",label:"Kegiatan"},{value:"Fasilitas",label:"Fasilitas"},{value:"Teknologi",label:"Teknologi"}],className:"!mb-0"}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:w.penulis,onChange:x=>d({...w,penulis:x.target.value})}),e.jsx("label",{className:"floating-label",children:"Penulis"})]}),e.jsx(ze,{id:"tgl-berita",label:"Tanggal",value:w.timestamp,onChange:x=>d({...w,timestamp:x}),className:"!mb-0"})]})]}),e.jsxs("div",{className:"space-y-4",children:[w.konten.map((x,l)=>e.jsxs("div",{className:"relative group p-4 border border-slate-100 rounded-xl hover:border-slate-300 transition-all bg-slate-50/50",children:[e.jsxs("div",{className:"absolute right-2 top-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity z-10",children:[e.jsx("button",{onClick:()=>S(l,"up"),className:"p-1 bg-white border border-slate-200 rounded shadow-sm text-slate-400 hover:text-blue-600",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})})}),e.jsx("button",{onClick:()=>S(l,"down"),className:"p-1 bg-white border border-slate-200 rounded shadow-sm text-slate-400 hover:text-blue-600",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}),e.jsx("button",{onClick:()=>A(l),className:"p-1 bg-white border border-slate-200 rounded shadow-sm text-rose-400 hover:text-rose-600",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),x.jenis==="teks"&&e.jsx("textarea",{ref:I=>{P.current[l]=I},className:"w-full bg-transparent border-none p-0 text-slate-700 resize-none focus:ring-0 placeholder-slate-300",placeholder:"Tulis paragraf...",value:x.isi,onChange:I=>{N(l,"isi",I.target.value),y(l)},onFocus:()=>y(l)}),x.jenis==="gambar"&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-white",placeholder:" ",value:x.isi,onChange:I=>N(l,"isi",I.target.value)}),e.jsx("label",{className:"floating-label",children:"URL Gambar"})]}),x.isi&&e.jsx("img",{src:x.isi,alt:"Preview",className:"h-32 object-cover rounded-lg border border-slate-200"})]}),x.jenis==="tombol"&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-white",placeholder:" ",value:x.isi,onChange:I=>N(l,"isi",I.target.value)}),e.jsx("label",{className:"floating-label",children:"Label Tombol"})]}),e.jsxs("div",{className:"flex-1 floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-white",placeholder:" ",value:x.hyperlink,onChange:I=>N(l,"hyperlink",I.target.value)}),e.jsx("label",{className:"floating-label",children:"Link URL"})]})]})]},l)),e.jsxs("div",{className:"flex justify-center gap-2 pt-4",children:[e.jsx("button",{onClick:()=>j("teks"),className:"px-3 py-1.5 rounded-full border border-slate-200 text-xs font-bold text-slate-500 hover:bg-slate-50",children:"+ Teks"}),e.jsx("button",{onClick:()=>j("gambar"),className:"px-3 py-1.5 rounded-full border border-slate-200 text-xs font-bold text-slate-500 hover:bg-slate-50",children:"+ Gambar"}),e.jsx("button",{onClick:()=>j("tombol"),className:"px-3 py-1.5 rounded-full border border-slate-200 text-xs font-bold text-slate-500 hover:bg-slate-50",children:"+ Tombol"})]})]})]}):e.jsxs("div",{className:"space-y-6 max-w-2xl mx-auto",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:C.judul,onChange:x=>L({...C,judul:x.target.value})}),e.jsx("label",{className:"floating-label",children:"Judul Notifikasi"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(de,{id:"kategori-notif",label:"Kategori",value:C.kategori,onChange:x=>L({...C,kategori:x}),options:[{value:"info",label:"Info"},{value:"academic",label:"Akademik"},{value:"payment",label:"Keuangan"}],className:"!mb-0"}),e.jsx(de,{id:"target-santri",label:"Target",value:C.target_santri,onChange:x=>L({...C,target_santri:x}),options:z,className:"!mb-0"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("textarea",{className:"floating-input peer h-32 py-3",placeholder:" ",value:C.pesan,onChange:x=>L({...C,pesan:x.target.value})}),e.jsx("label",{className:"floating-label",children:"Pesan"})]})]}),e.jsxs("div",{className:"pt-8 border-t border-slate-100 flex gap-4 mt-8",children:[e.jsx(ye,{label:"Batal",variant:"secondary",onClick:()=>i(!1),className:"flex-1"}),e.jsx(ye,{label:g?"Simpan":"Terbitkan",variant:"primary",onClick:r==="berita"?b:$,className:"flex-1"})]})]}):r==="berita"?e.jsxs("div",{id:"pub-list",className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[e.jsx("div",{className:"p-4 border-b border-slate-100 bg-slate-50/50",children:e.jsx("h3",{className:"font-bold text-slate-800 text-sm uppercase tracking-wide",children:"Daftar Berita"})}),e.jsx("div",{className:"divide-y divide-slate-100",children:o.map((x,l)=>{var _;const I=F(x.konten);return e.jsxs("div",{className:"p-5 hover:bg-slate-50 transition group flex flex-col md:flex-row justify-between items-start gap-4",children:[e.jsxs("div",{className:"flex-1 flex gap-4 w-full",children:[e.jsx("div",{className:"w-20 h-20 shrink-0 bg-slate-100 rounded-lg overflow-hidden border border-slate-200 flex items-center justify-center",children:I?e.jsx("img",{src:I,alt:"",className:"w-full h-full object-cover"}):e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-slate-300",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ue,{label:x.kategori,variant:"info"}),e.jsx("span",{className:"text-[10px] text-slate-400 font-mono",children:x.timestamp})]}),e.jsx("h4",{className:"text-base font-bold text-slate-900 group-hover:text-blue-700 transition leading-tight mb-1",children:x.judul}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-2",children:((_=x.konten.find(n=>n.jenis==="teks"))==null?void 0:_.isi)||"No preview available."})]})]}),e.jsx("div",{className:"flex gap-2 shrink-0 self-start md:self-center w-full md:w-auto mt-2 md:mt-0",children:e.jsx(ye,{size:"sm",label:"Edit",variant:"secondary",onClick:()=>T(x),className:"w-full md:w-auto justify-center"})})]},l)})})]}):e.jsxs("div",{id:"pub-list",className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm",children:[e.jsx("div",{className:"p-4 border-b border-slate-100 bg-slate-50/50",children:e.jsx("h3",{className:"font-bold text-slate-800 text-sm uppercase tracking-wide",children:"Riwayat Notifikasi"})}),e.jsx("div",{className:"divide-y divide-slate-100",children:k.map((x,l)=>e.jsxs("div",{className:"p-5 hover:bg-slate-50 transition group flex gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-slate-100 flex items-center justify-center text-slate-500 shrink-0",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h4",{className:"text-sm font-bold text-slate-900",children:x.judul}),e.jsx("span",{className:"text-[10px] text-slate-400 font-mono",children:x.waktu})]}),e.jsx("p",{className:"text-xs text-slate-600 mb-2",children:x.pesan}),e.jsx(Ue,{label:x.target_santri==="ALL"?"Broadcast":x.target_santri||"Unknown",variant:x.target_santri==="ALL"?"warning":"neutral"})]})]},l))})]})]})},Vn=[{title:"Manajemen Galeri & Postingan",description:"Kelola konten visual yang tampil di halaman Galeri dan Fasilitas website publik."},{targetId:"post-header",title:"Tambah Postingan",description:"Klik tombol ini untuk mengunggah foto kegiatan, fasilitas baru, atau prestasi santri.",position:"bottom"},{targetId:"post-filters",title:"Filter Kategori",description:"Saring konten berdasarkan kategori (Kegiatan, Fasilitas, Prestasi) untuk memudahkan pencarian.",position:"bottom"},{targetId:"post-grid",title:"Daftar Konten",description:"Klik pada kartu postingan untuk mengedit detailnya. Gunakan ikon hapus di pojok kanan atas kartu untuk menghapus.",position:"top"}],Gn=()=>{const{fetchData:a,updateCache:r}=ge(),[t,o]=s.useState([]),[c,k]=s.useState(!0),[f,D]=s.useState("Semua"),[B,p]=s.useState(""),[m,u]=s.useState(!1),[i,g]=s.useState(!1),[K,h]=s.useState(null),M={timestamp:new Date().toISOString().split("T")[0],tipe:"Kegiatan",judul:"",keterangan:"",link:"",link_aksi:"",ratio:"4:3"},[w,d]=s.useState(M);s.useEffect(()=>{(async()=>{k(!0);try{const A=await a("galeri",G.getGaleri,"ManajemenPostingan",!1,!1),S=Array.isArray(A)?A:(A==null?void 0:A.item)||[];o(S)}catch(A){console.error("Gagal memuat postingan:",A)}finally{k(!1)}})()},[a]);const C=s.useMemo(()=>["Semua",...Array.from(new Set(t.map(A=>A.tipe).filter(Boolean)))],[t]),L=s.useMemo(()=>{let N=t;if(f!=="Semua"&&(N=N.filter(A=>A.tipe===f)),B){const A=B.toLowerCase();N=N.filter(S=>S.judul.toLowerCase().includes(A)||S.keterangan.toLowerCase().includes(A))}return N},[t,f,B]),P=(N=null)=>{N!==null?(h(N),d(t[N]),g(!0)):(h(null),d(M),g(!1)),u(!0),window.scrollTo(0,0)},y=async(N,A)=>{if(A&&A.stopPropagation(),!!confirm("Hapus postingan ini?")){k(!0);try{const S=t.filter((b,T)=>T!==N);await G.updatePublicContent("galeri",S),r("galeri",S),o(S)}catch{alert("Gagal menghapus.")}finally{k(!1)}}},z=async()=>{if(!w.judul||!w.link){alert("Judul dan Link Gambar wajib diisi.");return}k(!0);try{let N=[...t];i&&K!==null?N[K]=w:N.unshift(w),await G.updatePublicContent("galeri",N),r("galeri",N),o(N),u(!1)}catch{alert("Gagal menyimpan data.")}finally{k(!1)}},j=N=>N.replace(":","/");return c&&!t?e.jsx(fe,{message:"Memuat Konten...",fullScreen:!1}):e.jsxs(la,{children:[e.jsx(ve,{tourId:"sys_postingan",steps:Vn}),m?e.jsxs(He,{title:i?"Edit Postingan":"Buat Postingan Baru",className:"max-w-4xl mx-auto animate-fade-in-up",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(de,{id:"tipe-post",label:"Kategori",value:w.tipe,onChange:N=>d({...w,tipe:N}),options:[{value:"Kegiatan",label:"Kegiatan Santri"},{value:"Fasilitas",label:"Fasilitas & Sarpras"},{value:"Prestasi",label:"Prestasi & Penghargaan"}],className:"!mb-0"}),e.jsx(ze,{id:"tgl-post",label:"Tanggal",value:w.timestamp,onChange:N=>d({...w,timestamp:N}),className:"!mb-0"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:w.judul,onChange:N=>d({...w,judul:N.target.value})}),e.jsx("label",{className:"floating-label",children:"Judul Postingan"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("textarea",{className:"floating-input peer h-32 py-3",placeholder:" ",value:w.keterangan,onChange:N=>d({...w,keterangan:N.target.value})}),e.jsx("label",{className:"floating-label",children:"Keterangan"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(de,{id:"ratio-post",label:"Aspek Rasio",value:w.ratio,onChange:N=>d({...w,ratio:N}),options:[{value:"1:1",label:"Kotak (1:1)"},{value:"4:3",label:"Standar (4:3)"},{value:"16:9",label:"Landscape (16:9)"},{value:"9:16",label:"Potrait (9:16)"}],className:"!mb-0"}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:w.link_aksi,onChange:N=>d({...w,link_aksi:N.target.value})}),e.jsx("label",{className:"floating-label",children:"Link Aksi (Opsional)"})]})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer font-mono text-sm",placeholder:" ",value:w.link,onChange:N=>d({...w,link:N.target.value})}),e.jsx("label",{className:"floating-label",children:"URL Gambar"})]})]}),e.jsxs("div",{className:"bg-slate-50 rounded-xl p-6 border border-slate-200 flex flex-col items-center justify-center",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest mb-4",children:"Preview Tampilan"}),e.jsxs("div",{className:"w-full max-w-sm bg-white rounded-xl shadow-lg overflow-hidden border border-slate-100",children:[e.jsxs("div",{className:"relative w-full bg-slate-200",style:{aspectRatio:j(w.ratio||"4:3")},children:[w.link?e.jsx("img",{src:w.link,alt:"Preview",className:"w-full h-full object-cover",onError:N=>N.currentTarget.src="https://placehold.co/600x400?text=Error+Image"}):e.jsx("div",{className:"flex items-center justify-center h-full text-slate-400 text-xs",children:"No Image"}),e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx("span",{className:"bg-white/90 text-slate-800 px-2 py-0.5 rounded text-[10px] font-bold uppercase shadow-sm",children:w.tipe})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h4",{className:"font-serif font-bold text-base text-slate-900 leading-tight mb-1",children:w.judul||"Judul Postingan"}),e.jsx("p",{className:"text-xs text-slate-500 line-clamp-2",children:w.keterangan||"Keterangan..."})]})]})]})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-100 flex gap-4",children:[e.jsx(ye,{label:"Batal",variant:"secondary",onClick:()=>u(!1),className:"flex-1"}),e.jsx(ye,{label:i?"Simpan Perubahan":"Simpan Postingan",variant:"primary",onClick:z,className:"flex-1"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"post-header",children:e.jsx(et,{title:"Galeri & Postingan",subtitle:"Manajemen konten visual untuk kegiatan, fasilitas, dan prestasi.",action:e.jsx(ye,{label:"Tambah Post",onClick:()=>P(null),icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})}),e.jsxs("div",{id:"post-filters",className:"flex flex-col md:flex-row justify-between items-center gap-4 bg-white p-2 rounded-xl shadow-sm border border-slate-200 mb-6",children:[e.jsx("div",{className:"flex gap-2 overflow-x-auto w-full md:w-auto p-1 scrollbar-hide",children:C.map(N=>e.jsx("button",{onClick:()=>D(N),className:`px-4 py-2 rounded-lg text-xs font-bold transition-all whitespace-nowrap ${f===N?"bg-slate-900 text-white shadow":"text-slate-500 hover:text-slate-800 hover:bg-slate-50"}`,children:N},N))}),e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("input",{type:"text",placeholder:"Cari postingan...",value:B,onChange:N=>p(N.target.value),className:"w-full pl-9 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-lg text-xs font-bold text-slate-700 outline-none focus:ring-2 focus:ring-slate-500 transition"}),e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-slate-400 absolute left-3 top-1/2 -translate-y-1/2 pointer-events-none",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]})]}),e.jsx("div",{id:"post-grid",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:L.length>0?L.map((N,A)=>e.jsxs("div",{onClick:()=>P(t.indexOf(N)),className:"bg-white rounded-xl border border-slate-200 overflow-hidden shadow-sm hover:shadow-lg transition-all group flex flex-col h-full relative cursor-pointer",children:[e.jsx("div",{className:"absolute top-2 right-2 flex gap-1 z-20 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("button",{onClick:S=>y(t.indexOf(N),S),className:"p-1.5 bg-white/90 backdrop-blur text-rose-600 rounded-lg shadow hover:bg-white",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})}),e.jsxs("div",{className:"relative w-full aspect-video bg-slate-100 overflow-hidden",children:[e.jsx("img",{src:N.link,alt:N.judul,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}),e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx(Ue,{label:N.tipe,variant:"neutral",className:"bg-white/90 backdrop-blur shadow-sm border-transparent"})})]}),e.jsxs("div",{className:"p-4 flex flex-col flex-1",children:[e.jsx("h4",{className:"font-bold text-slate-900 text-sm mb-1 line-clamp-1",children:N.judul}),e.jsx("p",{className:"text-slate-500 text-xs line-clamp-2 mb-3 flex-1",children:N.keterangan}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t border-slate-50 mt-auto",children:[e.jsx("span",{className:"text-[10px] text-slate-400 font-mono",children:N.timestamp}),e.jsx("span",{className:"text-[10px] font-bold text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity",children:"Edit Post"})]})]})]},A)):e.jsx("div",{className:"col-span-full py-20 text-center text-slate-400 bg-white rounded-xl border border-dashed border-slate-200",children:"Belum ada postingan."})})]})]})},Un=[{title:"Manajemen Program Donasi",description:"Kelola kampanye penggalangan dana, wakaf, dan infaq yang akan ditampilkan di halaman publik."},{targetId:"donasi-header",title:"Buat Kampanye",description:"Klik tombol 'Buat Program' untuk memulai penggalangan dana baru (misal: Pembangunan Masjid).",position:"bottom"},{targetId:"donasi-grid",title:"Daftar Kampanye",description:"Setiap kartu menampilkan status progress terkini (real-time) dari donasi yang masuk.",position:"top"}],Jn=()=>{const{fetchData:a,updateCache:r}=ge(),[t,o]=s.useState([]),[c,k]=s.useState([]),[f,D]=s.useState(!0),[B,p]=s.useState(!1),[m,u]=s.useState(!1),[i,g]=s.useState(null),K={id_donasi:"",kategori:"Pembangunan",pos:"Bangunan",judul:"",gambar:[],target:{waktu:new Date().toISOString().split("T")[0],nominal:0},deskripsi:""},[h,M]=s.useState(K),[w,d]=s.useState("");s.useEffect(()=>{(async()=>{D(!0);try{const[b,T]=await Promise.all([a("donasi",G.getDonasiRencana,"ManajemenDonasi",!1,!1),a("keuanganTransaksi",G.getKeuanganTransaksi,"ManajemenDonasi",!0,!1)]),$=Array.isArray(b)?b:(b==null?void 0:b.rencana)||[];o($),k(Array.isArray(T)?T:[])}catch(b){console.error("Gagal memuat donasi:",b)}finally{D(!1)}})()},[a]);const C=S=>{if(!c.length)return S.terkumpul||0;const $=c.filter(E=>{var x;const F=(E.status||((x=E.jenis_transaksi)==null?void 0:x.status)||"").toLowerCase();return E.jenis==="masuk"&&["selesai","lunas","verified","success","terverifikasi"].includes(F)}).filter(E=>{var _,n;if((((_=E.peruntukan)==null?void 0:_.id_ref)||E.id_donasi)===S.id_donasi)return!0;const x=(((n=E.peruntukan)==null?void 0:n.kategori)||"").toLowerCase(),l=S.kategori.toLowerCase(),I=S.judul.toLowerCase();return!!(l==="pembangunan"&&(x.includes("bangunan")||x.includes("gedung"))||l==="wakaf"&&x.includes("wakaf")||x&&I.includes(x)&&x.length>3)}).reduce((E,F)=>{var l;const x=(l=F.pembayaran)!=null&&l.nominal?Number(F.pembayaran.nominal):Number(F.nominal)||0;return E+x},0);return $>0?$:S.terkumpul||0},L=(S=null)=>{if(S){const b=t.find(T=>T.id_donasi===S);b&&(M({...b,target:{...b.target}}),g(S),u(!0))}else g(null),M({...K,id_donasi:`CMP-${Date.now().toString().slice(-6)}`}),u(!1);p(!0),window.scrollTo(0,0)},P=async(S,b)=>{if(b.stopPropagation(),!!confirm("Hapus program ini?")){D(!0);try{const T=t.filter($=>$.id_donasi!==S);await G.updateDonasiRencana(T),r("donasi",T),o(T)}catch{alert("Gagal menghapus.")}finally{D(!1)}}},y=async()=>{if(!h.judul||!h.target.nominal||h.gambar.length===0){alert("Judul, Nominal Target, dan Minimal 1 Gambar wajib diisi.");return}D(!0);try{const S={...h,pos:h.pos||"Operasional"};let b=[...t];m&&i?b=b.map(T=>T.id_donasi===i?S:T):b.push(S),await G.updateDonasiRencana(b),r("donasi",b),o(b),p(!1),d("")}catch{alert("Gagal menyimpan data.")}finally{D(!1)}},z=()=>{w&&(M(S=>({...S,gambar:[...S.gambar,w]})),d(""))},j=S=>{M(b=>({...b,gambar:b.gambar.filter((T,$)=>$!==S)}))},N=(S,b)=>b===0?0:Math.min(100,Math.round(S/b*100)),A=S=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(S).replace("Rp","Rp ");return f&&!t?e.jsx(fe,{message:"Memuat Program Donasi...",fullScreen:!1}):e.jsxs(la,{children:[e.jsx(ve,{tourId:"sys_donasi",steps:Un}),B?e.jsx(He,{title:m?"Edit Program Donasi":"Buat Program Baru",className:"max-w-4xl mx-auto animate-fade-in-up",children:e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-slate-50 cursor-not-allowed",placeholder:" ",value:h.id_donasi,readOnly:!0}),e.jsx("label",{className:"floating-label",children:"ID Program"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",placeholder:" ",value:h.judul,onChange:S=>M({...h,judul:S.target.value})}),e.jsx("label",{className:"floating-label",children:"Judul Program"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(de,{id:"kategori-donasi",label:"Kategori",value:h.kategori,onChange:S=>M({...h,kategori:S}),options:[{value:"Pembangunan",label:"Pembangunan"},{value:"Beasiswa",label:"Beasiswa"},{value:"Wakaf Produktif",label:"Wakaf Produktif"},{value:"Operasional",label:"Operasional"}],className:"!mb-0"}),e.jsx(de,{id:"pos-donasi",label:"Pos Anggaran (Keuangan)",value:h.pos||"Operasional",onChange:S=>M({...h,pos:S}),options:[{value:"Bangunan",label:"Bangunan / Konstruksi"},{value:"Operasional",label:"Operasional / Umum"},{value:"Makan",label:"Makan / Dapur"},{value:"PHBI",label:"PHBI / Kegiatan"},{value:"Administrasi",label:"Administrasi"}],className:"!mb-0"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(ze,{id:"tgl-deadline",label:"Deadline",value:h.target.waktu,onChange:S=>M({...h,target:{...h.target,waktu:S}}),className:"!mb-0"}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"number",className:"floating-input peer font-bold text-emerald-700",placeholder:" ",value:h.target.nominal||"",onChange:S=>M({...h,target:{...h.target,nominal:Number(S.target.value)}})}),e.jsx("label",{className:"floating-label",children:"Target Nominal (Rp)"})]})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("textarea",{className:"floating-input peer h-32 py-3",placeholder:" ",value:h.deskripsi,onChange:S=>M({...h,deskripsi:S.target.value})}),e.jsx("label",{className:"floating-label",children:"Deskripsi Lengkap"})]})]}),e.jsxs("div",{className:"bg-slate-50 p-6 rounded-2xl border border-slate-200 h-fit",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-4",children:"Galeri Gambar"}),e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsxs("div",{className:"flex-1 floating-group !mb-0 !mt-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-white",placeholder:" ",value:w,onChange:S=>d(S.target.value)}),e.jsx("label",{className:"floating-label bg-slate-50",children:"URL Gambar"})]}),e.jsx(ye,{label:"+",onClick:z,className:"px-4 text-lg"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[h.gambar.map((S,b)=>e.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden group border border-slate-200 bg-white",children:[e.jsx("img",{src:S,className:"w-full h-full object-cover",alt:""}),e.jsx("button",{onClick:()=>j(b),className:"absolute top-1 right-1 bg-rose-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},b)),h.gambar.length===0&&e.jsx("div",{className:"col-span-3 py-8 text-center text-slate-400 text-xs italic",children:"Belum ada gambar."})]})]})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-100 flex gap-4",children:[e.jsx(ye,{label:"Batal",variant:"secondary",onClick:()=>p(!1),className:"flex-1"}),e.jsx(ye,{label:m?"Simpan Perubahan":"Terbitkan Program",variant:"primary",onClick:y,className:"flex-1"})]})]})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{id:"donasi-header",children:e.jsx(et,{title:"Manajemen Donasi",subtitle:"Kelola program penggalangan dana, wakaf, dan infaq.",action:e.jsx("div",{id:"donasi-add-btn",children:e.jsx(ye,{label:"Buat Program",onClick:()=>L(null),icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})})}),e.jsx("div",{id:"donasi-grid",children:e.jsx(at,{children:t.map(S=>{const b=C(S),T=N(b,S.target.nominal);return e.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm overflow-hidden flex flex-col hover:shadow-md transition-all group",children:[e.jsxs("div",{className:"relative h-48 bg-slate-100 overflow-hidden",children:[e.jsx("img",{src:S.gambar[0],alt:S.judul,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500",onError:$=>$.currentTarget.src="https://placehold.co/600x400?text=No+Image"}),e.jsx("div",{className:"absolute top-3 left-3",children:e.jsx(Ue,{label:S.kategori,variant:"info",className:"shadow-sm bg-white/90 backdrop-blur-sm border-white/20 text-slate-800"})}),e.jsx("div",{className:"absolute bottom-3 left-3",children:e.jsxs("span",{className:"text-[9px] font-bold bg-emerald-500 text-white px-2 py-0.5 rounded shadow-sm flex items-center gap-1",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})," Data Realtime"]})}),e.jsxs("div",{className:"absolute top-3 right-3 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:$=>{$.stopPropagation(),L(S.id_donasi)},className:"p-1.5 bg-white text-slate-600 rounded-lg shadow hover:text-blue-600",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})}),e.jsx("button",{onClick:$=>P(S.id_donasi,$),className:"p-1.5 bg-white text-slate-600 rounded-lg shadow hover:text-rose-600",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),e.jsxs("div",{className:"p-5 flex-1 flex flex-col",children:[e.jsx("h4",{className:"font-bold text-slate-900 text-lg mb-2 leading-tight line-clamp-2",children:S.judul}),e.jsxs("div",{className:"mt-auto space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-end text-xs",children:[e.jsx("span",{className:"text-slate-500 font-medium",children:"Terkumpul"}),e.jsxs("span",{className:"font-bold text-emerald-600",children:[T,"%"]})]}),e.jsx("div",{className:"w-full bg-slate-100 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-emerald-500 h-full rounded-full transition-all duration-1000",style:{width:`${T}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs text-slate-500 font-mono pt-1",children:[e.jsx("span",{className:"font-bold text-slate-700",children:A(b)}),e.jsx("span",{children:A(S.target.nominal)})]})]})]}),e.jsxs("div",{className:"px-5 py-3 border-t border-slate-50 bg-slate-50/50 flex justify-between items-center text-xs text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})," ",S.target.waktu]}),e.jsx("span",{className:"font-mono text-[10px] bg-slate-200 px-1.5 py-0.5 rounded text-slate-600",children:S.pos||"Umum"})]})]},S.id_donasi)})})})]})]})},qn=[{title:"Manajemen AI Token",description:"Kelola API Key untuk fitur Ustadz AI (Chatbot). Sistem mendukung rotasi otomatis kunci untuk menghindari limit."},{targetId:"ai-stats",title:"Kesehatan Token",description:"Pantau jumlah token aktif dan kuota yang tersisa. Pastikan selalu ada token aktif agar chat berfungsi.",position:"bottom"},{targetId:"ai-header",title:"Tambah Kunci",description:"Klik untuk menambahkan API Key baru dari Google Gemini atau OpenAI.",position:"bottom"},{targetId:"ai-table",title:"Daftar Token",description:"Lihat status penggunaan. Klik ikon 'Edit' untuk mengubah kuota atau ikon 'Tes' untuk cek koneksi.",position:"top"}],Yn=()=>{const{fetchData:a,updateCache:r}=ge(),[t,o]=s.useState([]),[c,k]=s.useState(!0),[f,D]=s.useState(!1),[B,p]=s.useState(null),[m,u]=s.useState({}),i={id_token:"",kunci_api:"",catatan:"",provider:"Gemini",model:"gemini-1.5-flash",status:"active",terakhir_digunakan:"",waktu_update:"",jumlah_penggunaan:0,jumlah_error:0,batas_kuota:0},[g,K]=s.useState(i);s.useEffect(()=>{(async()=>{k(!0);try{const y=await a("databaseToken",G.getAiTokens,"ManajemenAi",!1,!1);o(Array.isArray(y)?y:[])}catch(y){console.error("Gagal memuat token:",y),o([])}finally{k(!1)}})()},[a]);const h=s.useMemo(()=>({total:t.length,active:t.filter(P=>P.status==="active").length,exhausted:t.filter(P=>P.status==="exhausted").length,errors:t.reduce((P,y)=>P+y.jumlah_error,0),totalRequests:t.reduce((P,y)=>P+y.jumlah_penggunaan,0)}),[t]),M=P=>{P?(K(P),p(P.id_token)):(K({...i,id_token:`TOKEN-${Date.now().toString().slice(-6)}`}),p(null)),D(!0)},w=async()=>{if(!g.kunci_api||!g.catatan){alert("API Key dan Catatan (Label) wajib diisi.");return}k(!0);try{let P=[...t];const y={...g,waktu_update:new Date().toISOString()};B?P=P.map(z=>z.id_token===B?y:z):P.push(y),await G.updateAiTokens(P),r("databaseToken",P),o(P),D(!1),p(null),K(i)}catch(P){console.error("Save failed",P),alert("Gagal menyimpan data token.")}finally{k(!1)}},d=async P=>{if(confirm("Hapus token ini? Jika ini token terakhir, fitur AI akan mati.")){k(!0);try{const y=t.filter(z=>z.id_token!==P);await G.updateAiTokens(y),r("databaseToken",y),o(y)}catch{alert("Gagal menghapus token.")}finally{k(!1)}}},C=async P=>{alert(`Simulasi Test Koneksi ke ${P.provider}...

Status: OK (200)
Latency: 120ms

Token valid dan siap digunakan.`)},L=(P,y)=>y?P:!P||P.length<10?"****************":P.substring(0,8)+"..."+P.substring(P.length-4);return c&&t.length===0?e.jsx(fe,{message:"Memuat Konfigurasi AI...",fullScreen:!1}):e.jsxs(la,{children:[e.jsx(ve,{tourId:"sys_ai",steps:qn}),e.jsx("div",{id:"ai-header",children:e.jsx(et,{title:"Manajemen AI Token",subtitle:"Konfigurasi API Key untuk Ustadz AI (Gemini) dengan sistem Auto-Rotation & Failover.",action:!f&&e.jsx(ye,{label:"Tambah Key",onClick:()=>M(),icon:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})})}),!f&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"ai-stats",className:"grid grid-cols-2 md:grid-cols-4 gap-4 animate-fade-in-up",children:[e.jsx(Aa,{label:"Total Request",value:h.totalRequests,icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"})}),trend:"neutral",subValue:"All time usage"}),e.jsx(Aa,{label:"Token Aktif",value:h.active,icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),trend:"good",subValue:`Dari ${h.total} total token`}),e.jsx(Aa,{label:"Kuota Habis",value:h.exhausted,icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),trend:h.exhausted>0?"warning":"neutral",subValue:"Perlu rotasi manual"}),e.jsx(Aa,{label:"Total Error",value:h.errors,icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})}),trend:h.errors>0?"danger":"good",subValue:"Rate limit / Invalid"})]}),e.jsx("div",{id:"ai-table",children:e.jsx(He,{className:"animate-fade-in-up delay-100",children:e.jsx($t,{headers:["Label Token","Provider / Model","Status","Usage (Req)","Last Used","Aksi"],isEmpty:t.length===0,children:t.map(P=>e.jsxs("tr",{className:"hover:bg-slate-50 transition group",children:[e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"font-bold text-slate-800 text-sm mb-1",children:P.catatan}),e.jsxs("div",{className:"font-mono text-[10px] text-slate-500 bg-slate-100 px-2 py-0.5 rounded border border-slate-200 inline-flex items-center gap-2",children:[L(P.kunci_api,m[P.id_token]),e.jsx("button",{onClick:()=>u(y=>({...y,[P.id_token]:!y[P.id_token]})),className:"text-slate-400 hover:text-slate-700",children:m[P.id_token]?e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}):e.jsxs("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("span",{className:"font-bold text-slate-700 block text-xs",children:P.provider}),e.jsx("span",{className:"text-[10px] text-slate-500",children:P.model})]}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(Ue,{label:P.status,variant:P.status==="active"?"success":P.status==="suspended"?"warning":"danger"})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-16 h-1.5 bg-slate-200 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${P.batas_kuota>0&&P.jumlah_penggunaan>=P.batas_kuota?"bg-rose-500":"bg-blue-500"}`,style:{width:P.batas_kuota>0?`${Math.min(100,P.jumlah_penggunaan/P.batas_kuota*100)}%`:"10%"}})}),e.jsx("span",{className:"font-mono font-bold text-xs text-slate-600",children:P.jumlah_penggunaan})]}),P.jumlah_error>0&&e.jsxs("span",{className:"text-[9px] text-rose-500 font-bold mt-0.5 block",children:[P.jumlah_error," Errors"]})]}),e.jsx("td",{className:"px-6 py-4 text-slate-500 font-mono text-[10px]",children:P.terakhir_digunakan?P.terakhir_digunakan:"-"}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex justify-end gap-1",children:[e.jsx(ye,{size:"sm",variant:"ghost",icon:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),onClick:()=>C(P),label:""}),e.jsx(ye,{size:"sm",variant:"secondary",icon:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),onClick:()=>M(P),label:""}),e.jsx(ye,{size:"sm",variant:"danger",icon:e.jsx("svg",{className:"w-3.5 h-3.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),onClick:()=>d(P.id_token),label:""})]})})]},P.id_token))})})})]}),f&&e.jsx(He,{title:B?"Edit Token":"Tambah Token Baru",className:"max-w-3xl mx-auto animate-fade-in-up",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer bg-slate-50",value:g.id_token,readOnly:!0,placeholder:" "}),e.jsx("label",{className:"floating-label",children:"ID Token"})]}),e.jsx(de,{id:"status-token",label:"Status",value:g.status,onChange:P=>K({...g,status:P}),options:[{value:"active",label:"Aktif"},{value:"suspended",label:"Suspended (Non-Aktif)"},{value:"exhausted",label:"Exhausted (Habis Kuota)"}],className:"!mb-0"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",value:g.catatan,onChange:P=>K({...g,catatan:P.target.value}),placeholder:" "}),e.jsx("label",{className:"floating-label",children:"Catatan / Label (Contoh: Akun Utama)"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer font-mono text-sm",value:g.kunci_api,onChange:P=>K({...g,kunci_api:P.target.value}),placeholder:" "}),e.jsx("label",{className:"floating-label",children:"Kunci API (Gemini Key)"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(de,{id:"provider-token",label:"Provider",value:g.provider,onChange:P=>K({...g,provider:P}),options:[{value:"Gemini",label:"Google Gemini"},{value:"OpenAI",label:"OpenAI (GPT)"}],className:"!mb-0"}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"text",className:"floating-input peer",value:g.model,onChange:P=>K({...g,model:P.target.value}),placeholder:" "}),e.jsx("label",{className:"floating-label",children:"Model (cth: gemini-1.5-flash)"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{type:"number",className:"floating-input peer",value:g.batas_kuota,onChange:P=>K({...g,batas_kuota:Number(P.target.value)}),placeholder:" "}),e.jsx("label",{className:"floating-label",children:"Batas Kuota (0 = Unlimited)"})]}),e.jsxs("div",{className:"flex gap-4 items-center px-4 py-2 bg-slate-50 rounded-xl border border-slate-200",children:[e.jsxs("div",{className:"text-xs text-slate-500",children:[e.jsx("span",{className:"block font-bold text-slate-400 uppercase text-[9px]",children:"Usage"}),e.jsx("span",{className:"font-mono font-bold text-lg text-slate-800",children:g.jumlah_penggunaan})]}),e.jsx("div",{className:"w-px h-8 bg-slate-300"}),e.jsxs("div",{className:"text-xs text-slate-500",children:[e.jsx("span",{className:"block font-bold text-slate-400 uppercase text-[9px]",children:"Errors"}),e.jsx("span",{className:"font-mono font-bold text-lg text-rose-600",children:g.jumlah_error})]})]})]}),e.jsxs("div",{className:"pt-6 border-t border-slate-100 flex gap-4",children:[e.jsx(ye,{label:"Batal",variant:"secondary",onClick:()=>D(!1),className:"flex-1"}),e.jsx(ye,{label:"Simpan Token",variant:"primary",onClick:w,className:"flex-1"})]})]})})]})},ft=[{id:"dashboard",name:"Dashboard",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 01-2-2v-2z"})}),description:"Ringkasan"},{id:"koperasi/transaksi",name:"Jurnal Koperasi",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})}),description:"Kasir & Stok"},{id:"koperasi/produk",name:"Data Produk",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4"})}),description:"Item & Stok"},{id:"koperasi/unit_lain",name:"Bisnis Lainnya",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h-5 10v-5a1 1 0 011-1h2a1 1 0 01 1v5m-4 0h4"})}),description:"Unit Usaha"},{id:"keuangan/transaksiumum",name:"Jurnal Umum",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),description:"Buku Besar & Sub-Pos",subItems:[{id:"keuangan/administrasi",name:"Administrasi & Pendaftaran",icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})},{id:"keuangan/bangunan",name:"Pembangunan & Wakaf",icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h-5 10v-5a1 1 0 011-1h2a1 1 0 01 1v5m-4 0h4"})})},{id:"keuangan/makan",name:"Uang Makan & Dapur",icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13M12 6.253V13"})})},{id:"keuangan/operasional",name:"Kas Operasional",icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})},{id:"keuangan/phbi",name:"Dana PHBI & Kegiatan",icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})},{id:"keuangan/harian",name:"Tabungan Santri",icon:e.jsx("svg",{className:"w-4 h-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}]},{id:"keuangan/bukutunggakan",name:"Buku Tunggakan",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),description:"Cek Tagihan Santri"},{id:"keuangan/aturbiaya",name:"Atur Biaya & Rekening",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37zM15 12a3 3 0 11-6 0 3 3 0 016 0z"})}),description:"Konfigurasi"},{id:"administrasi/persuratan",name:"Persuratan",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),description:"Surat Menyurat"},{id:"administrasi/agenda",name:"Agenda",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),description:"Kalender"},{id:"database/santri",name:"Data Santri",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})}),description:"Aktif & Alumni"},{id:"database/calonsantri",name:"Calon Santri",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M18 9v3m0 0v3m0-3h3m-3 0h-3m-2-5a4 4 0 11-8 0 4 4 0 018 0zM3 20a6 6 0 0112 0v1H3v-1z"})}),description:"Pendaftar Baru"},{id:"database/kepegawaian",name:"Kepegawaian Umum",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),description:"Data Pegawai"},{id:"database/dewankiyai",name:"Dewan Kiyai",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),description:"Masyayikh"},{id:"sistem/manajementampilan",name:"Manajemen Tampilan",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),description:"Konten Website"},{id:"sistem/manajemenpostingan",name:"Manajemen Postingan",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),description:"Galeri & Fasilitas"},{id:"sistem/manajemenpublikasi",name:"Manajemen Publikasi",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M11 5.882V19.24a1.76 1.76 0 01-3.417.592l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),description:"Berita & Notifikasi"},{id:"sistem/manajemendonasi",name:"Manajemen Donasi",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),description:"Program & Kampanye"},{id:"sistem/hakadmin",name:"Manajemen Akses",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),description:"Role & Permission"},{id:"sistem/pengguna",name:"Manajemen Pengguna",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),description:"Akun & Password"},{id:"sistem/manajemenai",name:"Manajemen AI",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),description:"API Key & Token"},{id:"sistem/pengaturanakun",name:"Pengaturan",icon:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.8,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37zM15 12a3 3 0 11-6 0 3 3 0 016 0z"})}),description:"Profil Saya"}],Qn=[{title:"Selamat Datang di Panel Admin",description:"Ini adalah pusat kontrol manajemen pesantren. Anda memiliki akses penuh ke seluruh modul."},{targetId:"layout-sidebar",title:"Navigasi Modul",description:"Akses berbagai fitur seperti Keuangan, Koperasi, Database Santri, dan Pengaturan Sistem dari sini.",position:"right"}],Xn=[{title:"",items:["dashboard"]},{title:"KOPERASI",items:["koperasi/transaksi","koperasi/produk","koperasi/unit_lain"]},{title:"KEUANGAN",items:["keuangan/transaksiumum","keuangan/bukutunggakan","keuangan/aturbiaya"]},{title:"ADMINISTRASI",items:["administrasi/persuratan","administrasi/agenda"]},{title:"DATABASE",items:["database/santri","database/calonsantri","database/kepegawaian","database/dewankiyai"]},{title:"SISTEM",items:["sistem/manajementampilan","sistem/manajemenpostingan","sistem/manajemenpublikasi","sistem/manajemendonasi","sistem/hakadmin","sistem/pengguna","sistem/manajemenai","sistem/pengaturanakun"]}],jt=({onLogout:a})=>{var f;const[r,t]=s.useState(()=>localStorage.getItem("miftahulhuda_active_module_admin")||"dashboard");s.useEffect(()=>{localStorage.setItem("miftahulhuda_active_module_admin",r)},[r]);const[o,c]=s.useState({userName:"Administrator",userRole:"Super Admin",userInitial:"AD",email:"",jabatan:"",akses:[]});s.useEffect(()=>{const D=localStorage.getItem("miftahulhuda_user");if(D)try{const B=JSON.parse(D);c(p=>({...p,...B}))}catch(B){console.error("Gagal parsing user data",B)}},[]);const k=()=>{switch(r){case"dashboard":return e.jsx(pt,{onNavigate:t});case"administrasi/agenda":return e.jsx(Ys,{});case"database/santri":return e.jsx(Xs,{});case"database/calonsantri":return e.jsx(en,{});case"database/kepegawaian":return e.jsx(tn,{});case"database/dewankiyai":return e.jsx(nn,{});case"administrasi/persuratan":return e.jsx(ln,{});case"sistem/hakadmin":return e.jsx(dn,{});case"koperasi/transaksi":return e.jsx(gt,{initialTab:"Jurnal"});case"koperasi/produk":return e.jsx(gt,{initialTab:"Produk"});case"koperasi/unit_lain":return e.jsx(kn,{});case"keuangan/transaksiumum":return e.jsx(Bn,{});case"keuangan/administrasi":return e.jsx(Tn,{});case"keuangan/bangunan":return e.jsx(wn,{});case"keuangan/makan":return e.jsx(Sn,{});case"keuangan/operasional":return e.jsx(Nn,{});case"keuangan/phbi":return e.jsx(Cn,{});case"keuangan/harian":return e.jsx(Mn,{});case"keuangan/aturbiaya":return e.jsx(An,{});case"keuangan/bukutunggakan":return e.jsx(In,{});case"sistem/pengguna":return e.jsx($n,{});case"sistem/manajementampilan":return e.jsx(Hn,{});case"sistem/manajemenpublikasi":return e.jsx(Fn,{});case"sistem/manajemenpostingan":return e.jsx(Gn,{});case"sistem/manajemendonasi":return e.jsx(Jn,{});case"sistem/manajemenai":return e.jsx(Yn,{});case"sistem/pengaturanakun":return e.jsx(Kn,{id_akun:o.id_akun,userName:o.userName,userRole:o.userRole,userInitial:o.userInitial,email:o.email,accentColor:"slate"});default:return e.jsx(pt,{onNavigate:t})}};return e.jsxs(e.Fragment,{children:[e.jsx(ve,{tourId:"sys_main",steps:Qn}),e.jsx(At,{title:r==="dashboard"?"Dashboard Admin":((f=ft.find(D=>D.id===r))==null?void 0:f.name)||"Menu",subTitle:"Panel Kontrol Manajemen Pesantren",activeModule:r,navItems:ft,navGroups:Xn,onNavigate:t,onLogout:a,...o,accentColor:"slate",children:k()})]})};var pe=(a=>(a.LANDING="LANDING",a.LOGIN="LOGIN",a.DASHBOARD_USER="DASHBOARD_USER",a.DASHBOARD_ADMIN="DASHBOARD_ADMIN",a.DASHBOARD_STAFF="DASHBOARD_STAFF",a))(pe||{});const Zn=({onNavigate:a,onNavigateBack:r})=>{const{fetchData:t,cache:o}=ge(),[c,k]=s.useState(!0),[f,D]=s.useState(""),[B,p]=s.useState(""),[m,u]=s.useState(!1),[i,g]=s.useState(!1),[K,h]=s.useState(0),[M,w]=s.useState(0),[d,C]=s.useState(""),[L,P]=s.useState(""),[y,z]=s.useState(""),[j,N]=s.useState(""),[A,S]=s.useState(null),[b,T]=s.useState(new Array(6).fill("")),$=s.useRef([]),[E,F]=s.useState(!1),[x,l]=s.useState(0),[I,_]=s.useState(!1),[n,v]=s.useState(!1),[R,W]=s.useState(""),[q,V]=s.useState(!1),[J,U]=s.useState(0),[re,Z]=s.useState(""),[ae,_e]=s.useState(null),oe="service_dgrn2vf",xe="verifikasi-server1",H="eMUcF7L_G95Qmasd1",ee={nama:"Miftahul Huda",sub_nama:"Al-Burhani",logo:"https://imgur.com/5wRslAz.png",deskripsi_singkat:"Sistem manajemen terintegrasi untuk mendukung transparansi dan kemudahan akses informasi bagi wali santri dan staff.",copyright:"© 2024 Miftahul Huda Al-Burhani System."};s.useEffect(()=>{(async()=>{if(o.dasar)_e(Array.isArray(o.dasar)?o.dasar[0]:o.dasar);else try{const se=await t("dasar",G.getDasar,"Login",!1,!1);_e(Array.isArray(se)?se[0]:se)}catch{}})()},[t,o.dasar]),s.useEffect(()=>{let X;return x>0&&(X=setInterval(()=>l(se=>se-1),1e3)),()=>clearInterval(X)},[x]),s.useEffect(()=>{let X;return M>0&&(X=setInterval(()=>w(se=>se-1),1e3)),()=>clearInterval(X)},[M]);const le=ae||ee,O=X=>{const se=Math.floor(X/60),ue=X%60;return`${se}:${ue<10?"0":""}${ue}`},Q=async(X,se,ue,je,Ae)=>{const Te={to_name:X,to_email:se,otp_code:ue,title:je,message:Ae};return ba.send(oe,xe,Te,H)},ne=async()=>{if(W(""),v(!0),!y||!y.includes("@")){W("Mohon masukkan alamat email yang valid."),v(!1);return}if(!L||L.length<3){W("Nama Lengkap minimal 3 huruf."),v(!1);return}if(!d||d.length<5){W("ID Referensi terlalu pendek (min 5 karakter)."),v(!1);return}if(!j.startsWith("8")){W("Nomor WhatsApp tidak valid (Gunakan format 8xx...)."),v(!1);return}if(j.length<10){W("Nomor WhatsApp terlalu pendek (min 10 digit)."),v(!1);return}if(/^(\d)\1+$/.test(j)||"0123456789012345".includes(j.substring(0,6))){W("Nomor WhatsApp terdeteksi tidak valid (pola sederhana)."),v(!1);return}try{const X=await G.getDatabaseSantri(),ue=(Array.isArray(X)?X:[X]).find(De=>{var Ke,We,$e;return((Ke=De.verifikasi_santri)==null?void 0:Ke.id_santri)===d||((We=De.data_akademik)==null?void 0:We.nisn)===d||(($e=De.data_santri)==null?void 0:$e.nik)===d});if(!ue){W("ID Referensi tidak ditemukan dalam database santri."),v(!1);return}const je=ue.data_santri.nama_lengkap.toLowerCase(),Ae=L.toLowerCase();if(!je.includes(Ae)&&!Ae.includes(je)){W("Nama tidak cocok dengan data ID Referensi."),v(!1);return}const Te=Math.floor(1e5+Math.random()*9e5).toString();S(Te),await Q(L,y,Te,"Verifikasi Pendaftaran","Data Anda ditemukan. Gunakan kode berikut untuk memverifikasi email Anda:"),l(300),T(new Array(6).fill("")),setTimeout(()=>{var De;return(De=$.current[0])==null?void 0:De.focus()},100),alert(`Kode verifikasi telah dikirim ke ${y}.`)}catch(X){console.error("Verification Error:",X),W("Gagal memverifikasi data. Cek koneksi internet.")}finally{v(!1)}},he=async()=>{if(!f||!f.includes("@")){W("Mohon masukkan alamat email yang terdaftar.");return}v(!0),W("");try{const X=await G.getDatabaseAkun();if(!(Array.isArray(X)&&X.some(je=>je.data_akun.email.toLowerCase()===f.toLowerCase()))){W("Email tidak ditemukan dalam database kami."),v(!1);return}const ue=Math.floor(1e5+Math.random()*9e5).toString();S(ue),await Q("Pengguna",f,ue,"Pemulihan Kata Sandi","Kami menerima permintaan untuk mereset kata sandi Anda. Gunakan kode berikut untuk melanjutkan:"),w(300),h(1),T(new Array(6).fill("")),alert(`Kode pemulihan dikirim ke ${f}.`)}catch(X){console.error(X),W("Gagal memproses permintaan. Periksa koneksi internet.")}finally{v(!1)}},Ce=async()=>{try{const X=await G.getDatabaseAkun(),se=Array.isArray(X)?X.find(ue=>ue.data_akun.email.toLowerCase()===f.toLowerCase()):null;if(se){const ue=se.data_akun.hash_kata_sandi||"Error: Hubungi Admin",je=se.data_akun.nama;await Q(je,f,ue,"Informasi Akun Anda","Verifikasi berhasil. Berikut adalah KATA SANDI / HASH akun Anda yang tersimpan di database:"),alert("Verifikasi Berhasil! Kata sandi telah dikirim ke email Anda. Silakan cek Inbox/Spam dan login kembali."),g(!1),h(0),T(new Array(6).fill("")),D("")}else W("Data akun tidak ditemukan (Anomali Data).")}catch(X){console.error(X),W("Gagal mengirim email pemulihan.")}},me=(X,se)=>{var je;if(isNaN(Number(se)))return;const ue=[...b];if(ue[X]=se,T(ue),se!==""&&X<5&&((je=$.current[X+1])==null||je.focus()),ue.every(Ae=>Ae!=="")){const Ae=ue.join("");(!c&&!i||c&&i)&&ke(Ae)}},be=(X,se)=>{var ue;se.key==="Backspace"&&!b[X]&&X>0&&((ue=$.current[X-1])==null||ue.focus())},Me=X=>{X.preventDefault();const se=X.clipboardData.getData("text").slice(0,6);if(/^\d+$/.test(se)){const ue=se.split(""),je=[...b];ue.forEach((Ae,Te)=>{Te<6&&(je[Te]=Ae)}),T(je),je.every(Ae=>Ae!=="")&&(!c&&!i||c&&i)&&ke(je.join(""))}},ke=X=>{V(!0),W(""),U(1),Z("Menginisialisasi Sistem..."),setTimeout(()=>{U(2),Z("Identifikasi Pengguna..."),setTimeout(()=>{U(3),Z("Memverifikasi Kode OTP..."),setTimeout(()=>{X===A?(U(4),Z("Verifikasi Berhasil!"),setTimeout(()=>{i?Ce():F(!0),V(!1),l(0)},1500)):(V(!1),W("Kode verifikasi salah. Silakan coba lagi."),T(new Array(6).fill("")))},1500)},1500)},1500)},Se=()=>{F(!1),l(0),S(null),T(new Array(6).fill(""))},Y=async X=>{if(X.preventDefault(),W(""),c){if(i){if(K===1){const se=b.join("");se.length===6?ke(se):W("Mohon lengkapi kode OTP.")}else he();return}_(!0);try{const se=await G.login({username:f,password:B});if(se){const je={wali:pe.DASHBOARD_USER,admin_sistem:pe.DASHBOARD_STAFF,admin_umum:pe.DASHBOARD_STAFF,admin_koperasi:pe.DASHBOARD_STAFF,wali_santri:pe.DASHBOARD_USER,admin:pe.DASHBOARD_STAFF}[se.peran];if(je){const Ae={userName:se.nama,userRole:se.peran==="wali"?"Wali Santri":"Admin",userInitial:se.nama.substring(0,2).toUpperCase(),userId:se.id_akun,id_referensi:se.id_santri,id_santri:se.id_santri,akses:se.akses||[],filter_santri:se.filter_santri||"",appView:je,rememberMe:m};localStorage.setItem("miftahulhuda_user",JSON.stringify(Ae)),a(je)}else W(`Role '${se.peran}' tidak dikenali.`)}}catch(se){W(se.message||"Gagal masuk. Periksa kembali data Anda.")}finally{_(!1)}}else{if(!E){W("Email belum diverifikasi.");return}if(!d||!L||!B){W("Semua kolom wajib diisi.");return}const se=/[A-Z]/.test(B),ue=/[a-z]/.test(B),je=/[0-9]/.test(B);if(!(B.length>=8)||!se||!ue||!je){W("Kata sandi LEMAH. Wajib minimal 8 karakter, mengandung huruf BESAR, huruf kecil, dan angka.");return}_(!0);try{const Te=await G.getDatabaseAkun(),De=Array.isArray(Te)?Te:[];if(De.some(wa=>wa.data_akun.email===y)){W("Email sudah terdaftar. Silakan login."),_(!1);return}const $e={verifikasi_akun:{id_akun:`WALI-${Date.now().toString().slice(-6)}`,id_santri:d},data_akun:{peran:"wali",nama:L,status:"terverifikasi",email:y,telepon:j,hash_kata_sandi:B,dibuat:new Date().toISOString()}},ia=[...De,$e];await G.updateRoles(ia),alert("Pendaftaran berhasil! Akun Anda telah dibuat. Silakan login."),k(!0),C(""),P(""),z(""),N(""),p(""),Se()}catch(Te){console.error("Register Error:",Te),W("Gagal mendaftar. Terjadi kesalahan pada server.")}finally{_(!1)}}},te={header:{login_title:"Ahlan Wa Sahlan",login_subtitle:"Silakan masuk menggunakan akun Anda.",register_title:"Gabung "+le.sub_nama,register_subtitle:"Verifikasi data diri Anda."}};return e.jsxs("div",{className:"min-h-screen flex flex-col lg:flex-row bg-gray-50 lg:bg-white font-sans overflow-hidden",children:[q&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-md animate-fade-in",children:e.jsxs("div",{className:"bg-white rounded-3xl p-8 w-80 text-center shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-emerald-400 via-yellow-400 to-emerald-400 animate-grid-flow"}),e.jsx("div",{className:"flex justify-center mb-6",children:J<4?e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-slate-100 border-t-emerald-500 animate-spin"}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center text-emerald-600",children:[J===1&&e.jsx("svg",{className:"w-6 h-6 animate-pulse",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"})}),J===2&&e.jsx("svg",{className:"w-6 h-6 animate-pulse",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),J===3&&e.jsx("svg",{className:"w-6 h-6 animate-pulse",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})]})]}):e.jsx("div",{className:"w-16 h-16 rounded-full bg-emerald-100 flex items-center justify-center text-emerald-600 animate-fade-in-scale",children:e.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})}),e.jsx("h3",{className:"font-bold text-lg text-slate-800 mb-2 animate-fade-in",children:re}),e.jsx("p",{className:"text-xs text-slate-400",children:"Mohon tunggu sebentar..."})]})}),e.jsxs("div",{className:"hidden lg:flex w-full lg:w-[45%] bg-emerald-950 relative overflow-hidden flex-col justify-between p-12 text-white",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.03] bg-[url('https://www.transparenttextures.com/patterns/arabesque.png')]"}),e.jsx("div",{className:"absolute top-0 right-0 w-[500px] h-[500px] bg-emerald-900/50 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-[400px] h-[400px] bg-yellow-500/10 rounded-full blur-3xl translate-y-1/3 -translate-x-1/3"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-10 cursor-pointer group w-fit",onClick:r,title:"Kembali ke Beranda",children:[e.jsx("div",{className:"p-2 bg-white/10 backdrop-blur-md rounded-xl border border-white/10 group-hover:bg-white/20 transition-all",children:e.jsx(Oe,{className:"w-8 h-8",src:le.logo})}),e.jsx("span",{className:"font-serif text-xl font-bold tracking-wide group-hover:text-yellow-400 transition-colors",children:le.nama})]}),e.jsxs("div",{className:"space-y-6 mt-10",children:[e.jsxs("h1",{className:"font-serif text-5xl font-bold leading-tight",children:["Pendidikan Adab ",e.jsx("br",{}),e.jsx("span",{className:"text-yellow-400",children:"Berbasis Digital"})]}),e.jsx("p",{className:"text-emerald-100/70 text-lg leading-relaxed max-w-md",children:le.deskripsi_singkat})]})]}),e.jsx("div",{className:"relative z-10 mt-auto",children:e.jsx("p",{className:"text-xs text-white/30 mt-6",children:le.copyright})})]}),e.jsx("div",{className:"lg:hidden relative z-10 p-8 pt-12 pb-20 flex flex-col items-center text-center bg-gray-50",children:e.jsxs("div",{className:"relative z-10 mb-2",children:[e.jsx("div",{className:"w-20 h-20 bg-white rounded-[2rem] flex items-center justify-center border border-gray-100 shadow-xl mb-6 mx-auto transform rotate-3",children:e.jsx(Oe,{className:"w-10 h-10",src:le.logo})}),e.jsxs("h1",{className:"font-serif text-2xl font-bold mb-2 text-emerald-950 drop-shadow-sm",children:[le.nama," ",e.jsx("br",{})," ",le.sub_nama]})]})}),e.jsx("div",{className:"flex-1 bg-white relative flex flex-col justify-center lg:items-center rounded-t-[2.5rem] lg:rounded-none shadow-[0_-10px_40px_rgba(0,0,0,0.05)] lg:shadow-none -mt-10 lg:mt-0 z-20 overflow-hidden",children:e.jsxs("div",{className:"w-full max-w-md mx-auto px-6 py-4 lg:px-12 lg:py-12 relative z-20 h-full overflow-y-auto custom-scrollbar",children:[e.jsxs("div",{className:"hidden lg:block mb-8",children:[e.jsx("h2",{className:"font-serif text-4xl font-bold text-gray-900 mb-2",children:c?i?"Pemulihan Akun":te.header.login_title:te.header.register_title}),e.jsx("p",{className:"text-gray-500 text-sm",children:c?i?K===0?"Masukkan email untuk menerima kode OTP.":"Masukkan kode OTP yang dikirim ke email Anda.":te.header.login_subtitle:te.header.register_subtitle})]}),!i&&e.jsxs("div",{className:"flex p-1 bg-gray-100/80 rounded-2xl mb-8 relative border border-gray-200/50",children:[e.jsx("div",{className:`absolute top-1 bottom-1 w-[calc(50%-4px)] bg-white rounded-xl shadow-sm transition-all duration-300 ease-out ${c?"left-1":"left-[calc(50%+2px)]"}`}),e.jsx("button",{onClick:()=>{k(!0),W("")},className:`flex-1 py-3 text-sm font-bold relative z-10 transition-colors ${c?"text-emerald-900":"text-gray-400"}`,children:"Masuk"}),e.jsx("button",{onClick:()=>{k(!1),W("")},className:`flex-1 py-3 text-sm font-bold relative z-10 transition-colors ${c?"text-gray-400":"text-emerald-900"}`,children:"Daftar"})]}),e.jsxs("form",{className:"space-y-5",onSubmit:Y,children:[!c&&e.jsxs("div",{className:"space-y-5 animate-fade-in",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{id:"reg-idref",type:"text",required:!0,className:"floating-input peer bg-white",placeholder:" ",value:d,onChange:X=>C(X.target.value)}),e.jsx("label",{htmlFor:"reg-idref",className:"floating-label",children:"ID Santri / NISN / NIK"})]}),e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{id:"reg-name",type:"text",required:!0,className:"floating-input peer bg-white",placeholder:" ",value:L,onChange:X=>P(X.target.value)}),e.jsx("label",{htmlFor:"reg-name",className:"floating-label",children:"Nama Lengkap (Sesuai ID)"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:`floating-group !mb-0 flex-1 ${E?"bg-emerald-50 border-emerald-200 rounded-2xl":""}`,children:[e.jsx("input",{id:"reg-email",type:"email",required:!0,disabled:E||x>0||n,className:`floating-input peer bg-white ${E?"!bg-transparent !border-transparent !text-emerald-800":""}`,placeholder:" ",value:y,onChange:X=>z(X.target.value)}),e.jsx("label",{htmlFor:"reg-email",className:`floating-label ${E?"!text-emerald-600":""}`,children:"Email Aktif"}),E&&e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 flex items-center gap-2",children:e.jsx("div",{className:"w-5 h-5 bg-emerald-500 rounded-full flex items-center justify-center text-white shadow-sm",children:e.jsx("svg",{className:"w-3 h-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})})]}),!E&&e.jsx("button",{type:"button",onClick:ne,disabled:x>0||!y||n,className:"absolute right-2 top-2 bottom-2 px-4 bg-emerald-600 text-white rounded-xl text-xs font-bold shadow-md hover:bg-emerald-700 disabled:bg-gray-200 disabled:text-gray-400 transition-all z-10",children:n?"...":x>0?O(x):"Verifikasi"}),E&&e.jsx("button",{type:"button",onClick:Se,className:"absolute right-12 top-1/2 -translate-y-1/2 p-1.5 text-gray-400 hover:text-emerald-600 hover:bg-white rounded-lg transition-colors z-10",title:"Ganti Email",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})})})]}),!E&&x>0&&e.jsxs("div",{className:"animate-fade-in-up",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2 tracking-wide text-center",children:"Masukkan Kode Verifikasi"}),e.jsx("div",{className:"flex gap-2 justify-center",children:b.map((X,se)=>e.jsx("input",{ref:ue=>{ue&&($.current[se]=ue)},type:"text",maxLength:1,value:X,onChange:ue=>me(se,ue.target.value),onKeyDown:ue=>be(se,ue),onPaste:Me,className:`w-10 h-12 md:w-12 md:h-14 border-2 rounded-xl text-center text-xl font-bold outline-none transition-all ${X?"border-emerald-500 bg-emerald-50 text-emerald-700":"border-gray-200 bg-white focus:border-emerald-400 focus:ring-4 focus:ring-emerald-100"}`},se))})]}),e.jsx("div",{className:"relative",children:e.jsx($a,{id:"reg-phone",label:"Nomor WhatsApp",value:j,onChange:N,required:!0})})]}),c&&e.jsxs("div",{className:"space-y-5 animate-fade-in",children:[e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{id:"identity",type:"text",required:!0,disabled:i&&K>0,className:"floating-input peer bg-white font-medium text-gray-900 focus:bg-white",placeholder:" ",value:f,onChange:X=>D(X.target.value)}),e.jsx("label",{htmlFor:"identity",className:"floating-label",children:i?"Email Terhubung":"ID Akun / Email / No. Telepon"})]}),i&&K===1&&e.jsxs("div",{className:"animate-fade-in-up",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-2 tracking-wide text-center",children:"Kode OTP Pemulihan"}),e.jsx("div",{className:"flex gap-2 justify-center",children:b.map((X,se)=>e.jsx("input",{ref:ue=>{ue&&($.current[se]=ue)},type:"text",maxLength:1,value:X,onChange:ue=>me(se,ue.target.value),onKeyDown:ue=>be(se,ue),onPaste:Me,className:`w-10 h-12 border-2 rounded-xl text-center text-xl font-bold outline-none transition-all ${X?"border-emerald-500 bg-emerald-50 text-emerald-700":"border-gray-200 bg-white focus:border-emerald-400"}`},se))})]})]}),c&&!i&&e.jsxs("div",{className:"floating-group !mb-0 animate-fade-in",children:[e.jsx("input",{id:"password",type:"password",required:!0,className:"floating-input peer bg-white",placeholder:" ",value:B,onChange:X=>p(X.target.value)}),e.jsx("label",{htmlFor:"password",className:"floating-label",children:"Kata Sandi"})]}),!c&&e.jsxs("div",{className:"floating-group !mb-0",children:[e.jsx("input",{id:"password-reg",type:"password",required:!0,className:"floating-input peer bg-white",placeholder:" ",value:B,onChange:X=>p(X.target.value)}),e.jsx("label",{htmlFor:"password-reg",className:"floating-label",children:"Buat Kata Sandi (Min. 8, Besar, Kecil, Angka)"})]}),c&&e.jsxs("div",{className:"flex items-center justify-between text-xs pt-1 animate-fade-in",children:[e.jsxs("label",{className:"flex items-center text-gray-500 cursor-pointer select-none group",children:[e.jsxs("div",{className:`w-4 h-4 border-2 rounded mr-2 flex items-center justify-center transition-colors ${m?"bg-emerald-500 border-emerald-500":"border-gray-300 group-hover:border-emerald-500"}`,children:[e.jsx("input",{type:"checkbox",className:"hidden",checked:m,onChange:X=>u(X.target.checked)}),m&&e.jsx("svg",{className:"w-2.5 h-2.5 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})]}),"Ingat Saya"]}),e.jsx("button",{type:"button",onClick:()=>{g(!i),W(""),h(0)},className:"font-bold text-emerald-600 hover:text-emerald-800 transition-colors",children:i?"Kembali ke Login":"Lupa Kata Sandi?"})]}),R&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-100 rounded-2xl text-red-600 text-xs font-bold text-center flex items-center justify-center gap-2 animate-pulse",children:R}),e.jsxs("div",{className:"pt-4 space-y-3",children:[e.jsx("button",{type:"submit",disabled:I||n||!c&&!E||i&&M>0&&K===0,className:"w-full py-4 bg-gradient-to-r from-emerald-900 to-emerald-800 text-white rounded-2xl font-bold text-sm shadow-xl shadow-emerald-900/20 hover:shadow-2xl hover:-translate-y-0.5 transition-all transform active:scale-95 flex items-center justify-center gap-2 group disabled:opacity-70 disabled:cursor-not-allowed",children:I||n?"Memproses...":c?i?K===0?M>0?`Tunggu ${O(M)}`:"Kirimkan Autentikasi":"Verifikasi & Pulihkan":"Masuk Sekarang":"Buat Akun Baru"}),i&&K===1&&e.jsxs("p",{className:"text-center text-xs text-gray-500 mt-2",children:["Kirim ulang OTP dalam ",e.jsx("span",{className:"font-bold text-emerald-600",children:O(M)})]}),e.jsx("div",{className:"lg:hidden",children:e.jsx("button",{type:"button",onClick:r,className:"w-full py-3 text-gray-400 font-bold text-sm hover:text-gray-600 transition-colors",children:"Tutup"})}),e.jsx("div",{className:"hidden lg:block pt-2",children:e.jsxs("button",{type:"button",onClick:r,className:"w-full py-3 text-gray-400 font-bold text-sm hover:text-emerald-700 transition-colors flex items-center justify-center gap-2 group hover:bg-gray-50 rounded-xl",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 transform group-hover:-translate-x-1 transition-transform text-emerald-600 opacity-0 group-hover:opacity-100",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7 7-7m8 14l-7-7 7-7"})}),"Kembali ke Beranda"]})})]})]}),e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("p",{className:"text-gray-400 text-[10px]",children:[le.copyright," ",e.jsx("br",{className:"lg:hidden"})," Protected by secure system."]})})]})})]})},er=()=>{const a=s.useMemo(()=>Array.from({length:15}).map((t,o)=>({left:`${Math.random()*100}%`,animationDelay:`${Math.random()*5}s`,top:`${Math.random()*100}%`,size:Math.random()>.5?"w-3 h-3":"w-2 h-2"})),[]),r=s.useMemo(()=>Array.from({length:8}).map((t,o)=>({left:`${Math.random()*100}%`,animationDuration:`${15+Math.random()*20}s`,animationDelay:`${Math.random()*10}s`,type:o%2===0?"moon":"star",size:Math.random()*30+20})),[]);return e.jsxs("div",{className:"fixed inset-0 z-[-1] overflow-hidden pointer-events-none bg-gradient-to-b from-gray-50 via-emerald-50/30 to-gray-50",children:[e.jsx("div",{className:"absolute inset-0 opacity-[0.03]",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23064e3b' fill-opacity='1'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}}),a.map((t,o)=>e.jsx("div",{className:`absolute text-yellow-500/30 animate-twinkle ${t.size}`,style:{left:t.left,top:t.top,animationDelay:t.animationDelay},children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})})},`star-${o}`)),r.map((t,o)=>e.jsx("div",{className:"absolute text-emerald-900/5 animate-float-slow",style:{left:t.left,width:`${t.size}px`,height:`${t.size}px`,animationDuration:t.animationDuration,animationDelay:t.animationDelay,bottom:"-50px"},children:t.type==="moon"?e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 3a9 9 0 1 0 9 9c0-.46-.04-.92-.1-1.36a5.389 5.389 0 0 1-4.4 2.26 5.403 5.403 0 0 1-3.14-9.8c-.44-.06-.9-.1-1.36-.1z"})}):e.jsx("svg",{viewBox:"0 0 24 24",fill:"currentColor",children:e.jsx("path",{d:"M12 2l2.5 5.5L20 10l-5.5 2.5L12 18l-2.5-5.5L4 10l5.5-2.5z"})})},`floater-${o}`))]})},kt=a=>decodeURIComponent(a).replace(/\+/g," "),vt=a=>{const r=a.replace(/^#\/?/,"").toLowerCase();if(r==="")return"HOME";switch(r.split("/")[0]){case"home":return"HOME";case"profil":return"PROFIL";case"akademik":return"AKADEMIK";case"fasilitas":return"FASILITAS";case"galeri":return"GALERI";case"berita":return"BERITA";case"pendaftaran":return"PENDAFTARAN";case"donasi":return"DONASI";case"koperasi":return"KOPERASI";case"chat":return"AI_CHAT";case"error":return r.includes("koneksi")?"ERROR_CONNECTION":"ERROR_404";default:return"ERROR_404"}};function ar(){const{fetchData:a,cache:r}=ge(),[t,o]=s.useState(()=>{const S=localStorage.getItem("miftahulhuda_user");if(window.location.hash==="#/login")return pe.LOGIN;if(S)try{const b=JSON.parse(S);return b.appView?b.appView:b.userRole==="Wali Santri"?pe.DASHBOARD_USER:pe.DASHBOARD_STAFF}catch(b){console.error("Session restore failed",b)}return pe.LANDING}),[c,k]=s.useState(()=>vt(window.location.hash)),[f,D]=s.useState(!1),[B,p]=s.useState(null),[m,u]=s.useState(null),[i,g]=s.useState(!1),[K,h]=s.useState(!1),[M,w]=s.useState(!navigator.onLine),d=S=>{if(!document.startViewTransition){S();return}document.startViewTransition(S)};s.useEffect(()=>{const S=Wa.addListener("backButton",({canGoBack:b})=>{if(f){D(!1);return}if(t!==pe.LANDING&&t!==pe.LOGIN){window.confirm("Keluar dari aplikasi?")&&Wa.exitApp();return}if(t===pe.LOGIN){window.location.hash="/",o(pe.LANDING);return}if(B||m){window.location.hash=B?"/berita":"/donasi",p(null),u(null);return}if(c!=="HOME"){window.location.hash="/";return}Wa.exitApp()});return()=>{S.then(b=>b.remove())}},[t,c,B,m,f]),s.useEffect(()=>{const S=()=>{w(!1),c==="ERROR_CONNECTION"&&(window.location.hash="/")},b=()=>{w(!0),t===pe.LANDING&&k("ERROR_CONNECTION")};return window.addEventListener("online",S),window.addEventListener("offline",b),()=>{window.removeEventListener("online",S),window.removeEventListener("offline",b)}},[c,t]),s.useEffect(()=>{const S=async()=>{var E;const b=window.location.hash,T=t===pe.DASHBOARD_USER||t===pe.DASHBOARD_ADMIN||t===pe.DASHBOARD_STAFF;if(D(!1),b==="#/login"){if(T){window.location.hash!=="#/"&&(window.location.hash="/");return}t!==pe.LOGIN&&!i&&d(()=>{o(pe.LOGIN),window.scrollTo(0,0)});return}if(b.startsWith("#/berita/")){const F=b.split("#/berita/");if(F.length>1&&F[1].trim()!==""){const x=kt(F[1]);let l=r.berita;if(!l){h(!0);try{const I=await a("berita",G.getBerita,"App.tsx DeepLink",!1,!1);l=Array.isArray(I)?I:(I==null?void 0:I.item)||[]}catch(I){console.error(I)}finally{h(!1)}}if(l&&Array.isArray(l)){const I=l.find(_=>_.judul&&_.judul.toLowerCase()===x.toLowerCase());if(I){d(()=>{k("BERITA"),p(I),u(null),t!==pe.LANDING&&o(pe.LANDING),window.scrollTo(0,0)});return}}}}if(b.startsWith("#/donasi/")){const F=b.split("#/donasi/");if(F.length>1&&F[1].trim()!==""){const x=kt(F[1]);let l=r.donasi;if(!l){h(!0);try{l=await a("donasi",G.getDonasiRencana,"App.tsx DeepLink Donasi",!1,!1)}catch(_){console.error(_)}finally{h(!1)}}let I=[];if(Array.isArray(l)?l.length>0&&l[0].rencana?I=l[0].rencana:I=l:(E=l==null?void 0:l.kampanye)!=null&&E.item&&(I=l.kampanye.item),I.length>0){const _=I.find(n=>n.judul&&n.judul.toLowerCase()===x.toLowerCase());if(_){d(()=>{k("DONASI"),u(_),p(null),t!==pe.LANDING&&o(pe.LANDING),window.scrollTo(0,0)});return}}}}if(M){k("ERROR_CONNECTION");return}const $=vt(b);d(()=>{t===pe.LOGIN&&!i&&o(pe.LANDING),t===pe.LANDING&&(k($),b.startsWith("#/berita/")||p(null),b.startsWith("#/donasi/")||u(null),window.scrollTo(0,0))})};return S(),window.addEventListener("hashchange",S),()=>window.removeEventListener("hashchange",S)},[t,i,r.berita,r.donasi,a,M]);const C=S=>{const T={HOME:"/",PROFIL:"/profil",AKADEMIK:"/akademik",FASILITAS:"/fasilitas",GALERI:"/galeri",BERITA:"/berita",PENDAFTARAN:"/pendaftaran",DONASI:"/donasi",KOPERASI:"/koperasi",AI_CHAT:"/chat",ERROR_404:"/error/404",ERROR_CONNECTION:"/error/koneksi"}[S]||"/";D(!1),S==="BERITA"?window.location.hash="/berita":S==="DONASI"?window.location.hash="/donasi":window.location.hash=T},L=()=>{g(!0),D(!1),setTimeout(()=>{window.location.hash="/login",d(()=>{o(pe.LOGIN),window.scrollTo(0,0)}),setTimeout(()=>{g(!1)},500)},1500)},P=()=>{g(!0),setTimeout(()=>{window.location.hash="/",d(()=>{o(pe.LANDING),k("HOME"),window.scrollTo(0,0)}),setTimeout(()=>{g(!1)},500)},1500)},y=()=>{localStorage.removeItem("miftahulhuda_user"),localStorage.removeItem("miftahulhuda_active_module_admin"),localStorage.removeItem("miftahulhuda_active_module_wali"),P()},z=()=>{const b={[pe.DASHBOARD_USER]:Fs,[pe.DASHBOARD_ADMIN]:jt,[pe.DASHBOARD_STAFF]:jt}[t];return b?e.jsx(b,{onLogout:y}):null},j=()=>{if(K)return e.jsx(fe,{message:"Memuat Konten...",fullScreen:!0});if(c==="ERROR_CONNECTION"||M)return e.jsx(mt,{});if(B)return e.jsx(ys,{news:B,onNewsClick:()=>{window.location.hash="/berita"}});switch(c){case"HOME":return e.jsx(yt,{onNavigate:C,onLogin:L,onNewsClick:S=>{window.location.hash=`/berita/${S.judul.replace(/\s+/g,"+")}`}});case"PROFIL":return e.jsx(_t,{});case"AKADEMIK":return e.jsx(St,{});case"FASILITAS":return e.jsx(Zt,{});case"GALERI":return e.jsx(as,{});case"BERITA":return e.jsx(ss,{onNewsSelect:S=>{window.location.hash=`/berita/${S.judul.replace(/\s+/g,"+")}`}});case"PENDAFTARAN":return e.jsx(Ct,{});case"DONASI":return e.jsx(gs,{initialSelectedCampaign:m});case"KOPERASI":return e.jsx(bs,{});case"AI_CHAT":return e.jsx(ks,{onNavigate:C});case"ERROR_404":return e.jsx(ct,{onBack:()=>C("HOME")});case"ERROR_CONNECTION":return e.jsx(mt,{});default:return e.jsx(ct,{onBack:()=>C("HOME")})}},N=B!==null||m!==null||c==="ERROR_404"||c==="ERROR_CONNECTION",A=c==="ERROR_404"||c==="ERROR_CONNECTION";return e.jsxs(e.Fragment,{children:[e.jsx(er,{}),i&&e.jsx(fe,{message:"Mengalihkan...",fullScreen:!0}),e.jsxs("div",{className:"min-h-screen flex flex-col relative bg-white",children:[t===pe.LANDING&&!N&&!A&&e.jsx(Ot,{activePage:c,onNavigate:C,onLogin:L,selectedNews:B,onBackNews:()=>{window.location.hash="/berita"},isMobileMenuOpen:f,setIsMobileMenuOpen:D}),e.jsx("main",{className:`flex-1 ${t===pe.LANDING&&!N&&!A?c==="AI_CHAT"?"page-content-wrapper":"page-content-wrapper pb-20 md:pb-0":""}`,children:t===pe.LANDING?j():t===pe.LOGIN?e.jsx(Zn,{onNavigate:S=>{d(()=>o(S))},onNavigateBack:P}):z()}),t===pe.LANDING&&c!=="AI_CHAT"&&!N&&!A&&e.jsx(Ft,{onNavigate:C}),c!=="AI_CHAT"&&!N&&!A&&e.jsx("div",{className:"hidden md:block",children:e.jsx(js,{onOpenFullChat:()=>C("AI_CHAT")})}),t===pe.LANDING&&c!=="AI_CHAT"&&!N&&!A&&e.jsx(Vt,{activePage:c,onNavigate:C,onLogin:L,forceHide:f})]})]})}const Kt=document.getElementById("root");if(!Kt)throw new Error("Could not find root element to mount to");const tr=Rt.createRoot(Kt);tr.render(e.jsx(ja.StrictMode,{children:e.jsx(Wt,{children:e.jsx(ar,{})})}));
